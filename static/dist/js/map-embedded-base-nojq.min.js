function initMap(a){var b,c=a.base||"map";switch(c){case"photo":b=LAYER_MAPBOX_SAT;break;case"map":default:b=isMobile?LAYER_MAPBOX_MAP:LAYER_MAPBOX_GL_MAP}var d={attributionControl:!1,zoomControl:!1,dragging:!0,closePopupOnClick:!1,crs:L.CRS.EPSG3857,minZoom:MIN_ZOOM,maxZoom:MAX_ZOOM,zoomSnap:0,layers:[b]};if(navigator.userAgent.match(/Android (4|5)/)&&(d.fadeAnimation=!0,d.zoomAnimation=!0,d.markerZoomAnimation=!0),MAP=new L.Map("map_canvas",d),new L.Control.Zoom({position:"bottomright"}).addTo(MAP),a.lat&&a.lng&&a.zoom){var e=parseFloat(a.lat),f=parseFloat(a.lng),g=parseInt(a.zoom);MAP.setView(L.latLng(e,f),g),a.drop_marker&&(MAP.addLayer(MARKER_TARGET),MARKER_TARGET.setLatLng(L.latLng(e,f)))}else MAP.fitBounds(MAX_BOUNDS);L.control.scale().addTo(MAP),$.event.trigger({type:"mapInitialized"})}function lineWKTtoFeature(a,b){var c=new Wkt.Wkt;return c.read(a),c.toObject(b)}function placeTargetMarker(a,b){MAP.addLayer(MARKER_TARGET),MARKER_TARGET.setLatLng(L.latLng(a,b))}function clearTargetMarker(){MAP.hasLayer(MARKER_TARGET)&&MAP.removeLayer(MARKER_TARGET)}function placeGPSMarker(a,b){MAP.addLayer(MARKER_GPS),MARKER_GPS.setLatLng(L.latLng(a,b))}function clearGPSMarker(){MAP.removeLayer(MARKER_GPS)}function showInfoPopup(a,b){switch(MAP.removeLayer(INFO_POPUP),b){case"warning":classes="info-popup warning";break;case"error":classes="info-popup error";break;default:classes="info-popup"}INFO_POPUP=L.popup({className:classes}).setLatLng(MAP.getCenter()).setContent(a).openOn(MAP)}function changeBasemap(a){for("map"==a&&(isMobile||(a="vector")),new_active_layer=AVAILABLE_LAYERS[a],i=0;i<ALL_LAYERS.length;i++)ALL_LAYERS[i]==new_active_layer?(MAP.hasLayer(ALL_LAYERS[i])||MAP.addLayer(ALL_LAYERS[i],!0),"vector"!=a&&new_active_layer.bringToBack()):MAP.hasLayer(ALL_LAYERS[i])&&MAP.removeLayer(ALL_LAYERS[i])}function latlng_formatted(a,b){switch(format=null!=b?b:SETTINGS.coordinate_format,format){case"dms":return latlng_as_dms(a);case"ddm":return latlng_as_ddm(a);case"dd":return latlng_as_dd(a);default:return latlng_as_dms(a)}}function latlng_as_dms(a,b){b=void 0!==b?b:0;var c=a.lat<0?"S":"N",d=a.lng<0?"W":"E";lat_dd=Math.abs(a.lat),lng_dd=Math.abs(a.lng);var e=parseInt(lat_dd),f=parseInt(60*(lat_dd-e)),g=(3600*(lat_dd-e-f/60)).toFixed(b),h=parseInt(lng_dd),i=parseInt(60*(lng_dd-h)),j=(3600*(lng_dd-h-i/60)).toFixed(b);return latlng_str=e+"° "+f+"' "+g+'" '+c+", "+h+"° "+i+"' "+j+'" '+d,latlng_str}function latlng_as_ddm(a,b){b=void 0!==b?b:2;var c=a.lat<0?"S":"N",d=a.lng<0?"W":"E",e=Math.abs(a.lat),f=Math.abs(a.lng),g=parseInt(e),h=(60*(e-g)).toFixed(b),i=parseInt(f),j=(60*(f-i)).toFixed(b);return latlng_str=g+"° "+h+"' "+c+", "+i+"° "+j+"' "+d,latlng_str}function latlng_as_dd(a,b){return b=void 0!==b?b:4,latlng_str=a.lat.toFixed(b)+", "+a.lng.toFixed(b),latlng_str}!function(a,b,c){var d={version:"1.0.3+ed36a04"};"object"==typeof module&&"object"==typeof module.exports?module.exports=d:"function"==typeof define&&define.amd&&define(d),void 0!==a&&function(){var b=a.L;d.noConflict=function(){return a.L=b,this},a.L=d}(),d.Util={extend:function(a){var b,c,d,e;for(c=1,d=arguments.length;c<d;c++){e=arguments[c];for(b in e)a[b]=e[b]}return a},create:Object.create||function(){function a(){}return function(b){return a.prototype=b,new a}}(),bind:function(a,b){var c=Array.prototype.slice;if(a.bind)return a.bind.apply(a,c.call(arguments,1));var d=c.call(arguments,2);return function(){return a.apply(b,d.length?d.concat(c.call(arguments)):arguments)}},stamp:function(a){return a._leaflet_id=a._leaflet_id||++d.Util.lastId,a._leaflet_id},lastId:0,throttle:function(a,b,c){var d,e,f,g;return g=function(){d=!1,e&&(f.apply(c,e),e=!1)},f=function(){d?e=arguments:(a.apply(c,arguments),setTimeout(g,b),d=!0)}},wrapNum:function(a,b,c){var d=b[1],e=b[0],f=d-e;return a===d&&c?a:((a-e)%f+f)%f+e},falseFn:function(){return!1},formatNum:function(a,b){var c=Math.pow(10,b||5);return Math.round(a*c)/c},trim:function(a){return a.trim?a.trim():a.replace(/^\s+|\s+$/g,"")},splitWords:function(a){return d.Util.trim(a).split(/\s+/)},setOptions:function(a,b){a.hasOwnProperty("options")||(a.options=a.options?d.Util.create(a.options):{});for(var c in b)a.options[c]=b[c];return a.options},getParamString:function(a,b,c){var d=[];for(var e in a)d.push(encodeURIComponent(c?e.toUpperCase():e)+"="+encodeURIComponent(a[e]));return(b&&-1!==b.indexOf("?")?"&":"?")+d.join("&")},template:function(a,b){return a.replace(d.Util.templateRe,function(a,d){var e=b[d];if(e===c)throw new Error("No value provided for variable "+a);return"function"==typeof e&&(e=e(b)),e})},templateRe:/\{ *([\w_\-]+) *\}/g,isArray:Array.isArray||function(a){return"[object Array]"===Object.prototype.toString.call(a)},indexOf:function(a,b){for(var c=0;c<a.length;c++)if(a[c]===b)return c;return-1},emptyImageUrl:"data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs="},function(){function b(b){return a["webkit"+b]||a["moz"+b]||a["ms"+b]}function c(b){var c=+new Date,d=Math.max(0,16-(c-e));return e=c+d,a.setTimeout(b,d)}var e=0,f=a.requestAnimationFrame||b("RequestAnimationFrame")||c,g=a.cancelAnimationFrame||b("CancelAnimationFrame")||b("CancelRequestAnimationFrame")||function(b){a.clearTimeout(b)};d.Util.requestAnimFrame=function(b,e,g){return g&&f===c?void b.call(e):f.call(a,d.bind(b,e))},d.Util.cancelAnimFrame=function(b){b&&g.call(a,b)}}(),d.extend=d.Util.extend,d.bind=d.Util.bind,d.stamp=d.Util.stamp,d.setOptions=d.Util.setOptions,d.Class=function(){},d.Class.extend=function(a){var b=function(){this.initialize&&this.initialize.apply(this,arguments),this.callInitHooks()},c=b.__super__=this.prototype,e=d.Util.create(c);e.constructor=b,b.prototype=e;for(var f in this)this.hasOwnProperty(f)&&"prototype"!==f&&(b[f]=this[f]);return a.statics&&(d.extend(b,a.statics),delete a.statics),a.includes&&(d.Util.extend.apply(null,[e].concat(a.includes)),delete a.includes),e.options&&(a.options=d.Util.extend(d.Util.create(e.options),a.options)),d.extend(e,a),e._initHooks=[],e.callInitHooks=function(){if(!this._initHooksCalled){c.callInitHooks&&c.callInitHooks.call(this),this._initHooksCalled=!0;for(var a=0,b=e._initHooks.length;a<b;a++)e._initHooks[a].call(this)}},b},d.Class.include=function(a){return d.extend(this.prototype,a),this},d.Class.mergeOptions=function(a){return d.extend(this.prototype.options,a),this},d.Class.addInitHook=function(a){var b=Array.prototype.slice.call(arguments,1),c="function"==typeof a?a:function(){this[a].apply(this,b)};return this.prototype._initHooks=this.prototype._initHooks||[],this.prototype._initHooks.push(c),this},d.Evented=d.Class.extend({on:function(a,b,c){if("object"==typeof a)for(var e in a)this._on(e,a[e],b);else{a=d.Util.splitWords(a);for(var f=0,g=a.length;f<g;f++)this._on(a[f],b,c)}return this},off:function(a,b,c){if(a)if("object"==typeof a)for(var e in a)this._off(e,a[e],b);else{a=d.Util.splitWords(a);for(var f=0,g=a.length;f<g;f++)this._off(a[f],b,c)}else delete this._events;return this},_on:function(a,b,d){this._events=this._events||{};var e=this._events[a];e||(e=[],this._events[a]=e),d===this&&(d=c);for(var f={fn:b,ctx:d},g=e,h=0,i=g.length;h<i;h++)if(g[h].fn===b&&g[h].ctx===d)return;g.push(f)},_off:function(a,b,e){var f,g,h;if(this._events&&(f=this._events[a])){if(!b){for(g=0,h=f.length;g<h;g++)f[g].fn=d.Util.falseFn;return void delete this._events[a]}if(e===this&&(e=c),f)for(g=0,h=f.length;g<h;g++){var i=f[g];if(i.ctx===e&&i.fn===b)return i.fn=d.Util.falseFn,this._firingCount&&(this._events[a]=f=f.slice()),void f.splice(g,1)}}},fire:function(a,b,c){if(!this.listens(a,c))return this;var e=d.Util.extend({},b,{type:a,target:this});if(this._events){var f=this._events[a];if(f){this._firingCount=this._firingCount+1||1;for(var g=0,h=f.length;g<h;g++){var i=f[g];i.fn.call(i.ctx||this,e)}this._firingCount--}}return c&&this._propagateEvent(e),this},listens:function(a,b){var c=this._events&&this._events[a];if(c&&c.length)return!0;if(b)for(var d in this._eventParents)if(this._eventParents[d].listens(a,b))return!0;return!1},once:function(a,b,c){if("object"==typeof a){for(var e in a)this.once(e,a[e],b);return this}var f=d.bind(function(){this.off(a,b,c).off(a,f,c)},this);return this.on(a,b,c).on(a,f,c)},addEventParent:function(a){return this._eventParents=this._eventParents||{},this._eventParents[d.stamp(a)]=a,this},removeEventParent:function(a){return this._eventParents&&delete this._eventParents[d.stamp(a)],this},_propagateEvent:function(a){for(var b in this._eventParents)this._eventParents[b].fire(a.type,d.extend({layer:a.target},a),!0)}});var e=d.Evented.prototype;e.addEventListener=e.on,e.removeEventListener=e.clearAllEventListeners=e.off,e.addOneTimeEventListener=e.once,e.fireEvent=e.fire,e.hasEventListeners=e.listens,d.Mixin={Events:e},function(){var c=navigator.userAgent.toLowerCase(),e=b.documentElement,f="ActiveXObject"in a,g=-1!==c.indexOf("webkit"),h=-1!==c.indexOf("phantom"),i=-1!==c.search("android [23]"),j=-1!==c.indexOf("chrome"),k=-1!==c.indexOf("gecko")&&!g&&!a.opera&&!f,l=0===navigator.platform.indexOf("Win"),m="undefined"!=typeof orientation||-1!==c.indexOf("mobile"),n=!a.PointerEvent&&a.MSPointerEvent,o=a.PointerEvent||n,p=f&&"transition"in e.style,q="WebKitCSSMatrix"in a&&"m11"in new a.WebKitCSSMatrix&&!i,r="MozPerspective"in e.style,s="OTransition"in e.style,t=!a.L_NO_TOUCH&&(o||"ontouchstart"in a||a.DocumentTouch&&b instanceof a.DocumentTouch);d.Browser={ie:f,ielt9:f&&!b.addEventListener,edge:"msLaunchUri"in navigator&&!("documentMode"in b),webkit:g,gecko:k,android:-1!==c.indexOf("android"),android23:i,chrome:j,safari:!j&&-1!==c.indexOf("safari"),win:l,ie3d:p,webkit3d:q,gecko3d:r,opera12:s,any3d:!a.L_DISABLE_3D&&(p||q||r)&&!s&&!h,mobile:m,mobileWebkit:m&&g,mobileWebkit3d:m&&q,mobileOpera:m&&a.opera,mobileGecko:m&&k,touch:!!t,msPointer:!!n,pointer:!!o,retina:(a.devicePixelRatio||a.screen.deviceXDPI/a.screen.logicalXDPI)>1}}(),d.Point=function(a,b,c){this.x=c?Math.round(a):a,this.y=c?Math.round(b):b},d.Point.prototype={clone:function(){return new d.Point(this.x,this.y)},add:function(a){return this.clone()._add(d.point(a))},_add:function(a){return this.x+=a.x,this.y+=a.y,this},subtract:function(a){return this.clone()._subtract(d.point(a))},_subtract:function(a){return this.x-=a.x,this.y-=a.y,this},divideBy:function(a){return this.clone()._divideBy(a)},_divideBy:function(a){return this.x/=a,this.y/=a,this},multiplyBy:function(a){return this.clone()._multiplyBy(a)},_multiplyBy:function(a){return this.x*=a,this.y*=a,this},scaleBy:function(a){return new d.Point(this.x*a.x,this.y*a.y)},unscaleBy:function(a){return new d.Point(this.x/a.x,this.y/a.y)},round:function(){return this.clone()._round()},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},floor:function(){return this.clone()._floor()},_floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},ceil:function(){return this.clone()._ceil()},_ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this},distanceTo:function(a){a=d.point(a);var b=a.x-this.x,c=a.y-this.y;return Math.sqrt(b*b+c*c)},equals:function(a){return a=d.point(a),a.x===this.x&&a.y===this.y},contains:function(a){return a=d.point(a),Math.abs(a.x)<=Math.abs(this.x)&&Math.abs(a.y)<=Math.abs(this.y)},toString:function(){return"Point("+d.Util.formatNum(this.x)+", "+d.Util.formatNum(this.y)+")"}},d.point=function(a,b,e){return a instanceof d.Point?a:d.Util.isArray(a)?new d.Point(a[0],a[1]):a===c||null===a?a:"object"==typeof a&&"x"in a&&"y"in a?new d.Point(a.x,a.y):new d.Point(a,b,e)},d.Bounds=function(a,b){if(a)for(var c=b?[a,b]:a,d=0,e=c.length;d<e;d++)this.extend(c[d])},d.Bounds.prototype={extend:function(a){return a=d.point(a),this.min||this.max?(this.min.x=Math.min(a.x,this.min.x),this.max.x=Math.max(a.x,this.max.x),this.min.y=Math.min(a.y,this.min.y),this.max.y=Math.max(a.y,this.max.y)):(this.min=a.clone(),this.max=a.clone()),this},getCenter:function(a){return new d.Point((this.min.x+this.max.x)/2,(this.min.y+this.max.y)/2,a)},getBottomLeft:function(){return new d.Point(this.min.x,this.max.y)},getTopRight:function(){return new d.Point(this.max.x,this.min.y)},getSize:function(){return this.max.subtract(this.min)},contains:function(a){var b,c;return a="number"==typeof a[0]||a instanceof d.Point?d.point(a):d.bounds(a),a instanceof d.Bounds?(b=a.min,c=a.max):b=c=a,b.x>=this.min.x&&c.x<=this.max.x&&b.y>=this.min.y&&c.y<=this.max.y},intersects:function(a){a=d.bounds(a);var b=this.min,c=this.max,e=a.min,f=a.max,g=f.x>=b.x&&e.x<=c.x,h=f.y>=b.y&&e.y<=c.y;return g&&h},overlaps:function(a){a=d.bounds(a);var b=this.min,c=this.max,e=a.min,f=a.max,g=f.x>b.x&&e.x<c.x,h=f.y>b.y&&e.y<c.y;return g&&h},isValid:function(){return!(!this.min||!this.max)}},d.bounds=function(a,b){return!a||a instanceof d.Bounds?a:new d.Bounds(a,b)},d.Transformation=function(a,b,c,d){this._a=a,this._b=b,this._c=c,this._d=d},d.Transformation.prototype={transform:function(a,b){return this._transform(a.clone(),b)},_transform:function(a,b){return b=b||1,a.x=b*(this._a*a.x+this._b),a.y=b*(this._c*a.y+this._d),a},untransform:function(a,b){return b=b||1,new d.Point((a.x/b-this._b)/this._a,(a.y/b-this._d)/this._c)}},d.DomUtil={get:function(a){return"string"==typeof a?b.getElementById(a):a},getStyle:function(a,c){var d=a.style[c]||a.currentStyle&&a.currentStyle[c];if((!d||"auto"===d)&&b.defaultView){var e=b.defaultView.getComputedStyle(a,null);d=e?e[c]:null}return"auto"===d?null:d},create:function(a,c,d){var e=b.createElement(a);return e.className=c||"",d&&d.appendChild(e),e},remove:function(a){var b=a.parentNode;b&&b.removeChild(a)},empty:function(a){for(;a.firstChild;)a.removeChild(a.firstChild)},toFront:function(a){a.parentNode.appendChild(a)},toBack:function(a){var b=a.parentNode;b.insertBefore(a,b.firstChild)},hasClass:function(a,b){if(a.classList!==c)return a.classList.contains(b);var e=d.DomUtil.getClass(a);return e.length>0&&new RegExp("(^|\\s)"+b+"(\\s|$)").test(e)},addClass:function(a,b){if(a.classList!==c)for(var e=d.Util.splitWords(b),f=0,g=e.length;f<g;f++)a.classList.add(e[f]);else if(!d.DomUtil.hasClass(a,b)){var h=d.DomUtil.getClass(a);d.DomUtil.setClass(a,(h?h+" ":"")+b)}},removeClass:function(a,b){a.classList!==c?a.classList.remove(b):d.DomUtil.setClass(a,d.Util.trim((" "+d.DomUtil.getClass(a)+" ").replace(" "+b+" "," ")))},setClass:function(a,b){a.className.baseVal===c?a.className=b:a.className.baseVal=b},getClass:function(a){return a.className.baseVal===c?a.className:a.className.baseVal},setOpacity:function(a,b){"opacity"in a.style?a.style.opacity=b:"filter"in a.style&&d.DomUtil._setOpacityIE(a,b)},_setOpacityIE:function(a,b){var c=!1,d="DXImageTransform.Microsoft.Alpha";try{c=a.filters.item(d)}catch(a){if(1===b)return}b=Math.round(100*b),c?(c.Enabled=100!==b,c.Opacity=b):a.style.filter+=" progid:"+d+"(opacity="+b+")"},testProp:function(a){for(var c=b.documentElement.style,d=0;d<a.length;d++)if(a[d]in c)return a[d];return!1},setTransform:function(a,b,c){var e=b||new d.Point(0,0);a.style[d.DomUtil.TRANSFORM]=(d.Browser.ie3d?"translate("+e.x+"px,"+e.y+"px)":"translate3d("+e.x+"px,"+e.y+"px,0)")+(c?" scale("+c+")":"")},setPosition:function(a,b){a._leaflet_pos=b,d.Browser.any3d?d.DomUtil.setTransform(a,b):(a.style.left=b.x+"px",a.style.top=b.y+"px")},getPosition:function(a){return a._leaflet_pos||new d.Point(0,0)}},function(){d.DomUtil.TRANSFORM=d.DomUtil.testProp(["transform","WebkitTransform","OTransform","MozTransform","msTransform"]);var c=d.DomUtil.TRANSITION=d.DomUtil.testProp(["webkitTransition","transition","OTransition","MozTransition","msTransition"]);if(d.DomUtil.TRANSITION_END="webkitTransition"===c||"OTransition"===c?c+"End":"transitionend","onselectstart"in b)d.DomUtil.disableTextSelection=function(){d.DomEvent.on(a,"selectstart",d.DomEvent.preventDefault)},d.DomUtil.enableTextSelection=function(){d.DomEvent.off(a,"selectstart",d.DomEvent.preventDefault)};else{var e=d.DomUtil.testProp(["userSelect","WebkitUserSelect","OUserSelect","MozUserSelect","msUserSelect"]);d.DomUtil.disableTextSelection=function(){if(e){var a=b.documentElement.style;this._userSelect=a[e],a[e]="none"}},d.DomUtil.enableTextSelection=function(){e&&(b.documentElement.style[e]=this._userSelect,delete this._userSelect)}}d.DomUtil.disableImageDrag=function(){d.DomEvent.on(a,"dragstart",d.DomEvent.preventDefault)},d.DomUtil.enableImageDrag=function(){d.DomEvent.off(a,"dragstart",d.DomEvent.preventDefault)},d.DomUtil.preventOutline=function(b){for(;-1===b.tabIndex;)b=b.parentNode;b&&b.style&&(d.DomUtil.restoreOutline(),this._outlineElement=b,this._outlineStyle=b.style.outline,b.style.outline="none",d.DomEvent.on(a,"keydown",d.DomUtil.restoreOutline,this))},d.DomUtil.restoreOutline=function(){this._outlineElement&&(this._outlineElement.style.outline=this._outlineStyle,delete this._outlineElement,delete this._outlineStyle,d.DomEvent.off(a,"keydown",d.DomUtil.restoreOutline,this))}}(),d.LatLng=function(a,b,d){if(isNaN(a)||isNaN(b))throw new Error("Invalid LatLng object: ("+a+", "+b+")");this.lat=+a,this.lng=+b,d!==c&&(this.alt=+d)},d.LatLng.prototype={equals:function(a,b){return!!a&&(a=d.latLng(a),Math.max(Math.abs(this.lat-a.lat),Math.abs(this.lng-a.lng))<=(b===c?1e-9:b))},toString:function(a){return"LatLng("+d.Util.formatNum(this.lat,a)+", "+d.Util.formatNum(this.lng,a)+")"},distanceTo:function(a){return d.CRS.Earth.distance(this,d.latLng(a))},wrap:function(){return d.CRS.Earth.wrapLatLng(this)},toBounds:function(a){var b=180*a/40075017,c=b/Math.cos(Math.PI/180*this.lat);return d.latLngBounds([this.lat-b,this.lng-c],[this.lat+b,this.lng+c])},clone:function(){return new d.LatLng(this.lat,this.lng,this.alt)}},d.latLng=function(a,b,e){return a instanceof d.LatLng?a:d.Util.isArray(a)&&"object"!=typeof a[0]?3===a.length?new d.LatLng(a[0],a[1],a[2]):2===a.length?new d.LatLng(a[0],a[1]):null:a===c||null===a?a:"object"==typeof a&&"lat"in a?new d.LatLng(a.lat,"lng"in a?a.lng:a.lon,a.alt):b===c?null:new d.LatLng(a,b,e)},d.LatLngBounds=function(a,b){if(a)for(var c=b?[a,b]:a,d=0,e=c.length;d<e;d++)this.extend(c[d])},d.LatLngBounds.prototype={extend:function(a){var b,c,e=this._southWest,f=this._northEast;if(a instanceof d.LatLng)b=a,c=a;else{if(!(a instanceof d.LatLngBounds))return a?this.extend(d.latLng(a)||d.latLngBounds(a)):this;if(b=a._southWest,c=a._northEast,!b||!c)return this}return e||f?(e.lat=Math.min(b.lat,e.lat),e.lng=Math.min(b.lng,e.lng),f.lat=Math.max(c.lat,f.lat),f.lng=Math.max(c.lng,f.lng)):(this._southWest=new d.LatLng(b.lat,b.lng),this._northEast=new d.LatLng(c.lat,c.lng)),this},pad:function(a){var b=this._southWest,c=this._northEast,e=Math.abs(b.lat-c.lat)*a,f=Math.abs(b.lng-c.lng)*a;return new d.LatLngBounds(new d.LatLng(b.lat-e,b.lng-f),new d.LatLng(c.lat+e,c.lng+f))},getCenter:function(){return new d.LatLng((this._southWest.lat+this._northEast.lat)/2,(this._southWest.lng+this._northEast.lng)/2)},getSouthWest:function(){return this._southWest},getNorthEast:function(){return this._northEast},getNorthWest:function(){return new d.LatLng(this.getNorth(),this.getWest())},getSouthEast:function(){return new d.LatLng(this.getSouth(),this.getEast())},getWest:function(){return this._southWest.lng},getSouth:function(){return this._southWest.lat},getEast:function(){return this._northEast.lng},getNorth:function(){return this._northEast.lat},contains:function(a){a="number"==typeof a[0]||a instanceof d.LatLng||"lat"in a?d.latLng(a):d.latLngBounds(a);var b,c,e=this._southWest,f=this._northEast;return a instanceof d.LatLngBounds?(b=a.getSouthWest(),c=a.getNorthEast()):b=c=a,b.lat>=e.lat&&c.lat<=f.lat&&b.lng>=e.lng&&c.lng<=f.lng},intersects:function(a){a=d.latLngBounds(a);var b=this._southWest,c=this._northEast,e=a.getSouthWest(),f=a.getNorthEast(),g=f.lat>=b.lat&&e.lat<=c.lat,h=f.lng>=b.lng&&e.lng<=c.lng;return g&&h},overlaps:function(a){a=d.latLngBounds(a);var b=this._southWest,c=this._northEast,e=a.getSouthWest(),f=a.getNorthEast(),g=f.lat>b.lat&&e.lat<c.lat,h=f.lng>b.lng&&e.lng<c.lng;return g&&h},toBBoxString:function(){return[this.getWest(),this.getSouth(),this.getEast(),this.getNorth()].join(",")},equals:function(a){return!!a&&(a=d.latLngBounds(a),this._southWest.equals(a.getSouthWest())&&this._northEast.equals(a.getNorthEast()))},isValid:function(){return!(!this._southWest||!this._northEast)}},d.latLngBounds=function(a,b){return a instanceof d.LatLngBounds?a:new d.LatLngBounds(a,b)},d.Projection={},d.Projection.LonLat={project:function(a){return new d.Point(a.lng,a.lat)},unproject:function(a){return new d.LatLng(a.y,a.x)},bounds:d.bounds([-180,-90],[180,90])},d.Projection.SphericalMercator={R:6378137,MAX_LATITUDE:85.0511287798,project:function(a){var b=Math.PI/180,c=this.MAX_LATITUDE,e=Math.max(Math.min(c,a.lat),-c),f=Math.sin(e*b);return new d.Point(this.R*a.lng*b,this.R*Math.log((1+f)/(1-f))/2)},unproject:function(a){var b=180/Math.PI;return new d.LatLng((2*Math.atan(Math.exp(a.y/this.R))-Math.PI/2)*b,a.x*b/this.R)},bounds:function(){var a=6378137*Math.PI;return d.bounds([-a,-a],[a,a])}()},d.CRS={latLngToPoint:function(a,b){var c=this.projection.project(a),d=this.scale(b);return this.transformation._transform(c,d)},pointToLatLng:function(a,b){var c=this.scale(b),d=this.transformation.untransform(a,c);return this.projection.unproject(d)},project:function(a){return this.projection.project(a)},unproject:function(a){return this.projection.unproject(a)},scale:function(a){return 256*Math.pow(2,a)},zoom:function(a){return Math.log(a/256)/Math.LN2},getProjectedBounds:function(a){if(this.infinite)return null;var b=this.projection.bounds,c=this.scale(a),e=this.transformation.transform(b.min,c),f=this.transformation.transform(b.max,c);return d.bounds(e,f)},infinite:!1,wrapLatLng:function(a){var b=this.wrapLng?d.Util.wrapNum(a.lng,this.wrapLng,!0):a.lng,c=this.wrapLat?d.Util.wrapNum(a.lat,this.wrapLat,!0):a.lat,e=a.alt;return d.latLng(c,b,e)},wrapLatLngBounds:function(a){var b=a.getCenter(),c=this.wrapLatLng(b),e=b.lat-c.lat,f=b.lng-c.lng;if(0===e&&0===f)return a;var g=a.getSouthWest(),h=a.getNorthEast(),i=d.latLng({lat:g.lat-e,lng:g.lng-f}),j=d.latLng({lat:h.lat-e,lng:h.lng-f});return new d.LatLngBounds(i,j)}},d.CRS.Simple=d.extend({},d.CRS,{projection:d.Projection.LonLat,transformation:new d.Transformation(1,0,-1,0),scale:function(a){return Math.pow(2,a)},zoom:function(a){return Math.log(a)/Math.LN2},distance:function(a,b){var c=b.lng-a.lng,d=b.lat-a.lat;return Math.sqrt(c*c+d*d)},infinite:!0}),d.CRS.Earth=d.extend({},d.CRS,{wrapLng:[-180,180],R:6371e3,distance:function(a,b){var c=Math.PI/180,d=a.lat*c,e=b.lat*c,f=Math.sin(d)*Math.sin(e)+Math.cos(d)*Math.cos(e)*Math.cos((b.lng-a.lng)*c);return this.R*Math.acos(Math.min(f,1))}}),d.CRS.EPSG3857=d.extend({},d.CRS.Earth,{code:"EPSG:3857",projection:d.Projection.SphericalMercator,transformation:function(){var a=.5/(Math.PI*d.Projection.SphericalMercator.R);return new d.Transformation(a,.5,-a,.5)}()}),d.CRS.EPSG900913=d.extend({},d.CRS.EPSG3857,{code:"EPSG:900913"}),d.CRS.EPSG4326=d.extend({},d.CRS.Earth,{code:"EPSG:4326",projection:d.Projection.LonLat,transformation:new d.Transformation(1/180,1,-1/180,.5)}),d.Map=d.Evented.extend({options:{crs:d.CRS.EPSG3857,center:c,zoom:c,minZoom:c,maxZoom:c,layers:[],maxBounds:c,renderer:c,zoomAnimation:!0,zoomAnimationThreshold:4,fadeAnimation:!0,markerZoomAnimation:!0,transform3DLimit:8388608,zoomSnap:1,zoomDelta:1,trackResize:!0},initialize:function(a,b){b=d.setOptions(this,b),this._initContainer(a),this._initLayout(),this._onResize=d.bind(this._onResize,this),this._initEvents(),b.maxBounds&&this.setMaxBounds(b.maxBounds),b.zoom!==c&&(this._zoom=this._limitZoom(b.zoom)),b.center&&b.zoom!==c&&this.setView(d.latLng(b.center),b.zoom,{reset:!0}),this._handlers=[],this._layers={},this._zoomBoundLayers={},this._sizeChanged=!0,this.callInitHooks(),this._zoomAnimated=d.DomUtil.TRANSITION&&d.Browser.any3d&&!d.Browser.mobileOpera&&this.options.zoomAnimation,this._zoomAnimated&&(this._createAnimProxy(),d.DomEvent.on(this._proxy,d.DomUtil.TRANSITION_END,this._catchTransitionEnd,this)),this._addLayers(this.options.layers)},setView:function(a,b,e){if(b=b===c?this._zoom:this._limitZoom(b),a=this._limitCenter(d.latLng(a),b,this.options.maxBounds),e=e||{},this._stop(),this._loaded&&!e.reset&&!0!==e){e.animate!==c&&(e.zoom=d.extend({animate:e.animate},e.zoom),e.pan=d.extend({animate:e.animate,duration:e.duration},e.pan));if(this._zoom!==b?this._tryAnimatedZoom&&this._tryAnimatedZoom(a,b,e.zoom):this._tryAnimatedPan(a,e.pan))return clearTimeout(this._sizeTimer),this}return this._resetView(a,b),this},setZoom:function(a,b){return this._loaded?this.setView(this.getCenter(),a,{zoom:b}):(this._zoom=a,this)},zoomIn:function(a,b){return a=a||(d.Browser.any3d?this.options.zoomDelta:1),this.setZoom(this._zoom+a,b)},zoomOut:function(a,b){return a=a||(d.Browser.any3d?this.options.zoomDelta:1),this.setZoom(this._zoom-a,b)},setZoomAround:function(a,b,c){var e=this.getZoomScale(b),f=this.getSize().divideBy(2),g=a instanceof d.Point?a:this.latLngToContainerPoint(a),h=g.subtract(f).multiplyBy(1-1/e),i=this.containerPointToLatLng(f.add(h));return this.setView(i,b,{zoom:c})},_getBoundsCenterZoom:function(a,b){b=b||{},a=a.getBounds?a.getBounds():d.latLngBounds(a);var c=d.point(b.paddingTopLeft||b.padding||[0,0]),e=d.point(b.paddingBottomRight||b.padding||[0,0]),f=this.getBoundsZoom(a,!1,c.add(e));f="number"==typeof b.maxZoom?Math.min(b.maxZoom,f):f;var g=e.subtract(c).divideBy(2),h=this.project(a.getSouthWest(),f),i=this.project(a.getNorthEast(),f);return{center:this.unproject(h.add(i).divideBy(2).add(g),f),zoom:f}},fitBounds:function(a,b){if(a=d.latLngBounds(a),!a.isValid())throw new Error("Bounds are not valid.");var c=this._getBoundsCenterZoom(a,b);return this.setView(c.center,c.zoom,b)},fitWorld:function(a){return this.fitBounds([[-90,-180],[90,180]],a)},panTo:function(a,b){return this.setView(a,this._zoom,{pan:b})},panBy:function(a,b){if(a=d.point(a).round(),b=b||{},!a.x&&!a.y)return this.fire("moveend");if(!0!==b.animate&&!this.getSize().contains(a))return this._resetView(this.unproject(this.project(this.getCenter()).add(a)),this.getZoom()),this;if(this._panAnim||(this._panAnim=new d.PosAnimation,this._panAnim.on({step:this._onPanTransitionStep,end:this._onPanTransitionEnd},this)),b.noMoveStart||this.fire("movestart"),!1!==b.animate){d.DomUtil.addClass(this._mapPane,"leaflet-pan-anim");var c=this._getMapPanePos().subtract(a).round();this._panAnim.run(this._mapPane,c,b.duration||.25,b.easeLinearity)}else this._rawPanBy(a),this.fire("move").fire("moveend");return this},flyTo:function(a,b,e){function f(a){var b=a?-1:1,c=a?s:r,d=s*s-r*r+b*v*v*t*t,e=2*c*v*t,f=d/e,g=Math.sqrt(f*f+1)-f;return g<1e-9?-18:Math.log(g)}function g(a){return(Math.exp(a)-Math.exp(-a))/2}function h(a){return(Math.exp(a)+Math.exp(-a))/2}function i(a){return g(a)/h(a)}function j(a){return r*(h(w)/h(w+u*a))}function k(a){return r*(h(w)*i(w+u*a)-g(w))/v}function l(a){return 1-Math.pow(1-a,1.5)}function m(){var c=(Date.now()-x)/z,e=l(c)*y;c<=1?(this._flyToFrame=d.Util.requestAnimFrame(m,this),this._move(this.unproject(n.add(o.subtract(n).multiplyBy(k(e)/t)),q),this.getScaleZoom(r/j(e),q),{flyTo:!0})):this._move(a,b)._moveEnd(!0)}if(e=e||{},!1===e.animate||!d.Browser.any3d)return this.setView(a,b,e);this._stop();var n=this.project(this.getCenter()),o=this.project(a),p=this.getSize(),q=this._zoom;a=d.latLng(a),b=b===c?q:b;var r=Math.max(p.x,p.y),s=r*this.getZoomScale(q,b),t=o.distanceTo(n)||1,u=1.42,v=u*u,w=f(0),x=Date.now(),y=(f(1)-w)/u,z=e.duration?1e3*e.duration:1e3*y*.8;return this._moveStart(!0),m.call(this),this},flyToBounds:function(a,b){var c=this._getBoundsCenterZoom(a,b);return this.flyTo(c.center,c.zoom,b)},setMaxBounds:function(a){return a=d.latLngBounds(a),a.isValid()?(this.options.maxBounds&&this.off("moveend",this._panInsideMaxBounds),this.options.maxBounds=a,this._loaded&&this._panInsideMaxBounds(),this.on("moveend",this._panInsideMaxBounds)):(this.options.maxBounds=null,this.off("moveend",this._panInsideMaxBounds))},setMinZoom:function(a){return this.options.minZoom=a,this._loaded&&this.getZoom()<this.options.minZoom?this.setZoom(a):this},setMaxZoom:function(a){return this.options.maxZoom=a,this._loaded&&this.getZoom()>this.options.maxZoom?this.setZoom(a):this},panInsideBounds:function(a,b){this._enforcingBounds=!0;var c=this.getCenter(),e=this._limitCenter(c,this._zoom,d.latLngBounds(a));return c.equals(e)||this.panTo(e,b),this._enforcingBounds=!1,this},invalidateSize:function(a){if(!this._loaded)return this;a=d.extend({animate:!1,pan:!0},!0===a?{animate:!0}:a);var b=this.getSize();this._sizeChanged=!0,this._lastCenter=null;var c=this.getSize(),e=b.divideBy(2).round(),f=c.divideBy(2).round(),g=e.subtract(f);return g.x||g.y?(a.animate&&a.pan?this.panBy(g):(a.pan&&this._rawPanBy(g),this.fire("move"),a.debounceMoveend?(clearTimeout(this._sizeTimer),this._sizeTimer=setTimeout(d.bind(this.fire,this,"moveend"),200)):this.fire("moveend")),this.fire("resize",{oldSize:b,newSize:c})):this},stop:function(){return this.setZoom(this._limitZoom(this._zoom)),this.options.zoomSnap||this.fire("viewreset"),this._stop()},locate:function(a){if(a=this._locateOptions=d.extend({timeout:1e4,watch:!1},a),!("geolocation"in navigator))return this._handleGeolocationError({code:0,message:"Geolocation not supported."}),this;var b=d.bind(this._handleGeolocationResponse,this),c=d.bind(this._handleGeolocationError,this);return a.watch?this._locationWatchId=navigator.geolocation.watchPosition(b,c,a):navigator.geolocation.getCurrentPosition(b,c,a),this},stopLocate:function(){return navigator.geolocation&&navigator.geolocation.clearWatch&&navigator.geolocation.clearWatch(this._locationWatchId),this._locateOptions&&(this._locateOptions.setView=!1),this},_handleGeolocationError:function(a){var b=a.code,c=a.message||(1===b?"permission denied":2===b?"position unavailable":"timeout");this._locateOptions.setView&&!this._loaded&&this.fitWorld(),this.fire("locationerror",{code:b,message:"Geolocation error: "+c+"."})},_handleGeolocationResponse:function(a){var b=a.coords.latitude,c=a.coords.longitude,e=new d.LatLng(b,c),f=e.toBounds(a.coords.accuracy),g=this._locateOptions;if(g.setView){var h=this.getBoundsZoom(f);this.setView(e,g.maxZoom?Math.min(h,g.maxZoom):h)}var i={latlng:e,bounds:f,timestamp:a.timestamp};for(var j in a.coords)"number"==typeof a.coords[j]&&(i[j]=a.coords[j]);this.fire("locationfound",i)},addHandler:function(a,b){if(!b)return this;var c=this[a]=new b(this);return this._handlers.push(c),this.options[a]&&c.enable(),this},remove:function(){if(this._initEvents(!0),this._containerId!==this._container._leaflet_id)throw new Error("Map container is being reused by another instance");try{delete this._container._leaflet_id,delete this._containerId}catch(a){this._container._leaflet_id=c,this._containerId=c}d.DomUtil.remove(this._mapPane),this._clearControlPos&&this._clearControlPos(),this._clearHandlers(),this._loaded&&this.fire("unload");for(var a in this._layers)this._layers[a].remove();return this},createPane:function(a,b){var c="leaflet-pane"+(a?" leaflet-"+a.replace("Pane","")+"-pane":""),e=d.DomUtil.create("div",c,b||this._mapPane);return a&&(this._panes[a]=e),e},getCenter:function(){return this._checkIfLoaded(),this._lastCenter&&!this._moved()?this._lastCenter:this.layerPointToLatLng(this._getCenterLayerPoint())},getZoom:function(){return this._zoom},getBounds:function(){var a=this.getPixelBounds(),b=this.unproject(a.getBottomLeft()),c=this.unproject(a.getTopRight());return new d.LatLngBounds(b,c)},getMinZoom:function(){return this.options.minZoom===c?this._layersMinZoom||0:this.options.minZoom},getMaxZoom:function(){return this.options.maxZoom===c?this._layersMaxZoom===c?1/0:this._layersMaxZoom:this.options.maxZoom},getBoundsZoom:function(a,b,c){a=d.latLngBounds(a),c=d.point(c||[0,0])
;var e=this.getZoom()||0,f=this.getMinZoom(),g=this.getMaxZoom(),h=a.getNorthWest(),i=a.getSouthEast(),j=this.getSize().subtract(c),k=d.bounds(this.project(i,e),this.project(h,e)).getSize(),l=d.Browser.any3d?this.options.zoomSnap:1,m=Math.min(j.x/k.x,j.y/k.y);return e=this.getScaleZoom(m,e),l&&(e=Math.round(e/(l/100))*(l/100),e=b?Math.ceil(e/l)*l:Math.floor(e/l)*l),Math.max(f,Math.min(g,e))},getSize:function(){return this._size&&!this._sizeChanged||(this._size=new d.Point(this._container.clientWidth||0,this._container.clientHeight||0),this._sizeChanged=!1),this._size.clone()},getPixelBounds:function(a,b){var c=this._getTopLeftPoint(a,b);return new d.Bounds(c,c.add(this.getSize()))},getPixelOrigin:function(){return this._checkIfLoaded(),this._pixelOrigin},getPixelWorldBounds:function(a){return this.options.crs.getProjectedBounds(a===c?this.getZoom():a)},getPane:function(a){return"string"==typeof a?this._panes[a]:a},getPanes:function(){return this._panes},getContainer:function(){return this._container},getZoomScale:function(a,b){var d=this.options.crs;return b=b===c?this._zoom:b,d.scale(a)/d.scale(b)},getScaleZoom:function(a,b){var d=this.options.crs;b=b===c?this._zoom:b;var e=d.zoom(a*d.scale(b));return isNaN(e)?1/0:e},project:function(a,b){return b=b===c?this._zoom:b,this.options.crs.latLngToPoint(d.latLng(a),b)},unproject:function(a,b){return b=b===c?this._zoom:b,this.options.crs.pointToLatLng(d.point(a),b)},layerPointToLatLng:function(a){var b=d.point(a).add(this.getPixelOrigin());return this.unproject(b)},latLngToLayerPoint:function(a){return this.project(d.latLng(a))._round()._subtract(this.getPixelOrigin())},wrapLatLng:function(a){return this.options.crs.wrapLatLng(d.latLng(a))},wrapLatLngBounds:function(a){return this.options.crs.wrapLatLngBounds(d.latLngBounds(a))},distance:function(a,b){return this.options.crs.distance(d.latLng(a),d.latLng(b))},containerPointToLayerPoint:function(a){return d.point(a).subtract(this._getMapPanePos())},layerPointToContainerPoint:function(a){return d.point(a).add(this._getMapPanePos())},containerPointToLatLng:function(a){var b=this.containerPointToLayerPoint(d.point(a));return this.layerPointToLatLng(b)},latLngToContainerPoint:function(a){return this.layerPointToContainerPoint(this.latLngToLayerPoint(d.latLng(a)))},mouseEventToContainerPoint:function(a){return d.DomEvent.getMousePosition(a,this._container)},mouseEventToLayerPoint:function(a){return this.containerPointToLayerPoint(this.mouseEventToContainerPoint(a))},mouseEventToLatLng:function(a){return this.layerPointToLatLng(this.mouseEventToLayerPoint(a))},_initContainer:function(a){var b=this._container=d.DomUtil.get(a);if(!b)throw new Error("Map container not found.");if(b._leaflet_id)throw new Error("Map container is already initialized.");d.DomEvent.addListener(b,"scroll",this._onScroll,this),this._containerId=d.Util.stamp(b)},_initLayout:function(){var a=this._container;this._fadeAnimated=this.options.fadeAnimation&&d.Browser.any3d,d.DomUtil.addClass(a,"leaflet-container"+(d.Browser.touch?" leaflet-touch":"")+(d.Browser.retina?" leaflet-retina":"")+(d.Browser.ielt9?" leaflet-oldie":"")+(d.Browser.safari?" leaflet-safari":"")+(this._fadeAnimated?" leaflet-fade-anim":""));var b=d.DomUtil.getStyle(a,"position");"absolute"!==b&&"relative"!==b&&"fixed"!==b&&(a.style.position="relative"),this._initPanes(),this._initControlPos&&this._initControlPos()},_initPanes:function(){var a=this._panes={};this._paneRenderers={},this._mapPane=this.createPane("mapPane",this._container),d.DomUtil.setPosition(this._mapPane,new d.Point(0,0)),this.createPane("tilePane"),this.createPane("shadowPane"),this.createPane("overlayPane"),this.createPane("markerPane"),this.createPane("tooltipPane"),this.createPane("popupPane"),this.options.markerZoomAnimation||(d.DomUtil.addClass(a.markerPane,"leaflet-zoom-hide"),d.DomUtil.addClass(a.shadowPane,"leaflet-zoom-hide"))},_resetView:function(a,b){d.DomUtil.setPosition(this._mapPane,new d.Point(0,0));var c=!this._loaded;this._loaded=!0,b=this._limitZoom(b),this.fire("viewprereset");var e=this._zoom!==b;this._moveStart(e)._move(a,b)._moveEnd(e),this.fire("viewreset"),c&&this.fire("load")},_moveStart:function(a){return a&&this.fire("zoomstart"),this.fire("movestart")},_move:function(a,b,d){b===c&&(b=this._zoom);var e=this._zoom!==b;return this._zoom=b,this._lastCenter=a,this._pixelOrigin=this._getNewPixelOrigin(a),(e||d&&d.pinch)&&this.fire("zoom",d),this.fire("move",d)},_moveEnd:function(a){return a&&this.fire("zoomend"),this.fire("moveend")},_stop:function(){return d.Util.cancelAnimFrame(this._flyToFrame),this._panAnim&&this._panAnim.stop(),this},_rawPanBy:function(a){d.DomUtil.setPosition(this._mapPane,this._getMapPanePos().subtract(a))},_getZoomSpan:function(){return this.getMaxZoom()-this.getMinZoom()},_panInsideMaxBounds:function(){this._enforcingBounds||this.panInsideBounds(this.options.maxBounds)},_checkIfLoaded:function(){if(!this._loaded)throw new Error("Set map center and zoom first.")},_initEvents:function(b){if(d.DomEvent){this._targets={},this._targets[d.stamp(this._container)]=this;var c=b?"off":"on";d.DomEvent[c](this._container,"click dblclick mousedown mouseup mouseover mouseout mousemove contextmenu keypress",this._handleDOMEvent,this),this.options.trackResize&&d.DomEvent[c](a,"resize",this._onResize,this),d.Browser.any3d&&this.options.transform3DLimit&&this[c]("moveend",this._onMoveEnd)}},_onResize:function(){d.Util.cancelAnimFrame(this._resizeRequest),this._resizeRequest=d.Util.requestAnimFrame(function(){this.invalidateSize({debounceMoveend:!0})},this)},_onScroll:function(){this._container.scrollTop=0,this._container.scrollLeft=0},_onMoveEnd:function(){var a=this._getMapPanePos();Math.max(Math.abs(a.x),Math.abs(a.y))>=this.options.transform3DLimit&&this._resetView(this.getCenter(),this.getZoom())},_findEventTargets:function(a,b){for(var c,e=[],f="mouseout"===b||"mouseover"===b,g=a.target||a.srcElement,h=!1;g;){if((c=this._targets[d.stamp(g)])&&("click"===b||"preclick"===b)&&!a._simulated&&this._draggableMoved(c)){h=!0;break}if(c&&c.listens(b,!0)){if(f&&!d.DomEvent._isExternalTarget(g,a))break;if(e.push(c),f)break}if(g===this._container)break;g=g.parentNode}return e.length||h||f||!d.DomEvent._isExternalTarget(g,a)||(e=[this]),e},_handleDOMEvent:function(a){if(this._loaded&&!d.DomEvent._skipped(a)){var b="keypress"===a.type&&13===a.keyCode?"click":a.type;"mousedown"===b&&d.DomUtil.preventOutline(a.target||a.srcElement),this._fireDOMEvent(a,b)}},_fireDOMEvent:function(a,b,c){if("click"===a.type){var e=d.Util.extend({},a);e.type="preclick",this._fireDOMEvent(e,e.type,c)}if(!a._stopped&&(c=(c||[]).concat(this._findEventTargets(a,b)),c.length)){var f=c[0];"contextmenu"===b&&f.listens(b,!0)&&d.DomEvent.preventDefault(a);var g={originalEvent:a};if("keypress"!==a.type){var h=f instanceof d.Marker;g.containerPoint=h?this.latLngToContainerPoint(f.getLatLng()):this.mouseEventToContainerPoint(a),g.layerPoint=this.containerPointToLayerPoint(g.containerPoint),g.latlng=h?f.getLatLng():this.layerPointToLatLng(g.layerPoint)}for(var i=0;i<c.length;i++)if(c[i].fire(b,g,!0),g.originalEvent._stopped||c[i].options.nonBubblingEvents&&-1!==d.Util.indexOf(c[i].options.nonBubblingEvents,b))return}},_draggableMoved:function(a){return a=a.dragging&&a.dragging.enabled()?a:this,a.dragging&&a.dragging.moved()||this.boxZoom&&this.boxZoom.moved()},_clearHandlers:function(){for(var a=0,b=this._handlers.length;a<b;a++)this._handlers[a].disable()},whenReady:function(a,b){return this._loaded?a.call(b||this,{target:this}):this.on("load",a,b),this},_getMapPanePos:function(){return d.DomUtil.getPosition(this._mapPane)||new d.Point(0,0)},_moved:function(){var a=this._getMapPanePos();return a&&!a.equals([0,0])},_getTopLeftPoint:function(a,b){return(a&&b!==c?this._getNewPixelOrigin(a,b):this.getPixelOrigin()).subtract(this._getMapPanePos())},_getNewPixelOrigin:function(a,b){var c=this.getSize()._divideBy(2);return this.project(a,b)._subtract(c)._add(this._getMapPanePos())._round()},_latLngToNewLayerPoint:function(a,b,c){var d=this._getNewPixelOrigin(c,b);return this.project(a,b)._subtract(d)},_latLngBoundsToNewLayerBounds:function(a,b,c){var e=this._getNewPixelOrigin(c,b);return d.bounds([this.project(a.getSouthWest(),b)._subtract(e),this.project(a.getNorthWest(),b)._subtract(e),this.project(a.getSouthEast(),b)._subtract(e),this.project(a.getNorthEast(),b)._subtract(e)])},_getCenterLayerPoint:function(){return this.containerPointToLayerPoint(this.getSize()._divideBy(2))},_getCenterOffset:function(a){return this.latLngToLayerPoint(a).subtract(this._getCenterLayerPoint())},_limitCenter:function(a,b,c){if(!c)return a;var e=this.project(a,b),f=this.getSize().divideBy(2),g=new d.Bounds(e.subtract(f),e.add(f)),h=this._getBoundsOffset(g,c,b);return h.round().equals([0,0])?a:this.unproject(e.add(h),b)},_limitOffset:function(a,b){if(!b)return a;var c=this.getPixelBounds(),e=new d.Bounds(c.min.add(a),c.max.add(a));return a.add(this._getBoundsOffset(e,b))},_getBoundsOffset:function(a,b,c){var e=d.bounds(this.project(b.getNorthEast(),c),this.project(b.getSouthWest(),c)),f=e.min.subtract(a.min),g=e.max.subtract(a.max),h=this._rebound(f.x,-g.x),i=this._rebound(f.y,-g.y);return new d.Point(h,i)},_rebound:function(a,b){return a+b>0?Math.round(a-b)/2:Math.max(0,Math.ceil(a))-Math.max(0,Math.floor(b))},_limitZoom:function(a){var b=this.getMinZoom(),c=this.getMaxZoom(),e=d.Browser.any3d?this.options.zoomSnap:1;return e&&(a=Math.round(a/e)*e),Math.max(b,Math.min(c,a))},_onPanTransitionStep:function(){this.fire("move")},_onPanTransitionEnd:function(){d.DomUtil.removeClass(this._mapPane,"leaflet-pan-anim"),this.fire("moveend")},_tryAnimatedPan:function(a,b){var c=this._getCenterOffset(a)._floor();return!(!0!==(b&&b.animate)&&!this.getSize().contains(c)||(this.panBy(c,b),0))},_createAnimProxy:function(){var a=this._proxy=d.DomUtil.create("div","leaflet-proxy leaflet-zoom-animated");this._panes.mapPane.appendChild(a),this.on("zoomanim",function(b){var c=d.DomUtil.TRANSFORM,e=a.style[c];d.DomUtil.setTransform(a,this.project(b.center,b.zoom),this.getZoomScale(b.zoom,1)),e===a.style[c]&&this._animatingZoom&&this._onZoomTransitionEnd()},this),this.on("load moveend",function(){var b=this.getCenter(),c=this.getZoom();d.DomUtil.setTransform(a,this.project(b,c),this.getZoomScale(c,1))},this)},_catchTransitionEnd:function(a){this._animatingZoom&&a.propertyName.indexOf("transform")>=0&&this._onZoomTransitionEnd()},_nothingToAnimate:function(){return!this._container.getElementsByClassName("leaflet-zoom-animated").length},_tryAnimatedZoom:function(a,b,c){if(this._animatingZoom)return!0;if(c=c||{},!this._zoomAnimated||!1===c.animate||this._nothingToAnimate()||Math.abs(b-this._zoom)>this.options.zoomAnimationThreshold)return!1;var e=this.getZoomScale(b),f=this._getCenterOffset(a)._divideBy(1-1/e);return!(!0!==c.animate&&!this.getSize().contains(f)||(d.Util.requestAnimFrame(function(){this._moveStart(!0)._animateZoom(a,b,!0)},this),0))},_animateZoom:function(a,b,c,e){c&&(this._animatingZoom=!0,this._animateToCenter=a,this._animateToZoom=b,d.DomUtil.addClass(this._mapPane,"leaflet-zoom-anim")),this.fire("zoomanim",{center:a,zoom:b,noUpdate:e}),setTimeout(d.bind(this._onZoomTransitionEnd,this),250)},_onZoomTransitionEnd:function(){this._animatingZoom&&(d.DomUtil.removeClass(this._mapPane,"leaflet-zoom-anim"),this._animatingZoom=!1,this._move(this._animateToCenter,this._animateToZoom),d.Util.requestAnimFrame(function(){this._moveEnd(!0)},this))}}),d.map=function(a,b){return new d.Map(a,b)},d.Layer=d.Evented.extend({options:{pane:"overlayPane",nonBubblingEvents:[],attribution:null},addTo:function(a){return a.addLayer(this),this},remove:function(){return this.removeFrom(this._map||this._mapToAdd)},removeFrom:function(a){return a&&a.removeLayer(this),this},getPane:function(a){return this._map.getPane(a?this.options[a]||a:this.options.pane)},addInteractiveTarget:function(a){return this._map._targets[d.stamp(a)]=this,this},removeInteractiveTarget:function(a){return delete this._map._targets[d.stamp(a)],this},getAttribution:function(){return this.options.attribution},_layerAdd:function(a){var b=a.target;if(b.hasLayer(this)){if(this._map=b,this._zoomAnimated=b._zoomAnimated,this.getEvents){var c=this.getEvents();b.on(c,this),this.once("remove",function(){b.off(c,this)},this)}this.onAdd(b),this.getAttribution&&b.attributionControl&&b.attributionControl.addAttribution(this.getAttribution()),this.fire("add"),b.fire("layeradd",{layer:this})}}}),d.Map.include({addLayer:function(a){var b=d.stamp(a);return this._layers[b]?this:(this._layers[b]=a,a._mapToAdd=this,a.beforeAdd&&a.beforeAdd(this),this.whenReady(a._layerAdd,a),this)},removeLayer:function(a){var b=d.stamp(a);return this._layers[b]?(this._loaded&&a.onRemove(this),a.getAttribution&&this.attributionControl&&this.attributionControl.removeAttribution(a.getAttribution()),delete this._layers[b],this._loaded&&(this.fire("layerremove",{layer:a}),a.fire("remove")),a._map=a._mapToAdd=null,this):this},hasLayer:function(a){return!!a&&d.stamp(a)in this._layers},eachLayer:function(a,b){for(var c in this._layers)a.call(b,this._layers[c]);return this},_addLayers:function(a){a=a?d.Util.isArray(a)?a:[a]:[];for(var b=0,c=a.length;b<c;b++)this.addLayer(a[b])},_addZoomLimit:function(a){!isNaN(a.options.maxZoom)&&isNaN(a.options.minZoom)||(this._zoomBoundLayers[d.stamp(a)]=a,this._updateZoomLevels())},_removeZoomLimit:function(a){var b=d.stamp(a);this._zoomBoundLayers[b]&&(delete this._zoomBoundLayers[b],this._updateZoomLevels())},_updateZoomLevels:function(){var a=1/0,b=-1/0,d=this._getZoomSpan();for(var e in this._zoomBoundLayers){var f=this._zoomBoundLayers[e].options;a=f.minZoom===c?a:Math.min(a,f.minZoom),b=f.maxZoom===c?b:Math.max(b,f.maxZoom)}this._layersMaxZoom=b===-1/0?c:b,this._layersMinZoom=a===1/0?c:a,d!==this._getZoomSpan()&&this.fire("zoomlevelschange"),this.options.maxZoom===c&&this._layersMaxZoom&&this.getZoom()>this._layersMaxZoom&&this.setZoom(this._layersMaxZoom),this.options.minZoom===c&&this._layersMinZoom&&this.getZoom()<this._layersMinZoom&&this.setZoom(this._layersMinZoom)}});var f="_leaflet_events";d.DomEvent={on:function(a,b,c,e){if("object"==typeof b)for(var f in b)this._on(a,f,b[f],c);else{b=d.Util.splitWords(b);for(var g=0,h=b.length;g<h;g++)this._on(a,b[g],c,e)}return this},off:function(a,b,c,e){if("object"==typeof b)for(var f in b)this._off(a,f,b[f],c);else{b=d.Util.splitWords(b);for(var g=0,h=b.length;g<h;g++)this._off(a,b[g],c,e)}return this},_on:function(b,c,e,g){var h=c+d.stamp(e)+(g?"_"+d.stamp(g):"");if(b[f]&&b[f][h])return this;var i=function(c){return e.call(g||b,c||a.event)},j=i;return d.Browser.pointer&&0===c.indexOf("touch")?this.addPointerListener(b,c,i,h):!d.Browser.touch||"dblclick"!==c||!this.addDoubleTapListener||d.Browser.pointer&&d.Browser.chrome?"addEventListener"in b?"mousewheel"===c?b.addEventListener("onwheel"in b?"wheel":"mousewheel",i,!1):"mouseenter"===c||"mouseleave"===c?(i=function(c){c=c||a.event,d.DomEvent._isExternalTarget(b,c)&&j(c)},b.addEventListener("mouseenter"===c?"mouseover":"mouseout",i,!1)):("click"===c&&d.Browser.android&&(i=function(a){return d.DomEvent._filterClick(a,j)}),b.addEventListener(c,i,!1)):"attachEvent"in b&&b.attachEvent("on"+c,i):this.addDoubleTapListener(b,i,h),b[f]=b[f]||{},b[f][h]=i,this},_off:function(a,b,c,e){var g=b+d.stamp(c)+(e?"_"+d.stamp(e):""),h=a[f]&&a[f][g];return h?(d.Browser.pointer&&0===b.indexOf("touch")?this.removePointerListener(a,b,g):d.Browser.touch&&"dblclick"===b&&this.removeDoubleTapListener?this.removeDoubleTapListener(a,g):"removeEventListener"in a?"mousewheel"===b?a.removeEventListener("onwheel"in a?"wheel":"mousewheel",h,!1):a.removeEventListener("mouseenter"===b?"mouseover":"mouseleave"===b?"mouseout":b,h,!1):"detachEvent"in a&&a.detachEvent("on"+b,h),a[f][g]=null,this):this},stopPropagation:function(a){return a.stopPropagation?a.stopPropagation():a.originalEvent?a.originalEvent._stopped=!0:a.cancelBubble=!0,d.DomEvent._skipped(a),this},disableScrollPropagation:function(a){return d.DomEvent.on(a,"mousewheel",d.DomEvent.stopPropagation)},disableClickPropagation:function(a){var b=d.DomEvent.stopPropagation;return d.DomEvent.on(a,d.Draggable.START.join(" "),b),d.DomEvent.on(a,{click:d.DomEvent._fakeStop,dblclick:b})},preventDefault:function(a){return a.preventDefault?a.preventDefault():a.returnValue=!1,this},stop:function(a){return d.DomEvent.preventDefault(a).stopPropagation(a)},getMousePosition:function(a,b){if(!b)return new d.Point(a.clientX,a.clientY);var c=b.getBoundingClientRect();return new d.Point(a.clientX-c.left-b.clientLeft,a.clientY-c.top-b.clientTop)},_wheelPxFactor:d.Browser.win&&d.Browser.chrome?2:d.Browser.gecko?a.devicePixelRatio:1,getWheelDelta:function(a){return d.Browser.edge?a.wheelDeltaY/2:a.deltaY&&0===a.deltaMode?-a.deltaY/d.DomEvent._wheelPxFactor:a.deltaY&&1===a.deltaMode?20*-a.deltaY:a.deltaY&&2===a.deltaMode?60*-a.deltaY:a.deltaX||a.deltaZ?0:a.wheelDelta?(a.wheelDeltaY||a.wheelDelta)/2:a.detail&&Math.abs(a.detail)<32765?20*-a.detail:a.detail?a.detail/-32765*60:0},_skipEvents:{},_fakeStop:function(a){d.DomEvent._skipEvents[a.type]=!0},_skipped:function(a){var b=this._skipEvents[a.type];return this._skipEvents[a.type]=!1,b},_isExternalTarget:function(a,b){var c=b.relatedTarget;if(!c)return!0;try{for(;c&&c!==a;)c=c.parentNode}catch(a){return!1}return c!==a},_filterClick:function(a,b){var c=a.timeStamp||a.originalEvent&&a.originalEvent.timeStamp,e=d.DomEvent._lastClick&&c-d.DomEvent._lastClick;return e&&e>100&&e<500||a.target._simulatedClick&&!a._simulated?void d.DomEvent.stop(a):(d.DomEvent._lastClick=c,void b(a))}},d.DomEvent.addListener=d.DomEvent.on,d.DomEvent.removeListener=d.DomEvent.off,d.PosAnimation=d.Evented.extend({run:function(a,b,c,e){this.stop(),this._el=a,this._inProgress=!0,this._duration=c||.25,this._easeOutPower=1/Math.max(e||.5,.2),this._startPos=d.DomUtil.getPosition(a),this._offset=b.subtract(this._startPos),this._startTime=+new Date,this.fire("start"),this._animate()},stop:function(){this._inProgress&&(this._step(!0),this._complete())},_animate:function(){this._animId=d.Util.requestAnimFrame(this._animate,this),this._step()},_step:function(a){var b=+new Date-this._startTime,c=1e3*this._duration;b<c?this._runFrame(this._easeOut(b/c),a):(this._runFrame(1),this._complete())},_runFrame:function(a,b){var c=this._startPos.add(this._offset.multiplyBy(a));b&&c._round(),d.DomUtil.setPosition(this._el,c),this.fire("step")},_complete:function(){d.Util.cancelAnimFrame(this._animId),this._inProgress=!1,this.fire("end")},_easeOut:function(a){return 1-Math.pow(1-a,this._easeOutPower)}}),d.Projection.Mercator={R:6378137,R_MINOR:6356752.314245179,bounds:d.bounds([-20037508.34279,-15496570.73972],[20037508.34279,18764656.23138]),project:function(a){var b=Math.PI/180,c=this.R,e=a.lat*b,f=this.R_MINOR/c,g=Math.sqrt(1-f*f),h=g*Math.sin(e),i=Math.tan(Math.PI/4-e/2)/Math.pow((1-h)/(1+h),g/2);return e=-c*Math.log(Math.max(i,1e-10)),new d.Point(a.lng*b*c,e)},unproject:function(a){for(var b,c=180/Math.PI,e=this.R,f=this.R_MINOR/e,g=Math.sqrt(1-f*f),h=Math.exp(-a.y/e),i=Math.PI/2-2*Math.atan(h),j=0,k=.1;j<15&&Math.abs(k)>1e-7;j++)b=g*Math.sin(i),b=Math.pow((1-b)/(1+b),g/2),k=Math.PI/2-2*Math.atan(h*b)-i,i+=k;return new d.LatLng(i*c,a.x*c/e)}},d.CRS.EPSG3395=d.extend({},d.CRS.Earth,{code:"EPSG:3395",projection:d.Projection.Mercator,transformation:function(){var a=.5/(Math.PI*d.Projection.Mercator.R);return new d.Transformation(a,.5,-a,.5)}()}),d.GridLayer=d.Layer.extend({options:{tileSize:256,opacity:1,updateWhenIdle:d.Browser.mobile,updateWhenZooming:!0,updateInterval:200,zIndex:1,bounds:null,minZoom:0,maxZoom:c,noWrap:!1,pane:"tilePane",className:"",keepBuffer:2},initialize:function(a){d.setOptions(this,a)},onAdd:function(){this._initContainer(),this._levels={},this._tiles={},this._resetView(),this._update()},beforeAdd:function(a){a._addZoomLimit(this)},onRemove:function(a){this._removeAllTiles(),d.DomUtil.remove(this._container),a._removeZoomLimit(this),this._container=null,this._tileZoom=null},bringToFront:function(){return this._map&&(d.DomUtil.toFront(this._container),this._setAutoZIndex(Math.max)),this},bringToBack:function(){return this._map&&(d.DomUtil.toBack(this._container),this._setAutoZIndex(Math.min)),this},getContainer:function(){return this._container},setOpacity:function(a){return this.options.opacity=a,this._updateOpacity(),this},setZIndex:function(a){return this.options.zIndex=a,this._updateZIndex(),this},isLoading:function(){return this._loading},redraw:function(){return this._map&&(this._removeAllTiles(),this._update()),this},getEvents:function(){var a={viewprereset:this._invalidateAll,viewreset:this._resetView,zoom:this._resetView,moveend:this._onMoveEnd};return this.options.updateWhenIdle||(this._onMove||(this._onMove=d.Util.throttle(this._onMoveEnd,this.options.updateInterval,this)),a.move=this._onMove),this._zoomAnimated&&(a.zoomanim=this._animateZoom),a},createTile:function(){return b.createElement("div")},getTileSize:function(){var a=this.options.tileSize;return a instanceof d.Point?a:new d.Point(a,a)},_updateZIndex:function(){this._container&&this.options.zIndex!==c&&null!==this.options.zIndex&&(this._container.style.zIndex=this.options.zIndex)},_setAutoZIndex:function(a){for(var b,c=this.getPane().children,d=-a(-1/0,1/0),e=0,f=c.length;e<f;e++)b=c[e].style.zIndex,c[e]!==this._container&&b&&(d=a(d,+b));isFinite(d)&&(this.options.zIndex=d+a(-1,1),this._updateZIndex())},_updateOpacity:function(){if(this._map&&!d.Browser.ielt9){d.DomUtil.setOpacity(this._container,this.options.opacity);var a=+new Date,b=!1,c=!1;for(var e in this._tiles){var f=this._tiles[e];if(f.current&&f.loaded){var g=Math.min(1,(a-f.loaded)/200);d.DomUtil.setOpacity(f.el,g),g<1?b=!0:(f.active&&(c=!0),f.active=!0)}}c&&!this._noPrune&&this._pruneTiles(),b&&(d.Util.cancelAnimFrame(this._fadeFrame),this._fadeFrame=d.Util.requestAnimFrame(this._updateOpacity,this))}},_initContainer:function(){this._container||(this._container=d.DomUtil.create("div","leaflet-layer "+(this.options.className||"")),this._updateZIndex(),this.options.opacity<1&&this._updateOpacity(),this.getPane().appendChild(this._container))},_updateLevels:function(){var a=this._tileZoom,b=this.options.maxZoom;if(a===c)return c;for(var e in this._levels)this._levels[e].el.children.length||e===a?this._levels[e].el.style.zIndex=b-Math.abs(a-e):(d.DomUtil.remove(this._levels[e].el),this._removeTilesAtZoom(e),delete this._levels[e]);var f=this._levels[a],g=this._map;return f||(f=this._levels[a]={},f.el=d.DomUtil.create("div","leaflet-tile-container leaflet-zoom-animated",this._container),f.el.style.zIndex=b,f.origin=g.project(g.unproject(g.getPixelOrigin()),a).round(),f.zoom=a,this._setZoomTransform(f,g.getCenter(),g.getZoom()),d.Util.falseFn(f.el.offsetWidth)),this._level=f,f},_pruneTiles:function(){if(this._map){var a,b,c=this._map.getZoom();if(c>this.options.maxZoom||c<this.options.minZoom)return void this._removeAllTiles();for(a in this._tiles)b=this._tiles[a],b.retain=b.current;for(a in this._tiles)if(b=this._tiles[a],b.current&&!b.active){var d=b.coords;this._retainParent(d.x,d.y,d.z,d.z-5)||this._retainChildren(d.x,d.y,d.z,d.z+2)}for(a in this._tiles)this._tiles[a].retain||this._removeTile(a)}},_removeTilesAtZoom:function(a){for(var b in this._tiles)this._tiles[b].coords.z===a&&this._removeTile(b)},_removeAllTiles:function(){for(var a in this._tiles)this._removeTile(a)},_invalidateAll:function(){for(var a in this._levels)d.DomUtil.remove(this._levels[a].el),delete this._levels[a];this._removeAllTiles(),this._tileZoom=null},_retainParent:function(a,b,c,e){var f=Math.floor(a/2),g=Math.floor(b/2),h=c-1,i=new d.Point(+f,+g);i.z=+h;var j=this._tileCoordsToKey(i),k=this._tiles[j];return k&&k.active?(k.retain=!0,!0):(k&&k.loaded&&(k.retain=!0),h>e&&this._retainParent(f,g,h,e))},_retainChildren:function(a,b,c,e){for(var f=2*a;f<2*a+2;f++)for(var g=2*b;g<2*b+2;g++){var h=new d.Point(f,g);h.z=c+1;var i=this._tileCoordsToKey(h),j=this._tiles[i];j&&j.active?j.retain=!0:(j&&j.loaded&&(j.retain=!0),c+1<e&&this._retainChildren(f,g,c+1,e))}},_resetView:function(a){var b=a&&(a.pinch||a.flyTo);this._setView(this._map.getCenter(),this._map.getZoom(),b,b)},_animateZoom:function(a){this._setView(a.center,a.zoom,!0,a.noUpdate)},_setView:function(a,b,d,e){var f=Math.round(b);(this.options.maxZoom!==c&&f>this.options.maxZoom||this.options.minZoom!==c&&f<this.options.minZoom)&&(f=c);var g=this.options.updateWhenZooming&&f!==this._tileZoom;e&&!g||(this._tileZoom=f,this._abortLoading&&this._abortLoading(),this._updateLevels(),this._resetGrid(),f!==c&&this._update(a),d||this._pruneTiles(),this._noPrune=!!d),this._setZoomTransforms(a,b)},_setZoomTransforms:function(a,b){for(var c in this._levels)this._setZoomTransform(this._levels[c],a,b)},_setZoomTransform:function(a,b,c){var e=this._map.getZoomScale(c,a.zoom),f=a.origin.multiplyBy(e).subtract(this._map._getNewPixelOrigin(b,c)).round();d.Browser.any3d?d.DomUtil.setTransform(a.el,f,e):d.DomUtil.setPosition(a.el,f)},_resetGrid:function(){var a=this._map,b=a.options.crs,c=this._tileSize=this.getTileSize(),d=this._tileZoom,e=this._map.getPixelWorldBounds(this._tileZoom);e&&(this._globalTileRange=this._pxBoundsToTileRange(e)),this._wrapX=b.wrapLng&&!this.options.noWrap&&[Math.floor(a.project([0,b.wrapLng[0]],d).x/c.x),Math.ceil(a.project([0,b.wrapLng[1]],d).x/c.y)],this._wrapY=b.wrapLat&&!this.options.noWrap&&[Math.floor(a.project([b.wrapLat[0],0],d).y/c.x),Math.ceil(a.project([b.wrapLat[1],0],d).y/c.y)]},_onMoveEnd:function(){this._map&&!this._map._animatingZoom&&this._update()},_getTiledPixelBounds:function(a){var b=this._map,c=b._animatingZoom?Math.max(b._animateToZoom,b.getZoom()):b.getZoom(),e=b.getZoomScale(c,this._tileZoom),f=b.project(a,this._tileZoom).floor(),g=b.getSize().divideBy(2*e);return new d.Bounds(f.subtract(g),f.add(g))},_update:function(a){var e=this._map;if(e){var f=e.getZoom();if(a===c&&(a=e.getCenter()),this._tileZoom!==c){var g=this._getTiledPixelBounds(a),h=this._pxBoundsToTileRange(g),i=h.getCenter(),j=[],k=this.options.keepBuffer,l=new d.Bounds(h.getBottomLeft().subtract([k,-k]),h.getTopRight().add([k,-k]));for(var m in this._tiles){var n=this._tiles[m].coords;n.z===this._tileZoom&&l.contains(d.point(n.x,n.y))||(this._tiles[m].current=!1)}if(Math.abs(f-this._tileZoom)>1)return void this._setView(a,f);for(var o=h.min.y;o<=h.max.y;o++)for(var p=h.min.x;p<=h.max.x;p++){var q=new d.Point(p,o);if(q.z=this._tileZoom,this._isValidTile(q)){var r=this._tiles[this._tileCoordsToKey(q)];r?r.current=!0:j.push(q)}}if(j.sort(function(a,b){return a.distanceTo(i)-b.distanceTo(i)}),0!==j.length){this._loading||(this._loading=!0,this.fire("loading"));var s=b.createDocumentFragment();for(p=0;p<j.length;p++)this._addTile(j[p],s);this._level.el.appendChild(s)}}}},_isValidTile:function(a){var b=this._map.options.crs;if(!b.infinite){var c=this._globalTileRange;if(!b.wrapLng&&(a.x<c.min.x||a.x>c.max.x)||!b.wrapLat&&(a.y<c.min.y||a.y>c.max.y))return!1}if(!this.options.bounds)return!0;var e=this._tileCoordsToBounds(a);return d.latLngBounds(this.options.bounds).overlaps(e)},_keyToBounds:function(a){return this._tileCoordsToBounds(this._keyToTileCoords(a))},_tileCoordsToBounds:function(a){var b=this._map,c=this.getTileSize(),e=a.scaleBy(c),f=e.add(c),g=b.unproject(e,a.z),h=b.unproject(f,a.z),i=new d.LatLngBounds(g,h);return this.options.noWrap||b.wrapLatLngBounds(i),i},_tileCoordsToKey:function(a){return a.x+":"+a.y+":"+a.z},_keyToTileCoords:function(a){var b=a.split(":"),c=new d.Point(+b[0],+b[1]);return c.z=+b[2],c},_removeTile:function(a){var b=this._tiles[a];b&&(d.DomUtil.remove(b.el),delete this._tiles[a],this.fire("tileunload",{tile:b.el,coords:this._keyToTileCoords(a)}))},_initTile:function(a){d.DomUtil.addClass(a,"leaflet-tile");var b=this.getTileSize();a.style.width=b.x+"px",a.style.height=b.y+"px",a.onselectstart=d.Util.falseFn,a.onmousemove=d.Util.falseFn,d.Browser.ielt9&&this.options.opacity<1&&d.DomUtil.setOpacity(a,this.options.opacity),d.Browser.android&&!d.Browser.android23&&(a.style.WebkitBackfaceVisibility="hidden")},_addTile:function(a,b){var c=this._getTilePos(a),e=this._tileCoordsToKey(a),f=this.createTile(this._wrapCoords(a),d.bind(this._tileReady,this,a));this._initTile(f),this.createTile.length<2&&d.Util.requestAnimFrame(d.bind(this._tileReady,this,a,null,f)),d.DomUtil.setPosition(f,c),this._tiles[e]={el:f,coords:a,current:!0},b.appendChild(f),this.fire("tileloadstart",{tile:f,coords:a})},_tileReady:function(a,b,c){if(this._map){b&&this.fire("tileerror",{error:b,tile:c,coords:a});var e=this._tileCoordsToKey(a);(c=this._tiles[e])&&(c.loaded=+new Date,this._map._fadeAnimated?(d.DomUtil.setOpacity(c.el,0),d.Util.cancelAnimFrame(this._fadeFrame),this._fadeFrame=d.Util.requestAnimFrame(this._updateOpacity,this)):(c.active=!0,this._pruneTiles()),b||(d.DomUtil.addClass(c.el,"leaflet-tile-loaded"),this.fire("tileload",{tile:c.el,coords:a})),this._noTilesToLoad()&&(this._loading=!1,this.fire("load"),d.Browser.ielt9||!this._map._fadeAnimated?d.Util.requestAnimFrame(this._pruneTiles,this):setTimeout(d.bind(this._pruneTiles,this),250)))}},_getTilePos:function(a){return a.scaleBy(this.getTileSize()).subtract(this._level.origin)},_wrapCoords:function(a){var b=new d.Point(this._wrapX?d.Util.wrapNum(a.x,this._wrapX):a.x,this._wrapY?d.Util.wrapNum(a.y,this._wrapY):a.y);return b.z=a.z,b},_pxBoundsToTileRange:function(a){var b=this.getTileSize();return new d.Bounds(a.min.unscaleBy(b).floor(),a.max.unscaleBy(b).ceil().subtract([1,1]))},_noTilesToLoad:function(){for(var a in this._tiles)if(!this._tiles[a].loaded)return!1;return!0}}),d.gridLayer=function(a){return new d.GridLayer(a)},d.TileLayer=d.GridLayer.extend({options:{minZoom:0,maxZoom:18,maxNativeZoom:null,minNativeZoom:null,subdomains:"abc",errorTileUrl:"",zoomOffset:0,tms:!1,zoomReverse:!1,detectRetina:!1,crossOrigin:!1},initialize:function(a,b){this._url=a,b=d.setOptions(this,b),b.detectRetina&&d.Browser.retina&&b.maxZoom>0&&(b.tileSize=Math.floor(b.tileSize/2),b.zoomReverse?(b.zoomOffset--,b.minZoom++):(b.zoomOffset++,b.maxZoom--),b.minZoom=Math.max(0,b.minZoom)),"string"==typeof b.subdomains&&(b.subdomains=b.subdomains.split("")),d.Browser.android||this.on("tileunload",this._onTileRemove)},setUrl:function(a,b){return this._url=a,b||this.redraw(),this},createTile:function(a,c){var e=b.createElement("img");return d.DomEvent.on(e,"load",d.bind(this._tileOnLoad,this,c,e)),d.DomEvent.on(e,"error",d.bind(this._tileOnError,this,c,e)),this.options.crossOrigin&&(e.crossOrigin=""),e.alt="",e.setAttribute("role","presentation"),e.src=this.getTileUrl(a),e},getTileUrl:function(a){var b={r:d.Browser.retina?"@2x":"",s:this._getSubdomain(a),x:a.x,y:a.y,z:this._getZoomForUrl()};if(this._map&&!this._map.options.crs.infinite){var c=this._globalTileRange.max.y-a.y;this.options.tms&&(b.y=c),b["-y"]=c}return d.Util.template(this._url,d.extend(b,this.options))},_tileOnLoad:function(a,b){d.Browser.ielt9?setTimeout(d.bind(a,this,null,b),0):a(null,b)},_tileOnError:function(a,b,c){var d=this.options.errorTileUrl;d&&b.src!==d&&(b.src=d),a(c,b)},getTileSize:function(){var a=this._map,b=d.GridLayer.prototype.getTileSize.call(this),c=this._tileZoom+this.options.zoomOffset,e=this.options.minNativeZoom,f=this.options.maxNativeZoom;return null!==e&&c<e?b.divideBy(a.getZoomScale(e,c)).round():null!==f&&c>f?b.divideBy(a.getZoomScale(f,c)).round():b},_onTileRemove:function(a){a.tile.onload=null},_getZoomForUrl:function(){var a=this._tileZoom,b=this.options.maxZoom,c=this.options.zoomReverse,d=this.options.zoomOffset,e=this.options.minNativeZoom,f=this.options.maxNativeZoom;return c&&(a=b-a),a+=d,null!==e&&a<e?e:null!==f&&a>f?f:a},_getSubdomain:function(a){var b=Math.abs(a.x+a.y)%this.options.subdomains.length;return this.options.subdomains[b]},_abortLoading:function(){var a,b;for(a in this._tiles)this._tiles[a].coords.z!==this._tileZoom&&(b=this._tiles[a].el,b.onload=d.Util.falseFn,
b.onerror=d.Util.falseFn,b.complete||(b.src=d.Util.emptyImageUrl,d.DomUtil.remove(b)))}}),d.tileLayer=function(a,b){return new d.TileLayer(a,b)},d.TileLayer.WMS=d.TileLayer.extend({defaultWmsParams:{service:"WMS",request:"GetMap",layers:"",styles:"",format:"image/jpeg",transparent:!1,version:"1.1.1"},options:{crs:null,uppercase:!1},initialize:function(a,b){this._url=a;var c=d.extend({},this.defaultWmsParams);for(var e in b)e in this.options||(c[e]=b[e]);b=d.setOptions(this,b),c.width=c.height=b.tileSize*(b.detectRetina&&d.Browser.retina?2:1),this.wmsParams=c},onAdd:function(a){this._crs=this.options.crs||a.options.crs,this._wmsVersion=parseFloat(this.wmsParams.version);var b=this._wmsVersion>=1.3?"crs":"srs";this.wmsParams[b]=this._crs.code,d.TileLayer.prototype.onAdd.call(this,a)},getTileUrl:function(a){var b=this._tileCoordsToBounds(a),c=this._crs.project(b.getNorthWest()),e=this._crs.project(b.getSouthEast()),f=(this._wmsVersion>=1.3&&this._crs===d.CRS.EPSG4326?[e.y,c.x,c.y,e.x]:[c.x,e.y,e.x,c.y]).join(","),g=d.TileLayer.prototype.getTileUrl.call(this,a);return g+d.Util.getParamString(this.wmsParams,g,this.options.uppercase)+(this.options.uppercase?"&BBOX=":"&bbox=")+f},setParams:function(a,b){return d.extend(this.wmsParams,a),b||this.redraw(),this}}),d.tileLayer.wms=function(a,b){return new d.TileLayer.WMS(a,b)},d.ImageOverlay=d.Layer.extend({options:{opacity:1,alt:"",interactive:!1,crossOrigin:!1},initialize:function(a,b,c){this._url=a,this._bounds=d.latLngBounds(b),d.setOptions(this,c)},onAdd:function(){this._image||(this._initImage(),this.options.opacity<1&&this._updateOpacity()),this.options.interactive&&(d.DomUtil.addClass(this._image,"leaflet-interactive"),this.addInteractiveTarget(this._image)),this.getPane().appendChild(this._image),this._reset()},onRemove:function(){d.DomUtil.remove(this._image),this.options.interactive&&this.removeInteractiveTarget(this._image)},setOpacity:function(a){return this.options.opacity=a,this._image&&this._updateOpacity(),this},setStyle:function(a){return a.opacity&&this.setOpacity(a.opacity),this},bringToFront:function(){return this._map&&d.DomUtil.toFront(this._image),this},bringToBack:function(){return this._map&&d.DomUtil.toBack(this._image),this},setUrl:function(a){return this._url=a,this._image&&(this._image.src=a),this},setBounds:function(a){return this._bounds=a,this._map&&this._reset(),this},getEvents:function(){var a={zoom:this._reset,viewreset:this._reset};return this._zoomAnimated&&(a.zoomanim=this._animateZoom),a},getBounds:function(){return this._bounds},getElement:function(){return this._image},_initImage:function(){var a=this._image=d.DomUtil.create("img","leaflet-image-layer "+(this._zoomAnimated?"leaflet-zoom-animated":""));a.onselectstart=d.Util.falseFn,a.onmousemove=d.Util.falseFn,a.onload=d.bind(this.fire,this,"load"),this.options.crossOrigin&&(a.crossOrigin=""),a.src=this._url,a.alt=this.options.alt},_animateZoom:function(a){var b=this._map.getZoomScale(a.zoom),c=this._map._latLngBoundsToNewLayerBounds(this._bounds,a.zoom,a.center).min;d.DomUtil.setTransform(this._image,c,b)},_reset:function(){var a=this._image,b=new d.Bounds(this._map.latLngToLayerPoint(this._bounds.getNorthWest()),this._map.latLngToLayerPoint(this._bounds.getSouthEast())),c=b.getSize();d.DomUtil.setPosition(a,b.min),a.style.width=c.x+"px",a.style.height=c.y+"px"},_updateOpacity:function(){d.DomUtil.setOpacity(this._image,this.options.opacity)}}),d.imageOverlay=function(a,b,c){return new d.ImageOverlay(a,b,c)},d.Icon=d.Class.extend({initialize:function(a){d.setOptions(this,a)},createIcon:function(a){return this._createIcon("icon",a)},createShadow:function(a){return this._createIcon("shadow",a)},_createIcon:function(a,b){var c=this._getIconUrl(a);if(!c){if("icon"===a)throw new Error("iconUrl not set in Icon options (see the docs).");return null}var d=this._createImg(c,b&&"IMG"===b.tagName?b:null);return this._setIconStyles(d,a),d},_setIconStyles:function(a,b){var c=this.options,e=c[b+"Size"];"number"==typeof e&&(e=[e,e]);var f=d.point(e),g=d.point("shadow"===b&&c.shadowAnchor||c.iconAnchor||f&&f.divideBy(2,!0));a.className="leaflet-marker-"+b+" "+(c.className||""),g&&(a.style.marginLeft=-g.x+"px",a.style.marginTop=-g.y+"px"),f&&(a.style.width=f.x+"px",a.style.height=f.y+"px")},_createImg:function(a,c){return c=c||b.createElement("img"),c.src=a,c},_getIconUrl:function(a){return d.Browser.retina&&this.options[a+"RetinaUrl"]||this.options[a+"Url"]}}),d.icon=function(a){return new d.Icon(a)},d.Icon.Default=d.Icon.extend({options:{iconUrl:"marker-icon.png",iconRetinaUrl:"marker-icon-2x.png",shadowUrl:"marker-shadow.png",iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],tooltipAnchor:[16,-28],shadowSize:[41,41]},_getIconUrl:function(a){return d.Icon.Default.imagePath||(d.Icon.Default.imagePath=this._detectIconPath()),(this.options.imagePath||d.Icon.Default.imagePath)+d.Icon.prototype._getIconUrl.call(this,a)},_detectIconPath:function(){var a=d.DomUtil.create("div","leaflet-default-icon-path",b.body),c=d.DomUtil.getStyle(a,"background-image")||d.DomUtil.getStyle(a,"backgroundImage");return b.body.removeChild(a),0===c.indexOf("url")?c.replace(/^url\([\"\']?/,"").replace(/marker-icon\.png[\"\']?\)$/,""):""}}),d.Marker=d.Layer.extend({options:{icon:new d.Icon.Default,interactive:!0,draggable:!1,keyboard:!0,title:"",alt:"",zIndexOffset:0,opacity:1,riseOnHover:!1,riseOffset:250,pane:"markerPane",nonBubblingEvents:["click","dblclick","mouseover","mouseout","contextmenu"]},initialize:function(a,b){d.setOptions(this,b),this._latlng=d.latLng(a)},onAdd:function(a){this._zoomAnimated=this._zoomAnimated&&a.options.markerZoomAnimation,this._zoomAnimated&&a.on("zoomanim",this._animateZoom,this),this._initIcon(),this.update()},onRemove:function(a){this.dragging&&this.dragging.enabled()&&(this.options.draggable=!0,this.dragging.removeHooks()),this._zoomAnimated&&a.off("zoomanim",this._animateZoom,this),this._removeIcon(),this._removeShadow()},getEvents:function(){return{zoom:this.update,viewreset:this.update}},getLatLng:function(){return this._latlng},setLatLng:function(a){var b=this._latlng;return this._latlng=d.latLng(a),this.update(),this.fire("move",{oldLatLng:b,latlng:this._latlng})},setZIndexOffset:function(a){return this.options.zIndexOffset=a,this.update()},setIcon:function(a){return this.options.icon=a,this._map&&(this._initIcon(),this.update()),this._popup&&this.bindPopup(this._popup,this._popup.options),this},getElement:function(){return this._icon},update:function(){if(this._icon){var a=this._map.latLngToLayerPoint(this._latlng).round();this._setPos(a)}return this},_initIcon:function(){var a=this.options,b="leaflet-zoom-"+(this._zoomAnimated?"animated":"hide"),c=a.icon.createIcon(this._icon),e=!1;c!==this._icon&&(this._icon&&this._removeIcon(),e=!0,a.title&&(c.title=a.title),a.alt&&(c.alt=a.alt)),d.DomUtil.addClass(c,b),a.keyboard&&(c.tabIndex="0"),this._icon=c,a.riseOnHover&&this.on({mouseover:this._bringToFront,mouseout:this._resetZIndex});var f=a.icon.createShadow(this._shadow),g=!1;f!==this._shadow&&(this._removeShadow(),g=!0),f&&(d.DomUtil.addClass(f,b),f.alt=""),this._shadow=f,a.opacity<1&&this._updateOpacity(),e&&this.getPane().appendChild(this._icon),this._initInteraction(),f&&g&&this.getPane("shadowPane").appendChild(this._shadow)},_removeIcon:function(){this.options.riseOnHover&&this.off({mouseover:this._bringToFront,mouseout:this._resetZIndex}),d.DomUtil.remove(this._icon),this.removeInteractiveTarget(this._icon),this._icon=null},_removeShadow:function(){this._shadow&&d.DomUtil.remove(this._shadow),this._shadow=null},_setPos:function(a){d.DomUtil.setPosition(this._icon,a),this._shadow&&d.DomUtil.setPosition(this._shadow,a),this._zIndex=a.y+this.options.zIndexOffset,this._resetZIndex()},_updateZIndex:function(a){this._icon.style.zIndex=this._zIndex+a},_animateZoom:function(a){var b=this._map._latLngToNewLayerPoint(this._latlng,a.zoom,a.center).round();this._setPos(b)},_initInteraction:function(){if(this.options.interactive&&(d.DomUtil.addClass(this._icon,"leaflet-interactive"),this.addInteractiveTarget(this._icon),d.Handler.MarkerDrag)){var a=this.options.draggable;this.dragging&&(a=this.dragging.enabled(),this.dragging.disable()),this.dragging=new d.Handler.MarkerDrag(this),a&&this.dragging.enable()}},setOpacity:function(a){return this.options.opacity=a,this._map&&this._updateOpacity(),this},_updateOpacity:function(){var a=this.options.opacity;d.DomUtil.setOpacity(this._icon,a),this._shadow&&d.DomUtil.setOpacity(this._shadow,a)},_bringToFront:function(){this._updateZIndex(this.options.riseOffset)},_resetZIndex:function(){this._updateZIndex(0)},_getPopupAnchor:function(){return this.options.icon.options.popupAnchor||[0,0]},_getTooltipAnchor:function(){return this.options.icon.options.tooltipAnchor||[0,0]}}),d.marker=function(a,b){return new d.Marker(a,b)},d.DivIcon=d.Icon.extend({options:{iconSize:[12,12],html:!1,bgPos:null,className:"leaflet-div-icon"},createIcon:function(a){var c=a&&"DIV"===a.tagName?a:b.createElement("div"),e=this.options;if(c.innerHTML=!1!==e.html?e.html:"",e.bgPos){var f=d.point(e.bgPos);c.style.backgroundPosition=-f.x+"px "+-f.y+"px"}return this._setIconStyles(c,"icon"),c},createShadow:function(){return null}}),d.divIcon=function(a){return new d.DivIcon(a)},d.DivOverlay=d.Layer.extend({options:{offset:[0,7],className:"",pane:"popupPane"},initialize:function(a,b){d.setOptions(this,a),this._source=b},onAdd:function(a){this._zoomAnimated=a._zoomAnimated,this._container||this._initLayout(),a._fadeAnimated&&d.DomUtil.setOpacity(this._container,0),clearTimeout(this._removeTimeout),this.getPane().appendChild(this._container),this.update(),a._fadeAnimated&&d.DomUtil.setOpacity(this._container,1),this.bringToFront()},onRemove:function(a){a._fadeAnimated?(d.DomUtil.setOpacity(this._container,0),this._removeTimeout=setTimeout(d.bind(d.DomUtil.remove,d.DomUtil,this._container),200)):d.DomUtil.remove(this._container)},getLatLng:function(){return this._latlng},setLatLng:function(a){return this._latlng=d.latLng(a),this._map&&(this._updatePosition(),this._adjustPan()),this},getContent:function(){return this._content},setContent:function(a){return this._content=a,this.update(),this},getElement:function(){return this._container},update:function(){this._map&&(this._container.style.visibility="hidden",this._updateContent(),this._updateLayout(),this._updatePosition(),this._container.style.visibility="",this._adjustPan())},getEvents:function(){var a={zoom:this._updatePosition,viewreset:this._updatePosition};return this._zoomAnimated&&(a.zoomanim=this._animateZoom),a},isOpen:function(){return!!this._map&&this._map.hasLayer(this)},bringToFront:function(){return this._map&&d.DomUtil.toFront(this._container),this},bringToBack:function(){return this._map&&d.DomUtil.toBack(this._container),this},_updateContent:function(){if(this._content){var a=this._contentNode,b="function"==typeof this._content?this._content(this._source||this):this._content;if("string"==typeof b)a.innerHTML=b;else{for(;a.hasChildNodes();)a.removeChild(a.firstChild);a.appendChild(b)}this.fire("contentupdate")}},_updatePosition:function(){if(this._map){var a=this._map.latLngToLayerPoint(this._latlng),b=d.point(this.options.offset),c=this._getAnchor();this._zoomAnimated?d.DomUtil.setPosition(this._container,a.add(c)):b=b.add(a).add(c);var e=this._containerBottom=-b.y,f=this._containerLeft=-Math.round(this._containerWidth/2)+b.x;this._container.style.bottom=e+"px",this._container.style.left=f+"px"}},_getAnchor:function(){return[0,0]}}),d.Popup=d.DivOverlay.extend({options:{maxWidth:300,minWidth:50,maxHeight:null,autoPan:!0,autoPanPaddingTopLeft:null,autoPanPaddingBottomRight:null,autoPanPadding:[5,5],keepInView:!1,closeButton:!0,autoClose:!0,className:""},openOn:function(a){return a.openPopup(this),this},onAdd:function(a){d.DivOverlay.prototype.onAdd.call(this,a),a.fire("popupopen",{popup:this}),this._source&&(this._source.fire("popupopen",{popup:this},!0),this._source instanceof d.Path||this._source.on("preclick",d.DomEvent.stopPropagation))},onRemove:function(a){d.DivOverlay.prototype.onRemove.call(this,a),a.fire("popupclose",{popup:this}),this._source&&(this._source.fire("popupclose",{popup:this},!0),this._source instanceof d.Path||this._source.off("preclick",d.DomEvent.stopPropagation))},getEvents:function(){var a=d.DivOverlay.prototype.getEvents.call(this);return("closeOnClick"in this.options?this.options.closeOnClick:this._map.options.closePopupOnClick)&&(a.preclick=this._close),this.options.keepInView&&(a.moveend=this._adjustPan),a},_close:function(){this._map&&this._map.closePopup(this)},_initLayout:function(){var a="leaflet-popup",b=this._container=d.DomUtil.create("div",a+" "+(this.options.className||"")+" leaflet-zoom-animated");if(this.options.closeButton){var c=this._closeButton=d.DomUtil.create("a",a+"-close-button",b);c.href="#close",c.innerHTML="&#215;",d.DomEvent.on(c,"click",this._onCloseButtonClick,this)}var e=this._wrapper=d.DomUtil.create("div",a+"-content-wrapper",b);this._contentNode=d.DomUtil.create("div",a+"-content",e),d.DomEvent.disableClickPropagation(e).disableScrollPropagation(this._contentNode).on(e,"contextmenu",d.DomEvent.stopPropagation),this._tipContainer=d.DomUtil.create("div",a+"-tip-container",b),this._tip=d.DomUtil.create("div",a+"-tip",this._tipContainer)},_updateLayout:function(){var a=this._contentNode,b=a.style;b.width="",b.whiteSpace="nowrap";var c=a.offsetWidth;c=Math.min(c,this.options.maxWidth),c=Math.max(c,this.options.minWidth),b.width=c+1+"px",b.whiteSpace="",b.height="";var e=a.offsetHeight,f=this.options.maxHeight,g="leaflet-popup-scrolled";f&&e>f?(b.height=f+"px",d.DomUtil.addClass(a,g)):d.DomUtil.removeClass(a,g),this._containerWidth=this._container.offsetWidth},_animateZoom:function(a){var b=this._map._latLngToNewLayerPoint(this._latlng,a.zoom,a.center),c=this._getAnchor();d.DomUtil.setPosition(this._container,b.add(c))},_adjustPan:function(){if(!(!this.options.autoPan||this._map._panAnim&&this._map._panAnim._inProgress)){var a=this._map,b=parseInt(d.DomUtil.getStyle(this._container,"marginBottom"),10)||0,c=this._container.offsetHeight+b,e=this._containerWidth,f=new d.Point(this._containerLeft,-c-this._containerBottom);f._add(d.DomUtil.getPosition(this._container));var g=a.layerPointToContainerPoint(f),h=d.point(this.options.autoPanPadding),i=d.point(this.options.autoPanPaddingTopLeft||h),j=d.point(this.options.autoPanPaddingBottomRight||h),k=a.getSize(),l=0,m=0;g.x+e+j.x>k.x&&(l=g.x+e-k.x+j.x),g.x-l-i.x<0&&(l=g.x-i.x),g.y+c+j.y>k.y&&(m=g.y+c-k.y+j.y),g.y-m-i.y<0&&(m=g.y-i.y),(l||m)&&a.fire("autopanstart").panBy([l,m])}},_onCloseButtonClick:function(a){this._close(),d.DomEvent.stop(a)},_getAnchor:function(){return d.point(this._source&&this._source._getPopupAnchor?this._source._getPopupAnchor():[0,0])}}),d.popup=function(a,b){return new d.Popup(a,b)},d.Map.mergeOptions({closePopupOnClick:!0}),d.Map.include({openPopup:function(a,b,c){return a instanceof d.Popup||(a=new d.Popup(c).setContent(a)),b&&a.setLatLng(b),this.hasLayer(a)?this:(this._popup&&this._popup.options.autoClose&&this.closePopup(),this._popup=a,this.addLayer(a))},closePopup:function(a){return a&&a!==this._popup||(a=this._popup,this._popup=null),a&&this.removeLayer(a),this}}),d.Layer.include({bindPopup:function(a,b){return a instanceof d.Popup?(d.setOptions(a,b),this._popup=a,a._source=this):(this._popup&&!b||(this._popup=new d.Popup(b,this)),this._popup.setContent(a)),this._popupHandlersAdded||(this.on({click:this._openPopup,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!0),this},unbindPopup:function(){return this._popup&&(this.off({click:this._openPopup,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!1,this._popup=null),this},openPopup:function(a,b){if(a instanceof d.Layer||(b=a,a=this),a instanceof d.FeatureGroup)for(var c in this._layers){a=this._layers[c];break}return b||(b=a.getCenter?a.getCenter():a.getLatLng()),this._popup&&this._map&&(this._popup._source=a,this._popup.update(),this._map.openPopup(this._popup,b)),this},closePopup:function(){return this._popup&&this._popup._close(),this},togglePopup:function(a){return this._popup&&(this._popup._map?this.closePopup():this.openPopup(a)),this},isPopupOpen:function(){return!!this._popup&&this._popup.isOpen()},setPopupContent:function(a){return this._popup&&this._popup.setContent(a),this},getPopup:function(){return this._popup},_openPopup:function(a){var b=a.layer||a.target;if(this._popup&&this._map)return d.DomEvent.stop(a),b instanceof d.Path?void this.openPopup(a.layer||a.target,a.latlng):void(this._map.hasLayer(this._popup)&&this._popup._source===b?this.closePopup():this.openPopup(b,a.latlng))},_movePopup:function(a){this._popup.setLatLng(a.latlng)}}),d.Tooltip=d.DivOverlay.extend({options:{pane:"tooltipPane",offset:[0,0],direction:"auto",permanent:!1,sticky:!1,interactive:!1,opacity:.9},onAdd:function(a){d.DivOverlay.prototype.onAdd.call(this,a),this.setOpacity(this.options.opacity),a.fire("tooltipopen",{tooltip:this}),this._source&&this._source.fire("tooltipopen",{tooltip:this},!0)},onRemove:function(a){d.DivOverlay.prototype.onRemove.call(this,a),a.fire("tooltipclose",{tooltip:this}),this._source&&this._source.fire("tooltipclose",{tooltip:this},!0)},getEvents:function(){var a=d.DivOverlay.prototype.getEvents.call(this);return d.Browser.touch&&!this.options.permanent&&(a.preclick=this._close),a},_close:function(){this._map&&this._map.closeTooltip(this)},_initLayout:function(){var a="leaflet-tooltip "+(this.options.className||"")+" leaflet-zoom-"+(this._zoomAnimated?"animated":"hide");this._contentNode=this._container=d.DomUtil.create("div",a)},_updateLayout:function(){},_adjustPan:function(){},_setPosition:function(a){var b=this._map,c=this._container,e=b.latLngToContainerPoint(b.getCenter()),f=b.layerPointToContainerPoint(a),g=this.options.direction,h=c.offsetWidth,i=c.offsetHeight,j=d.point(this.options.offset),k=this._getAnchor();"top"===g?a=a.add(d.point(-h/2+j.x,-i+j.y+k.y,!0)):"bottom"===g?a=a.subtract(d.point(h/2-j.x,-j.y,!0)):"center"===g?a=a.subtract(d.point(h/2+j.x,i/2-k.y+j.y,!0)):"right"===g||"auto"===g&&f.x<e.x?(g="right",a=a.add(d.point(j.x+k.x,k.y-i/2+j.y,!0))):(g="left",a=a.subtract(d.point(h+k.x-j.x,i/2-k.y-j.y,!0))),d.DomUtil.removeClass(c,"leaflet-tooltip-right"),d.DomUtil.removeClass(c,"leaflet-tooltip-left"),d.DomUtil.removeClass(c,"leaflet-tooltip-top"),d.DomUtil.removeClass(c,"leaflet-tooltip-bottom"),d.DomUtil.addClass(c,"leaflet-tooltip-"+g),d.DomUtil.setPosition(c,a)},_updatePosition:function(){var a=this._map.latLngToLayerPoint(this._latlng);this._setPosition(a)},setOpacity:function(a){this.options.opacity=a,this._container&&d.DomUtil.setOpacity(this._container,a)},_animateZoom:function(a){var b=this._map._latLngToNewLayerPoint(this._latlng,a.zoom,a.center);this._setPosition(b)},_getAnchor:function(){return d.point(this._source&&this._source._getTooltipAnchor&&!this.options.sticky?this._source._getTooltipAnchor():[0,0])}}),d.tooltip=function(a,b){return new d.Tooltip(a,b)},d.Map.include({openTooltip:function(a,b,c){return a instanceof d.Tooltip||(a=new d.Tooltip(c).setContent(a)),b&&a.setLatLng(b),this.hasLayer(a)?this:this.addLayer(a)},closeTooltip:function(a){return a&&this.removeLayer(a),this}}),d.Layer.include({bindTooltip:function(a,b){return a instanceof d.Tooltip?(d.setOptions(a,b),this._tooltip=a,a._source=this):(this._tooltip&&!b||(this._tooltip=d.tooltip(b,this)),this._tooltip.setContent(a)),this._initTooltipInteractions(),this._tooltip.options.permanent&&this._map&&this._map.hasLayer(this)&&this.openTooltip(),this},unbindTooltip:function(){return this._tooltip&&(this._initTooltipInteractions(!0),this.closeTooltip(),this._tooltip=null),this},_initTooltipInteractions:function(a){if(a||!this._tooltipHandlersAdded){var b=a?"off":"on",c={remove:this.closeTooltip,move:this._moveTooltip};this._tooltip.options.permanent?c.add=this._openTooltip:(c.mouseover=this._openTooltip,c.mouseout=this.closeTooltip,this._tooltip.options.sticky&&(c.mousemove=this._moveTooltip),d.Browser.touch&&(c.click=this._openTooltip)),this[b](c),this._tooltipHandlersAdded=!a}},openTooltip:function(a,b){if(a instanceof d.Layer||(b=a,a=this),a instanceof d.FeatureGroup)for(var c in this._layers){a=this._layers[c];break}return b||(b=a.getCenter?a.getCenter():a.getLatLng()),this._tooltip&&this._map&&(this._tooltip._source=a,this._tooltip.update(),this._map.openTooltip(this._tooltip,b),this._tooltip.options.interactive&&this._tooltip._container&&(d.DomUtil.addClass(this._tooltip._container,"leaflet-clickable"),this.addInteractiveTarget(this._tooltip._container))),this},closeTooltip:function(){return this._tooltip&&(this._tooltip._close(),this._tooltip.options.interactive&&this._tooltip._container&&(d.DomUtil.removeClass(this._tooltip._container,"leaflet-clickable"),this.removeInteractiveTarget(this._tooltip._container))),this},toggleTooltip:function(a){return this._tooltip&&(this._tooltip._map?this.closeTooltip():this.openTooltip(a)),this},isTooltipOpen:function(){return this._tooltip.isOpen()},setTooltipContent:function(a){return this._tooltip&&this._tooltip.setContent(a),this},getTooltip:function(){return this._tooltip},_openTooltip:function(a){var b=a.layer||a.target;this._tooltip&&this._map&&this.openTooltip(b,this._tooltip.options.sticky?a.latlng:c)},_moveTooltip:function(a){var b,c,d=a.latlng;this._tooltip.options.sticky&&a.originalEvent&&(b=this._map.mouseEventToContainerPoint(a.originalEvent),c=this._map.containerPointToLayerPoint(b),d=this._map.layerPointToLatLng(c)),this._tooltip.setLatLng(d)}}),d.LayerGroup=d.Layer.extend({initialize:function(a){this._layers={};var b,c;if(a)for(b=0,c=a.length;b<c;b++)this.addLayer(a[b])},addLayer:function(a){var b=this.getLayerId(a);return this._layers[b]=a,this._map&&this._map.addLayer(a),this},removeLayer:function(a){var b=a in this._layers?a:this.getLayerId(a);return this._map&&this._layers[b]&&this._map.removeLayer(this._layers[b]),delete this._layers[b],this},hasLayer:function(a){return!!a&&(a in this._layers||this.getLayerId(a)in this._layers)},clearLayers:function(){for(var a in this._layers)this.removeLayer(this._layers[a]);return this},invoke:function(a){var b,c,d=Array.prototype.slice.call(arguments,1);for(b in this._layers)c=this._layers[b],c[a]&&c[a].apply(c,d);return this},onAdd:function(a){for(var b in this._layers)a.addLayer(this._layers[b])},onRemove:function(a){for(var b in this._layers)a.removeLayer(this._layers[b])},eachLayer:function(a,b){for(var c in this._layers)a.call(b,this._layers[c]);return this},getLayer:function(a){return this._layers[a]},getLayers:function(){var a=[];for(var b in this._layers)a.push(this._layers[b]);return a},setZIndex:function(a){return this.invoke("setZIndex",a)},getLayerId:function(a){return d.stamp(a)}}),d.layerGroup=function(a){return new d.LayerGroup(a)},d.FeatureGroup=d.LayerGroup.extend({addLayer:function(a){return this.hasLayer(a)?this:(a.addEventParent(this),d.LayerGroup.prototype.addLayer.call(this,a),this.fire("layeradd",{layer:a}))},removeLayer:function(a){return this.hasLayer(a)?(a in this._layers&&(a=this._layers[a]),a.removeEventParent(this),d.LayerGroup.prototype.removeLayer.call(this,a),this.fire("layerremove",{layer:a})):this},setStyle:function(a){return this.invoke("setStyle",a)},bringToFront:function(){return this.invoke("bringToFront")},bringToBack:function(){return this.invoke("bringToBack")},getBounds:function(){var a=new d.LatLngBounds;for(var b in this._layers){var c=this._layers[b];a.extend(c.getBounds?c.getBounds():c.getLatLng())}return a}}),d.featureGroup=function(a){return new d.FeatureGroup(a)},d.Renderer=d.Layer.extend({options:{padding:.1},initialize:function(a){d.setOptions(this,a),d.stamp(this),this._layers=this._layers||{}},onAdd:function(){this._container||(this._initContainer(),this._zoomAnimated&&d.DomUtil.addClass(this._container,"leaflet-zoom-animated")),this.getPane().appendChild(this._container),this._update(),this.on("update",this._updatePaths,this)},onRemove:function(){d.DomUtil.remove(this._container),this.off("update",this._updatePaths,this)},getEvents:function(){var a={viewreset:this._reset,zoom:this._onZoom,moveend:this._update,zoomend:this._onZoomEnd};return this._zoomAnimated&&(a.zoomanim=this._onAnimZoom),a},_onAnimZoom:function(a){this._updateTransform(a.center,a.zoom)},_onZoom:function(){this._updateTransform(this._map.getCenter(),this._map.getZoom())},_updateTransform:function(a,b){var c=this._map.getZoomScale(b,this._zoom),e=d.DomUtil.getPosition(this._container),f=this._map.getSize().multiplyBy(.5+this.options.padding),g=this._map.project(this._center,b),h=this._map.project(a,b),i=h.subtract(g),j=f.multiplyBy(-c).add(e).add(f).subtract(i);d.Browser.any3d?d.DomUtil.setTransform(this._container,j,c):d.DomUtil.setPosition(this._container,j)},_reset:function(){this._update(),this._updateTransform(this._center,this._zoom);for(var a in this._layers)this._layers[a]._reset()},_onZoomEnd:function(){for(var a in this._layers)this._layers[a]._project()},_updatePaths:function(){for(var a in this._layers)this._layers[a]._update()},_update:function(){var a=this.options.padding,b=this._map.getSize(),c=this._map.containerPointToLayerPoint(b.multiplyBy(-a)).round();this._bounds=new d.Bounds(c,c.add(b.multiplyBy(1+2*a)).round()),this._center=this._map.getCenter(),this._zoom=this._map.getZoom()}}),d.Map.include({getRenderer:function(a){var b=a.options.renderer||this._getPaneRenderer(a.options.pane)||this.options.renderer||this._renderer;return b||(b=this._renderer=this.options.preferCanvas&&d.canvas()||d.svg()),this.hasLayer(b)||this.addLayer(b),b},_getPaneRenderer:function(a){if("overlayPane"===a||a===c)return!1;var b=this._paneRenderers[a];return b===c&&(b=d.SVG&&d.svg({pane:a})||d.Canvas&&d.canvas({pane:a}),this._paneRenderers[a]=b),b}}),d.Path=d.Layer.extend({options:{stroke:!0,color:"#3388ff",weight:3,opacity:1,lineCap:"round",lineJoin:"round",dashArray:null,dashOffset:null,fill:!1,fillColor:null,fillOpacity:.2,fillRule:"evenodd",interactive:!0},beforeAdd:function(a){this._renderer=a.getRenderer(this)},onAdd:function(){this._renderer._initPath(this),this._reset(),this._renderer._addPath(this)},onRemove:function(){this._renderer._removePath(this)},redraw:function(){return this._map&&this._renderer._updatePath(this),this},setStyle:function(a){return d.setOptions(this,a),this._renderer&&this._renderer._updateStyle(this),this},bringToFront:function(){return this._renderer&&this._renderer._bringToFront(this),this},bringToBack:function(){return this._renderer&&this._renderer._bringToBack(this),this},getElement:function(){return this._path},_reset:function(){this._project(),this._update()},_clickTolerance:function(){return(this.options.stroke?this.options.weight/2:0)+(d.Browser.touch?10:0)}}),d.LineUtil={simplify:function(a,b){if(!b||!a.length)return a.slice();var c=b*b;return a=this._reducePoints(a,c),a=this._simplifyDP(a,c)},pointToSegmentDistance:function(a,b,c){return Math.sqrt(this._sqClosestPointOnSegment(a,b,c,!0))},closestPointOnSegment:function(a,b,c){return this._sqClosestPointOnSegment(a,b,c)},_simplifyDP:function(a,b){var d=a.length,e=typeof Uint8Array!=c+""?Uint8Array:Array,f=new e(d);f[0]=f[d-1]=1,this._simplifyDPStep(a,f,b,0,d-1);var g,h=[];for(g=0;g<d;g++)f[g]&&h.push(a[g]);return h},_simplifyDPStep:function(a,b,c,d,e){var f,g,h,i=0;for(g=d+1;g<=e-1;g++)(h=this._sqClosestPointOnSegment(a[g],a[d],a[e],!0))>i&&(f=g,i=h);i>c&&(b[f]=1,this._simplifyDPStep(a,b,c,d,f),this._simplifyDPStep(a,b,c,f,e))},_reducePoints:function(a,b){for(var c=[a[0]],d=1,e=0,f=a.length;d<f;d++)this._sqDist(a[d],a[e])>b&&(c.push(a[d]),e=d);return e<f-1&&c.push(a[f-1]),c},clipSegment:function(a,b,c,d,e){var f,g,h,i=d?this._lastCode:this._getBitCode(a,c),j=this._getBitCode(b,c);for(this._lastCode=j;;){if(!(i|j))return[a,b];if(i&j)return!1;f=i||j,g=this._getEdgeIntersection(a,b,f,c,e),h=this._getBitCode(g,c),f===i?(a=g,i=h):(b=g,j=h)}},_getEdgeIntersection:function(a,b,c,e,f){var g,h,i=b.x-a.x,j=b.y-a.y,k=e.min,l=e.max;return 8&c?(g=a.x+i*(l.y-a.y)/j,h=l.y):4&c?(g=a.x+i*(k.y-a.y)/j,h=k.y):2&c?(g=l.x,h=a.y+j*(l.x-a.x)/i):1&c&&(g=k.x,h=a.y+j*(k.x-a.x)/i),new d.Point(g,h,f)},_getBitCode:function(a,b){var c=0;return a.x<b.min.x?c|=1:a.x>b.max.x&&(c|=2),a.y<b.min.y?c|=4:a.y>b.max.y&&(c|=8),c},_sqDist:function(a,b){var c=b.x-a.x,d=b.y-a.y;return c*c+d*d},_sqClosestPointOnSegment:function(a,b,c,e){var f,g=b.x,h=b.y,i=c.x-g,j=c.y-h,k=i*i+j*j;return k>0&&(f=((a.x-g)*i+(a.y-h)*j)/k,f>1?(g=c.x,h=c.y):f>0&&(g+=i*f,h+=j*f)),i=a.x-g,j=a.y-h,e?i*i+j*j:new d.Point(g,h)}},d.Polyline=d.Path.extend({options:{smoothFactor:1,noClip:!1},initialize:function(a,b){d.setOptions(this,b),this._setLatLngs(a)},getLatLngs:function(){return this._latlngs},setLatLngs:function(a){return this._setLatLngs(a),this.redraw()},isEmpty:function(){return!this._latlngs.length},closestLayerPoint:function(a){for(var b,c,e=1/0,f=null,g=d.LineUtil._sqClosestPointOnSegment,h=0,i=this._parts.length;h<i;h++)for(var j=this._parts[h],k=1,l=j.length;k<l;k++){b=j[k-1],c=j[k];var m=g(a,b,c,!0);m<e&&(e=m,f=g(a,b,c))}return f&&(f.distance=Math.sqrt(e)),f},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");var a,b,c,d,e,f,g,h=this._rings[0],i=h.length;if(!i)return null;for(a=0,b=0;a<i-1;a++)b+=h[a].distanceTo(h[a+1])/2;if(0===b)return this._map.layerPointToLatLng(h[0]);for(a=0,d=0;a<i-1;a++)if(e=h[a],f=h[a+1],c=e.distanceTo(f),(d+=c)>b)return g=(d-b)/c,this._map.layerPointToLatLng([f.x-g*(f.x-e.x),f.y-g*(f.y-e.y)])},getBounds:function(){return this._bounds},addLatLng:function(a,b){return b=b||this._defaultShape(),a=d.latLng(a),b.push(a),this._bounds.extend(a),this.redraw()},_setLatLngs:function(a){this._bounds=new d.LatLngBounds,this._latlngs=this._convertLatLngs(a)},_defaultShape:function(){return d.Polyline._flat(this._latlngs)?this._latlngs:this._latlngs[0]},_convertLatLngs:function(a){for(var b=[],c=d.Polyline._flat(a),e=0,f=a.length;e<f;e++)c?(b[e]=d.latLng(a[e]),this._bounds.extend(b[e])):b[e]=this._convertLatLngs(a[e]);return b},_project:function(){var a=new d.Bounds;this._rings=[],this._projectLatlngs(this._latlngs,this._rings,a);var b=this._clickTolerance(),c=new d.Point(b,b);this._bounds.isValid()&&a.isValid()&&(a.min._subtract(c),a.max._add(c),this._pxBounds=a)},_projectLatlngs:function(a,b,c){var e,f,g=a[0]instanceof d.LatLng,h=a.length;if(g){for(f=[],e=0;e<h;e++)f[e]=this._map.latLngToLayerPoint(a[e]),c.extend(f[e]);b.push(f)}else for(e=0;e<h;e++)this._projectLatlngs(a[e],b,c)},_clipPoints:function(){var a=this._renderer._bounds;if(this._parts=[],this._pxBounds&&this._pxBounds.intersects(a)){if(this.options.noClip)return void(this._parts=this._rings);var b,c,e,f,g,h,i,j=this._parts;for(b=0,e=0,f=this._rings.length;b<f;b++)for(i=this._rings[b],c=0,g=i.length;c<g-1;c++)(h=d.LineUtil.clipSegment(i[c],i[c+1],a,c,!0))&&(j[e]=j[e]||[],j[e].push(h[0]),h[1]===i[c+1]&&c!==g-2||(j[e].push(h[1]),e++))}},_simplifyPoints:function(){for(var a=this._parts,b=this.options.smoothFactor,c=0,e=a.length;c<e;c++)a[c]=d.LineUtil.simplify(a[c],b)},_update:function(){this._map&&(this._clipPoints(),this._simplifyPoints(),this._updatePath())},_updatePath:function(){this._renderer._updatePoly(this)}}),d.polyline=function(a,b){return new d.Polyline(a,b)},d.Polyline._flat=function(a){return!d.Util.isArray(a[0])||"object"!=typeof a[0][0]&&void 0!==a[0][0]},d.PolyUtil={},d.PolyUtil.clipPolygon=function(a,b,c){var e,f,g,h,i,j,k,l,m,n=[1,4,2,8],o=d.LineUtil;for(f=0,k=a.length;f<k;f++)a[f]._code=o._getBitCode(a[f],b);for(h=0;h<4;h++){for(l=n[h],e=[],f=0,k=a.length,g=k-1;f<k;g=f++)i=a[f],j=a[g],i._code&l?j._code&l||(m=o._getEdgeIntersection(j,i,l,b,c),m._code=o._getBitCode(m,b),e.push(m)):(j._code&l&&(m=o._getEdgeIntersection(j,i,l,b,c),m._code=o._getBitCode(m,b),e.push(m)),e.push(i));a=e}return a},d.Polygon=d.Polyline.extend({options:{fill:!0},isEmpty:function(){
return!this._latlngs.length||!this._latlngs[0].length},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");var a,b,c,d,e,f,g,h,i,j=this._rings[0],k=j.length;if(!k)return null;for(f=g=h=0,a=0,b=k-1;a<k;b=a++)c=j[a],d=j[b],e=c.y*d.x-d.y*c.x,g+=(c.x+d.x)*e,h+=(c.y+d.y)*e,f+=3*e;return i=0===f?j[0]:[g/f,h/f],this._map.layerPointToLatLng(i)},_convertLatLngs:function(a){var b=d.Polyline.prototype._convertLatLngs.call(this,a),c=b.length;return c>=2&&b[0]instanceof d.LatLng&&b[0].equals(b[c-1])&&b.pop(),b},_setLatLngs:function(a){d.Polyline.prototype._setLatLngs.call(this,a),d.Polyline._flat(this._latlngs)&&(this._latlngs=[this._latlngs])},_defaultShape:function(){return d.Polyline._flat(this._latlngs[0])?this._latlngs[0]:this._latlngs[0][0]},_clipPoints:function(){var a=this._renderer._bounds,b=this.options.weight,c=new d.Point(b,b);if(a=new d.Bounds(a.min.subtract(c),a.max.add(c)),this._parts=[],this._pxBounds&&this._pxBounds.intersects(a)){if(this.options.noClip)return void(this._parts=this._rings);for(var e,f=0,g=this._rings.length;f<g;f++)e=d.PolyUtil.clipPolygon(this._rings[f],a,!0),e.length&&this._parts.push(e)}},_updatePath:function(){this._renderer._updatePoly(this,!0)}}),d.polygon=function(a,b){return new d.Polygon(a,b)},d.Rectangle=d.Polygon.extend({initialize:function(a,b){d.Polygon.prototype.initialize.call(this,this._boundsToLatLngs(a),b)},setBounds:function(a){return this.setLatLngs(this._boundsToLatLngs(a))},_boundsToLatLngs:function(a){return a=d.latLngBounds(a),[a.getSouthWest(),a.getNorthWest(),a.getNorthEast(),a.getSouthEast()]}}),d.rectangle=function(a,b){return new d.Rectangle(a,b)},d.CircleMarker=d.Path.extend({options:{fill:!0,radius:10},initialize:function(a,b){d.setOptions(this,b),this._latlng=d.latLng(a),this._radius=this.options.radius},setLatLng:function(a){return this._latlng=d.latLng(a),this.redraw(),this.fire("move",{latlng:this._latlng})},getLatLng:function(){return this._latlng},setRadius:function(a){return this.options.radius=this._radius=a,this.redraw()},getRadius:function(){return this._radius},setStyle:function(a){var b=a&&a.radius||this._radius;return d.Path.prototype.setStyle.call(this,a),this.setRadius(b),this},_project:function(){this._point=this._map.latLngToLayerPoint(this._latlng),this._updateBounds()},_updateBounds:function(){var a=this._radius,b=this._radiusY||a,c=this._clickTolerance(),e=[a+c,b+c];this._pxBounds=new d.Bounds(this._point.subtract(e),this._point.add(e))},_update:function(){this._map&&this._updatePath()},_updatePath:function(){this._renderer._updateCircle(this)},_empty:function(){return this._radius&&!this._renderer._bounds.intersects(this._pxBounds)}}),d.circleMarker=function(a,b){return new d.CircleMarker(a,b)},d.Circle=d.CircleMarker.extend({initialize:function(a,b,c){if("number"==typeof b&&(b=d.extend({},c,{radius:b})),d.setOptions(this,b),this._latlng=d.latLng(a),isNaN(this.options.radius))throw new Error("Circle radius cannot be NaN");this._mRadius=this.options.radius},setRadius:function(a){return this._mRadius=a,this.redraw()},getRadius:function(){return this._mRadius},getBounds:function(){var a=[this._radius,this._radiusY||this._radius];return new d.LatLngBounds(this._map.layerPointToLatLng(this._point.subtract(a)),this._map.layerPointToLatLng(this._point.add(a)))},setStyle:d.Path.prototype.setStyle,_project:function(){var a=this._latlng.lng,b=this._latlng.lat,c=this._map,e=c.options.crs;if(e.distance===d.CRS.Earth.distance){var f=Math.PI/180,g=this._mRadius/d.CRS.Earth.R/f,h=c.project([b+g,a]),i=c.project([b-g,a]),j=h.add(i).divideBy(2),k=c.unproject(j).lat,l=Math.acos((Math.cos(g*f)-Math.sin(b*f)*Math.sin(k*f))/(Math.cos(b*f)*Math.cos(k*f)))/f;(isNaN(l)||0===l)&&(l=g/Math.cos(Math.PI/180*b)),this._point=j.subtract(c.getPixelOrigin()),this._radius=isNaN(l)?0:Math.max(Math.round(j.x-c.project([k,a-l]).x),1),this._radiusY=Math.max(Math.round(j.y-h.y),1)}else{var m=e.unproject(e.project(this._latlng).subtract([this._mRadius,0]));this._point=c.latLngToLayerPoint(this._latlng),this._radius=this._point.x-c.latLngToLayerPoint(m).x}this._updateBounds()}}),d.circle=function(a,b,c){return new d.Circle(a,b,c)},d.SVG=d.Renderer.extend({getEvents:function(){var a=d.Renderer.prototype.getEvents.call(this);return a.zoomstart=this._onZoomStart,a},_initContainer:function(){this._container=d.SVG.create("svg"),this._container.setAttribute("pointer-events","none"),this._rootGroup=d.SVG.create("g"),this._container.appendChild(this._rootGroup)},_onZoomStart:function(){this._update()},_update:function(){if(!this._map._animatingZoom||!this._bounds){d.Renderer.prototype._update.call(this);var a=this._bounds,b=a.getSize(),c=this._container;this._svgSize&&this._svgSize.equals(b)||(this._svgSize=b,c.setAttribute("width",b.x),c.setAttribute("height",b.y)),d.DomUtil.setPosition(c,a.min),c.setAttribute("viewBox",[a.min.x,a.min.y,b.x,b.y].join(" ")),this.fire("update")}},_initPath:function(a){var b=a._path=d.SVG.create("path");a.options.className&&d.DomUtil.addClass(b,a.options.className),a.options.interactive&&d.DomUtil.addClass(b,"leaflet-interactive"),this._updateStyle(a),this._layers[d.stamp(a)]=a},_addPath:function(a){this._rootGroup.appendChild(a._path),a.addInteractiveTarget(a._path)},_removePath:function(a){d.DomUtil.remove(a._path),a.removeInteractiveTarget(a._path),delete this._layers[d.stamp(a)]},_updatePath:function(a){a._project(),a._update()},_updateStyle:function(a){var b=a._path,c=a.options;b&&(c.stroke?(b.setAttribute("stroke",c.color),b.setAttribute("stroke-opacity",c.opacity),b.setAttribute("stroke-width",c.weight),b.setAttribute("stroke-linecap",c.lineCap),b.setAttribute("stroke-linejoin",c.lineJoin),c.dashArray?b.setAttribute("stroke-dasharray",c.dashArray):b.removeAttribute("stroke-dasharray"),c.dashOffset?b.setAttribute("stroke-dashoffset",c.dashOffset):b.removeAttribute("stroke-dashoffset")):b.setAttribute("stroke","none"),c.fill?(b.setAttribute("fill",c.fillColor||c.color),b.setAttribute("fill-opacity",c.fillOpacity),b.setAttribute("fill-rule",c.fillRule||"evenodd")):b.setAttribute("fill","none"))},_updatePoly:function(a,b){this._setPath(a,d.SVG.pointsToPath(a._parts,b))},_updateCircle:function(a){var b=a._point,c=a._radius,d=a._radiusY||c,e="a"+c+","+d+" 0 1,0 ",f=a._empty()?"M0 0":"M"+(b.x-c)+","+b.y+e+2*c+",0 "+e+2*-c+",0 ";this._setPath(a,f)},_setPath:function(a,b){a._path.setAttribute("d",b)},_bringToFront:function(a){d.DomUtil.toFront(a._path)},_bringToBack:function(a){d.DomUtil.toBack(a._path)}}),d.extend(d.SVG,{create:function(a){return b.createElementNS("http://www.w3.org/2000/svg",a)},pointsToPath:function(a,b){var c,e,f,g,h,i,j="";for(c=0,f=a.length;c<f;c++){for(h=a[c],e=0,g=h.length;e<g;e++)i=h[e],j+=(e?"L":"M")+i.x+" "+i.y;j+=b?d.Browser.svg?"z":"x":""}return j||"M0 0"}}),d.Browser.svg=!(!b.createElementNS||!d.SVG.create("svg").createSVGRect),d.svg=function(a){return d.Browser.svg||d.Browser.vml?new d.SVG(a):null},d.Browser.vml=!d.Browser.svg&&function(){try{var a=b.createElement("div");a.innerHTML='<v:shape adj="1"/>';var c=a.firstChild;return c.style.behavior="url(#default#VML)",c&&"object"==typeof c.adj}catch(a){return!1}}(),d.SVG.include(d.Browser.vml?{_initContainer:function(){this._container=d.DomUtil.create("div","leaflet-vml-container")},_update:function(){this._map._animatingZoom||(d.Renderer.prototype._update.call(this),this.fire("update"))},_initPath:function(a){var b=a._container=d.SVG.create("shape");d.DomUtil.addClass(b,"leaflet-vml-shape "+(this.options.className||"")),b.coordsize="1 1",a._path=d.SVG.create("path"),b.appendChild(a._path),this._updateStyle(a),this._layers[d.stamp(a)]=a},_addPath:function(a){var b=a._container;this._container.appendChild(b),a.options.interactive&&a.addInteractiveTarget(b)},_removePath:function(a){var b=a._container;d.DomUtil.remove(b),a.removeInteractiveTarget(b),delete this._layers[d.stamp(a)]},_updateStyle:function(a){var b=a._stroke,c=a._fill,e=a.options,f=a._container;f.stroked=!!e.stroke,f.filled=!!e.fill,e.stroke?(b||(b=a._stroke=d.SVG.create("stroke")),f.appendChild(b),b.weight=e.weight+"px",b.color=e.color,b.opacity=e.opacity,e.dashArray?b.dashStyle=d.Util.isArray(e.dashArray)?e.dashArray.join(" "):e.dashArray.replace(/( *, *)/g," "):b.dashStyle="",b.endcap=e.lineCap.replace("butt","flat"),b.joinstyle=e.lineJoin):b&&(f.removeChild(b),a._stroke=null),e.fill?(c||(c=a._fill=d.SVG.create("fill")),f.appendChild(c),c.color=e.fillColor||e.color,c.opacity=e.fillOpacity):c&&(f.removeChild(c),a._fill=null)},_updateCircle:function(a){var b=a._point.round(),c=Math.round(a._radius),d=Math.round(a._radiusY||c);this._setPath(a,a._empty()?"M0 0":"AL "+b.x+","+b.y+" "+c+","+d+" 0,23592600")},_setPath:function(a,b){a._path.v=b},_bringToFront:function(a){d.DomUtil.toFront(a._container)},_bringToBack:function(a){d.DomUtil.toBack(a._container)}}:{}),d.Browser.vml&&(d.SVG.create=function(){try{return b.namespaces.add("lvml","urn:schemas-microsoft-com:vml"),function(a){return b.createElement("<lvml:"+a+' class="lvml">')}}catch(a){return function(a){return b.createElement("<"+a+' xmlns="urn:schemas-microsoft.com:vml" class="lvml">')}}}()),d.Canvas=d.Renderer.extend({getEvents:function(){var a=d.Renderer.prototype.getEvents.call(this);return a.viewprereset=this._onViewPreReset,a},_onViewPreReset:function(){this._postponeUpdatePaths=!0},onAdd:function(){d.Renderer.prototype.onAdd.call(this),this._draw()},_initContainer:function(){var a=this._container=b.createElement("canvas");d.DomEvent.on(a,"mousemove",d.Util.throttle(this._onMouseMove,32,this),this).on(a,"click dblclick mousedown mouseup contextmenu",this._onClick,this).on(a,"mouseout",this._handleMouseOut,this),this._ctx=a.getContext("2d")},_updatePaths:function(){if(!this._postponeUpdatePaths){var a;this._redrawBounds=null;for(var b in this._layers)a=this._layers[b],a._update();this._redraw()}},_update:function(){if(!this._map._animatingZoom||!this._bounds){this._drawnLayers={},d.Renderer.prototype._update.call(this);var a=this._bounds,b=this._container,c=a.getSize(),e=d.Browser.retina?2:1;d.DomUtil.setPosition(b,a.min),b.width=e*c.x,b.height=e*c.y,b.style.width=c.x+"px",b.style.height=c.y+"px",d.Browser.retina&&this._ctx.scale(2,2),this._ctx.translate(-a.min.x,-a.min.y),this.fire("update")}},_reset:function(){d.Renderer.prototype._reset.call(this),this._postponeUpdatePaths&&(this._postponeUpdatePaths=!1,this._updatePaths())},_initPath:function(a){this._updateDashArray(a),this._layers[d.stamp(a)]=a;var b=a._order={layer:a,prev:this._drawLast,next:null};this._drawLast&&(this._drawLast.next=b),this._drawLast=b,this._drawFirst=this._drawFirst||this._drawLast},_addPath:function(a){this._requestRedraw(a)},_removePath:function(a){var b=a._order,c=b.next,e=b.prev;c?c.prev=e:this._drawLast=e,e?e.next=c:this._drawFirst=c,delete a._order,delete this._layers[d.stamp(a)],this._requestRedraw(a)},_updatePath:function(a){this._extendRedrawBounds(a),a._project(),a._update(),this._requestRedraw(a)},_updateStyle:function(a){this._updateDashArray(a),this._requestRedraw(a)},_updateDashArray:function(a){if(a.options.dashArray){var b,c=a.options.dashArray.split(","),d=[];for(b=0;b<c.length;b++)d.push(Number(c[b]));a.options._dashArray=d}},_requestRedraw:function(a){this._map&&(this._extendRedrawBounds(a),this._redrawRequest=this._redrawRequest||d.Util.requestAnimFrame(this._redraw,this))},_extendRedrawBounds:function(a){var b=(a.options.weight||0)+1;this._redrawBounds=this._redrawBounds||new d.Bounds,this._redrawBounds.extend(a._pxBounds.min.subtract([b,b])),this._redrawBounds.extend(a._pxBounds.max.add([b,b]))},_redraw:function(){this._redrawRequest=null,this._redrawBounds&&(this._redrawBounds.min._floor(),this._redrawBounds.max._ceil()),this._clear(),this._draw(),this._redrawBounds=null},_clear:function(){var a=this._redrawBounds;if(a){var b=a.getSize();this._ctx.clearRect(a.min.x,a.min.y,b.x,b.y)}else this._ctx.clearRect(0,0,this._container.width,this._container.height)},_draw:function(){var a,b=this._redrawBounds;if(this._ctx.save(),b){var c=b.getSize();this._ctx.beginPath(),this._ctx.rect(b.min.x,b.min.y,c.x,c.y),this._ctx.clip()}this._drawing=!0;for(var d=this._drawFirst;d;d=d.next)a=d.layer,(!b||a._pxBounds&&a._pxBounds.intersects(b))&&a._updatePath();this._drawing=!1,this._ctx.restore()},_updatePoly:function(a,b){if(this._drawing){var c,d,e,f,g=a._parts,h=g.length,i=this._ctx;if(h){for(this._drawnLayers[a._leaflet_id]=a,i.beginPath(),i.setLineDash&&i.setLineDash(a.options&&a.options._dashArray||[]),c=0;c<h;c++){for(d=0,e=g[c].length;d<e;d++)f=g[c][d],i[d?"lineTo":"moveTo"](f.x,f.y);b&&i.closePath()}this._fillStroke(i,a)}}},_updateCircle:function(a){if(this._drawing&&!a._empty()){var b=a._point,c=this._ctx,d=a._radius,e=(a._radiusY||d)/d;this._drawnLayers[a._leaflet_id]=a,1!==e&&(c.save(),c.scale(1,e)),c.beginPath(),c.arc(b.x,b.y/e,d,0,2*Math.PI,!1),1!==e&&c.restore(),this._fillStroke(c,a)}},_fillStroke:function(a,b){var c=b.options;c.fill&&(a.globalAlpha=c.fillOpacity,a.fillStyle=c.fillColor||c.color,a.fill(c.fillRule||"evenodd")),c.stroke&&0!==c.weight&&(a.globalAlpha=c.opacity,a.lineWidth=c.weight,a.strokeStyle=c.color,a.lineCap=c.lineCap,a.lineJoin=c.lineJoin,a.stroke())},_onClick:function(a){for(var b,c,e=this._map.mouseEventToLayerPoint(a),f=this._drawFirst;f;f=f.next)b=f.layer,b.options.interactive&&b._containsPoint(e)&&!this._map._draggableMoved(b)&&(c=b);c&&(d.DomEvent._fakeStop(a),this._fireEvent([c],a))},_onMouseMove:function(a){if(this._map&&!this._map.dragging.moving()&&!this._map._animatingZoom){var b=this._map.mouseEventToLayerPoint(a);this._handleMouseHover(a,b)}},_handleMouseOut:function(a){var b=this._hoveredLayer;b&&(d.DomUtil.removeClass(this._container,"leaflet-interactive"),this._fireEvent([b],a,"mouseout"),this._hoveredLayer=null)},_handleMouseHover:function(a,b){for(var c,e,f=this._drawFirst;f;f=f.next)c=f.layer,c.options.interactive&&c._containsPoint(b)&&(e=c);e!==this._hoveredLayer&&(this._handleMouseOut(a),e&&(d.DomUtil.addClass(this._container,"leaflet-interactive"),this._fireEvent([e],a,"mouseover"),this._hoveredLayer=e)),this._hoveredLayer&&this._fireEvent([this._hoveredLayer],a)},_fireEvent:function(a,b,c){this._map._fireDOMEvent(b,c||b.type,a)},_bringToFront:function(a){var b=a._order,c=b.next,d=b.prev;c&&(c.prev=d,d?d.next=c:c&&(this._drawFirst=c),b.prev=this._drawLast,this._drawLast.next=b,b.next=null,this._drawLast=b,this._requestRedraw(a))},_bringToBack:function(a){var b=a._order,c=b.next,d=b.prev;d&&(d.next=c,c?c.prev=d:d&&(this._drawLast=d),b.prev=null,b.next=this._drawFirst,this._drawFirst.prev=b,this._drawFirst=b,this._requestRedraw(a))}}),d.Browser.canvas=function(){return!!b.createElement("canvas").getContext}(),d.canvas=function(a){return d.Browser.canvas?new d.Canvas(a):null},d.Polyline.prototype._containsPoint=function(a,b){var c,e,f,g,h,i,j=this._clickTolerance();if(!this._pxBounds.contains(a))return!1;for(c=0,g=this._parts.length;c<g;c++)for(i=this._parts[c],e=0,h=i.length,f=h-1;e<h;f=e++)if((b||0!==e)&&d.LineUtil.pointToSegmentDistance(a,i[f],i[e])<=j)return!0;return!1},d.Polygon.prototype._containsPoint=function(a){var b,c,e,f,g,h,i,j,k=!1;if(!this._pxBounds.contains(a))return!1;for(f=0,i=this._parts.length;f<i;f++)for(b=this._parts[f],g=0,j=b.length,h=j-1;g<j;h=g++)c=b[g],e=b[h],c.y>a.y!=e.y>a.y&&a.x<(e.x-c.x)*(a.y-c.y)/(e.y-c.y)+c.x&&(k=!k);return k||d.Polyline.prototype._containsPoint.call(this,a,!0)},d.CircleMarker.prototype._containsPoint=function(a){return a.distanceTo(this._point)<=this._radius+this._clickTolerance()},d.GeoJSON=d.FeatureGroup.extend({initialize:function(a,b){d.setOptions(this,b),this._layers={},a&&this.addData(a)},addData:function(a){var b,c,e,f=d.Util.isArray(a)?a:a.features;if(f){for(b=0,c=f.length;b<c;b++)e=f[b],(e.geometries||e.geometry||e.features||e.coordinates)&&this.addData(e);return this}var g=this.options;if(g.filter&&!g.filter(a))return this;var h=d.GeoJSON.geometryToLayer(a,g);return h?(h.feature=d.GeoJSON.asFeature(a),h.defaultOptions=h.options,this.resetStyle(h),g.onEachFeature&&g.onEachFeature(a,h),this.addLayer(h)):this},resetStyle:function(a){return a.options=d.Util.extend({},a.defaultOptions),this._setLayerStyle(a,this.options.style),this},setStyle:function(a){return this.eachLayer(function(b){this._setLayerStyle(b,a)},this)},_setLayerStyle:function(a,b){"function"==typeof b&&(b=b(a.feature)),a.setStyle&&a.setStyle(b)}}),d.extend(d.GeoJSON,{geometryToLayer:function(a,b){var c,e,f,g,h="Feature"===a.type?a.geometry:a,i=h?h.coordinates:null,j=[],k=b&&b.pointToLayer,l=b&&b.coordsToLatLng||this.coordsToLatLng;if(!i&&!h)return null;switch(h.type){case"Point":return c=l(i),k?k(a,c):new d.Marker(c);case"MultiPoint":for(f=0,g=i.length;f<g;f++)c=l(i[f]),j.push(k?k(a,c):new d.Marker(c));return new d.FeatureGroup(j);case"LineString":case"MultiLineString":return e=this.coordsToLatLngs(i,"LineString"===h.type?0:1,l),new d.Polyline(e,b);case"Polygon":case"MultiPolygon":return e=this.coordsToLatLngs(i,"Polygon"===h.type?1:2,l),new d.Polygon(e,b);case"GeometryCollection":for(f=0,g=h.geometries.length;f<g;f++){var m=this.geometryToLayer({geometry:h.geometries[f],type:"Feature",properties:a.properties},b);m&&j.push(m)}return new d.FeatureGroup(j);default:throw new Error("Invalid GeoJSON object.")}},coordsToLatLng:function(a){return new d.LatLng(a[1],a[0],a[2])},coordsToLatLngs:function(a,b,c){for(var d,e=[],f=0,g=a.length;f<g;f++)d=b?this.coordsToLatLngs(a[f],b-1,c):(c||this.coordsToLatLng)(a[f]),e.push(d);return e},latLngToCoords:function(a){return a.alt!==c?[a.lng,a.lat,a.alt]:[a.lng,a.lat]},latLngsToCoords:function(a,b,c){for(var e=[],f=0,g=a.length;f<g;f++)e.push(b?d.GeoJSON.latLngsToCoords(a[f],b-1,c):d.GeoJSON.latLngToCoords(a[f]));return!b&&c&&e.push(e[0]),e},getFeature:function(a,b){return a.feature?d.extend({},a.feature,{geometry:b}):d.GeoJSON.asFeature(b)},asFeature:function(a){return"Feature"===a.type||"FeatureCollection"===a.type?a:{type:"Feature",properties:{},geometry:a}}});var g={toGeoJSON:function(){return d.GeoJSON.getFeature(this,{type:"Point",coordinates:d.GeoJSON.latLngToCoords(this.getLatLng())})}};d.Marker.include(g),d.Circle.include(g),d.CircleMarker.include(g),d.Polyline.prototype.toGeoJSON=function(){var a=!d.Polyline._flat(this._latlngs),b=d.GeoJSON.latLngsToCoords(this._latlngs,a?1:0);return d.GeoJSON.getFeature(this,{type:(a?"Multi":"")+"LineString",coordinates:b})},d.Polygon.prototype.toGeoJSON=function(){var a=!d.Polyline._flat(this._latlngs),b=a&&!d.Polyline._flat(this._latlngs[0]),c=d.GeoJSON.latLngsToCoords(this._latlngs,b?2:a?1:0,!0);return a||(c=[c]),d.GeoJSON.getFeature(this,{type:(b?"Multi":"")+"Polygon",coordinates:c})},d.LayerGroup.include({toMultiPoint:function(){var a=[];return this.eachLayer(function(b){a.push(b.toGeoJSON().geometry.coordinates)}),d.GeoJSON.getFeature(this,{type:"MultiPoint",coordinates:a})},toGeoJSON:function(){var a=this.feature&&this.feature.geometry&&this.feature.geometry.type;if("MultiPoint"===a)return this.toMultiPoint();var b="GeometryCollection"===a,c=[];return this.eachLayer(function(a){if(a.toGeoJSON){var e=a.toGeoJSON();c.push(b?e.geometry:d.GeoJSON.asFeature(e))}}),b?d.GeoJSON.getFeature(this,{geometries:c,type:"GeometryCollection"}):{type:"FeatureCollection",features:c}}}),d.geoJSON=function(a,b){return new d.GeoJSON(a,b)},d.geoJson=d.geoJSON,d.Draggable=d.Evented.extend({options:{clickTolerance:3},statics:{START:d.Browser.touch?["touchstart","mousedown"]:["mousedown"],END:{mousedown:"mouseup",touchstart:"touchend",pointerdown:"touchend",MSPointerDown:"touchend"},MOVE:{mousedown:"mousemove",touchstart:"touchmove",pointerdown:"touchmove",MSPointerDown:"touchmove"}},initialize:function(a,b,c){this._element=a,this._dragStartTarget=b||a,this._preventOutline=c},enable:function(){this._enabled||(d.DomEvent.on(this._dragStartTarget,d.Draggable.START.join(" "),this._onDown,this),this._enabled=!0)},disable:function(){this._enabled&&(d.Draggable._dragging===this&&this.finishDrag(),d.DomEvent.off(this._dragStartTarget,d.Draggable.START.join(" "),this._onDown,this),this._enabled=!1,this._moved=!1)},_onDown:function(a){if(!a._simulated&&this._enabled&&(this._moved=!1,!d.DomUtil.hasClass(this._element,"leaflet-zoom-anim")&&!(d.Draggable._dragging||a.shiftKey||1!==a.which&&1!==a.button&&!a.touches||(d.Draggable._dragging=this,this._preventOutline&&d.DomUtil.preventOutline(this._element),d.DomUtil.disableImageDrag(),d.DomUtil.disableTextSelection(),this._moving)))){this.fire("down");var c=a.touches?a.touches[0]:a;this._startPoint=new d.Point(c.clientX,c.clientY),d.DomEvent.on(b,d.Draggable.MOVE[a.type],this._onMove,this).on(b,d.Draggable.END[a.type],this._onUp,this)}},_onMove:function(c){if(!c._simulated&&this._enabled){if(c.touches&&c.touches.length>1)return void(this._moved=!0);var e=c.touches&&1===c.touches.length?c.touches[0]:c,f=new d.Point(e.clientX,e.clientY),g=f.subtract(this._startPoint);(g.x||g.y)&&(Math.abs(g.x)+Math.abs(g.y)<this.options.clickTolerance||(d.DomEvent.preventDefault(c),this._moved||(this.fire("dragstart"),this._moved=!0,this._startPos=d.DomUtil.getPosition(this._element).subtract(g),d.DomUtil.addClass(b.body,"leaflet-dragging"),this._lastTarget=c.target||c.srcElement,a.SVGElementInstance&&this._lastTarget instanceof SVGElementInstance&&(this._lastTarget=this._lastTarget.correspondingUseElement),d.DomUtil.addClass(this._lastTarget,"leaflet-drag-target")),this._newPos=this._startPos.add(g),this._moving=!0,d.Util.cancelAnimFrame(this._animRequest),this._lastEvent=c,this._animRequest=d.Util.requestAnimFrame(this._updatePosition,this,!0)))}},_updatePosition:function(){var a={originalEvent:this._lastEvent};this.fire("predrag",a),d.DomUtil.setPosition(this._element,this._newPos),this.fire("drag",a)},_onUp:function(a){!a._simulated&&this._enabled&&this.finishDrag()},finishDrag:function(){d.DomUtil.removeClass(b.body,"leaflet-dragging"),this._lastTarget&&(d.DomUtil.removeClass(this._lastTarget,"leaflet-drag-target"),this._lastTarget=null);for(var a in d.Draggable.MOVE)d.DomEvent.off(b,d.Draggable.MOVE[a],this._onMove,this).off(b,d.Draggable.END[a],this._onUp,this);d.DomUtil.enableImageDrag(),d.DomUtil.enableTextSelection(),this._moved&&this._moving&&(d.Util.cancelAnimFrame(this._animRequest),this.fire("dragend",{distance:this._newPos.distanceTo(this._startPos)})),this._moving=!1,d.Draggable._dragging=!1}}),d.Handler=d.Class.extend({initialize:function(a){this._map=a},enable:function(){return this._enabled?this:(this._enabled=!0,this.addHooks(),this)},disable:function(){return this._enabled?(this._enabled=!1,this.removeHooks(),this):this},enabled:function(){return!!this._enabled}}),d.Map.mergeOptions({dragging:!0,inertia:!d.Browser.android23,inertiaDeceleration:3400,inertiaMaxSpeed:1/0,easeLinearity:.2,worldCopyJump:!1,maxBoundsViscosity:0}),d.Map.Drag=d.Handler.extend({addHooks:function(){if(!this._draggable){var a=this._map;this._draggable=new d.Draggable(a._mapPane,a._container),this._draggable.on({down:this._onDown,dragstart:this._onDragStart,drag:this._onDrag,dragend:this._onDragEnd},this),this._draggable.on("predrag",this._onPreDragLimit,this),a.options.worldCopyJump&&(this._draggable.on("predrag",this._onPreDragWrap,this),a.on("zoomend",this._onZoomEnd,this),a.whenReady(this._onZoomEnd,this))}d.DomUtil.addClass(this._map._container,"leaflet-grab leaflet-touch-drag"),this._draggable.enable(),this._positions=[],this._times=[]},removeHooks:function(){d.DomUtil.removeClass(this._map._container,"leaflet-grab"),d.DomUtil.removeClass(this._map._container,"leaflet-touch-drag"),this._draggable.disable()},moved:function(){return this._draggable&&this._draggable._moved},moving:function(){return this._draggable&&this._draggable._moving},_onDown:function(){this._map._stop()},_onDragStart:function(){var a=this._map;if(this._map.options.maxBounds&&this._map.options.maxBoundsViscosity){var b=d.latLngBounds(this._map.options.maxBounds);this._offsetLimit=d.bounds(this._map.latLngToContainerPoint(b.getNorthWest()).multiplyBy(-1),this._map.latLngToContainerPoint(b.getSouthEast()).multiplyBy(-1).add(this._map.getSize())),this._viscosity=Math.min(1,Math.max(0,this._map.options.maxBoundsViscosity))}else this._offsetLimit=null;a.fire("movestart").fire("dragstart"),a.options.inertia&&(this._positions=[],this._times=[])},_onDrag:function(a){if(this._map.options.inertia){var b=this._lastTime=+new Date,c=this._lastPos=this._draggable._absPos||this._draggable._newPos;this._positions.push(c),this._times.push(b),b-this._times[0]>50&&(this._positions.shift(),this._times.shift())}this._map.fire("move",a).fire("drag",a)},_onZoomEnd:function(){var a=this._map.getSize().divideBy(2),b=this._map.latLngToLayerPoint([0,0]);this._initialWorldOffset=b.subtract(a).x,this._worldWidth=this._map.getPixelWorldBounds().getSize().x},_viscousLimit:function(a,b){return a-(a-b)*this._viscosity},_onPreDragLimit:function(){if(this._viscosity&&this._offsetLimit){var a=this._draggable._newPos.subtract(this._draggable._startPos),b=this._offsetLimit;a.x<b.min.x&&(a.x=this._viscousLimit(a.x,b.min.x)),a.y<b.min.y&&(a.y=this._viscousLimit(a.y,b.min.y)),a.x>b.max.x&&(a.x=this._viscousLimit(a.x,b.max.x)),a.y>b.max.y&&(a.y=this._viscousLimit(a.y,b.max.y)),this._draggable._newPos=this._draggable._startPos.add(a)}},_onPreDragWrap:function(){var a=this._worldWidth,b=Math.round(a/2),c=this._initialWorldOffset,d=this._draggable._newPos.x,e=(d-b+c)%a+b-c,f=(d+b+c)%a-b-c,g=Math.abs(e+c)<Math.abs(f+c)?e:f;this._draggable._absPos=this._draggable._newPos.clone(),this._draggable._newPos.x=g},_onDragEnd:function(a){var b=this._map,c=b.options,e=!c.inertia||this._times.length<2;if(b.fire("dragend",a),e)b.fire("moveend");else{var f=this._lastPos.subtract(this._positions[0]),g=(this._lastTime-this._times[0])/1e3,h=c.easeLinearity,i=f.multiplyBy(h/g),j=i.distanceTo([0,0]),k=Math.min(c.inertiaMaxSpeed,j),l=i.multiplyBy(k/j),m=k/(c.inertiaDeceleration*h),n=l.multiplyBy(-m/2).round();n.x||n.y?(n=b._limitOffset(n,b.options.maxBounds),d.Util.requestAnimFrame(function(){b.panBy(n,{duration:m,easeLinearity:h,noMoveStart:!0,animate:!0})})):b.fire("moveend")}}}),d.Map.addInitHook("addHandler","dragging",d.Map.Drag),d.Map.mergeOptions({doubleClickZoom:!0}),d.Map.DoubleClickZoom=d.Handler.extend({addHooks:function(){this._map.on("dblclick",this._onDoubleClick,this)},removeHooks:function(){this._map.off("dblclick",this._onDoubleClick,this)},_onDoubleClick:function(a){var b=this._map,c=b.getZoom(),d=b.options.zoomDelta,e=a.originalEvent.shiftKey?c-d:c+d;"center"===b.options.doubleClickZoom?b.setZoom(e):b.setZoomAround(a.containerPoint,e)}}),d.Map.addInitHook("addHandler","doubleClickZoom",d.Map.DoubleClickZoom),d.Map.mergeOptions({scrollWheelZoom:!0,wheelDebounceTime:40,wheelPxPerZoomLevel:60}),d.Map.ScrollWheelZoom=d.Handler.extend({addHooks:function(){d.DomEvent.on(this._map._container,"mousewheel",this._onWheelScroll,this),this._delta=0},removeHooks:function(){d.DomEvent.off(this._map._container,"mousewheel",this._onWheelScroll,this)},_onWheelScroll:function(a){var b=d.DomEvent.getWheelDelta(a),c=this._map.options.wheelDebounceTime;this._delta+=b,this._lastMousePos=this._map.mouseEventToContainerPoint(a),this._startTime||(this._startTime=+new Date);var e=Math.max(c-(+new Date-this._startTime),0);clearTimeout(this._timer),this._timer=setTimeout(d.bind(this._performZoom,this),e),d.DomEvent.stop(a)},_performZoom:function(){var a=this._map,b=a.getZoom(),c=this._map.options.zoomSnap||0;a._stop();var d=this._delta/(4*this._map.options.wheelPxPerZoomLevel),e=4*Math.log(2/(1+Math.exp(-Math.abs(d))))/Math.LN2,f=c?Math.ceil(e/c)*c:e,g=a._limitZoom(b+(this._delta>0?f:-f))-b;this._delta=0,this._startTime=null,g&&("center"===a.options.scrollWheelZoom?a.setZoom(b+g):a.setZoomAround(this._lastMousePos,b+g))}}),d.Map.addInitHook("addHandler","scrollWheelZoom",d.Map.ScrollWheelZoom),d.extend(d.DomEvent,{_touchstart:d.Browser.msPointer?"MSPointerDown":d.Browser.pointer?"pointerdown":"touchstart",_touchend:d.Browser.msPointer?"MSPointerUp":d.Browser.pointer?"pointerup":"touchend",addDoubleTapListener:function(a,b,c){function e(a){var b;if(d.Browser.pointer){if(!d.Browser.edge||"mouse"===a.pointerType)return;b=d.DomEvent._pointersCount}else b=a.touches.length;if(!(b>1)){var c=Date.now(),e=c-(g||c);h=a.touches?a.touches[0]:a,i=e>0&&e<=j,g=c}}function f(a){if(i&&!h.cancelBubble){if(d.Browser.pointer){if(!d.Browser.edge||"mouse"===a.pointerType)return;var c,e,f={};for(e in h)c=h[e],f[e]=c&&c.bind?c.bind(h):c;h=f}h.type="dblclick",b(h),g=null}}var g,h,i=!1,j=250,k="_leaflet_",l=this._touchstart,m=this._touchend;return a[k+l+c]=e,a[k+m+c]=f,a[k+"dblclick"+c]=b,a.addEventListener(l,e,!1),a.addEventListener(m,f,!1),a.addEventListener("dblclick",b,!1),this},removeDoubleTapListener:function(a,b){var c="_leaflet_",e=a[c+this._touchstart+b],f=a[c+this._touchend+b],g=a[c+"dblclick"+b];return a.removeEventListener(this._touchstart,e,!1),a.removeEventListener(this._touchend,f,!1),d.Browser.edge||a.removeEventListener("dblclick",g,!1),this}}),d.extend(d.DomEvent,{POINTER_DOWN:d.Browser.msPointer?"MSPointerDown":"pointerdown",POINTER_MOVE:d.Browser.msPointer?"MSPointerMove":"pointermove",POINTER_UP:d.Browser.msPointer?"MSPointerUp":"pointerup",POINTER_CANCEL:d.Browser.msPointer?"MSPointerCancel":"pointercancel",TAG_WHITE_LIST:["INPUT","SELECT","OPTION"],_pointers:{},_pointersCount:0,addPointerListener:function(a,b,c,d){return"touchstart"===b?this._addPointerStart(a,c,d):"touchmove"===b?this._addPointerMove(a,c,d):"touchend"===b&&this._addPointerEnd(a,c,d),this},removePointerListener:function(a,b,c){var d=a["_leaflet_"+b+c];return"touchstart"===b?a.removeEventListener(this.POINTER_DOWN,d,!1):"touchmove"===b?a.removeEventListener(this.POINTER_MOVE,d,!1):"touchend"===b&&(a.removeEventListener(this.POINTER_UP,d,!1),a.removeEventListener(this.POINTER_CANCEL,d,!1)),this},_addPointerStart:function(a,c,e){var f=d.bind(function(a){if("mouse"!==a.pointerType&&a.MSPOINTER_TYPE_MOUSE&&a.pointerType!==a.MSPOINTER_TYPE_MOUSE){if(!(this.TAG_WHITE_LIST.indexOf(a.target.tagName)<0))return;d.DomEvent.preventDefault(a)}this._handlePointer(a,c)},this);if(a["_leaflet_touchstart"+e]=f,a.addEventListener(this.POINTER_DOWN,f,!1),!this._pointerDocListener){var g=d.bind(this._globalPointerUp,this);b.documentElement.addEventListener(this.POINTER_DOWN,d.bind(this._globalPointerDown,this),!0),b.documentElement.addEventListener(this.POINTER_MOVE,d.bind(this._globalPointerMove,this),!0),b.documentElement.addEventListener(this.POINTER_UP,g,!0),b.documentElement.addEventListener(this.POINTER_CANCEL,g,!0),this._pointerDocListener=!0}},_globalPointerDown:function(a){this._pointers[a.pointerId]=a,this._pointersCount++},_globalPointerMove:function(a){this._pointers[a.pointerId]&&(this._pointers[a.pointerId]=a)},_globalPointerUp:function(a){delete this._pointers[a.pointerId],this._pointersCount--},_handlePointer:function(a,b){a.touches=[];for(var c in this._pointers)a.touches.push(this._pointers[c]);a.changedTouches=[a],b(a)},_addPointerMove:function(a,b,c){var e=d.bind(function(a){(a.pointerType!==a.MSPOINTER_TYPE_MOUSE&&"mouse"!==a.pointerType||0!==a.buttons)&&this._handlePointer(a,b)},this);a["_leaflet_touchmove"+c]=e,a.addEventListener(this.POINTER_MOVE,e,!1)},_addPointerEnd:function(a,b,c){var e=d.bind(function(a){this._handlePointer(a,b)},this);a["_leaflet_touchend"+c]=e,a.addEventListener(this.POINTER_UP,e,!1),a.addEventListener(this.POINTER_CANCEL,e,!1)}}),d.Map.mergeOptions({touchZoom:d.Browser.touch&&!d.Browser.android23,bounceAtZoomLimits:!0}),d.Map.TouchZoom=d.Handler.extend({addHooks:function(){d.DomUtil.addClass(this._map._container,"leaflet-touch-zoom"),d.DomEvent.on(this._map._container,"touchstart",this._onTouchStart,this)},removeHooks:function(){d.DomUtil.removeClass(this._map._container,"leaflet-touch-zoom"),d.DomEvent.off(this._map._container,"touchstart",this._onTouchStart,this)},_onTouchStart:function(a){var c=this._map
;if(a.touches&&2===a.touches.length&&!c._animatingZoom&&!this._zooming){var e=c.mouseEventToContainerPoint(a.touches[0]),f=c.mouseEventToContainerPoint(a.touches[1]);this._centerPoint=c.getSize()._divideBy(2),this._startLatLng=c.containerPointToLatLng(this._centerPoint),"center"!==c.options.touchZoom&&(this._pinchStartLatLng=c.containerPointToLatLng(e.add(f)._divideBy(2))),this._startDist=e.distanceTo(f),this._startZoom=c.getZoom(),this._moved=!1,this._zooming=!0,c._stop(),d.DomEvent.on(b,"touchmove",this._onTouchMove,this).on(b,"touchend",this._onTouchEnd,this),d.DomEvent.preventDefault(a)}},_onTouchMove:function(a){if(a.touches&&2===a.touches.length&&this._zooming){var b=this._map,c=b.mouseEventToContainerPoint(a.touches[0]),e=b.mouseEventToContainerPoint(a.touches[1]),f=c.distanceTo(e)/this._startDist;if(this._zoom=b.getScaleZoom(f,this._startZoom),!b.options.bounceAtZoomLimits&&(this._zoom<b.getMinZoom()&&f<1||this._zoom>b.getMaxZoom()&&f>1)&&(this._zoom=b._limitZoom(this._zoom)),"center"===b.options.touchZoom){if(this._center=this._startLatLng,1===f)return}else{var g=c._add(e)._divideBy(2)._subtract(this._centerPoint);if(1===f&&0===g.x&&0===g.y)return;this._center=b.unproject(b.project(this._pinchStartLatLng,this._zoom).subtract(g),this._zoom)}this._moved||(b._moveStart(!0),this._moved=!0),d.Util.cancelAnimFrame(this._animRequest);var h=d.bind(b._move,b,this._center,this._zoom,{pinch:!0,round:!1});this._animRequest=d.Util.requestAnimFrame(h,this,!0),d.DomEvent.preventDefault(a)}},_onTouchEnd:function(){return this._moved&&this._zooming?(this._zooming=!1,d.Util.cancelAnimFrame(this._animRequest),d.DomEvent.off(b,"touchmove",this._onTouchMove).off(b,"touchend",this._onTouchEnd),void(this._map.options.zoomAnimation?this._map._animateZoom(this._center,this._map._limitZoom(this._zoom),!0,this._map.options.zoomSnap):this._map._resetView(this._center,this._map._limitZoom(this._zoom)))):void(this._zooming=!1)}}),d.Map.addInitHook("addHandler","touchZoom",d.Map.TouchZoom),d.Map.mergeOptions({tap:!0,tapTolerance:15}),d.Map.Tap=d.Handler.extend({addHooks:function(){d.DomEvent.on(this._map._container,"touchstart",this._onDown,this)},removeHooks:function(){d.DomEvent.off(this._map._container,"touchstart",this._onDown,this)},_onDown:function(a){if(a.touches){if(d.DomEvent.preventDefault(a),this._fireClick=!0,a.touches.length>1)return this._fireClick=!1,void clearTimeout(this._holdTimeout);var c=a.touches[0],e=c.target;this._startPos=this._newPos=new d.Point(c.clientX,c.clientY),e.tagName&&"a"===e.tagName.toLowerCase()&&d.DomUtil.addClass(e,"leaflet-active"),this._holdTimeout=setTimeout(d.bind(function(){this._isTapValid()&&(this._fireClick=!1,this._onUp(),this._simulateEvent("contextmenu",c))},this),1e3),this._simulateEvent("mousedown",c),d.DomEvent.on(b,{touchmove:this._onMove,touchend:this._onUp},this)}},_onUp:function(a){if(clearTimeout(this._holdTimeout),d.DomEvent.off(b,{touchmove:this._onMove,touchend:this._onUp},this),this._fireClick&&a&&a.changedTouches){var c=a.changedTouches[0],e=c.target;e&&e.tagName&&"a"===e.tagName.toLowerCase()&&d.DomUtil.removeClass(e,"leaflet-active"),this._simulateEvent("mouseup",c),this._isTapValid()&&this._simulateEvent("click",c)}},_isTapValid:function(){return this._newPos.distanceTo(this._startPos)<=this._map.options.tapTolerance},_onMove:function(a){var b=a.touches[0];this._newPos=new d.Point(b.clientX,b.clientY),this._simulateEvent("mousemove",b)},_simulateEvent:function(c,d){var e=b.createEvent("MouseEvents");e._simulated=!0,d.target._simulatedClick=!0,e.initMouseEvent(c,!0,!0,a,1,d.screenX,d.screenY,d.clientX,d.clientY,!1,!1,!1,!1,0,null),d.target.dispatchEvent(e)}}),d.Browser.touch&&!d.Browser.pointer&&d.Map.addInitHook("addHandler","tap",d.Map.Tap),d.Map.mergeOptions({boxZoom:!0}),d.Map.BoxZoom=d.Handler.extend({initialize:function(a){this._map=a,this._container=a._container,this._pane=a._panes.overlayPane},addHooks:function(){d.DomEvent.on(this._container,"mousedown",this._onMouseDown,this)},removeHooks:function(){d.DomEvent.off(this._container,"mousedown",this._onMouseDown,this)},moved:function(){return this._moved},_resetState:function(){this._moved=!1},_onMouseDown:function(a){return!(!a.shiftKey||1!==a.which&&1!==a.button)&&(this._resetState(),d.DomUtil.disableTextSelection(),d.DomUtil.disableImageDrag(),this._startPoint=this._map.mouseEventToContainerPoint(a),void d.DomEvent.on(b,{contextmenu:d.DomEvent.stop,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this))},_onMouseMove:function(a){this._moved||(this._moved=!0,this._box=d.DomUtil.create("div","leaflet-zoom-box",this._container),d.DomUtil.addClass(this._container,"leaflet-crosshair"),this._map.fire("boxzoomstart")),this._point=this._map.mouseEventToContainerPoint(a);var b=new d.Bounds(this._point,this._startPoint),c=b.getSize();d.DomUtil.setPosition(this._box,b.min),this._box.style.width=c.x+"px",this._box.style.height=c.y+"px"},_finish:function(){this._moved&&(d.DomUtil.remove(this._box),d.DomUtil.removeClass(this._container,"leaflet-crosshair")),d.DomUtil.enableTextSelection(),d.DomUtil.enableImageDrag(),d.DomEvent.off(b,{contextmenu:d.DomEvent.stop,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseUp:function(a){if((1===a.which||1===a.button)&&(this._finish(),this._moved)){setTimeout(d.bind(this._resetState,this),0);var b=new d.LatLngBounds(this._map.containerPointToLatLng(this._startPoint),this._map.containerPointToLatLng(this._point));this._map.fitBounds(b).fire("boxzoomend",{boxZoomBounds:b})}},_onKeyDown:function(a){27===a.keyCode&&this._finish()}}),d.Map.addInitHook("addHandler","boxZoom",d.Map.BoxZoom),d.Map.mergeOptions({keyboard:!0,keyboardPanDelta:80}),d.Map.Keyboard=d.Handler.extend({keyCodes:{left:[37],right:[39],down:[40],up:[38],zoomIn:[187,107,61,171],zoomOut:[189,109,54,173]},initialize:function(a){this._map=a,this._setPanDelta(a.options.keyboardPanDelta),this._setZoomDelta(a.options.zoomDelta)},addHooks:function(){var a=this._map._container;a.tabIndex<=0&&(a.tabIndex="0"),d.DomEvent.on(a,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.on({focus:this._addHooks,blur:this._removeHooks},this)},removeHooks:function(){this._removeHooks(),d.DomEvent.off(this._map._container,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.off({focus:this._addHooks,blur:this._removeHooks},this)},_onMouseDown:function(){if(!this._focused){var c=b.body,d=b.documentElement,e=c.scrollTop||d.scrollTop,f=c.scrollLeft||d.scrollLeft;this._map._container.focus(),a.scrollTo(f,e)}},_onFocus:function(){this._focused=!0,this._map.fire("focus")},_onBlur:function(){this._focused=!1,this._map.fire("blur")},_setPanDelta:function(a){var b,c,d=this._panKeys={},e=this.keyCodes;for(b=0,c=e.left.length;b<c;b++)d[e.left[b]]=[-1*a,0];for(b=0,c=e.right.length;b<c;b++)d[e.right[b]]=[a,0];for(b=0,c=e.down.length;b<c;b++)d[e.down[b]]=[0,a];for(b=0,c=e.up.length;b<c;b++)d[e.up[b]]=[0,-1*a]},_setZoomDelta:function(a){var b,c,d=this._zoomKeys={},e=this.keyCodes;for(b=0,c=e.zoomIn.length;b<c;b++)d[e.zoomIn[b]]=a;for(b=0,c=e.zoomOut.length;b<c;b++)d[e.zoomOut[b]]=-a},_addHooks:function(){d.DomEvent.on(b,"keydown",this._onKeyDown,this)},_removeHooks:function(){d.DomEvent.off(b,"keydown",this._onKeyDown,this)},_onKeyDown:function(a){if(!(a.altKey||a.ctrlKey||a.metaKey)){var b,c=a.keyCode,e=this._map;if(c in this._panKeys){if(e._panAnim&&e._panAnim._inProgress)return;b=this._panKeys[c],a.shiftKey&&(b=d.point(b).multiplyBy(3)),e.panBy(b),e.options.maxBounds&&e.panInsideBounds(e.options.maxBounds)}else if(c in this._zoomKeys)e.setZoom(e.getZoom()+(a.shiftKey?3:1)*this._zoomKeys[c]);else{if(27!==c)return;e.closePopup()}d.DomEvent.stop(a)}}}),d.Map.addInitHook("addHandler","keyboard",d.Map.Keyboard),d.Handler.MarkerDrag=d.Handler.extend({initialize:function(a){this._marker=a},addHooks:function(){var a=this._marker._icon;this._draggable||(this._draggable=new d.Draggable(a,a,!0)),this._draggable.on({dragstart:this._onDragStart,drag:this._onDrag,dragend:this._onDragEnd},this).enable(),d.DomUtil.addClass(a,"leaflet-marker-draggable")},removeHooks:function(){this._draggable.off({dragstart:this._onDragStart,drag:this._onDrag,dragend:this._onDragEnd},this).disable(),this._marker._icon&&d.DomUtil.removeClass(this._marker._icon,"leaflet-marker-draggable")},moved:function(){return this._draggable&&this._draggable._moved},_onDragStart:function(){this._oldLatLng=this._marker.getLatLng(),this._marker.closePopup().fire("movestart").fire("dragstart")},_onDrag:function(a){var b=this._marker,c=b._shadow,e=d.DomUtil.getPosition(b._icon),f=b._map.layerPointToLatLng(e);c&&d.DomUtil.setPosition(c,e),b._latlng=f,a.latlng=f,a.oldLatLng=this._oldLatLng,b.fire("move",a).fire("drag",a)},_onDragEnd:function(a){delete this._oldLatLng,this._marker.fire("moveend").fire("dragend",a)}}),d.Control=d.Class.extend({options:{position:"topright"},initialize:function(a){d.setOptions(this,a)},getPosition:function(){return this.options.position},setPosition:function(a){var b=this._map;return b&&b.removeControl(this),this.options.position=a,b&&b.addControl(this),this},getContainer:function(){return this._container},addTo:function(a){this.remove(),this._map=a;var b=this._container=this.onAdd(a),c=this.getPosition(),e=a._controlCorners[c];return d.DomUtil.addClass(b,"leaflet-control"),-1!==c.indexOf("bottom")?e.insertBefore(b,e.firstChild):e.appendChild(b),this},remove:function(){return this._map?(d.DomUtil.remove(this._container),this.onRemove&&this.onRemove(this._map),this._map=null,this):this},_refocusOnMap:function(a){this._map&&a&&a.screenX>0&&a.screenY>0&&this._map.getContainer().focus()}}),d.control=function(a){return new d.Control(a)},d.Map.include({addControl:function(a){return a.addTo(this),this},removeControl:function(a){return a.remove(),this},_initControlPos:function(){function a(a,f){var g=c+a+" "+c+f;b[a+f]=d.DomUtil.create("div",g,e)}var b=this._controlCorners={},c="leaflet-",e=this._controlContainer=d.DomUtil.create("div",c+"control-container",this._container);a("top","left"),a("top","right"),a("bottom","left"),a("bottom","right")},_clearControlPos:function(){d.DomUtil.remove(this._controlContainer)}}),d.Control.Zoom=d.Control.extend({options:{position:"topleft",zoomInText:"+",zoomInTitle:"Zoom in",zoomOutText:"-",zoomOutTitle:"Zoom out"},onAdd:function(a){var b="leaflet-control-zoom",c=d.DomUtil.create("div",b+" leaflet-bar"),e=this.options;return this._zoomInButton=this._createButton(e.zoomInText,e.zoomInTitle,b+"-in",c,this._zoomIn),this._zoomOutButton=this._createButton(e.zoomOutText,e.zoomOutTitle,b+"-out",c,this._zoomOut),this._updateDisabled(),a.on("zoomend zoomlevelschange",this._updateDisabled,this),c},onRemove:function(a){a.off("zoomend zoomlevelschange",this._updateDisabled,this)},disable:function(){return this._disabled=!0,this._updateDisabled(),this},enable:function(){return this._disabled=!1,this._updateDisabled(),this},_zoomIn:function(a){!this._disabled&&this._map._zoom<this._map.getMaxZoom()&&this._map.zoomIn(this._map.options.zoomDelta*(a.shiftKey?3:1))},_zoomOut:function(a){!this._disabled&&this._map._zoom>this._map.getMinZoom()&&this._map.zoomOut(this._map.options.zoomDelta*(a.shiftKey?3:1))},_createButton:function(a,b,c,e,f){var g=d.DomUtil.create("a",c,e);return g.innerHTML=a,g.href="#",g.title=b,g.setAttribute("role","button"),g.setAttribute("aria-label",b),d.DomEvent.on(g,"mousedown dblclick",d.DomEvent.stopPropagation).on(g,"click",d.DomEvent.stop).on(g,"click",f,this).on(g,"click",this._refocusOnMap,this),g},_updateDisabled:function(){var a=this._map,b="leaflet-disabled";d.DomUtil.removeClass(this._zoomInButton,b),d.DomUtil.removeClass(this._zoomOutButton,b),(this._disabled||a._zoom===a.getMinZoom())&&d.DomUtil.addClass(this._zoomOutButton,b),(this._disabled||a._zoom===a.getMaxZoom())&&d.DomUtil.addClass(this._zoomInButton,b)}}),d.Map.mergeOptions({zoomControl:!0}),d.Map.addInitHook(function(){this.options.zoomControl&&(this.zoomControl=new d.Control.Zoom,this.addControl(this.zoomControl))}),d.control.zoom=function(a){return new d.Control.Zoom(a)},d.Control.Attribution=d.Control.extend({options:{position:"bottomright",prefix:'<a href="http://leafletjs.com" title="A JS library for interactive maps">Leaflet</a>'},initialize:function(a){d.setOptions(this,a),this._attributions={}},onAdd:function(a){a.attributionControl=this,this._container=d.DomUtil.create("div","leaflet-control-attribution"),d.DomEvent&&d.DomEvent.disableClickPropagation(this._container);for(var b in a._layers)a._layers[b].getAttribution&&this.addAttribution(a._layers[b].getAttribution());return this._update(),this._container},setPrefix:function(a){return this.options.prefix=a,this._update(),this},addAttribution:function(a){return a?(this._attributions[a]||(this._attributions[a]=0),this._attributions[a]++,this._update(),this):this},removeAttribution:function(a){return a?(this._attributions[a]&&(this._attributions[a]--,this._update()),this):this},_update:function(){if(this._map){var a=[];for(var b in this._attributions)this._attributions[b]&&a.push(b);var c=[];this.options.prefix&&c.push(this.options.prefix),a.length&&c.push(a.join(", ")),this._container.innerHTML=c.join(" | ")}}}),d.Map.mergeOptions({attributionControl:!0}),d.Map.addInitHook(function(){this.options.attributionControl&&(new d.Control.Attribution).addTo(this)}),d.control.attribution=function(a){return new d.Control.Attribution(a)},d.Control.Scale=d.Control.extend({options:{position:"bottomleft",maxWidth:100,metric:!0,imperial:!0},onAdd:function(a){var b="leaflet-control-scale",c=d.DomUtil.create("div",b),e=this.options;return this._addScales(e,b+"-line",c),a.on(e.updateWhenIdle?"moveend":"move",this._update,this),a.whenReady(this._update,this),c},onRemove:function(a){a.off(this.options.updateWhenIdle?"moveend":"move",this._update,this)},_addScales:function(a,b,c){a.metric&&(this._mScale=d.DomUtil.create("div",b,c)),a.imperial&&(this._iScale=d.DomUtil.create("div",b,c))},_update:function(){var a=this._map,b=a.getSize().y/2,c=a.distance(a.containerPointToLatLng([0,b]),a.containerPointToLatLng([this.options.maxWidth,b]));this._updateScales(c)},_updateScales:function(a){this.options.metric&&a&&this._updateMetric(a),this.options.imperial&&a&&this._updateImperial(a)},_updateMetric:function(a){var b=this._getRoundNum(a),c=b<1e3?b+" m":b/1e3+" km";this._updateScale(this._mScale,c,b/a)},_updateImperial:function(a){var b,c,d,e=3.2808399*a;e>5280?(b=e/5280,c=this._getRoundNum(b),this._updateScale(this._iScale,c+" mi",c/b)):(d=this._getRoundNum(e),this._updateScale(this._iScale,d+" ft",d/e))},_updateScale:function(a,b,c){a.style.width=Math.round(this.options.maxWidth*c)+"px",a.innerHTML=b},_getRoundNum:function(a){var b=Math.pow(10,(Math.floor(a)+"").length-1),c=a/b;return c=c>=10?10:c>=5?5:c>=3?3:c>=2?2:1,b*c}}),d.control.scale=function(a){return new d.Control.Scale(a)},d.Control.Layers=d.Control.extend({options:{collapsed:!0,position:"topright",autoZIndex:!0,hideSingleBase:!1,sortLayers:!1,sortFunction:function(a,b,c,d){return c<d?-1:d<c?1:0}},initialize:function(a,b,c){d.setOptions(this,c),this._layers=[],this._lastZIndex=0,this._handlingClick=!1;for(var e in a)this._addLayer(a[e],e);for(e in b)this._addLayer(b[e],e,!0)},onAdd:function(a){return this._initLayout(),this._update(),this._map=a,a.on("zoomend",this._checkDisabledLayers,this),this._container},onRemove:function(){this._map.off("zoomend",this._checkDisabledLayers,this);for(var a=0;a<this._layers.length;a++)this._layers[a].layer.off("add remove",this._onLayerChange,this)},addBaseLayer:function(a,b){return this._addLayer(a,b),this._map?this._update():this},addOverlay:function(a,b){return this._addLayer(a,b,!0),this._map?this._update():this},removeLayer:function(a){a.off("add remove",this._onLayerChange,this);var b=this._getLayer(d.stamp(a));return b&&this._layers.splice(this._layers.indexOf(b),1),this._map?this._update():this},expand:function(){d.DomUtil.addClass(this._container,"leaflet-control-layers-expanded"),this._form.style.height=null;var a=this._map.getSize().y-(this._container.offsetTop+50);return a<this._form.clientHeight?(d.DomUtil.addClass(this._form,"leaflet-control-layers-scrollbar"),this._form.style.height=a+"px"):d.DomUtil.removeClass(this._form,"leaflet-control-layers-scrollbar"),this._checkDisabledLayers(),this},collapse:function(){return d.DomUtil.removeClass(this._container,"leaflet-control-layers-expanded"),this},_initLayout:function(){var a="leaflet-control-layers",b=this._container=d.DomUtil.create("div",a),c=this.options.collapsed;b.setAttribute("aria-haspopup",!0),d.DomEvent.disableClickPropagation(b),d.Browser.touch||d.DomEvent.disableScrollPropagation(b);var e=this._form=d.DomUtil.create("form",a+"-list");c&&(this._map.on("click",this.collapse,this),d.Browser.android||d.DomEvent.on(b,{mouseenter:this.expand,mouseleave:this.collapse},this));var f=this._layersLink=d.DomUtil.create("a",a+"-toggle",b);f.href="#",f.title="Layers",d.Browser.touch?d.DomEvent.on(f,"click",d.DomEvent.stop).on(f,"click",this.expand,this):d.DomEvent.on(f,"focus",this.expand,this),d.DomEvent.on(e,"click",function(){setTimeout(d.bind(this._onInputClick,this),0)},this),c||this.expand(),this._baseLayersList=d.DomUtil.create("div",a+"-base",e),this._separator=d.DomUtil.create("div",a+"-separator",e),this._overlaysList=d.DomUtil.create("div",a+"-overlays",e),b.appendChild(e)},_getLayer:function(a){for(var b=0;b<this._layers.length;b++)if(this._layers[b]&&d.stamp(this._layers[b].layer)===a)return this._layers[b]},_addLayer:function(a,b,c){a.on("add remove",this._onLayerChange,this),this._layers.push({layer:a,name:b,overlay:c}),this.options.sortLayers&&this._layers.sort(d.bind(function(a,b){return this.options.sortFunction(a.layer,b.layer,a.name,b.name)},this)),this.options.autoZIndex&&a.setZIndex&&(this._lastZIndex++,a.setZIndex(this._lastZIndex))},_update:function(){if(!this._container)return this;d.DomUtil.empty(this._baseLayersList),d.DomUtil.empty(this._overlaysList);var a,b,c,e,f=0;for(c=0;c<this._layers.length;c++)e=this._layers[c],this._addItem(e),b=b||e.overlay,a=a||!e.overlay,f+=e.overlay?0:1;return this.options.hideSingleBase&&(a=a&&f>1,this._baseLayersList.style.display=a?"":"none"),this._separator.style.display=b&&a?"":"none",this},_onLayerChange:function(a){this._handlingClick||this._update();var b=this._getLayer(d.stamp(a.target)),c=b.overlay?"add"===a.type?"overlayadd":"overlayremove":"add"===a.type?"baselayerchange":null;c&&this._map.fire(c,b)},_createRadioElement:function(a,c){var d='<input type="radio" class="leaflet-control-layers-selector" name="'+a+'"'+(c?' checked="checked"':"")+"/>",e=b.createElement("div");return e.innerHTML=d,e.firstChild},_addItem:function(a){var c,e=b.createElement("label"),f=this._map.hasLayer(a.layer);a.overlay?(c=b.createElement("input"),c.type="checkbox",c.className="leaflet-control-layers-selector",c.defaultChecked=f):c=this._createRadioElement("leaflet-base-layers",f),c.layerId=d.stamp(a.layer),d.DomEvent.on(c,"click",this._onInputClick,this);var g=b.createElement("span");g.innerHTML=" "+a.name;var h=b.createElement("div");return e.appendChild(h),h.appendChild(c),h.appendChild(g),(a.overlay?this._overlaysList:this._baseLayersList).appendChild(e),this._checkDisabledLayers(),e},_onInputClick:function(){var a,b,c,d=this._form.getElementsByTagName("input"),e=[],f=[];this._handlingClick=!0;for(var g=d.length-1;g>=0;g--)a=d[g],b=this._getLayer(a.layerId).layer,c=this._map.hasLayer(b),a.checked&&!c?e.push(b):!a.checked&&c&&f.push(b);for(g=0;g<f.length;g++)this._map.removeLayer(f[g]);for(g=0;g<e.length;g++)this._map.addLayer(e[g]);this._handlingClick=!1,this._refocusOnMap()},_checkDisabledLayers:function(){for(var a,b,d=this._form.getElementsByTagName("input"),e=this._map.getZoom(),f=d.length-1;f>=0;f--)a=d[f],b=this._getLayer(a.layerId).layer,a.disabled=b.options.minZoom!==c&&e<b.options.minZoom||b.options.maxZoom!==c&&e>b.options.maxZoom},_expand:function(){return this.expand()},_collapse:function(){return this.collapse()}}),d.control.layers=function(a,b,c){return new d.Control.Layers(a,b,c)}}(window,document),function a(b,c,d){function e(g,h){if(!c[g]){if(!b[g]){var i="function"==typeof require&&require;if(!h&&i)return i(g,!0);if(f)return f(g,!0);var j=new Error("Cannot find module '"+g+"'");throw j.code="MODULE_NOT_FOUND",j}var k=c[g]={exports:{}};b[g][0].call(k.exports,function(a){var c=b[g][1][a];return e(c||a)},k,k.exports,a,b,c,d)}return c[g].exports}for(var f="function"==typeof require&&require,g=0;g<d.length;g++)e(d[g]);return e}({1:[function(a,b,c){function d(a,b,c){function d(a){return a>=200&&a<300||304===a}function e(){void 0===h.status||d(h.status)?b.call(h,null,h):b.call(h,h,null)}var f=!1;if(void 0===window.XMLHttpRequest)return b(Error("Browser not supported"));if(void 0===c){var g=a.match(/^\s*https?:\/\/[^\/]*/);c=g&&g[0]!==location.protocol+"//"+location.domain+(location.port?":"+location.port:"")}var h=new window.XMLHttpRequest;if(c&&!("withCredentials"in h)){h=new window.XDomainRequest;var i=b;b=function(){if(f)i.apply(this,arguments);else{var a=this,b=arguments;setTimeout(function(){i.apply(a,b)},0)}}}return"onload"in h?h.onload=e:h.onreadystatechange=function(){4===h.readyState&&e()},h.onerror=function(a){b.call(this,a||!0,null),b=function(){}},h.onprogress=function(){},h.ontimeout=function(a){b.call(this,a,null),b=function(){}},h.onabort=function(a){b.call(this,a,null),b=function(){}},h.open("GET",a,!0),h.send(null),f=!0,h}void 0!==b&&(b.exports=d)},{}],2:[function(a,b,c){b.exports=Array.isArray||function(a){return"[object Array]"==Object.prototype.toString.call(a)}},{}],3:[function(a,b,c){!function(a,b){"object"==typeof c&&c&&"string"!=typeof c.nodeName?b(c):"function"==typeof define&&define.amd?define(["exports"],b):(a.Mustache={},b(a.Mustache))}(this,function(a){function b(a){return"function"==typeof a}function c(a){return p(a)?"array":typeof a}function d(a){return a.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&")}function e(a,b){return null!=a&&"object"==typeof a&&b in a}function f(a,b){return q.call(a,b)}function g(a){return!f(r,a)}function h(a){return String(a).replace(/[&<>"'`=\/]/g,function(a){return s[a]})}function i(b,c){function e(a){if("string"==typeof a&&(a=a.split(u,2)),!p(a)||2!==a.length)throw new Error("Invalid tags: "+a);f=new RegExp(d(a[0])+"\\s*"),h=new RegExp("\\s*"+d(a[1])),i=new RegExp("\\s*"+d("}"+a[1]))}if(!b)return[];var f,h,i,m=[],n=[],o=[],q=!1,r=!1;e(c||a.tags);for(var s,y,z,A,B,C,D=new l(b);!D.eos();){if(s=D.pos,z=D.scanUntil(f))for(var E=0,F=z.length;E<F;++E)A=z.charAt(E),g(A)?o.push(n.length):r=!0,n.push(["text",A,s,s+1]),s+=1,"\n"===A&&function(){if(q&&!r)for(;o.length;)delete n[o.pop()];else o=[];q=!1,r=!1}();if(!D.scan(f))break;if(q=!0,y=D.scan(x)||"name",D.scan(t),"="===y?(z=D.scanUntil(v),D.scan(v),D.scanUntil(h)):"{"===y?(z=D.scanUntil(i),D.scan(w),D.scanUntil(h),y="&"):z=D.scanUntil(h),!D.scan(h))throw new Error("Unclosed tag at "+D.pos);if(B=[y,z,s,D.pos],n.push(B),"#"===y||"^"===y)m.push(B);else if("/"===y){if(!(C=m.pop()))throw new Error('Unopened section "'+z+'" at '+s);if(C[1]!==z)throw new Error('Unclosed section "'+C[1]+'" at '+s)}else"name"===y||"{"===y||"&"===y?r=!0:"="===y&&e(z)}if(C=m.pop())throw new Error('Unclosed section "'+C[1]+'" at '+D.pos);return k(j(n))}function j(a){for(var b,c,d=[],e=0,f=a.length;e<f;++e)(b=a[e])&&("text"===b[0]&&c&&"text"===c[0]?(c[1]+=b[1],c[3]=b[3]):(d.push(b),c=b));return d}function k(a){for(var b,c,d=[],e=d,f=[],g=0,h=a.length;g<h;++g)switch(b=a[g],b[0]){case"#":case"^":e.push(b),f.push(b),e=b[4]=[];break;case"/":c=f.pop(),c[5]=b[2],e=f.length>0?f[f.length-1][4]:d;break;default:e.push(b)}return d}function l(a){this.string=a,this.tail=a,this.pos=0}function m(a,b){this.view=a,this.cache={".":this.view},this.parent=b}function n(){this.cache={}}var o=Object.prototype.toString,p=Array.isArray||function(a){return"[object Array]"===o.call(a)},q=RegExp.prototype.test,r=/\S/,s={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;","`":"&#x60;","=":"&#x3D;"},t=/\s*/,u=/\s+/,v=/\s*=/,w=/\s*\}/,x=/#|\^|\/|>|\{|&|=|!/;l.prototype.eos=function(){return""===this.tail},l.prototype.scan=function(a){var b=this.tail.match(a);if(!b||0!==b.index)return"";var c=b[0];return this.tail=this.tail.substring(c.length),this.pos+=c.length,c},l.prototype.scanUntil=function(a){var b,c=this.tail.search(a);switch(c){case-1:b=this.tail,this.tail="";break;case 0:b="";break;default:b=this.tail.substring(0,c),this.tail=this.tail.substring(c)}return this.pos+=b.length,b},m.prototype.push=function(a){return new m(a,this)},m.prototype.lookup=function(a){var c,d=this.cache;if(d.hasOwnProperty(a))c=d[a];else{for(var f,g,h=this,i=!1;h;){if(a.indexOf(".")>0)for(c=h.view,f=a.split("."),g=0;null!=c&&g<f.length;)g===f.length-1&&(i=e(c,f[g])),c=c[f[g++]];else c=h.view[a],i=e(h.view,a);if(i)break;h=h.parent}d[a]=c}return b(c)&&(c=c.call(this.view)),c},n.prototype.clearCache=function(){this.cache={}},n.prototype.parse=function(a,b){var c=this.cache,d=c[a];return null==d&&(d=c[a]=i(a,b)),d},n.prototype.render=function(a,b,c){var d=this.parse(a),e=b instanceof m?b:new m(b);return this.renderTokens(d,e,c,a)},n.prototype.renderTokens=function(a,b,c,d){for(var e,f,g,h="",i=0,j=a.length;i<j;++i)g=void 0,e=a[i],f=e[0],"#"===f?g=this.renderSection(e,b,c,d):"^"===f?g=this.renderInverted(e,b,c,d):">"===f?g=this.renderPartial(e,b,c,d):"&"===f?g=this.unescapedValue(e,b):"name"===f?g=this.escapedValue(e,b):"text"===f&&(g=this.rawValue(e)),void 0!==g&&(h+=g);return h},n.prototype.renderSection=function(a,c,d,e){function f(a){return g.render(a,c,d)}var g=this,h="",i=c.lookup(a[1]);if(i){if(p(i))for(var j=0,k=i.length;j<k;++j)h+=this.renderTokens(a[4],c.push(i[j]),d,e);else if("object"==typeof i||"string"==typeof i||"number"==typeof i)h+=this.renderTokens(a[4],c.push(i),d,e);else if(b(i)){if("string"!=typeof e)throw new Error("Cannot use higher-order sections without the original template");null!=(i=i.call(c.view,e.slice(a[3],a[5]),f))&&(h+=i)}else h+=this.renderTokens(a[4],c,d,e);return h}},n.prototype.renderInverted=function(a,b,c,d){var e=b.lookup(a[1]);if(!e||p(e)&&0===e.length)return this.renderTokens(a[4],b,c,d)},n.prototype.renderPartial=function(a,c,d){if(d){var e=b(d)?d(a[1]):d[a[1]];return null!=e?this.renderTokens(this.parse(e),c,d,e):void 0}},n.prototype.unescapedValue=function(a,b){var c=b.lookup(a[1]);if(null!=c)return c},n.prototype.escapedValue=function(b,c){var d=c.lookup(b[1]);if(null!=d)return a.escape(d)},n.prototype.rawValue=function(a){return a[1]},a.name="mustache.js",a.version="2.2.1",a.tags=["{{","}}"];var y=new n;a.clearCache=function(){return y.clearCache()},a.parse=function(a,b){return y.parse(a,b)},a.render=function(a,b,d){if("string"!=typeof a)throw new TypeError('Invalid template! Template should be a "string" but "'+c(a)+'" was given as the first argument for mustache#render(template, view, partials)');return y.render(a,b,d)},a.to_html=function(c,d,e,f){var g=a.render(c,d,e);if(!b(f))return g;f(g)},a.escape=h,a.Scanner=l,a.Context=m,a.Writer=n})},{}],4:[function(a,b,c){function d(a){"use strict";return/^https?/.test(a.getScheme())?a.toString():/^mailto?/.test(a.getScheme())?a.toString():"data"==a.getScheme()&&/^image/.test(a.getPath())?a.toString():void 0}function e(a){return a}var f=a("./sanitizer-bundle.js");b.exports=function(a){return a?f(a,d,e):""}},{"./sanitizer-bundle.js":5}],5:[function(a,b,c){var d=function(){function a(a){var b=(""+a).match(n);return b?new i(j(b[1]),j(b[2]),j(b[3]),j(b[4]),j(b[5]),j(b[6]),j(b[7])):null}function b(a,b,f,g,h,j,k){var l=new i(d(a,o),d(b,o),c(f),g>0?g.toString():null,d(h,p),null,c(k));return j&&("string"==typeof j?l.setRawQuery(j.replace(/[^?&=0-9A-Za-z_\-~.%]/g,e)):l.setAllParameters(j)),l}function c(a){return"string"==typeof a?encodeURIComponent(a):null}function d(a,b){return"string"==typeof a?encodeURI(a).replace(b,e):null}function e(a){var b=a.charCodeAt(0);return"%"+"0123456789ABCDEF".charAt(b>>4&15)+"0123456789ABCDEF".charAt(15&b)}function f(a){return a.replace(/(^|\/)\.(?:\/|$)/g,"$1").replace(/\/{2,}/g,"/")}function g(a){if(null===a)return null;for(var b,c=f(a),d=l;(b=c.replace(d,"$1"))!=c;c=b);return c}function h(a,b){var c=a.clone(),d=b.hasScheme();d?c.setRawScheme(b.getRawScheme()):d=b.hasCredentials(),d?c.setRawCredentials(b.getRawCredentials()):d=b.hasDomain(),d?c.setRawDomain(b.getRawDomain()):d=b.hasPort();var e=b.getRawPath(),f=g(e);if(d)c.setPort(b.getPort()),f=f&&f.replace(m,"");else if(d=!!e){if(47!==f.charCodeAt(0)){var h=g(c.getRawPath()||"").replace(m,""),i=h.lastIndexOf("/")+1;f=g((i?h.substring(0,i):"")+g(e)).replace(m,"")}}else(f=f&&f.replace(m,""))!==e&&c.setRawPath(f);return d?c.setRawPath(f):d=b.hasQuery(),d?c.setRawQuery(b.getRawQuery()):d=b.hasFragment(),d&&c.setRawFragment(b.getRawFragment()),c}function i(a,b,c,d,e,f,g){this.scheme_=a,this.credentials_=b,this.domain_=c,this.port_=d,this.path_=e,this.query_=f,this.fragment_=g,this.paramCache_=null}function j(a){return"string"==typeof a&&a.length>0?a:null}var k=new RegExp("(/|^)(?:[^./][^/]*|\\.{2,}(?:[^./][^/]*)|\\.{3,}[^/]*)/\\.\\.(?:/|$)"),l=new RegExp(k),m=/^(?:\.\.\/)*(?:\.\.$)?/;i.prototype.toString=function(){var a=[];return null!==this.scheme_&&a.push(this.scheme_,":"),null!==this.domain_&&(a.push("//"),null!==this.credentials_&&a.push(this.credentials_,"@"),a.push(this.domain_),null!==this.port_&&a.push(":",this.port_.toString())),null!==this.path_&&a.push(this.path_),null!==this.query_&&a.push("?",this.query_),null!==this.fragment_&&a.push("#",this.fragment_),a.join("")},i.prototype.clone=function(){return new i(this.scheme_,this.credentials_,this.domain_,this.port_,this.path_,this.query_,this.fragment_)},i.prototype.getScheme=function(){return this.scheme_&&decodeURIComponent(this.scheme_).toLowerCase()},i.prototype.getRawScheme=function(){return this.scheme_},i.prototype.setScheme=function(a){return this.scheme_=d(a,o),this},i.prototype.setRawScheme=function(a){return this.scheme_=a||null,this},i.prototype.hasScheme=function(){return null!==this.scheme_},i.prototype.getCredentials=function(){return this.credentials_&&decodeURIComponent(this.credentials_)},i.prototype.getRawCredentials=function(){return this.credentials_},i.prototype.setCredentials=function(a){return this.credentials_=d(a,o),this},i.prototype.setRawCredentials=function(a){return this.credentials_=a||null,this},i.prototype.hasCredentials=function(){return null!==this.credentials_},i.prototype.getDomain=function(){return this.domain_&&decodeURIComponent(this.domain_)},i.prototype.getRawDomain=function(){return this.domain_},i.prototype.setDomain=function(a){return this.setRawDomain(a&&encodeURIComponent(a))},i.prototype.setRawDomain=function(a){return this.domain_=a||null,this.setRawPath(this.path_)},i.prototype.hasDomain=function(){return null!==this.domain_},i.prototype.getPort=function(){return this.port_&&decodeURIComponent(this.port_)},i.prototype.setPort=function(a){if(a){if((a=Number(a))!==(65535&a))throw new Error("Bad port number "+a);this.port_=""+a}else this.port_=null;return this},i.prototype.hasPort=function(){return null!==this.port_},i.prototype.getPath=function(){return this.path_&&decodeURIComponent(this.path_)},i.prototype.getRawPath=function(){return this.path_},i.prototype.setPath=function(a){return this.setRawPath(d(a,p))},i.prototype.setRawPath=function(a){return a?(a=String(a),this.path_=!this.domain_||/^\//.test(a)?a:"/"+a):this.path_=null,this},i.prototype.hasPath=function(){return null!==this.path_},i.prototype.getQuery=function(){return this.query_&&decodeURIComponent(this.query_).replace(/\+/g," ")},i.prototype.getRawQuery=function(){return this.query_},i.prototype.setQuery=function(a){return this.paramCache_=null,this.query_=c(a),this},i.prototype.setRawQuery=function(a){return this.paramCache_=null,this.query_=a||null,this},i.prototype.hasQuery=function(){
return null!==this.query_},i.prototype.setAllParameters=function(a){if("object"==typeof a&&!(a instanceof Array)&&(a instanceof Object||"[object Array]"!==Object.prototype.toString.call(a))){var b=[],c=-1;for(var d in a){var e=a[d];"string"==typeof e&&(b[++c]=d,b[++c]=e)}a=b}this.paramCache_=null;for(var f=[],g="",h=0;h<a.length;){var d=a[h++],e=a[h++];f.push(g,encodeURIComponent(d.toString())),g="&",e&&f.push("=",encodeURIComponent(e.toString()))}return this.query_=f.join(""),this},i.prototype.checkParameterCache_=function(){if(!this.paramCache_){var a=this.query_;if(a){for(var b=a.split(/[&\?]/),c=[],d=-1,e=0;e<b.length;++e){var f=b[e].match(/^([^=]*)(?:=(.*))?$/);c[++d]=decodeURIComponent(f[1]).replace(/\+/g," "),c[++d]=decodeURIComponent(f[2]||"").replace(/\+/g," ")}this.paramCache_=c}else this.paramCache_=[]}},i.prototype.setParameterValues=function(a,b){"string"==typeof b&&(b=[b]),this.checkParameterCache_();for(var c=0,d=this.paramCache_,e=[],f=0;f<d.length;f+=2)a===d[f]?c<b.length&&e.push(a,b[c++]):e.push(d[f],d[f+1]);for(;c<b.length;)e.push(a,b[c++]);return this.setAllParameters(e),this},i.prototype.removeParameter=function(a){return this.setParameterValues(a,[])},i.prototype.getAllParameters=function(){return this.checkParameterCache_(),this.paramCache_.slice(0,this.paramCache_.length)},i.prototype.getParameterValues=function(a){this.checkParameterCache_();for(var b=[],c=0;c<this.paramCache_.length;c+=2)a===this.paramCache_[c]&&b.push(this.paramCache_[c+1]);return b},i.prototype.getParameterMap=function(a){this.checkParameterCache_();for(var b={},c=0;c<this.paramCache_.length;c+=2){var d=this.paramCache_[c++],e=this.paramCache_[c++];d in b?b[d].push(e):b[d]=[e]}return b},i.prototype.getParameterValue=function(a){this.checkParameterCache_();for(var b=0;b<this.paramCache_.length;b+=2)if(a===this.paramCache_[b])return this.paramCache_[b+1];return null},i.prototype.getFragment=function(){return this.fragment_&&decodeURIComponent(this.fragment_)},i.prototype.getRawFragment=function(){return this.fragment_},i.prototype.setFragment=function(a){return this.fragment_=a?encodeURIComponent(a):null,this},i.prototype.setRawFragment=function(a){return this.fragment_=a||null,this},i.prototype.hasFragment=function(){return null!==this.fragment_};var n=new RegExp("^(?:([^:/?#]+):)?(?://(?:([^/?#]*)@)?([^/?#:@]*)(?::([0-9]+))?)?([^?#]+)?(?:\\?([^#]*))?(?:#(.*))?$"),o=/[#\/\?@]/g,p=/[\#\?]/g;return i.parse=a,i.create=b,i.resolve=h,i.collapse_dots=g,i.utils={mimeTypeOf:function(b){return/\.html$/.test(a(b).getPath())?"text/html":"application/javascript"},resolve:function(b,c){return b?h(a(b),a(c)).toString():""+c}},i}(),e={};if(e.atype={NONE:0,URI:1,URI_FRAGMENT:11,SCRIPT:2,STYLE:3,HTML:12,ID:4,IDREF:5,IDREFS:6,GLOBAL_NAME:7,LOCAL_NAME:8,CLASSES:9,FRAME_TARGET:10,MEDIA_QUERY:13},e.atype=e.atype,e.ATTRIBS={"*::class":9,"*::dir":0,"*::draggable":0,"*::hidden":0,"*::id":4,"*::inert":0,"*::itemprop":0,"*::itemref":6,"*::itemscope":0,"*::lang":0,"*::onblur":2,"*::onchange":2,"*::onclick":2,"*::ondblclick":2,"*::onfocus":2,"*::onkeydown":2,"*::onkeypress":2,"*::onkeyup":2,"*::onload":2,"*::onmousedown":2,"*::onmousemove":2,"*::onmouseout":2,"*::onmouseover":2,"*::onmouseup":2,"*::onreset":2,"*::onscroll":2,"*::onselect":2,"*::onsubmit":2,"*::onunload":2,"*::spellcheck":0,"*::style":3,"*::title":0,"*::translate":0,"a::accesskey":0,"a::coords":0,"a::href":1,"a::hreflang":0,"a::name":7,"a::onblur":2,"a::onfocus":2,"a::shape":0,"a::tabindex":0,"a::target":10,"a::type":0,"area::accesskey":0,"area::alt":0,"area::coords":0,"area::href":1,"area::nohref":0,"area::onblur":2,"area::onfocus":2,"area::shape":0,"area::tabindex":0,"area::target":10,"audio::controls":0,"audio::loop":0,"audio::mediagroup":5,"audio::muted":0,"audio::preload":0,"bdo::dir":0,"blockquote::cite":1,"br::clear":0,"button::accesskey":0,"button::disabled":0,"button::name":8,"button::onblur":2,"button::onfocus":2,"button::tabindex":0,"button::type":0,"button::value":0,"canvas::height":0,"canvas::width":0,"caption::align":0,"col::align":0,"col::char":0,"col::charoff":0,"col::span":0,"col::valign":0,"col::width":0,"colgroup::align":0,"colgroup::char":0,"colgroup::charoff":0,"colgroup::span":0,"colgroup::valign":0,"colgroup::width":0,"command::checked":0,"command::command":5,"command::disabled":0,"command::icon":1,"command::label":0,"command::radiogroup":0,"command::type":0,"data::value":0,"del::cite":1,"del::datetime":0,"details::open":0,"dir::compact":0,"div::align":0,"dl::compact":0,"fieldset::disabled":0,"font::color":0,"font::face":0,"font::size":0,"form::accept":0,"form::action":1,"form::autocomplete":0,"form::enctype":0,"form::method":0,"form::name":7,"form::novalidate":0,"form::onreset":2,"form::onsubmit":2,"form::target":10,"h1::align":0,"h2::align":0,"h3::align":0,"h4::align":0,"h5::align":0,"h6::align":0,"hr::align":0,"hr::noshade":0,"hr::size":0,"hr::width":0,"iframe::align":0,"iframe::frameborder":0,"iframe::height":0,"iframe::marginheight":0,"iframe::marginwidth":0,"iframe::width":0,"img::align":0,"img::alt":0,"img::border":0,"img::height":0,"img::hspace":0,"img::ismap":0,"img::name":7,"img::src":1,"img::usemap":11,"img::vspace":0,"img::width":0,"input::accept":0,"input::accesskey":0,"input::align":0,"input::alt":0,"input::autocomplete":0,"input::checked":0,"input::disabled":0,"input::inputmode":0,"input::ismap":0,"input::list":5,"input::max":0,"input::maxlength":0,"input::min":0,"input::multiple":0,"input::name":8,"input::onblur":2,"input::onchange":2,"input::onfocus":2,"input::onselect":2,"input::placeholder":0,"input::readonly":0,"input::required":0,"input::size":0,"input::src":1,"input::step":0,"input::tabindex":0,"input::type":0,"input::usemap":11,"input::value":0,"ins::cite":1,"ins::datetime":0,"label::accesskey":0,"label::for":5,"label::onblur":2,"label::onfocus":2,"legend::accesskey":0,"legend::align":0,"li::type":0,"li::value":0,"map::name":7,"menu::compact":0,"menu::label":0,"menu::type":0,"meter::high":0,"meter::low":0,"meter::max":0,"meter::min":0,"meter::value":0,"ol::compact":0,"ol::reversed":0,"ol::start":0,"ol::type":0,"optgroup::disabled":0,"optgroup::label":0,"option::disabled":0,"option::label":0,"option::selected":0,"option::value":0,"output::for":6,"output::name":8,"p::align":0,"pre::width":0,"progress::max":0,"progress::min":0,"progress::value":0,"q::cite":1,"select::autocomplete":0,"select::disabled":0,"select::multiple":0,"select::name":8,"select::onblur":2,"select::onchange":2,"select::onfocus":2,"select::required":0,"select::size":0,"select::tabindex":0,"source::type":0,"table::align":0,"table::bgcolor":0,"table::border":0,"table::cellpadding":0,"table::cellspacing":0,"table::frame":0,"table::rules":0,"table::summary":0,"table::width":0,"tbody::align":0,"tbody::char":0,"tbody::charoff":0,"tbody::valign":0,"td::abbr":0,"td::align":0,"td::axis":0,"td::bgcolor":0,"td::char":0,"td::charoff":0,"td::colspan":0,"td::headers":6,"td::height":0,"td::nowrap":0,"td::rowspan":0,"td::scope":0,"td::valign":0,"td::width":0,"textarea::accesskey":0,"textarea::autocomplete":0,"textarea::cols":0,"textarea::disabled":0,"textarea::inputmode":0,"textarea::name":8,"textarea::onblur":2,"textarea::onchange":2,"textarea::onfocus":2,"textarea::onselect":2,"textarea::placeholder":0,"textarea::readonly":0,"textarea::required":0,"textarea::rows":0,"textarea::tabindex":0,"textarea::wrap":0,"tfoot::align":0,"tfoot::char":0,"tfoot::charoff":0,"tfoot::valign":0,"th::abbr":0,"th::align":0,"th::axis":0,"th::bgcolor":0,"th::char":0,"th::charoff":0,"th::colspan":0,"th::headers":6,"th::height":0,"th::nowrap":0,"th::rowspan":0,"th::scope":0,"th::valign":0,"th::width":0,"thead::align":0,"thead::char":0,"thead::charoff":0,"thead::valign":0,"tr::align":0,"tr::bgcolor":0,"tr::char":0,"tr::charoff":0,"tr::valign":0,"track::default":0,"track::kind":0,"track::label":0,"track::srclang":0,"ul::compact":0,"ul::type":0,"video::controls":0,"video::height":0,"video::loop":0,"video::mediagroup":5,"video::muted":0,"video::poster":1,"video::preload":0,"video::width":0},e.ATTRIBS=e.ATTRIBS,e.eflags={OPTIONAL_ENDTAG:1,EMPTY:2,CDATA:4,RCDATA:8,UNSAFE:16,FOLDABLE:32,SCRIPT:64,STYLE:128,VIRTUALIZED:256},e.eflags=e.eflags,e.ELEMENTS={a:0,abbr:0,acronym:0,address:0,applet:272,area:2,article:0,aside:0,audio:0,b:0,base:274,basefont:274,bdi:0,bdo:0,big:0,blockquote:0,body:305,br:2,button:0,canvas:0,caption:0,center:0,cite:0,code:0,col:2,colgroup:1,command:2,data:0,datalist:0,dd:1,del:0,details:0,dfn:0,dialog:272,dir:0,div:0,dl:0,dt:1,em:0,fieldset:0,figcaption:0,figure:0,font:0,footer:0,form:0,frame:274,frameset:272,h1:0,h2:0,h3:0,h4:0,h5:0,h6:0,head:305,header:0,hgroup:0,hr:2,html:305,i:0,iframe:16,img:2,input:2,ins:0,isindex:274,kbd:0,keygen:274,label:0,legend:0,li:1,link:274,map:0,mark:0,menu:0,meta:274,meter:0,nav:0,nobr:0,noembed:276,noframes:276,noscript:276,object:272,ol:0,optgroup:0,option:1,output:0,p:1,param:274,pre:0,progress:0,q:0,s:0,samp:0,script:84,section:0,select:0,small:0,source:2,span:0,strike:0,strong:0,style:148,sub:0,summary:0,sup:0,table:0,tbody:1,td:1,textarea:8,tfoot:1,th:1,thead:1,time:0,title:280,tr:1,track:2,tt:0,u:0,ul:0,var:0,video:0,wbr:2},e.ELEMENTS=e.ELEMENTS,e.ELEMENT_DOM_INTERFACES={a:"HTMLAnchorElement",abbr:"HTMLElement",acronym:"HTMLElement",address:"HTMLElement",applet:"HTMLAppletElement",area:"HTMLAreaElement",article:"HTMLElement",aside:"HTMLElement",audio:"HTMLAudioElement",b:"HTMLElement",base:"HTMLBaseElement",basefont:"HTMLBaseFontElement",bdi:"HTMLElement",bdo:"HTMLElement",big:"HTMLElement",blockquote:"HTMLQuoteElement",body:"HTMLBodyElement",br:"HTMLBRElement",button:"HTMLButtonElement",canvas:"HTMLCanvasElement",caption:"HTMLTableCaptionElement",center:"HTMLElement",cite:"HTMLElement",code:"HTMLElement",col:"HTMLTableColElement",colgroup:"HTMLTableColElement",command:"HTMLCommandElement",data:"HTMLElement",datalist:"HTMLDataListElement",dd:"HTMLElement",del:"HTMLModElement",details:"HTMLDetailsElement",dfn:"HTMLElement",dialog:"HTMLDialogElement",dir:"HTMLDirectoryElement",div:"HTMLDivElement",dl:"HTMLDListElement",dt:"HTMLElement",em:"HTMLElement",fieldset:"HTMLFieldSetElement",figcaption:"HTMLElement",figure:"HTMLElement",font:"HTMLFontElement",footer:"HTMLElement",form:"HTMLFormElement",frame:"HTMLFrameElement",frameset:"HTMLFrameSetElement",h1:"HTMLHeadingElement",h2:"HTMLHeadingElement",h3:"HTMLHeadingElement",h4:"HTMLHeadingElement",h5:"HTMLHeadingElement",h6:"HTMLHeadingElement",head:"HTMLHeadElement",header:"HTMLElement",hgroup:"HTMLElement",hr:"HTMLHRElement",html:"HTMLHtmlElement",i:"HTMLElement",iframe:"HTMLIFrameElement",img:"HTMLImageElement",input:"HTMLInputElement",ins:"HTMLModElement",isindex:"HTMLUnknownElement",kbd:"HTMLElement",keygen:"HTMLKeygenElement",label:"HTMLLabelElement",legend:"HTMLLegendElement",li:"HTMLLIElement",link:"HTMLLinkElement",map:"HTMLMapElement",mark:"HTMLElement",menu:"HTMLMenuElement",meta:"HTMLMetaElement",meter:"HTMLMeterElement",nav:"HTMLElement",nobr:"HTMLElement",noembed:"HTMLElement",noframes:"HTMLElement",noscript:"HTMLElement",object:"HTMLObjectElement",ol:"HTMLOListElement",optgroup:"HTMLOptGroupElement",option:"HTMLOptionElement",output:"HTMLOutputElement",p:"HTMLParagraphElement",param:"HTMLParamElement",pre:"HTMLPreElement",progress:"HTMLProgressElement",q:"HTMLQuoteElement",s:"HTMLElement",samp:"HTMLElement",script:"HTMLScriptElement",section:"HTMLElement",select:"HTMLSelectElement",small:"HTMLElement",source:"HTMLSourceElement",span:"HTMLSpanElement",strike:"HTMLElement",strong:"HTMLElement",style:"HTMLStyleElement",sub:"HTMLElement",summary:"HTMLElement",sup:"HTMLElement",table:"HTMLTableElement",tbody:"HTMLTableSectionElement",td:"HTMLTableDataCellElement",textarea:"HTMLTextAreaElement",tfoot:"HTMLTableSectionElement",th:"HTMLTableHeaderCellElement",thead:"HTMLTableSectionElement",time:"HTMLTimeElement",title:"HTMLTitleElement",tr:"HTMLTableRowElement",track:"HTMLTrackElement",tt:"HTMLElement",u:"HTMLElement",ul:"HTMLUListElement",var:"HTMLElement",video:"HTMLVideoElement",wbr:"HTMLElement"},e.ELEMENT_DOM_INTERFACES=e.ELEMENT_DOM_INTERFACES,e.ueffects={NOT_LOADED:0,SAME_DOCUMENT:1,NEW_DOCUMENT:2},e.ueffects=e.ueffects,e.URIEFFECTS={"a::href":2,"area::href":2,"blockquote::cite":0,"command::icon":1,"del::cite":0,"form::action":2,"img::src":1,"input::src":1,"ins::cite":0,"q::cite":0,"video::poster":1},e.URIEFFECTS=e.URIEFFECTS,e.ltypes={UNSANDBOXED:2,SANDBOXED:1,DATA:0},e.ltypes=e.ltypes,e.LOADERTYPES={"a::href":2,"area::href":2,"blockquote::cite":2,"command::icon":1,"del::cite":2,"form::action":2,"img::src":1,"input::src":1,"ins::cite":2,"q::cite":2,"video::poster":1},e.LOADERTYPES=e.LOADERTYPES,"i"!=="I".toLowerCase())throw"I/i problem";var f=function(a){function b(a){if(F.hasOwnProperty(a))return F[a];var b=a.match(G);if(b)return String.fromCharCode(parseInt(b[1],10));if(b=a.match(H))return String.fromCharCode(parseInt(b[1],16));if(J&&I.test(a)){J.innerHTML="&"+a+";";var c=J.textContent;return F[a]=c,c}return"&"+a+";"}function c(a,c){return b(c)}function e(a){return a.replace(K,"")}function f(a){return a.replace(L,c)}function g(a){return(""+a).replace(N,"&amp;").replace(P,"&lt;").replace(Q,"&gt;").replace(R,"&#34;")}function h(a){return a.replace(O,"&amp;$1").replace(P,"&lt;").replace(Q,"&gt;")}function i(a){var b={cdata:a.cdata||a.cdata,comment:a.comment||a.comment,endDoc:a.endDoc||a.endDoc,endTag:a.endTag||a.endTag,pcdata:a.pcdata||a.pcdata,rcdata:a.rcdata||a.rcdata,startDoc:a.startDoc||a.startDoc,startTag:a.startTag||a.startTag};return function(a,c){return j(a,b,c)}}function j(a,b,c){l(b,m(a),0,{noMoreGT:!1,noMoreEndComments:!1},c)}function k(a,b,c,d,e){return function(){l(a,b,c,d,e)}}function l(b,c,d,e,f){try{b.startDoc&&0==d&&b.startDoc(f);for(var g,h,i,j=d,l=c.length;j<l;){var m=c[j++],q=c[j];switch(m){case"&":M.test(q)?(b.pcdata&&b.pcdata("&"+q,f,V,k(b,c,j,e,f)),j++):b.pcdata&&b.pcdata("&amp;",f,V,k(b,c,j,e,f));break;case"</":(g=/^([-\w:]+)[^\'\"]*/.exec(q))?g[0].length===q.length&&">"===c[j+1]?(j+=2,i=g[1].toLowerCase(),b.endTag&&b.endTag(i,f,V,k(b,c,j,e,f))):j=n(c,j,b,f,V,e):b.pcdata&&b.pcdata("&lt;/",f,V,k(b,c,j,e,f));break;case"<":if(g=/^([-\w:]+)\s*\/?/.exec(q))if(g[0].length===q.length&&">"===c[j+1]){j+=2,i=g[1].toLowerCase(),b.startTag&&b.startTag(i,[],f,V,k(b,c,j,e,f));var r=a.ELEMENTS[i];if(r&U){var s={name:i,next:j,eflags:r};j=p(c,s,b,f,V,e)}}else j=o(c,j,b,f,V,e);else b.pcdata&&b.pcdata("&lt;",f,V,k(b,c,j,e,f));break;case"\x3c!--":if(!e.noMoreEndComments){for(h=j+1;h<l&&(">"!==c[h]||!/--$/.test(c[h-1]));h++);if(h<l){if(b.comment){var t=c.slice(j,h).join("");b.comment(t.substr(0,t.length-2),f,V,k(b,c,h+1,e,f))}j=h+1}else e.noMoreEndComments=!0}e.noMoreEndComments&&b.pcdata&&b.pcdata("&lt;!--",f,V,k(b,c,j,e,f));break;case"<!":if(/^\w/.test(q)){if(!e.noMoreGT){for(h=j+1;h<l&&">"!==c[h];h++);h<l?j=h+1:e.noMoreGT=!0}e.noMoreGT&&b.pcdata&&b.pcdata("&lt;!",f,V,k(b,c,j,e,f))}else b.pcdata&&b.pcdata("&lt;!",f,V,k(b,c,j,e,f));break;case"<?":if(!e.noMoreGT){for(h=j+1;h<l&&">"!==c[h];h++);h<l?j=h+1:e.noMoreGT=!0}e.noMoreGT&&b.pcdata&&b.pcdata("&lt;?",f,V,k(b,c,j,e,f));break;case">":b.pcdata&&b.pcdata("&gt;",f,V,k(b,c,j,e,f));break;case"":break;default:b.pcdata&&b.pcdata(m,f,V,k(b,c,j,e,f))}}b.endDoc&&b.endDoc(f)}catch(a){if(a!==V)throw a}}function m(a){var b=/(<\/|<\!--|<[!?]|[&<>])/g;if(a+="",T)return a.split(b);for(var c,d=[],e=0;null!==(c=b.exec(a));)d.push(a.substring(e,c.index)),d.push(c[0]),e=c.index+c[0].length;return d.push(a.substring(e)),d}function n(a,b,c,d,e,f){var g=q(a,b);return g?(c.endTag&&c.endTag(g.name,d,e,k(c,a,b,f,d)),g.next):a.length}function o(a,b,c,d,e,f){var g=q(a,b);return g?(c.startTag&&c.startTag(g.name,g.attrs,d,e,k(c,a,g.next,f,d)),g.eflags&U?p(a,g,c,d,e,f):g.next):a.length}function p(b,c,d,e,f,g){var i=b.length;W.hasOwnProperty(c.name)||(W[c.name]=new RegExp("^"+c.name+"(?:[\\s\\/]|$)","i"));for(var j=W[c.name],l=c.next,m=c.next+1;m<i&&("</"!==b[m-1]||!j.test(b[m]));m++);m<i&&(m-=1);var n=b.slice(l,m).join("");if(c.eflags&a.eflags.CDATA)d.cdata&&d.cdata(n,e,f,k(d,b,m,g,e));else{if(!(c.eflags&a.eflags.RCDATA))throw new Error("bug");d.rcdata&&d.rcdata(h(n),e,f,k(d,b,m,g,e))}return m}function q(b,c){var d=/^([-\w:]+)/.exec(b[c]),e={};e.name=d[1].toLowerCase(),e.eflags=a.ELEMENTS[e.name];for(var f=b[c].substr(d[0].length),g=c+1,h=b.length;g<h&&">"!==b[g];g++)f+=b[g];if(!(h<=g)){for(var i=[];""!==f;)if(d=S.exec(f)){if(d[4]&&!d[5]||d[6]&&!d[7]){for(var j=d[4]||d[6],k=!1,l=[f,b[g++]];g<h;g++){if(k){if(">"===b[g])break}else 0<=b[g].indexOf(j)&&(k=!0);l.push(b[g])}if(h<=g)break;f=l.join("");continue}var m=d[1].toLowerCase(),n=d[2]?r(d[3]):"";i.push(m,n),f=f.substr(d[0].length)}else f=f.replace(/^[\s\S][^a-z\s]*/,"");return e.attrs=i,e.next=g+1,e}}function r(a){var b=a.charCodeAt(0);return 34!==b&&39!==b||(a=a.substr(1,a.length-2)),f(e(a))}function s(b){var c,d,e=function(a,b){d||b.push(a)};return i({startDoc:function(a){c=[],d=!1},startTag:function(e,f,h){if(!d&&a.ELEMENTS.hasOwnProperty(e)){var i=a.ELEMENTS[e];if(!(i&a.eflags.FOLDABLE)){var j=b(e,f);if(!j)return void(d=!(i&a.eflags.EMPTY));if("object"!=typeof j)throw new Error("tagPolicy did not return object (old API?)");if(!("attribs"in j))throw new Error("tagPolicy gave no attribs");f=j.attribs;var k,l;if("tagName"in j?(l=j.tagName,k=a.ELEMENTS[l]):(l=e,k=i),i&a.eflags.OPTIONAL_ENDTAG){var m=c[c.length-1];!m||m.orig!==e||m.rep===l&&e===l||h.push("</",m.rep,">")}i&a.eflags.EMPTY||c.push({orig:e,rep:l}),h.push("<",l);for(var n=0,o=f.length;n<o;n+=2){var p=f[n],q=f[n+1];null!==q&&void 0!==q&&h.push(" ",p,'="',g(q),'"')}h.push(">"),i&a.eflags.EMPTY&&!(k&a.eflags.EMPTY)&&h.push("</",l,">")}}},endTag:function(b,e){if(d)return void(d=!1);if(a.ELEMENTS.hasOwnProperty(b)){var f=a.ELEMENTS[b];if(!(f&(a.eflags.EMPTY|a.eflags.FOLDABLE))){var g;if(f&a.eflags.OPTIONAL_ENDTAG)for(g=c.length;--g>=0;){var h=c[g].orig;if(h===b)break;if(!(a.ELEMENTS[h]&a.eflags.OPTIONAL_ENDTAG))return}else for(g=c.length;--g>=0&&c[g].orig!==b;);if(g<0)return;for(var i=c.length;--i>g;){var j=c[i].rep;a.ELEMENTS[j]&a.eflags.OPTIONAL_ENDTAG||e.push("</",j,">")}g<c.length&&(b=c[g].rep),c.length=g,e.push("</",b,">")}}},pcdata:e,rcdata:e,cdata:e,endDoc:function(a){for(;c.length;c.length--)a.push("</",c[c.length-1].rep,">")}})}function t(a,b,c,e,f){if(!f)return null;try{var g=d.parse(""+a);if(g&&(!g.hasScheme()||X.test(g.getScheme()))){var h=f(g,b,c,e);return h?h.toString():null}}catch(a){return null}return null}function u(a,b,c,d,e){if(c||a(b+" removed",{change:"removed",tagName:b}),d!==e){var f="changed";d&&!e?f="removed":!d&&e&&(f="added"),a(b+"."+c+" "+f,{change:f,tagName:b,attribName:c,oldValue:d,newValue:e})}}function v(a,b,c){var d;return d=b+"::"+c,a.hasOwnProperty(d)?a[d]:(d="*::"+c,a.hasOwnProperty(d)?a[d]:void 0)}function w(b,c){return v(a.LOADERTYPES,b,c)}function x(b,c){return v(a.URIEFFECTS,b,c)}function y(b,c,d,e,f){for(var g=0;g<c.length;g+=2){var h,i=c[g],j=c[g+1],k=j,l=null;if(h=b+"::"+i,(a.ATTRIBS.hasOwnProperty(h)||(h="*::"+i,a.ATTRIBS.hasOwnProperty(h)))&&(l=a.ATTRIBS[h]),null!==l)switch(l){case a.atype.NONE:break;case a.atype.SCRIPT:j=null,f&&u(f,b,i,k,j);break;case a.atype.STYLE:if(void 0===C){j=null,f&&u(f,b,i,k,j);break}var m=[];C(j,{declaration:function(b,c){var e=b.toLowerCase(),f=E[e];f&&(D(e,f,c,d?function(b){return t(b,a.ueffects.SAME_DOCUMENT,a.ltypes.SANDBOXED,{TYPE:"CSS",CSS_PROP:e},d)}:null),m.push(b+": "+c.join(" ")))}}),j=m.length>0?m.join(" ; "):null,f&&u(f,b,i,k,j);break;case a.atype.ID:case a.atype.IDREF:case a.atype.IDREFS:case a.atype.GLOBAL_NAME:case a.atype.LOCAL_NAME:case a.atype.CLASSES:j=e?e(j):j,f&&u(f,b,i,k,j);break;case a.atype.URI:j=t(j,x(b,i),w(b,i),{TYPE:"MARKUP",XML_ATTR:i,XML_TAG:b},d),f&&u(f,b,i,k,j);break;case a.atype.URI_FRAGMENT:j&&"#"===j.charAt(0)?(j=j.substring(1),null!==(j=e?e(j):j)&&void 0!==j&&(j="#"+j)):j=null,f&&u(f,b,i,k,j);break;default:j=null,f&&u(f,b,i,k,j)}else j=null,f&&u(f,b,i,k,j);c[g+1]=j}return c}function z(b,c,d){return function(e,f){if(!(a.ELEMENTS[e]&a.eflags.UNSAFE))return{attribs:y(e,f,b,c,d)};d&&u(d,e,void 0,void 0,void 0)}}function A(a,b){var c=[];return s(b)(a,c),c.join("")}function B(a,b,c,d){return A(a,z(b,c,d))}var C,D,E;"undefined"!=typeof window&&(C=window.parseCssDeclarations,D=window.sanitizeCssProperty,E=window.cssSchema);var F={lt:"<",LT:"<",gt:">",GT:">",amp:"&",AMP:"&",quot:'"',apos:"'",nbsp:" "},G=/^#(\d+)$/,H=/^#x([0-9A-Fa-f]+)$/,I=/^[A-Za-z][A-za-z0-9]+$/,J="undefined"!=typeof window&&window.document?window.document.createElement("textarea"):null,K=/\0/g,L=/&(#[0-9]+|#[xX][0-9A-Fa-f]+|\w+);/g,M=/^(#[0-9]+|#[xX][0-9A-Fa-f]+|\w+);/,N=/&/g,O=/&([^a-z#]|#(?:[^0-9x]|x(?:[^0-9a-f]|$)|$)|$)/gi,P=/[<]/g,Q=/>/g,R=/\"/g,S=new RegExp("^\\s*([-.:\\w]+)(?:\\s*(=)\\s*((\")[^\"]*(\"|$)|(')[^']*('|$)|(?=[a-z][-\\w]*\\s*=)|[^\"'\\s]*))?","i"),T=3==="a,b".split(/(,)/).length,U=a.eflags.CDATA|a.eflags.RCDATA,V={},W={},X=/^(?:https?|mailto|data)$/i,Y={};return Y.escapeAttrib=Y.escapeAttrib=g,Y.makeHtmlSanitizer=Y.makeHtmlSanitizer=s,Y.makeSaxParser=Y.makeSaxParser=i,Y.makeTagPolicy=Y.makeTagPolicy=z,Y.normalizeRCData=Y.normalizeRCData=h,Y.sanitize=Y.sanitize=B,Y.sanitizeAttribs=Y.sanitizeAttribs=y,Y.sanitizeWithPolicy=Y.sanitizeWithPolicy=A,Y.unescapeEntities=Y.unescapeEntities=f,Y}(e),g=f.sanitize;e.ATTRIBS["*::style"]=0,e.ELEMENTS.style=0,e.ATTRIBS["a::target"]=0,e.ELEMENTS.video=0,e.ATTRIBS["video::src"]=0,e.ATTRIBS["video::poster"]=0,e.ATTRIBS["video::controls"]=0,e.ELEMENTS.audio=0,e.ATTRIBS["audio::src"]=0,e.ATTRIBS["video::autoplay"]=0,e.ATTRIBS["video::controls"]=0,void 0!==b&&(b.exports=g)},{}],6:[function(a,b,c){b.exports={author:"Mapbox",name:"mapbox.js",description:"mapbox javascript api",version:"3.1.1",homepage:"http://mapbox.com/",repository:{type:"git",url:"git://github.com/mapbox/mapbox.js.git"},main:"src/index.js",dependencies:{corslite:"0.0.6",isarray:"0.0.1",leaflet:"1.0.2",mustache:"2.2.1","sanitize-caja":"0.1.4"},scripts:{test:"eslint --no-eslintrc -c .eslintrc src && phantomjs node_modules/mocha-phantomjs-core/mocha-phantomjs-core.js test/index.html"},license:"BSD-3-Clause",devDependencies:{browserify:"^13.0.0","clean-css":"~2.0.7","cz-conventional-changelog":"1.2.0",eslint:"^0.23.0","expect.js":"0.3.1",happen:"0.1.3","leaflet-fullscreen":"0.0.4","leaflet-hash":"0.2.1",marked:"~0.3.0",minifyify:"^6.1.0",minimist:"0.0.5",mocha:"2.4.5","mocha-phantomjs-core":"2.0.1","phantomjs-prebuilt":"2.1.12",sinon:"1.10.2"},optionalDependencies:{},engines:{node:"*"},config:{commitizen:{path:"./node_modules/cz-conventional-changelog"}}}},{}],7:[function(a,b,c){"use strict";b.exports={HTTP_URL:"http://a.tiles.mapbox.com/v4",HTTPS_URL:"https://a.tiles.mapbox.com/v4",FORCE_HTTPS:!1,REQUIRE_ACCESS_TOKEN:!0}},{}],8:[function(a,b,c){"use strict";var d=a("./util"),e=a("./format_url"),f=a("./request"),g=a("./marker"),h=a("./simplestyle"),i=L.FeatureGroup.extend({options:{filter:function(){return!0},sanitizer:a("sanitize-caja"),style:h.style,popupOptions:{closeButton:!1}},initialize:function(a,b){L.setOptions(this,b),this._layers={},"string"==typeof a?d.idUrl(a,this):a&&"object"==typeof a&&this.setGeoJSON(a)},setGeoJSON:function(a){return this._geojson=a,this.clearLayers(),this._initialize(a),this},getGeoJSON:function(){return this._geojson},loadURL:function(a){return this._request&&"abort"in this._request&&this._request.abort(),this._request=f(a,L.bind(function(b,c){this._request=null,b&&"abort"!==b.type?(d.log("could not load features at "+a),this.fire("error",{error:b})):c&&(this.setGeoJSON(c),this.fire("ready"))},this)),this},loadID:function(a){return this.loadURL(e("/v4/"+a+"/features.json",this.options.accessToken))},setFilter:function(a){return this.options.filter=a,this._geojson&&(this.clearLayers(),this._initialize(this._geojson)),this},getFilter:function(){return this.options.filter},_initialize:function(a){var b,c,d=L.Util.isArray(a)?a:a.features;if(d)for(b=0,c=d.length;b<c;b++)(d[b].geometries||d[b].geometry||d[b].features)&&this._initialize(d[b]);else if(this.options.filter(a)){var e={accessToken:this.options.accessToken},f=this.options.pointToLayer||function(a,b){return g.style(a,b,e)},i=L.GeoJSON.geometryToLayer(a,{pointToLayer:f}),j=g.createPopup(a,this.options.sanitizer),k=this.options.style,l=k===h.style;!(k&&"setStyle"in i)||l&&(i instanceof L.Circle||i instanceof L.CircleMarker)||("function"==typeof k&&(k=k(a)),i.setStyle(k)),i.feature=a,j&&i.bindPopup(j,this.options.popupOptions),this.addLayer(i)}}});b.exports.FeatureLayer=i,b.exports.featureLayer=function(a,b){return new i(a,b)}},{"./format_url":10,"./marker":21,"./request":22,"./simplestyle":24,"./util":27,"sanitize-caja":4}],9:[function(a,b,c){"use strict";var d=L.Class.extend({includes:L.Mixin.Events,data:{},record:function(a){L.extend(this.data,a),this.fire("change")}});b.exports=new d},{}],10:[function(a,b,c){"use strict";var d=a("./config"),e=a("../package.json").version;b.exports=function(a,b){if(!(b=b||L.mapbox.accessToken)&&d.REQUIRE_ACCESS_TOKEN)throw new Error("An API access token is required to use Mapbox.js. See https://www.mapbox.com/mapbox.js/api/v"+e+"/api-access-tokens/");var c="https:"===document.location.protocol||d.FORCE_HTTPS?d.HTTPS_URL:d.HTTP_URL;if(c=c.replace(/\/v4$/,""),c+=a,d.REQUIRE_ACCESS_TOKEN){if("s"===b[0])throw new Error("Use a public access token (pk.*) with Mapbox.js, not a secret access token (sk.*). See https://www.mapbox.com/mapbox.js/api/v"+e+"/api-access-tokens/");c+=-1!==c.indexOf("?")?"&access_token=":"?access_token=",c+=b}return c},b.exports.tileJSON=function(a,c){if(0===a.indexOf("mapbox://styles"))throw new Error("Styles created with Mapbox Studio need to be used with L.mapbox.styleLayer, not L.mapbox.tileLayer");if(-1!==a.indexOf("/"))return a;var d=b.exports("/v4/"+a+".json",c);return 0===d.indexOf("https")&&(d+="&secure"),d},b.exports.style=function(a,c){if(-1===a.indexOf("mapbox://styles/"))throw new Error("Incorrectly formatted Mapbox style at "+a);var d=a.split("mapbox://styles/")[1];return b.exports("/styles/v1/"+d,c).replace("http://","https://")}},{"../package.json":6,"./config":7}],11:[function(a,b,c){"use strict";var d=a("isarray"),e=a("./util"),f=a("./format_url"),g=a("./feedback"),h=a("./request");b.exports=function(a,b){function c(a,b){var c=Math.pow(10,b);return a.lat=Math.round(a.lat*c)/c,a.lng=Math.round(a.lng*c)/c,a}b||(b={});var i={};return e.strict(a,"string"),-1===a.indexOf("/")&&(a=f("/geocoding/v5/"+a+"/{query}.json",b.accessToken,5)),i.getURL=function(){return a},i.queryURL=function(a){var b=!(d(a)||"string"==typeof a),e=b?a.query:a;if(d(e)){for(var f=[],h=0;h<e.length;h++)f[h]=encodeURIComponent(e[h]);e=f.join(";")}else e=encodeURIComponent(e);g.record({geocoding:e});var j=L.Util.template(i.getURL(),{query:e});if(b){if(a.types&&(d(a.types)?j+="&types="+a.types.join():j+="&types="+a.types),a.country&&(d(a.country)?j+="&country="+a.country.join():j+="&country="+a.country),a.bbox&&(d(a.bbox)?j+="&bbox="+a.bbox.join():j+="&bbox="+a.bbox),a.proximity){var k=c(L.latLng(a.proximity),3);j+="&proximity="+k.lng+","+k.lat}"boolean"==typeof a.autocomplete&&(j+="&autocomplete="+a.autocomplete)}return j},i.query=function(a,b){return e.strict(b,"function"),h(i.queryURL(a),function(a,c){if(c&&(c.length||c.features)){var d={results:c};c.features&&c.features.length&&(d.latlng=[c.features[0].center[1],c.features[0].center[0]],c.features[0].bbox&&(d.bounds=c.features[0].bbox,d.lbounds=e.lbounds(d.bounds))),b(null,d)}else b(a||!0)}),i},i.reverseQuery=function(a,b){function d(a){var b;return b=void 0!==a.lat&&void 0!==a.lng?L.latLng(a.lat,a.lng):void 0!==a.lat&&void 0!==a.lon?L.latLng(a.lat,a.lon):L.latLng(a[1],a[0]),b=c(b,5),b.lng+","+b.lat}var e="";if(a.length&&a[0].length){for(var f=0,g=[];f<a.length;f++)g.push(d(a[f]));e=g.join(";")}else e=d(a);return h(i.queryURL(e),function(a,c){b(a,c)}),i},i}},{"./feedback":9,"./format_url":10,"./request":22,"./util":27,isarray:2}],12:[function(a,b,c){"use strict";var d=a("./geocoder"),e=a("./util"),f=L.Control.extend({includes:L.Mixin.Events,options:{proximity:!0,position:"topleft",pointZoom:16,keepOpen:!1,autocomplete:!1,queryOptions:{}},initialize:function(a,b){L.Util.setOptions(this,b),this.setURL(a),this._updateSubmit=L.bind(this._updateSubmit,this),this._updateAutocomplete=L.bind(this._updateAutocomplete,this),this._chooseResult=L.bind(this._chooseResult,this)},setURL:function(a){return this.geocoder=d(a,{accessToken:this.options.accessToken}),this},getURL:function(){return this.geocoder.getURL()},setID:function(a){return this.setURL(a)},setTileJSON:function(a){return this.setURL(a.geocoder)},_toggle:function(a){a&&L.DomEvent.stop(a),L.DomUtil.hasClass(this._container,"active")?(L.DomUtil.removeClass(this._container,"active"),this._results.innerHTML="",this._input.blur()):(L.DomUtil.addClass(this._container,"active"),this._input.focus(),this._input.select())},_closeIfOpen:function(){L.DomUtil.hasClass(this._container,"active")&&!this.options.keepOpen&&(L.DomUtil.removeClass(this._container,"active"),this._results.innerHTML="",this._input.blur())},onAdd:function(a){var b=L.DomUtil.create("div","leaflet-control-mapbox-geocoder leaflet-bar leaflet-control"),c=L.DomUtil.create("a","leaflet-control-mapbox-geocoder-toggle mapbox-icon mapbox-icon-geocoder",b),d=L.DomUtil.create("div","leaflet-control-mapbox-geocoder-results",b),e=L.DomUtil.create("div","leaflet-control-mapbox-geocoder-wrap",b),f=L.DomUtil.create("form","leaflet-control-mapbox-geocoder-form",e),g=L.DomUtil.create("input","",f);return c.href="#",c.innerHTML="&nbsp;",g.type="text",g.setAttribute("placeholder","Search"),L.DomEvent.addListener(f,"submit",this._geocode,this),L.DomEvent.addListener(g,"keyup",this._autocomplete,this),L.DomEvent.disableClickPropagation(b),this._map=a,this._results=d,this._input=g,this._form=f,this.options.keepOpen?L.DomUtil.addClass(b,"active"):(this._map.on("click",this._closeIfOpen,this),L.DomEvent.addListener(c,"click",this._toggle,this)),b},_updateSubmit:function(a,b){if(L.DomUtil.removeClass(this._container,"searching"),this._results.innerHTML="",a||!b)this.fire("error",{error:a});else{var c=[];b.results&&b.results.features&&(c=b.results.features),1===c.length?(this.fire("autoselect",{feature:c[0]}),this.fire("found",{results:b.results}),this._chooseResult(c[0]),this._closeIfOpen()):c.length>1?(this.fire("found",{results:b.results}),this._displayResults(c)):(this.fire("notfound"),this._displayResults(c))}},_updateAutocomplete:function(a,b){if(this._results.innerHTML="",a||!b)this.fire("error",{error:a});else{var c=[];b.results&&b.results.features&&(c=b.results.features),c.length?this.fire("found",{results:b.results}):this.fire("notfound"),this._displayResults(c)}},_displayResults:function(a){for(var b=0,c=Math.min(a.length,5);b<c;b++){var d=a[b],e=d.place_name;if(e.length){var f=L.DomUtil.create("a","",this._results);f["innerText"in f?"innerText":"textContent"]=e,f.setAttribute("title",e),f.href="#",L.bind(function(a){L.DomEvent.addListener(f,"click",function(b){this._chooseResult(a),L.DomEvent.stop(b),this.fire("select",{feature:a})},this)},this)(d)}}a.length>5&&(L.DomUtil.create("span","",this._results).innerHTML="Top 5 of "+a.length+"  results")},_chooseResult:function(a){a.bbox?this._map.fitBounds(e.lbounds(a.bbox)):a.center&&this._map.setView([a.center[1],a.center[0]],void 0===this._map.getZoom()?this.options.pointZoom:Math.max(this._map.getZoom(),this.options.pointZoom))},_geocode:function(a){if(L.DomEvent.preventDefault(a),""===this._input.value)return this._updateSubmit();L.DomUtil.addClass(this._container,"searching"),this.geocoder.query(L.Util.extend({query:this._input.value,proximity:!!this.options.proximity&&this._map.getCenter()},this.options.queryOptions),this._updateSubmit)},_autocomplete:function(){if(this.options.autocomplete)return""===this._input.value?this._updateAutocomplete():void this.geocoder.query(L.Util.extend({query:this._input.value,proximity:!!this.options.proximity&&this._map.getCenter()},this.options.queryOptions),this._updateAutocomplete)}})
;b.exports.GeocoderControl=f,b.exports.geocoderControl=function(a,b){return new f(a,b)}},{"./geocoder":11,"./util":27}],13:[function(a,b,c){"use strict";function d(a){return a>=93&&a--,a>=35&&a--,a-32}b.exports=function(a){return function(b,c){if(a){var e=d(a.grid[c].charCodeAt(b)),f=a.keys[e];return a.data[f]}}}},{}],14:[function(a,b,c){"use strict";var d=a("./util"),e=a("mustache"),f=L.Control.extend({options:{pinnable:!0,follow:!1,sanitizer:a("sanitize-caja"),touchTeaser:!0,location:!0},_currentContent:"",_pinned:!1,initialize:function(a,b){L.Util.setOptions(this,b),d.strict_instance(a,L.Class,"L.mapbox.gridLayer"),this._layer=a},setTemplate:function(a){return d.strict(a,"string"),this.options.template=a,this},_template:function(a,b){if(b){var c=this.options.template||this._layer.getTileJSON().template;if(c){var d={};return d["__"+a+"__"]=!0,this.options.sanitizer(e.to_html(c,L.extend(d,b)))}}},_show:function(a,b){a!==this._currentContent&&(this._currentContent=a,this.options.follow?(this._popup.setContent(a).setLatLng(b.latLng),this._map._popup!==this._popup&&this._popup.openOn(this._map)):(this._container.style.display="block",this._contentWrapper.innerHTML=a))},hide:function(){return this._pinned=!1,this._currentContent="",this._map.closePopup(),this._container.style.display="none",this._contentWrapper.innerHTML="",L.DomUtil.removeClass(this._container,"closable"),this},_mouseover:function(a){if(a.data?L.DomUtil.addClass(this._map._container,"map-clickable"):L.DomUtil.removeClass(this._map._container,"map-clickable"),!this._pinned){var b=this._template("teaser",a.data);b?this._show(b,a):this.hide()}},_mousemove:function(a){this._pinned||this.options.follow&&this._popup.setLatLng(a.latLng)},_navigateTo:function(a){window.top.location.href=a},_click:function(a){var b=this._template("location",a.data);if(this.options.location&&b&&0===b.search(/^https?:/))return this._navigateTo(this._template("location",a.data));if(this.options.pinnable){var c=this._template("full",a.data);!c&&this.options.touchTeaser&&L.Browser.touch&&(c=this._template("teaser",a.data)),c?(L.DomUtil.addClass(this._container,"closable"),this._pinned=!0,this._show(c,a)):this._pinned&&(L.DomUtil.removeClass(this._container,"closable"),this._pinned=!1,this.hide())}},_onPopupClose:function(){this._currentContent=null,this._pinned=!1},_createClosebutton:function(a,b){var c=L.DomUtil.create("a","close",a);return c.innerHTML="close",c.href="#",c.title="close",L.DomEvent.on(c,"click",L.DomEvent.stopPropagation).on(c,"mousedown",L.DomEvent.stopPropagation).on(c,"dblclick",L.DomEvent.stopPropagation).on(c,"click",L.DomEvent.preventDefault).on(c,"click",b,this),c},onAdd:function(a){this._map=a;var b=L.DomUtil.create("div","leaflet-control-grid map-tooltip"),c=L.DomUtil.create("div","map-tooltip-content");return b.style.display="none",this._createClosebutton(b,this.hide),b.appendChild(c),this._contentWrapper=c,this._popup=new L.Popup({autoPan:!1,closeOnClick:!1}),a.on("popupclose",this._onPopupClose,this),L.DomEvent.disableClickPropagation(b).addListener(b,"mousewheel",L.DomEvent.stopPropagation),this._layer.on("mouseover",this._mouseover,this).on("mousemove",this._mousemove,this).on("click",this._click,this),b},onRemove:function(a){a.off("popupclose",this._onPopupClose,this),this._layer.off("mouseover",this._mouseover,this).off("mousemove",this._mousemove,this).off("click",this._click,this)}});b.exports.GridControl=f,b.exports.gridControl=function(a,b){return new f(a,b)}},{"./util":27,mustache:3,"sanitize-caja":4}],15:[function(a,b,c){"use strict";var d=a("./util"),e=a("./request"),f=a("./grid"),g=L.Layer.extend({includes:[a("./load_tilejson")],options:{template:function(){return""}},_mouseOn:null,_tilejson:{},_cache:{},initialize:function(a,b){L.Util.setOptions(this,b),this._loadTileJSON(a)},_setTileJSON:function(a){return d.strict(a,"object"),L.extend(this.options,{grids:a.grids,minZoom:a.minzoom,maxZoom:a.maxzoom,bounds:a.bounds&&d.lbounds(a.bounds)}),this._tilejson=a,this._cache={},this._update(),this},getTileJSON:function(){return this._tilejson},active:function(){return!!(this._map&&this.options.grids&&this.options.grids.length)},onAdd:function(a){this._map=a,this._update(),this._map.on("click",this._click,this).on("mousemove",this._move,this).on("moveend",this._update,this)},onRemove:function(){this._map.off("click",this._click,this).off("mousemove",this._move,this).off("moveend",this._update,this)},getData:function(a,b){if(this.active()){var c=this._map,d=c.project(a.wrap()),e=Math.floor(d.x/256),f=Math.floor(d.y/256),g=c.options.crs.scale(c.getZoom())/256;return e=(e+g)%g,f=(f+g)%g,this._getTile(c.getZoom(),e,f,function(a){var c=Math.floor((d.x-256*e)/4),g=Math.floor((d.y-256*f)/4);b(a(c,g))}),this}},_click:function(a){this.getData(a.latlng,L.bind(function(b){this.fire("click",{latLng:a.latlng,data:b})},this))},_move:function(a){this.getData(a.latlng,L.bind(function(b){b!==this._mouseOn?(this._mouseOn&&this.fire("mouseout",{latLng:a.latlng,data:this._mouseOn}),this.fire("mouseover",{latLng:a.latlng,data:b}),this._mouseOn=b):this.fire("mousemove",{latLng:a.latlng,data:b})},this))},_getTileURL:function(a){var b=this.options.grids,c=(a.x+a.y)%b.length,d=b[c];return L.Util.template(d,a)},_update:function(){if(this.active()){var a=this._map.getPixelBounds(),b=this._map.getZoom();if(!(b>this.options.maxZoom||b<this.options.minZoom))for(var c=L.bounds(a.min.divideBy(256)._floor(),a.max.divideBy(256)._floor()),d=this._map.options.crs.scale(b)/256,e=c.min.x;e<=c.max.x;e++)for(var f=c.min.y;f<=c.max.y;f++)this._getTile(b,(e%d+d)%d,(f%d+d)%d)}},_getTile:function(a,b,c,d){var g=a+"_"+b+"_"+c,h=L.point(b,c);if(h.z=a,this._tileShouldBeLoaded(h)){if(g in this._cache){if(!d)return;return void("function"==typeof this._cache[g]?d(this._cache[g]):this._cache[g].push(d))}this._cache[g]=[],d&&this._cache[g].push(d),e(this._getTileURL(h),L.bind(function(a,b){var c=this._cache[g];this._cache[g]=f(b);for(var d=0;d<c.length;++d)c[d](this._cache[g])},this))}},_tileShouldBeLoaded:function(a){if(a.z>this.options.maxZoom||a.z<this.options.minZoom)return!1;if(this.options.bounds){var b=a.multiplyBy(256),c=b.add(new L.Point(256,256)),d=this._map.unproject(b),e=this._map.unproject(c),f=new L.LatLngBounds([d,e]);if(!this.options.bounds.intersects(f))return!1}return!0}});b.exports.GridLayer=g,b.exports.gridLayer=function(a,b){return new g(a,b)}},{"./grid":13,"./load_tilejson":17,"./request":22,"./util":27}],16:[function(a,b,c){"use strict";var d=L.Control.extend({options:{position:"bottomright",sanitizer:a("sanitize-caja")},initialize:function(a){L.setOptions(this,a),this._legends={}},onAdd:function(){return this._container=L.DomUtil.create("div","map-legends wax-legends"),L.DomEvent.disableClickPropagation(this._container),this._update(),this._container},addLegend:function(a){return a?(this._legends[a]||(this._legends[a]=0),this._legends[a]++,this._update()):this},removeLegend:function(a){return a?(this._legends[a]&&this._legends[a]--,this._update()):this},_update:function(){if(!this._map)return this;this._container.innerHTML="";var a="none";for(var b in this._legends)if(this._legends.hasOwnProperty(b)&&this._legends[b]){var c=L.DomUtil.create("div","map-legend wax-legend",this._container);c.innerHTML=this.options.sanitizer(b),a="block"}return this._container.style.display=a,this}});b.exports.LegendControl=d,b.exports.legendControl=function(a){return new d(a)}},{"sanitize-caja":4}],17:[function(a,b,c){"use strict";var d=a("./request"),e=a("./format_url"),f=a("./util");b.exports={_loadTileJSON:function(a){"string"==typeof a?(a=e.tileJSON(a,this.options&&this.options.accessToken),d(a,L.bind(function(b,c){b?(f.log("could not load TileJSON at "+a),this.fire("error",{error:b})):c&&(this._setTileJSON(c),this.fire("ready"))},this))):a&&"object"==typeof a&&this._setTileJSON(a)}}},{"./format_url":10,"./request":22,"./util":27}],18:[function(a,b,c){"use strict";function d(a,b){return!b||a.accessToken?a:L.extend({accessToken:b},a)}var e=a("./tile_layer").tileLayer,f=a("./feature_layer").featureLayer,g=a("./grid_layer").gridLayer,h=a("./grid_control").gridControl,i=a("./share_control").shareControl,j=a("./legend_control").legendControl,k=a("./mapbox_logo").mapboxLogoControl,l=a("./feedback"),m=L.Map.extend({includes:[a("./load_tilejson")],options:{tileLayer:{},featureLayer:{},gridLayer:{},legendControl:{},gridControl:{},shareControl:!1,sanitizer:a("sanitize-caja")},_tilejson:{},initialize:function(a,b,c){if(L.Map.prototype.initialize.call(this,a,L.extend({},L.Map.prototype.options,c)),this.attributionControl){this.attributionControl.setPrefix("");var m=this.options.attributionControl.compact;(m||!1!==m&&this._container.offsetWidth<=640)&&L.DomUtil.addClass(this.attributionControl._container,"leaflet-compact-attribution"),void 0===m&&this.on("resize",function(){this._container.offsetWidth>640?L.DomUtil.removeClass(this.attributionControl._container,"leaflet-compact-attribution"):L.DomUtil.addClass(this.attributionControl._container,"leaflet-compact-attribution")})}this.options.tileLayer&&(this.tileLayer=e(void 0,d(this.options.tileLayer,this.options.accessToken)),this.addLayer(this.tileLayer)),this.options.featureLayer&&(this.featureLayer=f(void 0,d(this.options.featureLayer,this.options.accessToken)),this.addLayer(this.featureLayer)),this.options.gridLayer&&(this.gridLayer=g(void 0,d(this.options.gridLayer,this.options.accessToken)),this.addLayer(this.gridLayer)),this.options.gridLayer&&this.options.gridControl&&(this.gridControl=h(this.gridLayer,this.options.gridControl),this.addControl(this.gridControl)),this.options.legendControl&&(this.legendControl=j(this.options.legendControl),this.addControl(this.legendControl)),this.options.shareControl&&(this.shareControl=i(void 0,d(this.options.shareControl,this.options.accessToken)),this.addControl(this.shareControl)),this._mapboxLogoControl=k(this.options.mapboxLogoControl),this.addControl(this._mapboxLogoControl),this._loadTileJSON(b),this.on("layeradd",this._onLayerAdd,this).on("layerremove",this._onLayerRemove,this).on("moveend",this._updateMapFeedbackLink,this),this.whenReady(function(){l.on("change",this._updateMapFeedbackLink,this)}),this.on("unload",function(){l.off("change",this._updateMapFeedbackLink,this)})},_setTileJSON:function(a){return this._tilejson=a,this._initialize(a),this},getTileJSON:function(){return this._tilejson},_initialize:function(a){if(this.tileLayer&&(this.tileLayer._setTileJSON(a),this._updateLayer(this.tileLayer)),this.featureLayer&&!this.featureLayer.getGeoJSON()&&a.data&&a.data[0]&&this.featureLayer.loadURL(a.data[0]),this.gridLayer&&(this.gridLayer._setTileJSON(a),this._updateLayer(this.gridLayer)),this.legendControl&&a.legend&&this.legendControl.addLegend(a.legend),this.shareControl&&this.shareControl._setTileJSON(a),this._mapboxLogoControl._setTileJSON(a),!this._loaded&&a.center){var b=void 0!==this.getZoom()?this.getZoom():a.center[2],c=L.latLng(a.center[1],a.center[0]);this.setView(c,b)}},_updateMapFeedbackLink:function(){if(this._controlContainer.getElementsByClassName){var a=this._controlContainer.getElementsByClassName("mapbox-improve-map");if(a.length&&this._loaded){var b=this.getCenter().wrap(),c=this._tilejson||{},d=c.id||"",e="#"+d+"/"+b.lng.toFixed(3)+"/"+b.lat.toFixed(3)+"/"+this.getZoom();for(var f in l.data)e+="/"+f+"="+l.data[f];for(var g=0;g<a.length;g++)a[g].hash=e}}},_onLayerAdd:function(a){"on"in a.layer&&a.layer.on("ready",this._onLayerReady,this),window.setTimeout(L.bind(this._updateMapFeedbackLink,this),0)},_onLayerRemove:function(a){"on"in a.layer&&a.layer.off("ready",this._onLayerReady,this),window.setTimeout(L.bind(this._updateMapFeedbackLink,this),0)},_onLayerReady:function(a){this._updateLayer(a.target)},_updateLayer:function(a){a.options&&(this.attributionControl&&this._loaded&&a.getAttribution&&this.attributionControl.addAttribution(a.getAttribution()),L.stamp(a)in this._zoomBoundLayers||!a.options.maxZoom&&!a.options.minZoom||(this._zoomBoundLayers[L.stamp(a)]=a),this._updateMapFeedbackLink(),this._updateZoomLevels())}});b.exports.Map=m,b.exports.map=function(a,b,c){return new m(a,b,c)}},{"./feature_layer":8,"./feedback":9,"./grid_control":14,"./grid_layer":15,"./legend_control":16,"./load_tilejson":17,"./mapbox_logo":20,"./share_control":23,"./tile_layer":26,"sanitize-caja":4}],19:[function(a,b,c){"use strict";var d=a("./geocoder_control"),e=a("./grid_control"),f=a("./feature_layer"),g=a("./legend_control"),h=a("./share_control"),i=a("./tile_layer"),j=a("./map"),k=a("./grid_layer"),l=a("./style_layer");L.mapbox=b.exports={VERSION:a("../package.json").version,geocoder:a("./geocoder"),marker:a("./marker"),simplestyle:a("./simplestyle"),tileLayer:i.tileLayer,TileLayer:i.TileLayer,styleLayer:l.styleLayer,StyleLayer:l.StyleLayer,shareControl:h.shareControl,ShareControl:h.ShareControl,legendControl:g.legendControl,LegendControl:g.LegendControl,geocoderControl:d.geocoderControl,GeocoderControl:d.GeocoderControl,gridControl:e.gridControl,GridControl:e.GridControl,gridLayer:k.gridLayer,GridLayer:k.GridLayer,featureLayer:f.featureLayer,FeatureLayer:f.FeatureLayer,map:j.map,Map:j.Map,config:a("./config"),sanitize:a("sanitize-caja"),template:a("mustache").to_html,feedback:a("./feedback")},window.L.Icon.Default.imagePath=("https:"===document.location.protocol||"http:"===document.location.protocol?"":"https:")+"//api.tiles.mapbox.com/mapbox.js/v"+a("../package.json").version+"/images/"},{"../package.json":6,"./config":7,"./feature_layer":8,"./feedback":9,"./geocoder":11,"./geocoder_control":12,"./grid_control":14,"./grid_layer":15,"./legend_control":16,"./map":18,"./marker":21,"./share_control":23,"./simplestyle":24,"./style_layer":25,"./tile_layer":26,mustache:3,"sanitize-caja":4}],20:[function(a,b,c){"use strict";var d=L.Control.extend({options:{position:"bottomleft"},initialize:function(a){L.setOptions(this,a)},onAdd:function(){return this._container=L.DomUtil.create("div","mapbox-logo"),this._container},_setTileJSON:function(a){a.mapbox_logo&&L.DomUtil.addClass(this._container,"mapbox-logo-true")}});b.exports.MapboxLogoControl=d,b.exports.mapboxLogoControl=function(a){return new d(a)}},{}],21:[function(a,b,c){"use strict";function d(a,b){a=a||{};var c={small:[20,50],medium:[30,70],large:[35,90]},d=a["marker-size"]||"medium",e="marker-symbol"in a&&""!==a["marker-symbol"]?"-"+a["marker-symbol"]:"",f=(a["marker-color"]||"7e7e7e").replace("#","");return L.icon({iconUrl:g("/v4/marker/pin-"+d.charAt(0)+e+"+"+f+(L.Browser.retina?"@2x":"")+".png",b&&b.accessToken),iconSize:c[d],iconAnchor:[c[d][0]/2,c[d][1]/2],popupAnchor:[0,-c[d][1]/2]})}function e(a,b,c){return L.marker(b,{icon:d(a.properties,c),title:h.strip_tags(i(a.properties&&a.properties.title||""))})}function f(a,b){if(!a||!a.properties)return"";var c="";return a.properties.title&&(c+='<div class="marker-title">'+a.properties.title+"</div>"),a.properties.description&&(c+='<div class="marker-description">'+a.properties.description+"</div>"),(b||i)(c)}var g=a("./format_url"),h=a("./util"),i=a("sanitize-caja");b.exports={icon:d,style:e,createPopup:f}},{"./format_url":10,"./util":27,"sanitize-caja":4}],22:[function(a,b,c){"use strict";var d=a("corslite"),e=a("./util").strict,f=a("./config"),g=/^(https?:)?(?=\/\/(.|api)\.tiles\.mapbox\.com\/)/;b.exports=function(a,b){function c(a,c){!a&&c&&(c=JSON.parse(c.responseText)),b(a,c)}return e(a,"string"),e(b,"function"),a=a.replace(g,function(a,b){return"withCredentials"in new window.XMLHttpRequest?"https:"===b||"https:"===document.location.protocol||f.FORCE_HTTPS?"https:":"http:":document.location.protocol}),d(a,c)}},{"./config":7,"./util":27,corslite:1}],23:[function(a,b,c){"use strict";var d=a("./format_url"),e=L.Control.extend({includes:[a("./load_tilejson")],options:{position:"topleft",url:""},initialize:function(a,b){L.setOptions(this,b),this._loadTileJSON(a)},_setTileJSON:function(a){this._tilejson=a},onAdd:function(a){this._map=a;var b=L.DomUtil.create("div","leaflet-control-mapbox-share leaflet-bar"),c=L.DomUtil.create("a","mapbox-share mapbox-icon mapbox-icon-share",b);return c.href="#",this._modal=L.DomUtil.create("div","mapbox-modal",this._map._container),this._mask=L.DomUtil.create("div","mapbox-modal-mask",this._modal),this._content=L.DomUtil.create("div","mapbox-modal-content",this._modal),L.DomEvent.addListener(c,"click",this._shareClick,this),L.DomEvent.disableClickPropagation(b),this._map.on("mousedown",this._clickOut,this),b},_clickOut:function(a){if(this._sharing)return L.DomEvent.preventDefault(a),L.DomUtil.removeClass(this._modal,"active"),this._content.innerHTML="",void(this._sharing=null)},_shareClick:function(a){function b(a,b,c){var d=document.createElement("a");return d.setAttribute("class",a),d.setAttribute("href",b),d.setAttribute("target","_blank"),c=document.createTextNode(c),d.appendChild(c),d}if(L.DomEvent.stop(a),this._sharing)return this._clickOut(a);var c=this._tilejson||this._map._tilejson||{},e=encodeURIComponent(this.options.url||c.webpage||window.location),f=encodeURIComponent(c.name),g=d("/v4/"+c.id+"/"+this._map.getCenter().lng+","+this._map.getCenter().lat+","+this._map.getZoom()+"/600x600.png",this.options.accessToken),h=d("/v4/"+c.id+".html",this.options.accessToken),i="//twitter.com/intent/tweet?status="+f+" "+e,j="//www.facebook.com/sharer.php?u="+e+"&t="+f,k="//www.pinterest.com/pin/create/button/?url="+e+"&media="+g+"&description="+f,l='<iframe width="100%" height="500px" frameBorder="0" src="'+h+'"></iframe>';L.DomUtil.addClass(this._modal,"active"),this._sharing=L.DomUtil.create("div","mapbox-modal-body",this._content);var m=b("mapbox-button mapbox-button-icon mapbox-icon-twitter",i,"Twitter"),n=b("mapbox-button mapbox-button-icon mapbox-icon-facebook",j,"Facebook"),o=b("mapbox-button mapbox-button-icon mapbox-icon-pinterest",k,"Pinterest"),p=document.createElement("h3"),q=document.createTextNode("Share this map");p.appendChild(q);var r=document.createElement("div");r.setAttribute("class","mapbox-share-buttons"),r.appendChild(n),r.appendChild(m),r.appendChild(o),this._sharing.appendChild(p),this._sharing.appendChild(r);var s=L.DomUtil.create("input","mapbox-embed",this._sharing);s.type="text",s.value=l,L.DomUtil.create("label","mapbox-embed-description",this._sharing).innerHTML="Copy and paste this <strong>HTML code</strong> into documents to embed this map on web pages.";var t=L.DomUtil.create("a","leaflet-popup-close-button",this._sharing);t.href="#",L.DomEvent.disableClickPropagation(this._sharing),L.DomEvent.addListener(t,"click",this._clickOut,this),L.DomEvent.addListener(s,"click",function(a){a.target.focus(),a.target.select()})}});b.exports.ShareControl=e,b.exports.shareControl=function(a,b){return new e(a,b)}},{"./format_url":10,"./load_tilejson":17}],24:[function(a,b,c){"use strict";function d(a,b){var c={};for(var d in b)void 0===a[d]?c[d]=b[d]:c[d]=a[d];return c}function e(a){for(var b={},c=0;c<h.length;c++)b[h[c][1]]=a[h[c][0]];return b}function f(a){return e(d(a.properties||{},g))}var g={stroke:"#555555","stroke-width":2,"stroke-opacity":1,fill:"#555555","fill-opacity":.5},h=[["stroke","color"],["stroke-width","weight"],["stroke-opacity","opacity"],["fill","fillColor"],["fill-opacity","fillOpacity"]];b.exports={style:f,defaults:g}},{}],25:[function(a,b,c){"use strict";var d=a("./util"),e=a("./format_url"),f=a("./request"),g=L.TileLayer.extend({options:{sanitizer:a("sanitize-caja")},initialize:function(a,b){L.TileLayer.prototype.initialize.call(this,void 0,L.extend({},b,{tileSize:512,zoomOffset:-1,minNativeZoom:0,tms:!1})),this._url=this._formatTileURL(a),this._getAttribution(a)},_getAttribution:function(a){var b=e.style(a,this.options&&this.options.accessToken);f(b,L.bind(function(c,g){c&&(d.log("could not load Mapbox style at "+b),this.fire("error",{error:c}));var h=[];for(var i in g.sources){var j=g.sources[i].url.split("mapbox://")[1];h.push(j)}f(e.tileJSON(h.join(),this.options.accessToken),L.bind(function(b,c){b?(d.log("could not load TileJSON at "+a),this.fire("error",{error:b})):c&&(d.strict(c,"object"),this.options.attribution=this.options.sanitizer(c.attribution),this._tilejson=c,this.fire("ready"))},this))},this))},setUrl:null,_formatTileURL:function(a){if("string"==typeof a){-1===a.indexOf("mapbox://styles/")&&(d.log("Incorrectly formatted Mapbox style at "+a),this.fire("error"));var b=a.split("mapbox://styles/")[1];return e("/styles/v1/"+b+"/tiles/{z}/{x}/{y}{r}",this.options.accessToken)}if("object"==typeof a)return e("/styles/v1/"+a.owner+"/"+a.id+"/tiles/{z}/{x}/{y}{r}",this.options.accessToken)}});b.exports.StyleLayer=g,b.exports.styleLayer=function(a,b){return new g(a,b)}},{"./format_url":10,"./request":22,"./util":27,"sanitize-caja":4}],26:[function(a,b,c){"use strict";var d=a("./util"),e=/\.((?:png|jpg)\d*)(?=$|\?)/,f=L.TileLayer.extend({includes:[a("./load_tilejson")],options:{sanitizer:a("sanitize-caja")},formats:["png","jpg","png32","png64","png128","png256","jpg70","jpg80","jpg90"],scalePrefix:"@2x.",initialize:function(a,b){L.TileLayer.prototype.initialize.call(this,void 0,b),this._tilejson={},b&&b.format&&d.strict_oneof(b.format,this.formats),this._loadTileJSON(a)},setFormat:function(a){return d.strict(a,"string"),this.options.format=a,this.redraw(),this},setUrl:null,_setTileJSON:function(a){if(d.strict(a,"object"),!this.options.format){var b=a.tiles[0].match(e);b&&(this.options.format=b[1])}return L.extend(this.options,{tiles:a.tiles,attribution:this.options.sanitizer(a.attribution),minZoom:a.minzoom||0,maxZoom:a.maxzoom||18,tms:"tms"===a.scheme,bounds:a.bounds&&d.lbounds(a.bounds)}),this._tilejson=a,this.redraw(),this},getTileJSON:function(){return this._tilejson},getTileUrl:function(a){var b=this.options.tiles,c=Math.floor(Math.abs(a.x+a.y)%b.length),d=b[c],f=L.Util.template(d,a);return f&&this.options.format?f.replace(e,(L.Browser.retina?this.scalePrefix:".")+this.options.format):f},_update:function(){this.options.tiles&&L.TileLayer.prototype._update.call(this)}});b.exports.TileLayer=f,b.exports.tileLayer=function(a,b){return new f(a,b)}},{"./load_tilejson":17,"./util":27,"sanitize-caja":4}],27:[function(a,b,c){"use strict";function d(a,b){if(!b||!b.length)return!1;for(var c=0;c<b.length;c++)if(b[c]===a)return!0;return!1}b.exports={idUrl:function(a,b){-1===a.indexOf("/")?b.loadID(a):b.loadURL(a)},log:function(a){"object"==typeof console&&"function"==typeof console.error&&console.error(a)},strict:function(a,b){if(typeof a!==b)throw new Error("Invalid argument: "+b+" expected")},strict_instance:function(a,b,c){if(!(a instanceof b))throw new Error("Invalid argument: "+c+" expected")},strict_oneof:function(a,b){if(!d(a,b))throw new Error("Invalid argument: "+a+" given, valid values are "+b.join(", "))},strip_tags:function(a){return a.replace(/<[^<]+>/g,"")},lbounds:function(a){return new L.LatLngBounds([[a[1],a[0]],[a[3],a[2]]])}}},{}]},{},[19]),function(a,b){"object"==typeof exports&&"undefined"!=typeof module?module.exports=b():"function"==typeof define&&define.amd?define(b):(a=a||self,a.mapboxgl=b())}(this,function(){"use strict";function a(a,e){if(b)if(c){var f="var sharedChunk = {}; ("+b+")(sharedChunk); ("+c+")(sharedChunk);",g={};b(g),d=e(g),d.workerUrl=window.URL.createObjectURL(new Blob([f],{type:"text/javascript"}))}else c=e;else b=e}var b,c,d;return a(["exports"],function(a){function b(a,b){return a(b={exports:{}},b.exports),b.exports}function c(a,b,c,d){this.cx=3*a,this.bx=3*(c-a)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*b,this.by=3*(d-b)-this.cy,this.ay=1-this.cy-this.by,this.p1x=a,this.p1y=d,this.p2x=c,this.p2y=d}function d(a,b){this.x=a,this.y=b}function e(a,b){if(Array.isArray(a)){if(!Array.isArray(b)||a.length!==b.length)return!1;for(var c=0;c<a.length;c++)if(!e(a[c],b[c]))return!1;return!0}if("object"==typeof a&&null!==a&&null!==b){if("object"!=typeof b)return!1;if(Object.keys(a).length!==Object.keys(b).length)return!1;for(var d in a)if(!e(a[d],b[d]))return!1;return!0}return a===b}function f(a,b,c,d){var e=new qd(a,b,c,d);return function(a){return e.solve(a)}}function g(a,b,c){return Math.min(c,Math.max(b,a))}function h(a,b,c){var d=c-b,e=((a-b)%d+d)%d+b;return e===b?c:e}function i(a){for(var b=[],c=arguments.length-1;c-- >0;)b[c]=arguments[c+1];for(var d=0,e=b;d<e.length;d+=1){var f=e[d];for(var g in f)a[g]=f[g]}return a}function j(){return vd++}function k(){return function a(b){return b?(b^16*Math.random()>>b/4).toString(16):([1e7]+-[1e3]+-4e3+-8e3+-1e11).replace(/[018]/g,a)}()}function l(a){return!!a&&/^[0-9a-f]{8}-[0-9a-f]{4}-[4][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(a)}function m(a,b){a.forEach(function(a){b[a]&&(b[a]=b[a].bind(b))})}function n(a,b){return-1!==a.indexOf(b,a.length-b.length)}function o(a,b,c){var d={};for(var e in a)d[e]=b.call(c||this,a[e],e,a);return d}function p(a,b,c){var d={};for(var e in a)b.call(c||this,a[e],e,a)&&(d[e]=a[e]);return d}function q(a){return Array.isArray(a)?a.map(q):"object"==typeof a&&a?o(a,q):a}function r(a){wd[a]||("undefined"!=typeof console&&console.warn(a),wd[a]=!0)}function s(a,b,c){return(c.y-a.y)*(b.x-a.x)>(b.y-a.y)*(c.x-a.x)}function t(a){for(var b=0,c=0,d=a.length,e=d-1,f=void 0,g=void 0;c<d;e=c++)f=a[c],b+=((g=a[e]).x-f.x)*(f.y+g.y);return b}function u(a){try{var b=self[a];return b.setItem("_mapbox_test_",1),b.removeItem("_mapbox_test_"),!0}catch(a){return!1}}function v(a){var b=a.createTexture();a.bindTexture(a.TEXTURE_2D,b);try{if(a.texImage2D(a.TEXTURE_2D,0,a.RGBA,a.RGBA,a.UNSIGNED_BYTE,td),a.isContextLost())return;Cd.supported=!0}catch(a){}a.deleteTexture(b),Dd=!0}function w(a,b){var c=z(Bd.API_URL);if(a.protocol=c.protocol,a.authority=c.authority,"/"!==c.path&&(a.path=""+c.path+a.path),!Bd.REQUIRE_ACCESS_TOKEN)return A(a);if(!(b=b||Bd.ACCESS_TOKEN))throw new Error("An API access token is required to use Mapbox GL. "+Fd);if("s"===b[0])throw new Error("Use a public access token (pk.*) with Mapbox GL, not a secret access token (sk.*). "+Fd);return a.params.push("access_token="+b),A(a)}function x(a){return 0===a.indexOf("mapbox:")}function y(a){return Gd.test(a)}function z(a){var b=a.match(Kd);if(!b)throw new Error("Unable to parse URL object");return{protocol:b[1],authority:b[2],path:b[3]||"/",params:b[4]?b[4].split("&"):[]}}function A(a){var b=a.params.length?"?"+a.params.join("&"):"";return a.protocol+"://"+a.authority+a.path+b}function B(a){if(!a)return null;var b,c=a.split(".");if(!c||3!==c.length)return null;try{return JSON.parse((b=c[1],decodeURIComponent(self.atob(b).split("").map(function(a){return"%"+("00"+a.charCodeAt(0).toString(16)).slice(-2)}).join(""))))}catch(a){return null}}function C(){return"undefined"!=typeof WorkerGlobalScope&&"undefined"!=typeof self&&self instanceof WorkerGlobalScope}function D(a,b,c){c[a]&&-1!==c[a].indexOf(b)||(c[a]=c[a]||[],c[a].push(b))}function E(a,b,c){if(c&&c[a]){var d=c[a].indexOf(b);-1!==d&&c[a].splice(d,1)}}function F(a){var b=a.key,c=a.value;return c?[new ce(b,c,"constants have been deprecated as of v8")]:[]}function G(a){for(var b=[],c=arguments.length-1;c-- >0;)b[c]=arguments[c+1];for(var d=0,e=b;d<e.length;d+=1){var f=e[d];for(var g in f)a[g]=f[g]}return a}function H(a){return a instanceof Number||a instanceof String||a instanceof Boolean?a.valueOf():a}function I(a){return Array.isArray(a)?a.map(I):H(a)}function J(a,b){return{kind:"array",itemType:a,N:b}}function K(a){if("array"===a.kind){var b=K(a.itemType);return"number"==typeof a.N?"array<"+b+", "+a.N+">":"value"===a.itemType.kind?"array":"array<"+b+">"}return a.kind}function L(a,b){if("error"===b.kind)return null;if("array"===a.kind){if("array"===b.kind&&(0===b.N&&"value"===b.itemType.kind||!L(a.itemType,b.itemType))&&("number"!=typeof a.N||a.N===b.N))return null}else{if(a.kind===b.kind)return null;if("value"===a.kind)for(var c=0,d=oe;c<d.length;c+=1)if(!L(d[c],b))return null}return"Expected "+K(a)+" but found "+K(b)+" instead."}function M(a,b,c,d){return"number"==typeof a&&a>=0&&a<=255&&"number"==typeof b&&b>=0&&b<=255&&"number"==typeof c&&c>=0&&c<=255?void 0===d||"number"==typeof d&&d>=0&&d<=1?null:"Invalid rgba value ["+[a,b,c,d].join(", ")+"]: 'a' must be between 0 and 1.":"Invalid rgba value ["+("number"==typeof d?[a,b,c,d]:[a,b,c]).join(", ")+"]: 'r', 'g', and 'b' must be between 0 and 255."}function N(a){if(null===a)return fe;if("string"==typeof a)return he;if("boolean"==typeof a)return ie;if("number"==typeof a)return ge;if(a instanceof qe)return je;if(a instanceof re)return me;if(a instanceof te)return ne;if(Array.isArray(a)){for(var b,c=a.length,d=0,e=a;d<e.length;d+=1){var f=N(e[d]);if(b){if(b===f)continue;b=le;break}b=f}return J(b||le,c)}return ke}function O(a){var b=typeof a;return null===a?"":"string"===b||"number"===b||"boolean"===b?String(a):a instanceof qe||a instanceof te?a.toString():JSON.stringify(a)}function P(a){if(a instanceof De){if("get"===a.name&&1===a.args.length)return!1;if("feature-state"===a.name)return!1;if("has"===a.name&&1===a.args.length)return!1;if("properties"===a.name||"geometry-type"===a.name||"id"===a.name)return!1;if(/^filter-/.test(a.name))return!1}var b=!0;return a.eachChild(function(a){b&&!P(a)&&(b=!1)}),b}function Q(a){if(a instanceof De&&"feature-state"===a.name)return!1;var b=!0;return a.eachChild(function(a){b&&!Q(a)&&(b=!1)}),b}function R(a,b){if(a instanceof De&&b.indexOf(a.name)>=0)return!1;var c=!0;return a.eachChild(function(a){c&&!R(a,b)&&(c=!1)}),c}function S(a,b){for(var c,d,e=0,f=a.length-1,g=0;e<=f;){if(c=a[g=Math.floor((e+f)/2)],d=a[g+1],b===c||b>c&&b<d)return g;if(c<b)e=g+1;else{if(!(c>b))throw new ve("Input is not a number.");f=g-1}}return Math.max(g-1,0)}function T(a,b,c){return a*(1-c)+b*c}function U(a){return a>Pe?Math.pow(a,1/3):a/Oe+Me}function V(a){return a>Ne?a*a*a:Oe*(a-Me)}function W(a){return 255*(a<=.0031308?12.92*a:1.055*Math.pow(a,1/2.4)-.055)}function X(a){return(a/=255)<=.04045?a/12.92:Math.pow((a+.055)/1.055,2.4)}function Y(a){var b=X(a.r),c=X(a.g),d=X(a.b),e=U((.4124564*b+.3575761*c+.1804375*d)/Je),f=U((.2126729*b+.7151522*c+.072175*d)/Ke);return{l:116*f-16,a:500*(e-f),b:200*(f-U((.0193339*b+.119192*c+.9503041*d)/Le)),alpha:a.a}}function Z(a){var b=(a.l+16)/116,c=isNaN(a.a)?b:b+a.a/500,d=isNaN(a.b)?b:b-a.b/200;return b=Ke*V(b),c=Je*V(c),d=Le*V(d),new qe(W(3.2404542*c-1.5371385*b-.4985314*d),W(-.969266*c+1.8760108*b+.041556*d),W(.0556434*c-.2040259*b+1.0572252*d),a.alpha)}function $(a,b,c){var d=b-a;return a+c*(d>180||d<-180?d-360*Math.round(d/360):d)}function _(a,b,c,d){var e=d-c,f=a-c;return 0===e?0:1===b?f/e:(Math.pow(b,f)-1)/(Math.pow(b,e)-1)}function aa(a,b){return"=="===a||"!="===a?"boolean"===b.kind||"string"===b.kind||"number"===b.kind||"null"===b.kind||"value"===b.kind:"string"===b.kind||"number"===b.kind||"value"===b.kind}function ba(a,b,c,d){return 0===d.compare(b,c)}function ca(a,b,c){var d="=="!==a&&"!="!==a;return function(){function e(a,b,c){this.type=ie,this.lhs=a,this.rhs=b,this.collator=c,this.hasUntypedArgument="value"===a.type.kind||"value"===b.type.kind}return e.parse=function(a,b){if(3!==a.length&&4!==a.length)return b.error("Expected two or three arguments.");var c=a[0],f=b.parse(a[1],1,le);if(!f)return null;if(!aa(c,f.type))return b.concat(1).error('"'+c+"\" comparisons are not supported for type '"+K(f.type)+"'.");var g=b.parse(a[2],2,le);if(!g)return null;if(!aa(c,g.type))return b.concat(2).error('"'+c+"\" comparisons are not supported for type '"+K(g.type)+"'.");if(f.type.kind!==g.type.kind&&"value"!==f.type.kind&&"value"!==g.type.kind)return b.error("Cannot compare types '"+K(f.type)+"' and '"+K(g.type)+"'.");d&&("value"===f.type.kind&&"value"!==g.type.kind?f=new xe(g.type,[f]):"value"!==f.type.kind&&"value"===g.type.kind&&(g=new xe(f.type,[g])));var h=null;if(4===a.length){if("string"!==f.type.kind&&"string"!==g.type.kind&&"value"!==f.type.kind&&"value"!==g.type.kind)return b.error("Cannot use collator to compare non-string types.");if(!(h=b.parse(a[3],3,me)))return null}return new e(f,g,h)},e.prototype.evaluate=function(e){var f=this.lhs.evaluate(e),g=this.rhs.evaluate(e)
;if(d&&this.hasUntypedArgument){var h=N(f),i=N(g);if(h.kind!==i.kind||"string"!==h.kind&&"number"!==h.kind)throw new ve('Expected arguments for "'+a+'" to be (string, string) or (number, number), but found ('+h.kind+", "+i.kind+") instead.")}if(this.collator&&!d&&this.hasUntypedArgument){var j=N(f),k=N(g);if("string"!==j.kind||"string"!==k.kind)return b(e,f,g)}return this.collator?c(e,f,g,this.collator.evaluate(e)):b(e,f,g)},e.prototype.eachChild=function(a){a(this.lhs),a(this.rhs),this.collator&&a(this.collator)},e.prototype.possibleOutputs=function(){return[!0,!1]},e.prototype.serialize=function(){var b=[a];return this.eachChild(function(a){b.push(a.serialize())}),b},e}()}function da(a,b){var c=b[0],d=b[1],e=b[2],f=b[3];c=c.evaluate(a),d=d.evaluate(a),e=e.evaluate(a);var g=f?f.evaluate(a):1,h=M(c,d,e,g);if(h)throw new ve(h);return new qe(c/255*g,d/255*g,e/255*g,g)}function ea(a,b){return a in b}function fa(a,b){var c=b[a];return void 0===c?null:c}function ga(a){return{type:a}}function ha(a){return{result:"success",value:a}}function ia(a){return{result:"error",value:a}}function ja(a){return"data-driven"===a["property-type"]||"cross-faded-data-driven"===a["property-type"]}function ka(a){return!!a.expression&&a.expression.parameters.indexOf("zoom")>-1}function la(a){return!!a.expression&&a.expression.interpolated}function ma(a){return a instanceof Number?"number":a instanceof String?"string":a instanceof Boolean?"boolean":Array.isArray(a)?"array":null===a?"null":typeof a}function na(a){return"object"==typeof a&&null!==a&&!Array.isArray(a)}function oa(a){return a}function pa(a,b,c){return void 0!==a?a:void 0!==b?b:void 0!==c?c:void 0}function qa(a,b,c,d,e){return pa(typeof c===e?d[c]:void 0,a.default,b.default)}function ra(a,b,c){if("number"!==ma(c))return pa(a.default,b.default);var d=a.stops.length;if(1===d)return a.stops[0][1];if(c<=a.stops[0][0])return a.stops[0][1];if(c>=a.stops[d-1][0])return a.stops[d-1][1];var e=ua(a.stops,c);return a.stops[e][1]}function sa(a,b,c){var d=void 0!==a.base?a.base:1;if("number"!==ma(c))return pa(a.default,b.default);var e=a.stops.length;if(1===e)return a.stops[0][1];if(c<=a.stops[0][0])return a.stops[0][1];if(c>=a.stops[e-1][0])return a.stops[e-1][1];var f=ua(a.stops,c),g=function(a,b,c,d){var e=d-c,f=a-c;return 0===e?0:1===b?f/e:(Math.pow(b,f)-1)/(Math.pow(b,e)-1)}(c,d,a.stops[f][0],a.stops[f+1][0]),h=a.stops[f][1],i=a.stops[f+1][1],j=Ie[b.type]||oa;if(a.colorSpace&&"rgb"!==a.colorSpace){var k=Ue[a.colorSpace];j=function(a,b){return k.reverse(k.interpolate(k.forward(a),k.forward(b),g))}}return"function"==typeof h.evaluate?{evaluate:function(){for(var a=[],b=arguments.length;b--;)a[b]=arguments[b];var c=h.evaluate.apply(void 0,a),d=i.evaluate.apply(void 0,a);if(void 0!==c&&void 0!==d)return j(c,d,g)}}:j(h,i,g)}function ta(a,b,c){return"color"===b.type?c=qe.parse(c):"formatted"===b.type?c=te.fromString(c.toString()):ma(c)===b.type||"enum"===b.type&&b.values[c]||(c=void 0),pa(c,a.default,b.default)}function ua(a,b){for(var c,d,e=0,f=a.length-1,g=0;e<=f;){if(c=a[g=Math.floor((e+f)/2)][0],d=a[g+1][0],b===c||b>c&&b<d)return g;c<b?e=g+1:c>b&&(f=g-1)}return Math.max(g-1,0)}function va(a){return Array.isArray(a)&&a.length>0&&"string"==typeof a[0]&&a[0]in hf}function wa(a,b){var c=new Ge(hf,[],b?function(a){var b={color:je,string:he,number:ge,enum:he,boolean:ie,formatted:ne};return"array"===a.type?J(b[a.value]||le,a.length):b[a.type]}(b):void 0),d=c.parse(a,void 0,void 0,void 0,b&&"string"===b.type?{typeAnnotation:"coerce"}:void 0);return d?ha(new jf(d,b)):ia(c.errors)}function xa(a,b){if("error"===(a=wa(a,b)).result)return a;var c=a.value.expression,d=P(c);if(!d&&!ja(b))return ia([new de("","data expressions not supported")]);var e=R(c,["zoom"]);if(!e&&!ka(b))return ia([new de("","zoom expressions not supported")]);var f=function a(b){var c=null;if(b instanceof Xe)c=a(b.result);else if(b instanceof We)for(var d=0,e=b.args;d<e.length;d+=1){var f=e[d];if(c=a(f))break}else(b instanceof He||b instanceof Ve)&&b.input instanceof De&&"zoom"===b.input.name&&(c=b);return c instanceof de?c:(b.eachChild(function(b){var d=a(b);d instanceof de?c=d:!c&&d?c=new de("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):c&&d&&c!==d&&(c=new de("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),c)}(c);return f||e?f instanceof de?ia([f]):f instanceof Ve&&!la(b)?ia([new de("",'"interpolate" expressions cannot be used with this property')]):ha(f?new lf(d?"camera":"composite",a.value,f):new kf(d?"constant":"source",a.value)):ia([new de("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}function ya(a,b){if(na(a))return new mf(a,b);if(va(a)){var c=xa(a,b);if("error"===c.result)throw new Error(c.value.map(function(a){return a.key+": "+a.message}).join(", "));return c.value}var d=a;return"string"==typeof a&&"color"===b.type&&(d=qe.parse(a)),{kind:"constant",evaluate:function(){return d}}}function za(a){var b=a.key,c=a.value,d=a.valueSpec||{},e=a.objectElementValidators||{},f=a.style,g=a.styleSpec,h=[],i=ma(c);if("object"!==i)return[new ce(b,c,"object expected, "+i+" found")];for(var j in c){var k=j.split(".")[0],l=d[k]||d["*"],m=void 0;if(e[k])m=e[k];else if(d[k])m=Va;else if(e["*"])m=e["*"];else{if(!d["*"]){h.push(new ce(b,c[j],'unknown property "'+j+'"'));continue}m=Va}h=h.concat(m({key:(b?b+".":b)+j,value:c[j],valueSpec:l,style:f,styleSpec:g,object:c,objectKey:j},c))}for(var n in d)e[n]||d[n].required&&void 0===d[n].default&&void 0===c[n]&&h.push(new ce(b,c,'missing required property "'+n+'"'));return h}function Aa(a){var b=a.value,c=a.valueSpec,d=a.style,e=a.styleSpec,f=a.key,g=a.arrayElementValidator||Va;if("array"!==ma(b))return[new ce(f,b,"array expected, "+ma(b)+" found")];if(c.length&&b.length!==c.length)return[new ce(f,b,"array length "+c.length+" expected, length "+b.length+" found")];if(c["min-length"]&&b.length<c["min-length"])return[new ce(f,b,"array length at least "+c["min-length"]+" expected, length "+b.length+" found")];var h={type:c.value};e.$version<7&&(h.function=c.function),"object"===ma(c.value)&&(h=c.value);for(var i=[],j=0;j<b.length;j++)i=i.concat(g({array:b,arrayIndex:j,value:b[j],valueSpec:h,style:d,styleSpec:e,key:f+"["+j+"]"}));return i}function Ba(a){var b=a.key,c=a.value,d=a.valueSpec,e=ma(c);return"number"!==e?[new ce(b,c,"number expected, "+e+" found")]:"minimum"in d&&c<d.minimum?[new ce(b,c,c+" is less than the minimum value "+d.minimum)]:"maximum"in d&&c>d.maximum?[new ce(b,c,c+" is greater than the maximum value "+d.maximum)]:[]}function Ca(a){function b(a){var b=[],d=a.value,h=a.key;if("array"!==ma(d))return[new ce(h,d,"array expected, "+ma(d)+" found")];if(2!==d.length)return[new ce(h,d,"array length 2 expected, length "+d.length+" found")];if(l){if("object"!==ma(d[0]))return[new ce(h,d,"object expected, "+ma(d[0])+" found")];if(void 0===d[0].zoom)return[new ce(h,d,"object stop key must have zoom")];if(void 0===d[0].value)return[new ce(h,d,"object stop key must have value")];if(f&&f>H(d[0].zoom))return[new ce(h,d[0].zoom,"stop zoom values must appear in ascending order")];H(d[0].zoom)!==f&&(f=H(d[0].zoom),e=void 0,i={}),b=b.concat(za({key:h+"[0]",value:d[0],valueSpec:{zoom:{}},style:a.style,styleSpec:a.styleSpec,objectElementValidators:{zoom:Ba,value:c}}))}else b=b.concat(c({key:h+"[0]",value:d[0],valueSpec:{},style:a.style,styleSpec:a.styleSpec},d));return va(I(d[1]))?b.concat([new ce(h+"[1]",d[1],"expressions are not allowed in function stops.")]):b.concat(Va({key:h+"[1]",value:d[1],valueSpec:g,style:a.style,styleSpec:a.styleSpec}))}function c(a,b){var c=ma(a.value),f=H(a.value),j=null!==a.value?a.value:b;if(d){if(c!==d)return[new ce(a.key,j,c+" stop domain type must match previous stop domain type "+d)]}else d=c;if("number"!==c&&"string"!==c&&"boolean"!==c)return[new ce(a.key,j,"stop domain value must be a number, string, or boolean")];if("number"!==c&&"categorical"!==h){var k="number expected, "+c+" found";return ja(g)&&void 0===h&&(k+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new ce(a.key,j,k)]}return"categorical"!==h||"number"!==c||isFinite(f)&&Math.floor(f)===f?"categorical"!==h&&"number"===c&&void 0!==e&&f<e?[new ce(a.key,j,"stop domain values must appear in ascending order")]:(e=f,"categorical"===h&&f in i?[new ce(a.key,j,"stop domain values must be unique")]:(i[f]=!0,[])):[new ce(a.key,j,"integer expected, found "+f)]}var d,e,f,g=a.valueSpec,h=H(a.value.type),i={},j="categorical"!==h&&void 0===a.value.property,k=!j,l="array"===ma(a.value.stops)&&"array"===ma(a.value.stops[0])&&"object"===ma(a.value.stops[0][0]),m=za({key:a.key,value:a.value,valueSpec:a.styleSpec.function,style:a.style,styleSpec:a.styleSpec,objectElementValidators:{stops:function(a){if("identity"===h)return[new ce(a.key,a.value,'identity function may not have a "stops" property')];var c=[],d=a.value;return c=c.concat(Aa({key:a.key,value:d,valueSpec:a.valueSpec,style:a.style,styleSpec:a.styleSpec,arrayElementValidator:b})),"array"===ma(d)&&0===d.length&&c.push(new ce(a.key,d,"array must have at least one stop")),c},default:function(a){return Va({key:a.key,value:a.value,valueSpec:g,style:a.style,styleSpec:a.styleSpec})}}});return"identity"===h&&j&&m.push(new ce(a.key,a.value,'missing required property "property"')),"identity"===h||a.value.stops||m.push(new ce(a.key,a.value,'missing required property "stops"')),"exponential"===h&&a.valueSpec.expression&&!la(a.valueSpec)&&m.push(new ce(a.key,a.value,"exponential functions not supported")),a.styleSpec.$version>=8&&(k&&!ja(a.valueSpec)?m.push(new ce(a.key,a.value,"property functions not supported")):j&&!ka(a.valueSpec)&&m.push(new ce(a.key,a.value,"zoom functions not supported"))),"categorical"!==h&&!l||void 0!==a.value.property||m.push(new ce(a.key,a.value,'"property" property is required')),m}function Da(a){var b=("property"===a.expressionContext?xa:wa)(I(a.value),a.valueSpec);if("error"===b.result)return b.value.map(function(b){return new ce(""+a.key+b.key,a.value,b.message)});var c=b.value.expression||b.value._styleExpression.expression;if("property"===a.expressionContext&&"text-font"===a.propertyKey&&-1!==c.possibleOutputs().indexOf(void 0))return[new ce(a.key,a.value,'Invalid data expression for "'+a.propertyKey+'". Output values must be contained as literals within the expression.')];if("property"===a.expressionContext&&"layout"===a.propertyType&&!Q(c))return[new ce(a.key,a.value,'"feature-state" data expressions are not supported with layout properties.')];if("filter"===a.expressionContext&&!Q(c))return[new ce(a.key,a.value,'"feature-state" data expressions are not supported with filters.')];if(a.expressionContext&&0===a.expressionContext.indexOf("cluster")){if(!R(c,["zoom","feature-state"]))return[new ce(a.key,a.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if("cluster-initial"===a.expressionContext&&!P(c))return[new ce(a.key,a.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function Ea(a){var b=a.key,c=a.value,d=a.valueSpec,e=[];return Array.isArray(d.values)?-1===d.values.indexOf(H(c))&&e.push(new ce(b,c,"expected one of ["+d.values.join(", ")+"], "+JSON.stringify(c)+" found")):-1===Object.keys(d.values).indexOf(H(c))&&e.push(new ce(b,c,"expected one of ["+Object.keys(d.values).join(", ")+"], "+JSON.stringify(c)+" found")),e}function Fa(a){if(!0===a||!1===a)return!0;if(!Array.isArray(a)||0===a.length)return!1;switch(a[0]){case"has":return a.length>=2&&"$id"!==a[1]&&"$type"!==a[1];case"in":case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return 3!==a.length||Array.isArray(a[1])||Array.isArray(a[2]);case"any":case"all":for(var b=0,c=a.slice(1);b<c.length;b+=1){var d=c[b];if(!Fa(d)&&"boolean"!=typeof d)return!1}return!0;default:return!0}}function Ga(a){if(null==a)return function(){return!0};Fa(a)||(a=Ia(a));var b=wa(a,nf);if("error"===b.result)throw new Error(b.value.map(function(a){return a.key+": "+a.message}).join(", "));return function(a,c){return b.value.evaluate(a,c)}}function Ha(a,b){return a<b?-1:a>b?1:0}function Ia(a){if(!a)return!0;var b,c=a[0];return a.length<=1?"any"!==c:"=="===c?Ja(a[1],a[2],"=="):"!="===c?Ma(Ja(a[1],a[2],"==")):"<"===c||">"===c||"<="===c||">="===c?Ja(a[1],a[2],c):"any"===c?(b=a.slice(1),["any"].concat(b.map(Ia))):"all"===c?["all"].concat(a.slice(1).map(Ia)):"none"===c?["all"].concat(a.slice(1).map(Ia).map(Ma)):"in"===c?Ka(a[1],a.slice(2)):"!in"===c?Ma(Ka(a[1],a.slice(2))):"has"===c?La(a[1]):"!has"!==c||Ma(La(a[1]))}function Ja(a,b,c){switch(a){case"$type":return["filter-type-"+c,b];case"$id":return["filter-id-"+c,b];default:return["filter-"+c,a,b]}}function Ka(a,b){if(0===b.length)return!1;switch(a){case"$type":return["filter-type-in",["literal",b]];case"$id":return["filter-id-in",["literal",b]];default:return b.length>200&&!b.some(function(a){return typeof a!=typeof b[0]})?["filter-in-large",a,["literal",b.sort(Ha)]]:["filter-in-small",a,["literal",b]]}}function La(a){switch(a){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",a]}}function Ma(a){return["!",a]}function Na(a){return Fa(I(a.value))?Da(G({},a,{expressionContext:"filter",valueSpec:{value:"boolean"}})):function a(b){var c=b.value,d=b.key;if("array"!==ma(c))return[new ce(d,c,"array expected, "+ma(c)+" found")];var e,f=b.styleSpec,g=[];if(c.length<1)return[new ce(d,c,"filter array must have at least 1 element")];switch(g=g.concat(Ea({key:d+"[0]",value:c[0],valueSpec:f.filter_operator,style:b.style,styleSpec:b.styleSpec})),H(c[0])){case"<":case"<=":case">":case">=":c.length>=2&&"$type"===H(c[1])&&g.push(new ce(d,c,'"$type" cannot be use with operator "'+c[0]+'"'));case"==":case"!=":3!==c.length&&g.push(new ce(d,c,'filter array for operator "'+c[0]+'" must have 3 elements'));case"in":case"!in":c.length>=2&&"string"!==(e=ma(c[1]))&&g.push(new ce(d+"[1]",c[1],"string expected, "+e+" found"));for(var h=2;h<c.length;h++)e=ma(c[h]),"$type"===H(c[1])?g=g.concat(Ea({key:d+"["+h+"]",value:c[h],valueSpec:f.geometry_type,style:b.style,styleSpec:b.styleSpec})):"string"!==e&&"number"!==e&&"boolean"!==e&&g.push(new ce(d+"["+h+"]",c[h],"string, number, or boolean expected, "+e+" found"));break;case"any":case"all":case"none":for(var i=1;i<c.length;i++)g=g.concat(a({key:d+"["+i+"]",value:c[i],style:b.style,styleSpec:b.styleSpec}));break;case"has":case"!has":e=ma(c[1]),2!==c.length?g.push(new ce(d,c,'filter array for "'+c[0]+'" operator must have 2 elements')):"string"!==e&&g.push(new ce(d+"[1]",c[1],"string expected, "+e+" found"))}return g}(a)}function Oa(a,b){var c=a.key,d=a.style,e=a.styleSpec,f=a.value,g=a.objectKey,h=e[b+"_"+a.layerType];if(!h)return[];var i=g.match(/^(.*)-transition$/);if("paint"===b&&i&&h[i[1]]&&h[i[1]].transition)return Va({key:c,value:f,valueSpec:e.transition,style:d,styleSpec:e});var j,k=a.valueSpec||h[g];if(!k)return[new ce(c,f,'unknown property "'+g+'"')];if("string"===ma(f)&&ja(k)&&!k.tokens&&(j=/^{([^}]+)}$/.exec(f)))return[new ce(c,f,'"'+g+'" does not support interpolation syntax\nUse an identity property function instead: `{ "type": "identity", "property": '+JSON.stringify(j[1])+" }`.")];var l=[];return"symbol"===a.layerType&&("text-field"===g&&d&&!d.glyphs&&l.push(new ce(c,f,'use of "text-field" requires a style "glyphs" property')),"text-font"===g&&na(I(f))&&"identity"===H(f.type)&&l.push(new ce(c,f,'"text-font" does not support identity functions'))),l.concat(Va({key:a.key,value:f,valueSpec:k,style:d,styleSpec:e,expressionContext:"property",propertyType:b,propertyKey:g}))}function Pa(a){return Oa(a,"paint")}function Qa(a){return Oa(a,"layout")}function Ra(a){var b=[],c=a.value,d=a.key,e=a.style,f=a.styleSpec;c.type||c.ref||b.push(new ce(d,c,'either "type" or "ref" is required'));var g,h=H(c.type),i=H(c.ref);if(c.id)for(var j=H(c.id),k=0;k<a.arrayIndex;k++){var l=e.layers[k];H(l.id)===j&&b.push(new ce(d,c.id,'duplicate layer id "'+c.id+'", previously used at line '+l.id.__line__))}if("ref"in c)["type","source","source-layer","filter","layout"].forEach(function(a){a in c&&b.push(new ce(d,c[a],'"'+a+'" is prohibited for ref layers'))}),e.layers.forEach(function(a){H(a.id)===i&&(g=a)}),g?g.ref?b.push(new ce(d,c.ref,"ref cannot reference another ref layer")):h=H(g.type):b.push(new ce(d,c.ref,'ref layer "'+i+'" not found'));else if("background"!==h)if(c.source){var m=e.sources&&e.sources[c.source],n=m&&H(m.type);m?"vector"===n&&"raster"===h?b.push(new ce(d,c.source,'layer "'+c.id+'" requires a raster source')):"raster"===n&&"raster"!==h?b.push(new ce(d,c.source,'layer "'+c.id+'" requires a vector source')):"vector"!==n||c["source-layer"]?"raster-dem"===n&&"hillshade"!==h?b.push(new ce(d,c.source,"raster-dem source can only be used with layer type 'hillshade'.")):"line"!==h||!c.paint||!c.paint["line-gradient"]||"geojson"===n&&m.lineMetrics||b.push(new ce(d,c,'layer "'+c.id+'" specifies a line-gradient, which requires a GeoJSON source with `lineMetrics` enabled.')):b.push(new ce(d,c,'layer "'+c.id+'" must specify a "source-layer"')):b.push(new ce(d,c.source,'source "'+c.source+'" not found'))}else b.push(new ce(d,c,'missing required property "source"'));return b=b.concat(za({key:d,value:c,valueSpec:f.layer,style:a.style,styleSpec:a.styleSpec,objectElementValidators:{"*":function(){return[]},type:function(){return Va({key:d+".type",value:c.type,valueSpec:f.layer.type,style:a.style,styleSpec:a.styleSpec,object:c,objectKey:"type"})},filter:Na,layout:function(a){return za({layer:c,key:a.key,value:a.value,style:a.style,styleSpec:a.styleSpec,objectElementValidators:{"*":function(a){return Qa(G({layerType:h},a))}}})},paint:function(a){return za({layer:c,key:a.key,value:a.value,style:a.style,styleSpec:a.styleSpec,objectElementValidators:{"*":function(a){return Pa(G({layerType:h},a))}}})}}}))}function Sa(a){var b=a.value,c=a.key,d=a.styleSpec,e=a.style;if(!b.type)return[new ce(c,b,'"type" is required')];var f,g=H(b.type);switch(g){case"vector":case"raster":case"raster-dem":if(f=za({key:c,value:b,valueSpec:d["source_"+g.replace("-","_")],style:a.style,styleSpec:d}),"url"in b)for(var h in b)["type","url","tileSize"].indexOf(h)<0&&f.push(new ce(c+"."+h,b[h],'a source with a "url" property may not include a "'+h+'" property'));return f;case"geojson":if(f=za({key:c,value:b,valueSpec:d.source_geojson,style:e,styleSpec:d}),b.cluster)for(var i in b.clusterProperties){var j=b.clusterProperties[i],k=j[0],l=j[1],m="string"==typeof k?[k,["accumulated"],["get",i]]:k;f.push.apply(f,Da({key:c+"."+i+".map",value:l,expressionContext:"cluster-map"})),f.push.apply(f,Da({key:c+"."+i+".reduce",value:m,expressionContext:"cluster-reduce"}))}return f;case"video":return za({key:c,value:b,valueSpec:d.source_video,style:e,styleSpec:d});case"image":return za({key:c,value:b,valueSpec:d.source_image,style:e,styleSpec:d});case"canvas":return[new ce(c,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return Ea({key:c+".type",value:b.type,valueSpec:{values:["vector","raster","raster-dem","geojson","video","image"]},style:e,styleSpec:d})}}function Ta(a){var b=a.value,c=a.styleSpec,d=c.light,e=a.style,f=[],g=ma(b);if(void 0===b)return f;if("object"!==g)return f=f.concat([new ce("light",b,"object expected, "+g+" found")]);for(var h in b){var i=h.match(/^(.*)-transition$/);f=i&&d[i[1]]&&d[i[1]].transition?f.concat(Va({key:h,value:b[h],valueSpec:c.transition,style:e,styleSpec:c})):d[h]?f.concat(Va({key:h,value:b[h],valueSpec:d[h],style:e,styleSpec:c})):f.concat([new ce(h,b[h],'unknown property "'+h+'"')])}return f}function Ua(a){var b=a.value,c=a.key,d=ma(b);return"string"!==d?[new ce(c,b,"string expected, "+d+" found")]:[]}function Va(a){var b=a.value,c=a.valueSpec,d=a.styleSpec;return c.expression&&na(H(b))?Ca(a):c.expression&&va(I(b))?Da(a):c.type&&of[c.type]?of[c.type](a):za(G({},a,{valueSpec:c.type?d[c.type]:c}))}function Wa(a){var b=a.value,c=a.key,d=Ua(a);return d.length?d:(-1===b.indexOf("{fontstack}")&&d.push(new ce(c,b,'"glyphs" url must include a "{fontstack}" token')),-1===b.indexOf("{range}")&&d.push(new ce(c,b,'"glyphs" url must include a "{range}" token')),d)}function Xa(a,b){b=b||be;var c=[];return c=c.concat(Va({key:"",value:a,valueSpec:b.$root,styleSpec:b,style:a,objectElementValidators:{glyphs:Wa,"*":function(){return[]}}})),a.constants&&(c=c.concat(F({key:"constants",value:a.constants,style:a,styleSpec:b}))),Ya(c)}function Ya(a){return[].concat(a).sort(function(a,b){return a.line-b.line})}function Za(a){return function(){for(var b=[],c=arguments.length;c--;)b[c]=arguments[c];return Ya(a.apply(this,b))}}function $a(a,b){var c=!1;if(b&&b.length)for(var d=0,e=b;d<e.length;d+=1){var f=e[d];a.fire(new _d(new Error(f.message))),c=!0}return c}function _a(a,b,c){var d=this.cells=[];if(a instanceof ArrayBuffer){this.arrayBuffer=a;var e=new Int32Array(this.arrayBuffer);a=e[0],b=e[1],c=e[2],this.d=b+2*c;for(var f=0;f<this.d*this.d;f++){var g=e[uf+f],h=e[uf+f+1];d.push(g===h?null:e.subarray(g,h))}var i=e[uf+d.length],j=e[uf+d.length+1];this.keys=e.subarray(i,j),this.bboxes=e.subarray(j),this.insert=this._insertReadonly}else{this.d=b+2*c;for(var k=0;k<this.d*this.d;k++)d.push([]);this.keys=[],this.bboxes=[]}this.n=b,this.extent=a,this.padding=c,this.scale=b/a,this.uid=0;var l=c/b*a;this.min=-l,this.max=a+l}function ab(a,b,c){void 0===c&&(c={}),Object.defineProperty(b,"_classRegistryKey",{value:a,writeable:!1}),wf[a]={klass:b,omit:c.omit||[],shallow:c.shallow||[]}}function bb(a,b){if(null==a||"boolean"==typeof a||"number"==typeof a||"string"==typeof a||a instanceof Boolean||a instanceof Number||a instanceof String||a instanceof Date||a instanceof RegExp)return a;if(a instanceof ArrayBuffer)return b&&b.push(a),a;if(ArrayBuffer.isView(a)){var c=a;return b&&b.push(c.buffer),c}if(a instanceof vf)return b&&b.push(a.data.buffer),a;if(Array.isArray(a)){for(var d=[],e=0,f=a;e<f.length;e+=1){var g=f[e];d.push(bb(g,b))}return d}if("object"==typeof a){var h=a.constructor,i=h._classRegistryKey;if(!i)throw new Error("can't serialize object of unregistered class");var j=h.serialize?h.serialize(a,b):{};if(!h.serialize){for(var k in a)if(a.hasOwnProperty(k)&&!(wf[i].omit.indexOf(k)>=0)){var l=a[k];j[k]=wf[i].shallow.indexOf(k)>=0?l:bb(l,b)}a instanceof Error&&(j.message=a.message)}if(j.$name)throw new Error("$name property is reserved for worker serialization logic.");return"Object"!==i&&(j.$name=i),j}throw new Error("can't serialize object of type "+typeof a)}function cb(a){if(null==a||"boolean"==typeof a||"number"==typeof a||"string"==typeof a||a instanceof Boolean||a instanceof Number||a instanceof String||a instanceof Date||a instanceof RegExp||a instanceof ArrayBuffer||ArrayBuffer.isView(a)||a instanceof vf)return a;if(Array.isArray(a))return a.map(cb);if("object"==typeof a){var b=a.$name||"Object",c=wf[b].klass;if(!c)throw new Error("can't deserialize unregistered class "+b);if(c.deserialize)return c.deserialize(a);for(var d=Object.create(c.prototype),e=0,f=Object.keys(a);e<f.length;e+=1){var g=f[e];if("$name"!==g){var h=a[g];d[g]=wf[b].shallow.indexOf(g)>=0?h:cb(h)}}return d}throw new Error("can't deserialize object of type "+typeof a)}function db(a){for(var b=0,c=a;b<c.length;b+=1)if(fb(c[b].charCodeAt(0)))return!0;return!1}function eb(a){return!(Af.Arabic(a)||Af["Arabic Supplement"](a)||Af["Arabic Extended-A"](a)||Af["Arabic Presentation Forms-A"](a)||Af["Arabic Presentation Forms-B"](a))}function fb(a){return!!(746===a||747===a||!(a<4352)&&(Af["Bopomofo Extended"](a)||Af.Bopomofo(a)||Af["CJK Compatibility Forms"](a)&&!(a>=65097&&a<=65103)||Af["CJK Compatibility Ideographs"](a)||Af["CJK Compatibility"](a)||Af["CJK Radicals Supplement"](a)||Af["CJK Strokes"](a)||!(!Af["CJK Symbols and Punctuation"](a)||a>=12296&&a<=12305||a>=12308&&a<=12319||12336===a)||Af["CJK Unified Ideographs Extension A"](a)||Af["CJK Unified Ideographs"](a)||Af["Enclosed CJK Letters and Months"](a)||Af["Hangul Compatibility Jamo"](a)||Af["Hangul Jamo Extended-A"](a)||Af["Hangul Jamo Extended-B"](a)||Af["Hangul Jamo"](a)||Af["Hangul Syllables"](a)||Af.Hiragana(a)||Af["Ideographic Description Characters"](a)||Af.Kanbun(a)||Af["Kangxi Radicals"](a)||Af["Katakana Phonetic Extensions"](a)||Af.Katakana(a)&&12540!==a||!(!Af["Halfwidth and Fullwidth Forms"](a)||65288===a||65289===a||65293===a||a>=65306&&a<=65310||65339===a||65341===a||65343===a||a>=65371&&a<=65503||65507===a||a>=65512&&a<=65519)||!(!Af["Small Form Variants"](a)||a>=65112&&a<=65118||a>=65123&&a<=65126)||Af["Unified Canadian Aboriginal Syllabics"](a)||Af["Unified Canadian Aboriginal Syllabics Extended"](a)||Af["Vertical Forms"](a)||Af["Yijing Hexagram Symbols"](a)||Af["Yi Syllables"](a)||Af["Yi Radicals"](a)))}function gb(a){return!(fb(a)||function(a){return!!(Af["Latin-1 Supplement"](a)&&(167===a||169===a||174===a||177===a||188===a||189===a||190===a||215===a||247===a)||Af["General Punctuation"](a)&&(8214===a||8224===a||8225===a||8240===a||8241===a||8251===a||8252===a||8258===a||8263===a||8264===a||8265===a||8273===a)||Af["Letterlike Symbols"](a)||Af["Number Forms"](a)||Af["Miscellaneous Technical"](a)&&(a>=8960&&a<=8967||a>=8972&&a<=8991||a>=8996&&a<=9e3||9003===a||a>=9085&&a<=9114||a>=9150&&a<=9165||9167===a||a>=9169&&a<=9179||a>=9186&&a<=9215)||Af["Control Pictures"](a)&&9251!==a||Af["Optical Character Recognition"](a)||Af["Enclosed Alphanumerics"](a)||Af["Geometric Shapes"](a)||Af["Miscellaneous Symbols"](a)&&!(a>=9754&&a<=9759)||Af["Miscellaneous Symbols and Arrows"](a)&&(a>=11026&&a<=11055||a>=11088&&a<=11097||a>=11192&&a<=11243)||Af["CJK Symbols and Punctuation"](a)||Af.Katakana(a)||Af["Private Use Area"](a)||Af["CJK Compatibility Forms"](a)||Af["Small Form Variants"](a)||Af["Halfwidth and Fullwidth Forms"](a)||8734===a||8756===a||8757===a||a>=9984&&a<=10087||a>=10102&&a<=10131||65532===a||65533===a)}(a))}function hb(a,b){return!(!b&&(a>=1424&&a<=2303||Af["Arabic Presentation Forms-A"](a)||Af["Arabic Presentation Forms-B"](a))||a>=2304&&a<=3583||a>=3840&&a<=4255||Af.Khmer(a))}function ib(a,b){void 0===b&&(b=1);var c=0,d=0;return{members:a.map(function(a){var e,f=(e=a.type,Wf[e].BYTES_PER_ELEMENT),g=c=jb(c,Math.max(b,f)),h=a.components||1;return d=Math.max(d,f),c+=f*h,{name:a.name,type:a.type,components:h,offset:g}}),size:jb(c,Math.max(d,b)),alignment:b}}function jb(a,b){return Math.ceil(a/b)*b}function kb(a,b){return 256*(a=g(Math.floor(a),0,255))+(b=g(Math.floor(b),0,255))}function lb(a,b,c){var d=a[b];a[b]=a[c],a[c]=d}function mb(a){return[kb(255*a.r,255*a.g),kb(255*a.b,255*a.a)]}function nb(a,b){return{"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern_to","pattern_from"],"fill-pattern":["pattern_to","pattern_from"],"fill-extrusion-pattern":["pattern_to","pattern_from"]}[a]||[a.replace(b+"-","").replace(/-/g,"_")]}function ob(a,b,c){var d={color:{source:qg,composite:rg},number:{source:kg,composite:qg}},e=function(a){return{"line-pattern":{source:bg,composite:bg},"fill-pattern":{source:bg,composite:bg},"fill-extrusion-pattern":{source:bg,composite:bg}}[a]}(a);return e&&e[c]||d[b][c]}function pb(a){for(var b=Zg/a.extent,c=a.loadGeometry(),d=0;d<c.length;d++)for(var e=c[d],f=0;f<e.length;f++){var g=e[f];g.x=Math.round(g.x*b),g.y=Math.round(g.y*b),(g.x<$g.min||g.x>$g.max||g.y<$g.min||g.y>$g.max)&&r("Geometry exceeds allowed extent, reduce your vector tile buffer size")}return c}function qb(a,b,c,d,e){a.emplaceBack(2*b+(d+1)/2,2*c+(e+1)/2)}function rb(a,b){for(var c=0;c<a.length;c++)if(Ab(b,a[c]))return!0;for(var d=0;d<b.length;d++)if(Ab(a,b[d]))return!0;return!!vb(a,b)}function sb(a,b,c){return!!Ab(a,b)||!!xb(b,a,c)}function tb(a,b){if(1===a.length)return zb(b,a[0]);for(var c=0;c<b.length;c++)for(var d=b[c],e=0;e<d.length;e++)if(Ab(a,d[e]))return!0;for(var f=0;f<a.length;f++)if(zb(b,a[f]))return!0;for(var g=0;g<b.length;g++)if(vb(a,b[g]))return!0;return!1}function ub(a,b,c){if(a.length>1){if(vb(a,b))return!0;for(var d=0;d<b.length;d++)if(xb(b[d],a,c))return!0}for(var e=0;e<a.length;e++)if(xb(a[e],b,c))return!0;return!1}function vb(a,b){if(0===a.length||0===b.length)return!1;for(var c=0;c<a.length-1;c++)for(var d=a[c],e=a[c+1],f=0;f<b.length-1;f++)if(wb(d,e,b[f],b[f+1]))return!0;return!1}function wb(a,b,c,d){return s(a,c,d)!==s(b,c,d)&&s(a,b,c)!==s(a,b,d)}function xb(a,b,c){var d=c*c;if(1===b.length)return a.distSqr(b[0])<d;for(var e=1;e<b.length;e++)if(yb(a,b[e-1],b[e])<d)return!0;return!1}function yb(a,b,c){var d=b.distSqr(c);if(0===d)return a.distSqr(b);var e=((a.x-b.x)*(c.x-b.x)+(a.y-b.y)*(c.y-b.y))/d;return e<0?a.distSqr(b):e>1?a.distSqr(c):a.distSqr(c.sub(b)._mult(e)._add(b))}function zb(a,b){for(var c,d,e,f=!1,g=0;g<a.length;g++)for(var h=0,i=(c=a[g]).length-1;h<c.length;i=h++)d=c[h],e=c[i],d.y>b.y!=e.y>b.y&&b.x<(e.x-d.x)*(b.y-d.y)/(e.y-d.y)+d.x&&(f=!f);return f}function Ab(a,b){for(var c=!1,d=0,e=a.length-1;d<a.length;e=d++){var f=a[d],g=a[e];f.y>b.y!=g.y>b.y&&b.x<(g.x-f.x)*(b.y-f.y)/(g.y-f.y)+f.x&&(c=!c)}return c}function Bb(a,b,c){var d=c[0],e=c[2];if(a.x<d.x&&b.x<d.x||a.x>e.x&&b.x>e.x||a.y<d.y&&b.y<d.y||a.y>e.y&&b.y>e.y)return!1;var f=s(a,b,c[0]);return f!==s(a,b,c[1])||f!==s(a,b,c[2])||f!==s(a,b,c[3])}function Cb(a,b,c){var d=b.paint.get(a).value;return"constant"===d.kind?d.value:c.programConfigurations.get(b.id).binders[a].maxValue}function Db(a){return Math.sqrt(a[0]*a[0]+a[1]*a[1])}function Eb(a,b,c,d,e){if(!b[0]&&!b[1])return a;var f=rd.convert(b)._mult(e);"viewport"===c&&f._rotate(-d);for(var g=[],h=0;h<a.length;h++){var i=a[h];g.push(i.sub(f))}return g}function Fb(){var a=new bh(9);return bh!=Float32Array&&(a[1]=0,a[2]=0,a[3]=0,a[5]=0,a[6]=0,a[7]=0),a[0]=1,a[4]=1,a[8]=1,a}function Gb(){var a=new bh(3);return bh!=Float32Array&&(a[0]=0,a[1]=0,a[2]=0),a}function Hb(a,b,c){var d=new bh(3);return d[0]=a,d[1]=b,d[2]=c,d}function Ib(a,b,c){var d=b[0],e=b[1],f=b[2],g=b[3];return a[0]=c[0]*d+c[4]*e+c[8]*f+c[12]*g,a[1]=c[1]*d+c[5]*e+c[9]*f+c[13]*g,a[2]=c[2]*d+c[6]*e+c[10]*f+c[14]*g,a[3]=c[3]*d+c[7]*e+c[11]*f+c[15]*g,a}function Jb(){var a=new bh(4);return bh!=Float32Array&&(a[0]=0,a[1]=0,a[2]=0),a[3]=1,a}function Kb(a,b){var c=Ib([],[a.x,a.y,0,1],b);return new rd(c[0]/c[3],c[1]/c[3])}function Lb(a,b,c,d){var e=b.width,f=b.height;if(d){if(d.length!==e*f*c)throw new RangeError("mismatched image size")}else d=new Uint8Array(e*f*c);return a.width=e,a.height=f,a.data=d,a}function Mb(a,b,c){var d=b.width,e=b.height;if(d!==a.width||e!==a.height){var f=Lb({},{width:d,height:e},c);Nb(a,f,{x:0,y:0},{x:0,y:0},{width:Math.min(a.width,d),height:Math.min(a.height,e)},c),a.width=d,a.height=e,a.data=f.data}}function Nb(a,b,c,d,e,f){if(0===e.width||0===e.height)return b;if(e.width>a.width||e.height>a.height||c.x>a.width-e.width||c.y>a.height-e.height)throw new RangeError("out of range source coordinates for image copy");if(e.width>b.width||e.height>b.height||d.x>b.width-e.width||d.y>b.height-e.height)throw new RangeError("out of range destination coordinates for image copy");for(var g=a.data,h=b.data,i=0;i<e.height;i++)for(var j=((c.y+i)*a.width+c.x)*f,k=((d.y+i)*b.width+d.x)*f,l=0;l<e.width*f;l++)h[k+l]=g[j+l];return b}function Ob(a,b){for(var c=new Uint8Array(1024),d={},e=0,f=0;e<256;e++,f+=4){d[b]=e/255;var g=a.evaluate(d);c[f+0]=Math.floor(255*g.r/g.a),c[f+1]=Math.floor(255*g.g/g.a),c[f+2]=Math.floor(255*g.b/g.a),c[f+3]=Math.floor(255*g.a)}return new fh({width:256,height:1},c)}function Pb(a,b,c){c=c||2;var d,e,f,g,h,i,j,k=b&&b.length,l=k?b[0]*c:a.length,m=Qb(a,0,l,c,!0),n=[];if(!m||m.next===m.prev)return n;if(k&&(m=function(a,b,c,d){var e,f,g,h,i,j=[];for(e=0,f=b.length;e<f;e++)g=b[e]*d,
h=e<f-1?b[e+1]*d:a.length,(i=Qb(a,g,h,d,!1))===i.next&&(i.steiner=!0),j.push($b(i));for(j.sort(Xb),e=0;e<j.length;e++)Yb(j[e],c),c=Rb(c,c.next);return c}(a,b,m,c)),a.length>80*c){d=f=a[0],e=g=a[1];for(var o=c;o<l;o+=c)(h=a[o])<d&&(d=h),(i=a[o+1])<e&&(e=i),h>f&&(f=h),i>g&&(g=i);j=0!==(j=Math.max(f-d,g-e))?1/j:0}return Sb(m,n,c,d,e,j),n}function Qb(a,b,c,d,e){var f,g;if(e===jc(a,b,c,d)>0)for(f=b;f<c;f+=d)g=gc(f,a[f],a[f+1],g);else for(f=c-d;f>=b;f-=d)g=gc(f,a[f],a[f+1],g);return g&&cc(g,g.next)&&(hc(g),g=g.next),g}function Rb(a,b){if(!a)return a;b||(b=a);var c,d=a;do{if(c=!1,d.steiner||!cc(d,d.next)&&0!==bc(d.prev,d,d.next))d=d.next;else{if(hc(d),(d=b=d.prev)===d.next)break;c=!0}}while(c||d!==b);return b}function Sb(a,b,c,d,e,f,g){if(a){!g&&f&&function(a,b,c,d){var e=a;do{null===e.z&&(e.z=Zb(e.x,e.y,b,c,d)),e.prevZ=e.prev,e.nextZ=e.next,e=e.next}while(e!==a);e.prevZ.nextZ=null,e.prevZ=null,function(a){var b,c,d,e,f,g,h,i,j=1;do{for(c=a,a=null,f=null,g=0;c;){for(g++,d=c,h=0,b=0;b<j&&(h++,d=d.nextZ);b++);for(i=j;h>0||i>0&&d;)0!==h&&(0===i||!d||c.z<=d.z)?(e=c,c=c.nextZ,h--):(e=d,d=d.nextZ,i--),f?f.nextZ=e:a=e,e.prevZ=f,f=e;c=d}f.nextZ=null,j*=2}while(g>1)}(e)}(a,d,e,f);for(var h,i,j=a;a.prev!==a.next;)if(h=a.prev,i=a.next,f?Ub(a,d,e,f):Tb(a))b.push(h.i/c),b.push(a.i/c),b.push(i.i/c),hc(a),a=i.next,j=i.next;else if((a=i)===j){g?1===g?Sb(a=Vb(a,b,c),b,c,d,e,f,2):2===g&&Wb(a,b,c,d,e,f):Sb(Rb(a),b,c,d,e,f,1);break}}}function Tb(a){var b=a.prev,c=a,d=a.next;if(bc(b,c,d)>=0)return!1;for(var e=a.next.next;e!==a.prev;){if(_b(b.x,b.y,c.x,c.y,d.x,d.y,e.x,e.y)&&bc(e.prev,e,e.next)>=0)return!1;e=e.next}return!0}function Ub(a,b,c,d){var e=a.prev,f=a,g=a.next;if(bc(e,f,g)>=0)return!1;for(var h=e.x<f.x?e.x<g.x?e.x:g.x:f.x<g.x?f.x:g.x,i=e.y<f.y?e.y<g.y?e.y:g.y:f.y<g.y?f.y:g.y,j=e.x>f.x?e.x>g.x?e.x:g.x:f.x>g.x?f.x:g.x,k=e.y>f.y?e.y>g.y?e.y:g.y:f.y>g.y?f.y:g.y,l=Zb(h,i,b,c,d),m=Zb(j,k,b,c,d),n=a.prevZ,o=a.nextZ;n&&n.z>=l&&o&&o.z<=m;){if(n!==a.prev&&n!==a.next&&_b(e.x,e.y,f.x,f.y,g.x,g.y,n.x,n.y)&&bc(n.prev,n,n.next)>=0)return!1;if(n=n.prevZ,o!==a.prev&&o!==a.next&&_b(e.x,e.y,f.x,f.y,g.x,g.y,o.x,o.y)&&bc(o.prev,o,o.next)>=0)return!1;o=o.nextZ}for(;n&&n.z>=l;){if(n!==a.prev&&n!==a.next&&_b(e.x,e.y,f.x,f.y,g.x,g.y,n.x,n.y)&&bc(n.prev,n,n.next)>=0)return!1;n=n.prevZ}for(;o&&o.z<=m;){if(o!==a.prev&&o!==a.next&&_b(e.x,e.y,f.x,f.y,g.x,g.y,o.x,o.y)&&bc(o.prev,o,o.next)>=0)return!1;o=o.nextZ}return!0}function Vb(a,b,c){var d=a;do{var e=d.prev,f=d.next.next;!cc(e,f)&&dc(e,d,d.next,f)&&ec(e,f)&&ec(f,e)&&(b.push(e.i/c),b.push(d.i/c),b.push(f.i/c),hc(d),hc(d.next),d=a=f),d=d.next}while(d!==a);return d}function Wb(a,b,c,d,e,f){var g=a;do{for(var h=g.next.next;h!==g.prev;){if(g.i!==h.i&&ac(g,h)){var i=fc(g,h);return g=Rb(g,g.next),i=Rb(i,i.next),Sb(g,b,c,d,e,f),void Sb(i,b,c,d,e,f)}h=h.next}g=g.next}while(g!==a)}function Xb(a,b){return a.x-b.x}function Yb(a,b){if(b=function(a,b){var c,d=b,e=a.x,f=a.y,g=-1/0;do{if(f<=d.y&&f>=d.next.y&&d.next.y!==d.y){var h=d.x+(f-d.y)*(d.next.x-d.x)/(d.next.y-d.y);if(h<=e&&h>g){if(g=h,h===e){if(f===d.y)return d;if(f===d.next.y)return d.next}c=d.x<d.next.x?d:d.next}}d=d.next}while(d!==b);if(!c)return null;if(e===g)return c.prev;var i,j=c,k=c.x,l=c.y,m=1/0;for(d=c.next;d!==j;)e>=d.x&&d.x>=k&&e!==d.x&&_b(f<l?e:g,f,k,l,f<l?g:e,f,d.x,d.y)&&((i=Math.abs(f-d.y)/(e-d.x))<m||i===m&&d.x>c.x)&&ec(d,a)&&(c=d,m=i),d=d.next;return c}(a,b)){var c=fc(b,a);Rb(c,c.next)}}function Zb(a,b,c,d,e){return(a=1431655765&((a=858993459&((a=252645135&((a=16711935&((a=32767*(a-c)*e)|a<<8))|a<<4))|a<<2))|a<<1))|(b=1431655765&((b=858993459&((b=252645135&((b=16711935&((b=32767*(b-d)*e)|b<<8))|b<<4))|b<<2))|b<<1))<<1}function $b(a){var b=a,c=a;do{(b.x<c.x||b.x===c.x&&b.y<c.y)&&(c=b),b=b.next}while(b!==a);return c}function _b(a,b,c,d,e,f,g,h){return(e-g)*(b-h)-(a-g)*(f-h)>=0&&(a-g)*(d-h)-(c-g)*(b-h)>=0&&(c-g)*(f-h)-(e-g)*(d-h)>=0}function ac(a,b){return a.next.i!==b.i&&a.prev.i!==b.i&&!function(a,b){var c=a;do{if(c.i!==a.i&&c.next.i!==a.i&&c.i!==b.i&&c.next.i!==b.i&&dc(c,c.next,a,b))return!0;c=c.next}while(c!==a);return!1}(a,b)&&ec(a,b)&&ec(b,a)&&function(a,b){var c=a,d=!1,e=(a.x+b.x)/2,f=(a.y+b.y)/2;do{c.y>f!=c.next.y>f&&c.next.y!==c.y&&e<(c.next.x-c.x)*(f-c.y)/(c.next.y-c.y)+c.x&&(d=!d),c=c.next}while(c!==a);return d}(a,b)}function bc(a,b,c){return(b.y-a.y)*(c.x-b.x)-(b.x-a.x)*(c.y-b.y)}function cc(a,b){return a.x===b.x&&a.y===b.y}function dc(a,b,c,d){return!!(cc(a,b)&&cc(c,d)||cc(a,d)&&cc(c,b))||bc(a,b,c)>0!=bc(a,b,d)>0&&bc(c,d,a)>0!=bc(c,d,b)>0}function ec(a,b){return bc(a.prev,a,a.next)<0?bc(a,b,a.next)>=0&&bc(a,a.prev,b)>=0:bc(a,b,a.prev)<0||bc(a,a.next,b)<0}function fc(a,b){var c=new ic(a.i,a.x,a.y),d=new ic(b.i,b.x,b.y),e=a.next,f=b.prev;return a.next=b,b.prev=a,c.next=e,e.prev=c,d.next=c,c.prev=d,f.next=d,d.prev=f,d}function gc(a,b,c,d){var e=new ic(a,b,c);return d?(e.next=d.next,e.prev=d,d.next.prev=e,d.next=e):(e.prev=e,e.next=e),e}function hc(a){a.next.prev=a.prev,a.prev.next=a.next,a.prevZ&&(a.prevZ.nextZ=a.nextZ),a.nextZ&&(a.nextZ.prevZ=a.prevZ)}function ic(a,b,c){this.i=a,this.x=b,this.y=c,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function jc(a,b,c,d){for(var e=0,f=b,g=c-d;f<c;f+=d)e+=(a[g]-a[f])*(a[f+1]+a[g+1]),g=f;return e}function kc(a,b,c,d,e){!function a(b,c,d,e,f){for(;e>d;){if(e-d>600){var g=e-d+1,h=c-d+1,i=Math.log(g),j=.5*Math.exp(2*i/3),k=.5*Math.sqrt(i*j*(g-j)/g)*(h-g/2<0?-1:1);a(b,c,Math.max(d,Math.floor(c-h*j/g+k)),Math.min(e,Math.floor(c+(g-h)*j/g+k)),f)}var l=b[c],m=d,n=e;for(lc(b,d,c),f(b[e],l)>0&&lc(b,d,e);m<n;){for(lc(b,m,n),m++,n--;f(b[m],l)<0;)m++;for(;f(b[n],l)>0;)n--}0===f(b[d],l)?lc(b,d,n):lc(b,++n,e),n<=c&&(d=n+1),c<=n&&(e=n-1)}}(a,b,c||0,d||a.length-1,e||mc)}function lc(a,b,c){var d=a[b];a[b]=a[c],a[c]=d}function mc(a,b){return a<b?-1:a>b?1:0}function nc(a,b){var c=a.length;if(c<=1)return[a];for(var d,e,f=[],g=0;g<c;g++){var h=t(a[g]);0!==h&&(a[g].area=Math.abs(h),void 0===e&&(e=h<0),e===h<0?(d&&f.push(d),d=[a[g]]):d.push(a[g]))}if(d&&f.push(d),b>1)for(var i=0;i<f.length;i++)f[i].length<=b||(kc(f[i],b,1,f[i].length-1,oc),f[i]=f[i].slice(0,b));return f}function oc(a,b){return b.area-a.area}function pc(a,b,c){for(var d=c.patternDependencies,e=!1,f=0,g=b;f<g.length;f+=1){var h=g[f].paint.get(a+"-pattern");h.isConstant()||(e=!0);var i=h.constantOr(null);i&&(e=!0,d[i.to]=!0,d[i.from]=!0)}return e}function qc(a,b,c,d,e){for(var f=e.patternDependencies,g=0,h=b;g<h.length;g+=1){var i=h[g],j=i.paint.get(a+"-pattern").value;if("constant"!==j.kind){var k=j.evaluate({zoom:d-1},c,{}),l=j.evaluate({zoom:d},c,{}),m=j.evaluate({zoom:d+1},c,{});f[k]=!0,f[l]=!0,f[m]=!0,c.patterns[i.id]={min:k,mid:l,max:m}}}return c}function rc(a,b,c,d,e,f,g,h){a.emplaceBack(b,c,2*Math.floor(d*th)+g,e*th*2,f*th*2,Math.round(h))}function sc(a,b){return a.x===b.x&&(a.x<0||a.x>Zg)||a.y===b.y&&(a.y<0||a.y>Zg)}function tc(a){return a.every(function(a){return a.x<0})||a.every(function(a){return a.x>Zg})||a.every(function(a){return a.y<0})||a.every(function(a){return a.y>Zg})}function uc(a,b){return a.x*b.x+a.y*b.y}function vc(a,b){if(1===a.length){var c=b[0],d=b[1],e=b[3],f=a[0],g=d.sub(c),h=e.sub(c),i=f.sub(c),j=uc(g,g),k=uc(g,h),l=uc(h,h),m=uc(i,g),n=uc(i,h),o=j*l-k*k,p=(l*m-k*n)/o,q=(j*n-k*m)/o,r=1-p-q;return c.z*r+d.z*p+e.z*q}for(var s=1/0,t=0,u=b;t<u.length;t+=1){var v=u[t];s=Math.min(s,v.z)}return s}function wc(a,b,c,d,e){this.properties={},this.extent=c,this.type=0,this._pbf=a,this._geometry=-1,this._keys=d,this._values=e,a.readFields(xc,this,b)}function xc(a,b,c){1==a?b.id=c.readVarint():2==a?function(a,b){for(var c=a.readVarint()+a.pos;a.pos<c;){var d=b._keys[a.readVarint()],e=b._values[a.readVarint()];b.properties[d]=e}}(c,b):3==a?b.type=c.readVarint():4==a&&(b._geometry=c.pos)}function yc(a){for(var b,c,d=0,e=0,f=a.length,g=f-1;e<f;g=e++)b=a[e],d+=((c=a[g]).x-b.x)*(b.y+c.y);return d}function zc(a,b){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=a,this._keys=[],this._values=[],this._features=[],a.readFields(Ac,this,b),this.length=this._features.length}function Ac(a,b,c){15===a?b.version=c.readVarint():1===a?b.name=c.readString():5===a?b.extent=c.readVarint():2===a?b._features.push(c.pos):3===a?b._keys.push(c.readString()):4===a&&b._values.push(function(a){for(var b=null,c=a.readVarint()+a.pos;a.pos<c;){var d=a.readVarint()>>3;b=1===d?a.readString():2===d?a.readFloat():3===d?a.readDouble():4===d?a.readVarint64():5===d?a.readVarint():6===d?a.readSVarint():7===d?a.readBoolean():null}return b}(c))}function Bc(a,b,c){if(3===a){var d=new Ah(c,c.readVarint()+c.pos);d.length&&(b[d.name]=d)}}function Cc(a,b,c,d,e,f,g){a.emplaceBack(b.x,b.y,d?1:0,e?1:-1,Math.round(Dh*c.x)+128,Math.round(Dh*c.y)+128,1+(0===f?0:f<0?-1:1)|(g*Fh&63)<<2,g*Fh>>6)}function Dc(a,b){return(a/b.tileTotal*(b.end-b.start)+b.start)*(Gh-1)}function Ec(a,b){return b>0?b+2*a:a}function Fc(a,b,c){return a.sections.forEach(function(a){a.text=function(a,b,c){var d=b.layout.get("text-transform").evaluate(c,{});return"uppercase"===d?a=a.toLocaleUpperCase():"lowercase"===d&&(a=a.toLocaleLowerCase()),Ff.applyArabicShaping&&(a=Ff.applyArabicShaping(a)),a}(a.text,b,c)}),a}function Gc(a,b){var c=b.expression;if("constant"===c.kind)return{functionType:"constant",layoutSize:c.evaluate(new Gf(a+1))};if("source"===c.kind)return{functionType:"source"};for(var d=c.zoomStops,e=0;e<d.length&&d[e]<=a;)e++;for(var f=e=Math.max(0,e-1);f<d.length&&d[f]<a+1;)f++;f=Math.min(d.length-1,f);var g={min:d[e],max:d[f]};return"composite"===c.kind?{functionType:"composite",zoomRange:g,propertyValue:b.value}:{functionType:"camera",layoutSize:c.evaluate(new Gf(a+1)),zoomRange:g,sizeRange:{min:c.evaluate(new Gf(g.min)),max:c.evaluate(new Gf(g.max))},propertyValue:b.value}}function Hc(a,b,c,d,e,f,g,h){a.emplaceBack(b,c,Math.round(32*d),Math.round(32*e),f,g,h?h[0]:0,h?h[1]:0)}function Ic(a,b,c){a.emplaceBack(b.x,b.y,c),a.emplaceBack(b.x,b.y,c),a.emplaceBack(b.x,b.y,c),a.emplaceBack(b.x,b.y,c)}function Jc(a){for(var b=0,c=0,d=0,e=a;d<e.length;d+=1){var f=e[d];b+=f.w*f.h,c=Math.max(c,f.w)}a.sort(function(a,b){return b.h-a.h});for(var g=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(b/.95)),c),h:1/0}],h=0,i=0,j=0,k=a;j<k.length;j+=1)for(var l=k[j],m=g.length-1;m>=0;m--){var n=g[m];if(!(l.w>n.w||l.h>n.h)){if(l.x=n.x,l.y=n.y,i=Math.max(i,l.y+l.h),h=Math.max(h,l.x+l.w),l.w===n.w&&l.h===n.h){var o=g.pop();m<g.length&&(g[m]=o)}else l.h===n.h?(n.x+=l.w,n.w-=l.w):l.w===n.w?(n.y+=l.h,n.h-=l.h):(g.push({x:n.x+l.w,y:n.y,w:n.w-l.w,h:l.h}),n.y+=l.h,n.h-=l.h);break}}return{w:h,h:i,fill:b/(h*i)||0}}function Kc(a){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(a)?a:new Uint8Array(a||0),this.pos=0,this.type=0,this.length=this.buf.length}function Lc(a){return a.type===Kc.Bytes?a.readVarint()+a.pos:a.pos+1}function Mc(a,b,c){return c?4294967296*b+(a>>>0):4294967296*(b>>>0)+(a>>>0)}function Nc(a,b,c){var d=b<=16383?1:b<=2097151?2:b<=268435455?3:Math.ceil(Math.log(b)/(7*Math.LN2));c.realloc(d);for(var e=c.pos-1;e>=a;e--)c.buf[e+d]=c.buf[e]}function Oc(a,b){for(var c=0;c<a.length;c++)b.writeVarint(a[c])}function Pc(a,b){for(var c=0;c<a.length;c++)b.writeSVarint(a[c])}function Qc(a,b){for(var c=0;c<a.length;c++)b.writeFloat(a[c])}function Rc(a,b){for(var c=0;c<a.length;c++)b.writeDouble(a[c])}function Sc(a,b){for(var c=0;c<a.length;c++)b.writeBoolean(a[c])}function Tc(a,b){for(var c=0;c<a.length;c++)b.writeFixed32(a[c])}function Uc(a,b){for(var c=0;c<a.length;c++)b.writeSFixed32(a[c])}function Vc(a,b){for(var c=0;c<a.length;c++)b.writeFixed64(a[c])}function Wc(a,b){for(var c=0;c<a.length;c++)b.writeSFixed64(a[c])}function Xc(a,b){return(a[b]|a[b+1]<<8|a[b+2]<<16)+16777216*a[b+3]}function Yc(a,b,c){a[c]=b,a[c+1]=b>>>8,a[c+2]=b>>>16,a[c+3]=b>>>24}function Zc(a,b){return(a[b]|a[b+1]<<8|a[b+2]<<16)+(a[b+3]<<24)}function $c(a,b,c){1===a&&c.readMessage(_c,b)}function _c(a,b,c){if(3===a){var d=c.readMessage(ad,{}),e=d.id,f=d.bitmap,g=d.width,h=d.height,i=d.left,j=d.top,k=d.advance;b.push({id:e,bitmap:new eh({width:g+2*qi,height:h+2*qi},f),metrics:{width:g,height:h,left:i,top:j,advance:k}})}}function ad(a,b,c){1===a?b.id=c.readVarint():2===a?b.bitmap=c.readBytes():3===a?b.width=c.readVarint():4===a?b.height=c.readVarint():5===a?b.left=c.readSVarint():6===a?b.top=c.readSVarint():7===a&&(b.advance=c.readVarint())}function bd(a,b,c){var d=2*Math.PI*6378137/256/Math.pow(2,c);return[a*d-2*Math.PI*6378137/2,b*d-2*Math.PI*6378137/2]}function cd(a){return 2*Math.PI*6378137*Math.cos(a*Math.PI/180)}function dd(a){return(180+a)/360}function ed(a){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+a*Math.PI/360)))/360}function fd(a,b){return a/cd(b)}function gd(a){var b=180-360*a;return 360/Math.PI*Math.atan(Math.exp(b*Math.PI/180))-90}function hd(a,b,c,d){(a*=2)<0&&(a=-1*a-1);var e=1<<b;return 32*(e*e*a+e*d+c)+b}function id(a){for(var b=1/0,c=1/0,d=-1/0,e=-1/0,f=0,g=a;f<g.length;f+=1){var h=g[f];b=Math.min(b,h.x),c=Math.min(c,h.y),d=Math.max(d,h.x),e=Math.max(e,h.y)}return{minX:b,minY:c,maxX:d,maxY:e}}function jd(a,b){return b-a}function kd(a,b,c,d){var e=Math.pow(a-b,2);return d?a<b?e/2:2*e:e+Math.abs(c)*c}function ld(a,b){var c=0;return 10===a&&(c-=1e4),40!==a&&65288!==a||(c+=50),41!==b&&65289!==b||(c+=50),c}function md(a,b,c,d,e,f){for(var g=null,h=kd(b,c,e,f),i=0,j=d;i<j.length;i+=1){var k=j[i],l=kd(b-k.x,c,e,f)+k.badness;l<=h&&(g=k,h=l)}return{index:a,x:b,priorBreak:g,badness:h}}function nd(a,b,c,d){if(!c)return[];if(!a)return[];for(var e,f=[],g=function(a,b,c,d){for(var e=0,f=0;f<a.length();f++){var g=a.getSection(f),h=d[g.fontStack],i=h&&h[a.getCharCode(f)];i&&(e+=i.metrics.advance*g.scale+b)}return e/Math.max(1,Math.ceil(e/c))}(a,b,c,d),h=0,i=0;i<a.length();i++){var j=a.getSection(i),k=a.getCharCode(i),l=d[j.fontStack],m=l&&l[k];m&&!Ji[k]&&(h+=m.metrics.advance*j.scale+b),i<a.length()-1&&(Ki[k]||!((e=k)<11904)&&(Af["Bopomofo Extended"](e)||Af.Bopomofo(e)||Af["CJK Compatibility Forms"](e)||Af["CJK Compatibility Ideographs"](e)||Af["CJK Compatibility"](e)||Af["CJK Radicals Supplement"](e)||Af["CJK Strokes"](e)||Af["CJK Symbols and Punctuation"](e)||Af["CJK Unified Ideographs Extension A"](e)||Af["CJK Unified Ideographs"](e)||Af["Enclosed CJK Letters and Months"](e)||Af["Halfwidth and Fullwidth Forms"](e)||Af.Hiragana(e)||Af["Ideographic Description Characters"](e)||Af["Kangxi Radicals"](e)||Af["Katakana Phonetic Extensions"](e)||Af.Katakana(e)||Af["Vertical Forms"](e)||Af["Yi Radicals"](e)||Af["Yi Syllables"](e)))&&f.push(md(i+1,h,g,f,ld(k,a.getCharCode(i+1)),!1))}return function a(b){return b?a(b.priorBreak).concat(b.index):[]}(md(a.length(),h,g,f,0,!0))}function od(a){var b=.5,c=.5;switch(a){case"right":case"top-right":case"bottom-right":b=1;break;case"left":case"top-left":case"bottom-left":b=0}switch(a){case"bottom":case"bottom-right":case"bottom-left":c=1;break;case"top":case"top-right":case"top-left":c=0}return{horizontalAlign:b,verticalAlign:c}}function pd(a,b,c,d,e){if(e){var f=a[d],g=b[f.fontStack],h=g&&g[f.glyph];if(h)for(var i=h.metrics.advance*f.scale,j=(a[d].x+i)*e,k=c;k<=d;k++)a[k].x-=j}}var qd=c;c.prototype.sampleCurveX=function(a){return((this.ax*a+this.bx)*a+this.cx)*a},c.prototype.sampleCurveY=function(a){return((this.ay*a+this.by)*a+this.cy)*a},c.prototype.sampleCurveDerivativeX=function(a){return(3*this.ax*a+2*this.bx)*a+this.cx},c.prototype.solveCurveX=function(a,b){var c,d,e,f,g;for(void 0===b&&(b=1e-6),e=a,g=0;g<8;g++){if(f=this.sampleCurveX(e)-a,Math.abs(f)<b)return e;var h=this.sampleCurveDerivativeX(e);if(Math.abs(h)<1e-6)break;e-=f/h}if((e=a)<(c=0))return c;if(e>(d=1))return d;for(;c<d;){if(f=this.sampleCurveX(e),Math.abs(f-a)<b)return e;a>f?c=e:d=e,e=.5*(d-c)+c}return e},c.prototype.solve=function(a,b){return this.sampleCurveY(this.solveCurveX(a,b))};var rd=d;d.prototype={clone:function(){return new d(this.x,this.y)},add:function(a){return this.clone()._add(a)},sub:function(a){return this.clone()._sub(a)},multByPoint:function(a){return this.clone()._multByPoint(a)},divByPoint:function(a){return this.clone()._divByPoint(a)},mult:function(a){return this.clone()._mult(a)},div:function(a){return this.clone()._div(a)},rotate:function(a){return this.clone()._rotate(a)},rotateAround:function(a,b){return this.clone()._rotateAround(a,b)},matMult:function(a){return this.clone()._matMult(a)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(a){return this.x===a.x&&this.y===a.y},dist:function(a){return Math.sqrt(this.distSqr(a))},distSqr:function(a){var b=a.x-this.x,c=a.y-this.y;return b*b+c*c},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(a){return Math.atan2(this.y-a.y,this.x-a.x)},angleWith:function(a){return this.angleWithSep(a.x,a.y)},angleWithSep:function(a,b){return Math.atan2(this.x*b-this.y*a,this.x*a+this.y*b)},_matMult:function(a){var b=a[0]*this.x+a[1]*this.y,c=a[2]*this.x+a[3]*this.y;return this.x=b,this.y=c,this},_add:function(a){return this.x+=a.x,this.y+=a.y,this},_sub:function(a){return this.x-=a.x,this.y-=a.y,this},_mult:function(a){return this.x*=a,this.y*=a,this},_div:function(a){return this.x/=a,this.y/=a,this},_multByPoint:function(a){return this.x*=a.x,this.y*=a.y,this},_divByPoint:function(a){return this.x/=a.x,this.y/=a.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var a=this.y;return this.y=this.x,this.x=-a,this},_rotate:function(a){var b=Math.cos(a),c=Math.sin(a),d=b*this.x-c*this.y,e=c*this.x+b*this.y;return this.x=d,this.y=e,this},_rotateAround:function(a,b){var c=Math.cos(a),d=Math.sin(a),e=b.x+c*(this.x-b.x)-d*(this.y-b.y),f=b.y+d*(this.x-b.x)+c*(this.y-b.y);return this.x=e,this.y=f,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},d.convert=function(a){return a instanceof d?a:Array.isArray(a)?new d(a[0],a[1]):a};var sd,td,ud=f(.25,.1,.25,1),vd=1,wd={},xd=self.performance&&self.performance.now?self.performance.now.bind(self.performance):Date.now.bind(Date),yd=self.requestAnimationFrame||self.mozRequestAnimationFrame||self.webkitRequestAnimationFrame||self.msRequestAnimationFrame,zd=self.cancelAnimationFrame||self.mozCancelAnimationFrame||self.webkitCancelAnimationFrame||self.msCancelAnimationFrame,Ad={now:xd,frame:function(a){var b=yd(a);return{cancel:function(){return zd(b)}}},getImageData:function(a){var b=self.document.createElement("canvas"),c=b.getContext("2d");if(!c)throw new Error("failed to create canvas 2d context");return b.width=a.width,b.height=a.height,c.drawImage(a,0,0,a.width,a.height),c.getImageData(0,0,a.width,a.height)},resolveURL:function(a){var b=self.document.createElement("a");return b.href=a,b.href},hardwareConcurrency:self.navigator.hardwareConcurrency||4,get devicePixelRatio(){return self.devicePixelRatio}},Bd={API_URL:"https://api.mapbox.com",get EVENTS_URL(){return 0===this.API_URL.indexOf("https://api.mapbox.cn")?"https://events.mapbox.cn/events/v2":"https://events.mapbox.com/events/v2"},FEEDBACK_URL:"https://apps.mapbox.com/feedback",REQUIRE_ACCESS_TOKEN:!0,ACCESS_TOKEN:null,MAX_PARALLEL_IMAGE_REQUESTS:16},Cd={supported:!1,testSupport:function(a){!Dd&&td&&(Ed?v(a):sd=a)}},Dd=!1,Ed=!1;self.document&&((td=self.document.createElement("img")).onload=function(){sd&&v(sd),sd=null,Ed=!0},td.onerror=function(){Dd=!0,sd=null},td.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA=");var Fd="See https://www.mapbox.com/api-documentation/#access-tokens-and-token-scopes",Gd=/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/|\?|$)/i,Hd=/(\.(png|jpg)\d*)(?=$)/,Id=/\.[\w]+$/,Jd=function(a){var b=z(a);if(!b.path.match(/(^\/v4\/)/)||!b.path.match(Id))return a;var c="mapbox://tiles/";c+=b.path.replace("/v4/","");var d=b.params.filter(function(a){return!a.match(/^access_token=/)});return d.length&&(c+="?"+d.join("&")),c},Kd=/^(\w+):\/\/([^\/?]*)(\/[^?]+)?\??(.+)?/,Ld=function(a){this.type=a,this.anonId=null,this.eventData={},this.queue=[],this.pendingRequest=null};Ld.prototype.getStorageKey=function(a){var b,c=B(Bd.ACCESS_TOKEN),d="";return c&&c.u?(b=c.u,d=self.btoa(encodeURIComponent(b).replace(/%([0-9A-F]{2})/g,function(a,b){return String.fromCharCode(Number("0x"+b))}))):d=Bd.ACCESS_TOKEN||"",a?"mapbox.eventData."+a+":"+d:"mapbox.eventData:"+d},Ld.prototype.fetchEventData=function(){var a=u("localStorage"),b=this.getStorageKey(),c=this.getStorageKey("uuid");if(a)try{var d=self.localStorage.getItem(b);d&&(this.eventData=JSON.parse(d));var e=self.localStorage.getItem(c);e&&(this.anonId=e)}catch(a){r("Unable to read from LocalStorage")}},Ld.prototype.saveEventData=function(){var a=u("localStorage"),b=this.getStorageKey(),c=this.getStorageKey("uuid");if(a)try{self.localStorage.setItem(c,this.anonId),Object.keys(this.eventData).length>=1&&self.localStorage.setItem(b,JSON.stringify(this.eventData))}catch(a){r("Unable to write to LocalStorage")}},Ld.prototype.processRequests=function(){},Ld.prototype.postEvent=function(a,b,c){var d=this,e=z(Bd.EVENTS_URL);e.params.push("access_token="+(Bd.ACCESS_TOKEN||""));var f={event:this.type,created:new Date(a).toISOString(),sdkIdentifier:"mapbox-gl-js",sdkVersion:"0.53.0",userId:this.anonId},g=b?i(f,b):f,h={url:A(e),headers:{"Content-Type":"text/plain"},body:JSON.stringify([g])};this.pendingRequest=Yd(h,function(a){d.pendingRequest=null,c(a),d.saveEventData(),d.processRequests()})},Ld.prototype.queueRequest=function(a){this.queue.push(a),this.processRequests()};var Md=function(a){function b(){a.call(this,"map.load"),this.success={}}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.postMapLoadEvent=function(a,b){Bd.ACCESS_TOKEN&&Array.isArray(a)&&a.some(function(a){return x(a)||y(a)})&&this.queueRequest({id:b,timestamp:Date.now()})},b.prototype.processRequests=function(){var a=this;if(!this.pendingRequest&&0!==this.queue.length){var b=this.queue.shift(),c=b.id,d=b.timestamp;c&&this.success[c]||(this.anonId||this.fetchEventData(),l(this.anonId)||(this.anonId=k()),this.postEvent(d,{},function(b){b||c&&(a.success[c]=!0)}))}},b}(Ld),Nd=new(function(a){function b(){a.call(this,"appUserTurnstile")}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.postTurnstileEvent=function(a){Bd.ACCESS_TOKEN&&Array.isArray(a)&&a.some(function(a){return x(a)||y(a)})&&this.queueRequest(Date.now())},b.prototype.processRequests=function(){var a=this;if(!this.pendingRequest&&0!==this.queue.length){this.anonId&&this.eventData.lastSuccess&&this.eventData.tokenU||this.fetchEventData();var b=B(Bd.ACCESS_TOKEN),c=b?b.u:Bd.ACCESS_TOKEN,d=c!==this.eventData.tokenU;l(this.anonId)||(this.anonId=k(),d=!0);var e=this.queue.shift();if(this.eventData.lastSuccess){var f=new Date(this.eventData.lastSuccess),g=new Date(e),h=(e-this.eventData.lastSuccess)/864e5;d=d||h>=1||h<-1||f.getDate()!==g.getDate()}else d=!0;if(!d)return this.processRequests();this.postEvent(e,{"enabled.telemetry":!1},function(b){b||(a.eventData.lastSuccess=e,a.eventData.tokenU=c)})}},b}(Ld)),Od=Nd.postTurnstileEvent.bind(Nd),Pd=new Md,Qd=Pd.postMapLoadEvent.bind(Pd),Rd={Unknown:"Unknown",Style:"Style",Source:"Source",Tile:"Tile",Glyphs:"Glyphs",SpriteImage:"SpriteImage",SpriteJSON:"SpriteJSON",Image:"Image"};"function"==typeof Object.freeze&&Object.freeze(Rd);var Sd,Td,Ud=function(a){function b(b,c,d){401===c&&y(d)&&(b+=": you may have provided an invalid Mapbox access token. See https://www.mapbox.com/api-documentation/#access-tokens-and-token-scopes"),a.call(this,b),this.status=c,this.url=d,this.name=this.constructor.name,this.message=b}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.toString=function(){return this.name+": "+this.message+" ("+this.status+"): "+this.url},b}(Error),Vd=C()?function(){return self.worker&&self.worker.referrer}:function(){var a=self.location.origin;if(a&&"null"!==a&&"file://"!==a)return a+self.location.pathname},Wd=function(a,b){if(!/^file:/.test(a.url)){if(self.fetch&&self.Request&&self.AbortController)return function(a,b){var c=new self.AbortController,d=new self.Request(a.url,{method:a.method||"GET",body:a.body,credentials:a.credentials,headers:a.headers,referrer:Vd(),signal:c.signal});return"json"===a.type&&d.headers.set("Accept","application/json"),self.fetch(d).then(function(c){c.ok?c[a.type||"text"]().then(function(a){b(null,a,c.headers.get("Cache-Control"),c.headers.get("Expires"))}).catch(function(a){return b(new Error(a.message))}):b(new Ud(c.statusText,c.status,a.url))}).catch(function(a){20!==a.code&&b(new Error(a.message))}),{cancel:function(){return c.abort()}}}(a,b);if(C()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",a,b)}return function(a,b){var c=new self.XMLHttpRequest;for(var d in c.open(a.method||"GET",a.url,!0),"arrayBuffer"===a.type&&(c.responseType="arraybuffer"),a.headers)c.setRequestHeader(d,a.headers[d]);return"json"===a.type&&c.setRequestHeader("Accept","application/json"),c.withCredentials="include"===a.credentials,c.onerror=function(){b(new Error(c.statusText))},c.onload=function(){if((c.status>=200&&c.status<300||0===c.status)&&null!==c.response){var d=c.response;if("json"===a.type)try{d=JSON.parse(c.response)}catch(a){return b(a)}b(null,d,c.getResponseHeader("Cache-Control"),c.getResponseHeader("Expires"))}else b(new Ud(c.statusText,c.status,a.url))},c.send(a.body),{cancel:function(){return c.abort()}}}(a,b)},Xd=function(a,b){return Wd(i(a,{type:"arrayBuffer"}),b)},Yd=function(a,b){return Wd(i(a,{method:"POST"}),b)};Sd=[],Td=0;var Zd=function(a,b){if(Td>=Bd.MAX_PARALLEL_IMAGE_REQUESTS){var c={requestParameters:a,callback:b,cancelled:!1,cancel:function(){this.cancelled=!0}};return Sd.push(c),c}Td++;var d=!1,e=function(){if(!d)for(d=!0,Td--;Sd.length&&Td<Bd.MAX_PARALLEL_IMAGE_REQUESTS;){var a=Sd.shift(),b=a.requestParameters,c=a.callback;a.cancelled||(a.cancel=Zd(b,c).cancel)}},f=Xd(a,function(a,c,d,f){if(e(),a)b(a);else if(c){var g=new self.Image,h=self.URL||self.webkitURL;g.onload=function(){b(null,g),h.revokeObjectURL(g.src)},g.onerror=function(){return b(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."))};var i=new self.Blob([new Uint8Array(c)],{type:"image/png"});g.cacheControl=d,g.expires=f,g.src=c.byteLength?h.createObjectURL(i):"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII="}});return{cancel:function(){f.cancel(),e()}}},$d=function(a,b){void 0===b&&(b={}),i(this,b),this.type=a},_d=function(a){function b(b,c){void 0===c&&(c={}),a.call(this,"error",i({error:b},c))}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b}($d),ae=function(){};ae.prototype.on=function(a,b){return this._listeners=this._listeners||{},D(a,b,this._listeners),this},ae.prototype.off=function(a,b){return E(a,b,this._listeners),E(a,b,this._oneTimeListeners),this},ae.prototype.once=function(a,b){return this._oneTimeListeners=this._oneTimeListeners||{},D(a,b,this._oneTimeListeners),this},ae.prototype.fire=function(a,b){"string"==typeof a&&(a=new $d(a,b||{}));var c=a.type;if(this.listens(c)){a.target=this;for(var d=0,e=this._listeners&&this._listeners[c]?this._listeners[c].slice():[];d<e.length;d+=1)e[d].call(this,a);for(var f=0,g=this._oneTimeListeners&&this._oneTimeListeners[c]?this._oneTimeListeners[c].slice():[];f<g.length;f+=1){var h=g[f];E(c,h,this._oneTimeListeners),h.call(this,a)}var j=this._eventedParent;j&&(i(a,"function"==typeof this._eventedParentData?this._eventedParentData():this._eventedParentData),j.fire(a))}else a instanceof _d&&console.error(a.error);return this},ae.prototype.listens=function(a){return this._listeners&&this._listeners[a]&&this._listeners[a].length>0||this._oneTimeListeners&&this._oneTimeListeners[a]&&this._oneTimeListeners[a].length>0||this._eventedParent&&this._eventedParent.listens(a)},ae.prototype.setEventedParent=function(a,b){return this._eventedParent=a,this._eventedParentData=b,this};var be={$version:8,$root:{version:{required:!0,type:"enum",values:[8]},name:{type:"string"},metadata:{type:"*"},center:{type:"array",value:"number"},zoom:{type:"number"},bearing:{type:"number",default:0,period:360,units:"degrees"},pitch:{type:"number",default:0,units:"degrees"},light:{type:"light"},sources:{required:!0,type:"sources"},sprite:{type:"string"},glyphs:{type:"string"},transition:{type:"transition"},layers:{required:!0,type:"array",value:"layer"}},sources:{"*":{type:"source"}},source:["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],source_vector:{type:{required:!0,type:"enum",values:{vector:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},attribution:{type:"string"},"*":{type:"*"}},source_raster:{type:{required:!0,type:"enum",values:{raster:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},attribution:{type:"string"},"*":{type:"*"}},source_raster_dem:{type:{required:!0,type:"enum",values:{"raster-dem":{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},attribution:{type:"string"},encoding:{type:"enum",values:{terrarium:{},mapbox:{}},default:"mapbox"},"*":{type:"*"}},source_geojson:{type:{required:!0,type:"enum",values:{geojson:{}}},data:{type:"*"},maxzoom:{type:"number",default:18},attribution:{type:"string"},buffer:{type:"number",default:128,maximum:512,minimum:0},tolerance:{type:"number",default:.375},cluster:{type:"boolean",default:!1},clusterRadius:{type:"number",default:50,minimum:0},clusterMaxZoom:{type:"number"},clusterProperties:{type:"*"},lineMetrics:{type:"boolean",default:!1},generateId:{type:"boolean",default:!1}},source_video:{type:{required:!0,type:"enum",values:{video:{}}},urls:{required:!0,type:"array",value:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},source_image:{type:{required:!0,type:"enum",values:{image:{}}},url:{required:!0,type:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},layer:{id:{type:"string",required:!0},type:{type:"enum",values:{fill:{},line:{},symbol:{},circle:{},heatmap:{},"fill-extrusion":{},raster:{},hillshade:{},background:{}},required:!0},metadata:{type:"*"},source:{type:"string"},"source-layer":{type:"string"},minzoom:{type:"number",minimum:0,maximum:24},maxzoom:{type:"number",minimum:0,maximum:24},filter:{type:"filter"},layout:{type:"layout"},paint:{type:"paint"}},layout:["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background"],layout_background:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_fill:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_circle:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_heatmap:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},"layout_fill-extrusion":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},
layout_line:{"line-cap":{type:"enum",values:{butt:{},round:{},square:{}},default:"butt",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-join":{type:"enum",values:{bevel:{},round:{},miter:{}},default:"miter",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{type:"number",default:2,requires:[{"line-join":"miter"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-round-limit":{type:"number",default:1.05,requires:[{"line-join":"round"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_symbol:{"symbol-placement":{type:"enum",values:{point:{},line:{},"line-center":{}},default:"point",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-spacing":{type:"number",default:250,minimum:1,units:"pixels",requires:[{"symbol-placement":"line"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{type:"boolean",default:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{type:"enum",values:{auto:{},"viewport-y":{},source:{}},default:"auto",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-optional":{type:"boolean",default:!1,requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-size":{type:"number",default:1,minimum:0,units:"factor of the original icon size",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{type:"enum",values:{none:{},width:{},height:{},both:{}},default:"none",requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{type:"array",value:"number",length:4,default:[0,0,0,0],units:"pixels",requires:["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-image":{type:"string",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-keep-upright":{type:"boolean",default:!1,requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-offset":{type:"array",value:"number",length:2,default:[0,0],requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-field":{type:"formatted",default:"",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"],requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-size":{type:"number",default:16,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{type:"number",default:10,minimum:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{type:"number",default:1.2,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-letter-spacing":{type:"number",default:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-justify":{type:"enum",values:{left:{},center:{},right:{}},default:"center",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{type:"number",default:45,units:"degrees",requires:["text-field",{"symbol-placement":["line","line-center"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-keep-upright":{type:"boolean",default:!0,requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-transform":{type:"enum",values:{none:{},uppercase:{},lowercase:{}},default:"none",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-offset":{type:"array",value:"number",units:"ems",length:2,default:[0,0],requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-optional":{type:"boolean",default:!1,requires:["text-field","icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_raster:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_hillshade:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},filter:{type:"array",value:"*"},filter_operator:{type:"enum",values:{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},in:{},"!in":{},all:{},any:{},none:{},has:{},"!has":{}}},geometry_type:{type:"enum",values:{Point:{},LineString:{},Polygon:{}}},function:{expression:{type:"expression"},stops:{type:"array",value:"function_stop"},base:{type:"number",default:1,minimum:0},property:{type:"string",default:"$zoom"},type:{type:"enum",values:{identity:{},exponential:{},interval:{},categorical:{}},default:"exponential"},colorSpace:{type:"enum",values:{rgb:{},lab:{},hcl:{}},default:"rgb"},default:{type:"*",required:!1}},function_stop:{type:"array",minimum:0,maximum:22,value:["number","color"],length:2},expression:{type:"array",value:"*",minimum:1},expression_name:{type:"enum",values:{let:{group:"Variable binding"},var:{group:"Variable binding"},literal:{group:"Types"},array:{group:"Types"},at:{group:"Lookup"},case:{group:"Decision"},match:{group:"Decision"},coalesce:{group:"Decision"},step:{group:"Ramps, scales, curves"},interpolate:{group:"Ramps, scales, curves"},"interpolate-hcl":{group:"Ramps, scales, curves"},"interpolate-lab":{group:"Ramps, scales, curves"},ln2:{group:"Math"},pi:{group:"Math"},e:{group:"Math"},typeof:{group:"Types"},string:{group:"Types"},number:{group:"Types"},boolean:{group:"Types"},object:{group:"Types"},collator:{group:"Types"},format:{group:"Types"},"number-format":{group:"Types"},"to-string":{group:"Types"},"to-number":{group:"Types"},"to-boolean":{group:"Types"},"to-rgba":{group:"Color"},"to-color":{group:"Types"},rgb:{group:"Color"},rgba:{group:"Color"},get:{group:"Lookup"},has:{group:"Lookup"},length:{group:"Lookup"},properties:{group:"Feature data"},"feature-state":{group:"Feature data"},"geometry-type":{group:"Feature data"},id:{group:"Feature data"},zoom:{group:"Zoom"},"heatmap-density":{group:"Heatmap"},"line-progress":{group:"Feature data"},accumulated:{group:"Feature data"},"+":{group:"Math"},"*":{group:"Math"},"-":{group:"Math"},"/":{group:"Math"},"%":{group:"Math"},"^":{group:"Math"},sqrt:{group:"Math"},log10:{group:"Math"},ln:{group:"Math"},log2:{group:"Math"},sin:{group:"Math"},cos:{group:"Math"},tan:{group:"Math"},asin:{group:"Math"},acos:{group:"Math"},atan:{group:"Math"},min:{group:"Math"},max:{group:"Math"},round:{group:"Math"},abs:{group:"Math"},ceil:{group:"Math"},floor:{group:"Math"},"==":{group:"Decision"},"!=":{group:"Decision"},">":{group:"Decision"},"<":{group:"Decision"},">=":{group:"Decision"},"<=":{group:"Decision"},all:{group:"Decision"},any:{group:"Decision"},"!":{group:"Decision"},"is-supported-script":{group:"String"},upcase:{group:"String"},downcase:{group:"String"},concat:{group:"String"},"resolved-locale":{group:"String"}}},light:{anchor:{type:"enum",default:"viewport",values:{map:{},viewport:{}},"property-type":"data-constant",transition:!1,expression:{interpolated:!1,parameters:["zoom"]}},position:{type:"array",default:[1.15,210,30],length:3,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},intensity:{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},paint:["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background"],paint_fill:{"fill-antialias":{type:"boolean",default:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{type:"color",transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-pattern":{type:"string",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-extrusion-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-extrusion-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{type:"string",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{type:"number",default:0,minimum:0,units:"meters",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{type:"number",default:0,minimum:0,units:"meters",transition:!0,requires:["fill-extrusion-height"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{type:"boolean",default:!0,transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_line:{"line-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"line-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["line-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-width":{type:"number",default:1,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{type:"number",default:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{type:"array",value:"number",minimum:0,transition:!0,units:"line widths",requires:[{"!":"line-pattern"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"line-pattern":{type:"string",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{type:"color",transition:!1,requires:[{"!":"line-dasharray"},{"!":"line-pattern"},{source:"geojson",has:{lineMetrics:!0}}],expression:{interpolated:!0,parameters:["line-progress"]},"property-type":"color-ramp"}},paint_circle:{"circle-radius":{type:"number",default:5,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{type:"number",default:0,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["circle-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{type:"enum",values:{map:{},viewport:{}},default:"map",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"}},paint_heatmap:{"heatmap-radius":{type:"number",default:30,minimum:1,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{type:"number",default:1,minimum:0,transition:!1,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{type:"number",default:1,minimum:0,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"heatmap-color":{type:"color",default:["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],transition:!1,expression:{interpolated:!0,parameters:["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_symbol:{"icon-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{type:"color",default:"#000000",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["icon-image","icon-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{type:"color",default:"#000000",transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["text-field","text-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_raster:{"raster-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{type:"number",default:0,period:360,transition:!0,units:"degrees",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{type:"number",default:0,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-saturation":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-contrast":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-resampling":{type:"enum",values:{linear:{},nearest:{}},default:"linear",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{type:"number",default:300,minimum:0,transition:!1,units:"milliseconds",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_hillshade:{"hillshade-illumination-direction":{type:"number",default:335,minimum:0,maximum:359,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{type:"number",default:.5,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{type:"color",default:"#FFFFFF",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_background:{"background-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"background-pattern"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"background-pattern":{type:"string",transition:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"background-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},transition:{duration:{type:"number",default:300,minimum:0,units:"milliseconds"},delay:{type:"number",default:0,minimum:0,units:"milliseconds"}},"property-type":{"data-driven":{type:"property-type"},"cross-faded":{type:"property-type"},"cross-faded-data-driven":{type:"property-type"},"color-ramp":{type:"property-type"},"data-constant":{type:"property-type"},constant:{type:"property-type"}}},ce=function(a,b,c,d){this.message=(a?a+": ":"")+c,d&&(this.identifier=d),null!=b&&b.__line__&&(this.line=b.__line__)},de=function(a){function b(b,c){a.call(this,c),this.message=c,this.key=b}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b}(Error),ee=function(a,b){void 0===b&&(b=[]),this.parent=a,this.bindings={};for(var c=0,d=b;c<d.length;c+=1){var e=d[c],f=e[0],g=e[1];this.bindings[f]=g}};ee.prototype.concat=function(a){return new ee(this,a)},ee.prototype.get=function(a){if(this.bindings[a])return this.bindings[a];if(this.parent)return this.parent.get(a);throw new Error(a+" not found in scope.")},ee.prototype.has=function(a){return!!this.bindings[a]||!!this.parent&&this.parent.has(a)};var fe={kind:"null"},ge={kind:"number"},he={kind:"string"},ie={kind:"boolean"},je={kind:"color"},ke={kind:"object"},le={kind:"value"},me={kind:"collator"},ne={kind:"formatted"},oe=[fe,ge,he,ie,je,ne,ke,J(le)],pe=b(function(a,b){function c(a){return(a=Math.round(a))<0?0:a>255?255:a}function d(a){return a<0?0:a>1?1:a}function e(a){return c("%"===a[a.length-1]?parseFloat(a)/100*255:parseInt(a))}function f(a){return d("%"===a[a.length-1]?parseFloat(a)/100:parseFloat(a))}function g(a,b,c){return c<0?c+=1:c>1&&(c-=1),6*c<1?a+(b-a)*c*6:2*c<1?b:3*c<2?a+(b-a)*(2/3-c)*6:a}var h={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],rebeccapurple:[102,51,153,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};try{b.parseCSSColor=function(a){var b,d=a.replace(/ /g,"").toLowerCase();if(d in h)return h[d].slice();if("#"===d[0])return 4===d.length?(b=parseInt(d.substr(1),16))>=0&&b<=4095?[(3840&b)>>4|(3840&b)>>8,240&b|(240&b)>>4,15&b|(15&b)<<4,1]:null:7===d.length&&(b=parseInt(d.substr(1),16))>=0&&b<=16777215?[(16711680&b)>>16,(65280&b)>>8,255&b,1]:null;var i=d.indexOf("("),j=d.indexOf(")");if(-1!==i&&j+1===d.length){var k=d.substr(0,i),l=d.substr(i+1,j-(i+1)).split(","),m=1;switch(k){case"rgba":if(4!==l.length)return null;m=f(l.pop());case"rgb":return 3!==l.length?null:[e(l[0]),e(l[1]),e(l[2]),m];case"hsla":if(4!==l.length)return null;m=f(l.pop());case"hsl":if(3!==l.length)return null;var n=(parseFloat(l[0])%360+360)%360/360,o=f(l[1]),p=f(l[2]),q=p<=.5?p*(o+1):p+o-p*o,r=2*p-q;return[c(255*g(r,q,n+1/3)),c(255*g(r,q,n)),c(255*g(r,q,n-1/3)),m];default:return null}}return null}}catch(a){}}).parseCSSColor,qe=function(a,b,c,d){void 0===d&&(d=1),this.r=a,this.g=b,this.b=c,this.a=d};qe.parse=function(a){if(a){if(a instanceof qe)return a;if("string"==typeof a){var b=pe(a);if(b)return new qe(b[0]/255*b[3],b[1]/255*b[3],b[2]/255*b[3],b[3])}}},qe.prototype.toString=function(){var a=this.toArray(),b=a[0],c=a[1],d=a[2],e=a[3];return"rgba("+Math.round(b)+","+Math.round(c)+","+Math.round(d)+","+e+")"},qe.prototype.toArray=function(){var a=this.r,b=this.g,c=this.b,d=this.a;return 0===d?[0,0,0,0]:[255*a/d,255*b/d,255*c/d,d]},qe.black=new qe(0,0,0,1),qe.white=new qe(1,1,1,1),
qe.transparent=new qe(0,0,0,0),qe.red=new qe(1,0,0,1);var re=function(a,b,c){this.sensitivity=a?b?"variant":"case":b?"accent":"base",this.locale=c,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})};re.prototype.compare=function(a,b){return this.collator.compare(a,b)},re.prototype.resolvedLocale=function(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale};var se=function(a,b,c){this.text=a,this.scale=b,this.fontStack=c},te=function(a){this.sections=a};te.fromString=function(a){return new te([new se(a,null,null)])},te.prototype.toString=function(){return this.sections.map(function(a){return a.text}).join("")},te.prototype.serialize=function(){for(var a=["format"],b=0,c=this.sections;b<c.length;b+=1){var d=c[b];a.push(d.text);var e={};d.fontStack&&(e["text-font"]=["literal",d.fontStack.split(",")]),d.scale&&(e["font-scale"]=d.scale),a.push(e)}return a};var ue=function(a,b){this.type=a,this.value=b};ue.parse=function(a,b){if(2!==a.length)return b.error("'literal' expression requires exactly one argument, but found "+(a.length-1)+" instead.");if(!function a(b){if(null===b)return!0;if("string"==typeof b)return!0;if("boolean"==typeof b)return!0;if("number"==typeof b)return!0;if(b instanceof qe)return!0;if(b instanceof re)return!0;if(b instanceof te)return!0;if(Array.isArray(b)){for(var c=0,d=b;c<d.length;c+=1)if(!a(d[c]))return!1;return!0}if("object"==typeof b){for(var e in b)if(!a(b[e]))return!1;return!0}return!1}(a[1]))return b.error("invalid value");var c=a[1],d=N(c),e=b.expectedType;return"array"!==d.kind||0!==d.N||!e||"array"!==e.kind||"number"==typeof e.N&&0!==e.N||(d=e),new ue(d,c)},ue.prototype.evaluate=function(){return this.value},ue.prototype.eachChild=function(){},ue.prototype.possibleOutputs=function(){return[this.value]},ue.prototype.serialize=function(){return"array"===this.type.kind||"object"===this.type.kind?["literal",this.value]:this.value instanceof qe?["rgba"].concat(this.value.toArray()):this.value instanceof te?this.value.serialize():this.value};var ve=function(a){this.name="ExpressionEvaluationError",this.message=a};ve.prototype.toJSON=function(){return this.message};var we={string:he,number:ge,boolean:ie,object:ke},xe=function(a,b){this.type=a,this.args=b};xe.parse=function(a,b){if(a.length<2)return b.error("Expected at least one argument.");var c,d=1,e=a[0];if("array"===e){var f,g;if(a.length>2){var h=a[1];if("string"!=typeof h||!(h in we)||"object"===h)return b.error('The item type argument of "array" must be one of string, number, boolean',1);f=we[h],d++}else f=le;if(a.length>3){if(null!==a[2]&&("number"!=typeof a[2]||a[2]<0||a[2]!==Math.floor(a[2])))return b.error('The length argument to "array" must be a positive integer literal',2);g=a[2],d++}c=J(f,g)}else c=we[e];for(var i=[];d<a.length;d++){var j=b.parse(a[d],d,le);if(!j)return null;i.push(j)}return new xe(c,i)},xe.prototype.evaluate=function(a){for(var b=0;b<this.args.length;b++){var c=this.args[b].evaluate(a);if(!L(this.type,N(c)))return c;if(b===this.args.length-1)throw new ve("Expected value to be of type "+K(this.type)+", but found "+K(N(c))+" instead.")}return null},xe.prototype.eachChild=function(a){this.args.forEach(a)},xe.prototype.possibleOutputs=function(){var a;return(a=[]).concat.apply(a,this.args.map(function(a){return a.possibleOutputs()}))},xe.prototype.serialize=function(){var a=this.type,b=[a.kind];if("array"===a.kind){var c=a.itemType;if("string"===c.kind||"number"===c.kind||"boolean"===c.kind){b.push(c.kind);var d=a.N;("number"==typeof d||this.args.length>1)&&b.push(d)}}return b.concat(this.args.map(function(a){return a.serialize()}))};var ye=function(a){this.type=ne,this.sections=a};ye.parse=function(a,b){if(a.length<3)return b.error("Expected at least two arguments.");if((a.length-1)%2!=0)return b.error("Expected an even number of arguments.");for(var c=[],d=1;d<a.length-1;d+=2){var e=b.parse(a[d],1,le);if(!e)return null;var f=e.type.kind;if("string"!==f&&"value"!==f&&"null"!==f)return b.error("Formatted text type must be 'string', 'value', or 'null'.");var g=a[d+1];if("object"!=typeof g||Array.isArray(g))return b.error("Format options argument must be an object.");var h=null;if(g["font-scale"]&&!(h=b.parse(g["font-scale"],1,ge)))return null;var i=null;if(g["text-font"]&&!(i=b.parse(g["text-font"],1,J(he))))return null;c.push({text:e,scale:h,font:i})}return new ye(c)},ye.prototype.evaluate=function(a){return new te(this.sections.map(function(b){return new se(O(b.text.evaluate(a)),b.scale?b.scale.evaluate(a):null,b.font?b.font.evaluate(a).join(","):null)}))},ye.prototype.eachChild=function(a){for(var b=0,c=this.sections;b<c.length;b+=1){var d=c[b];a(d.text),d.scale&&a(d.scale),d.font&&a(d.font)}},ye.prototype.possibleOutputs=function(){return[void 0]},ye.prototype.serialize=function(){for(var a=["format"],b=0,c=this.sections;b<c.length;b+=1){var d=c[b];a.push(d.text.serialize());var e={};d.scale&&(e["font-scale"]=d.scale.serialize()),d.font&&(e["text-font"]=d.font.serialize()),a.push(e)}return a};var ze={"to-boolean":ie,"to-color":je,"to-number":ge,"to-string":he},Ae=function(a,b){this.type=a,this.args=b};Ae.parse=function(a,b){if(a.length<2)return b.error("Expected at least one argument.");var c=a[0];if(("to-boolean"===c||"to-string"===c)&&2!==a.length)return b.error("Expected one argument.");for(var d=ze[c],e=[],f=1;f<a.length;f++){var g=b.parse(a[f],f,le);if(!g)return null;e.push(g)}return new Ae(d,e)},Ae.prototype.evaluate=function(a){if("boolean"===this.type.kind)return Boolean(this.args[0].evaluate(a));if("color"===this.type.kind){for(var b,c,d=0,e=this.args;d<e.length;d+=1){if(c=null,(b=e[d].evaluate(a))instanceof qe)return b;if("string"==typeof b){var f=a.parseColor(b);if(f)return f}else if(Array.isArray(b)&&!(c=b.length<3||b.length>4?"Invalid rbga value "+JSON.stringify(b)+": expected an array containing either three or four numeric values.":M(b[0],b[1],b[2],b[3])))return new qe(b[0]/255,b[1]/255,b[2]/255,b[3])}throw new ve(c||"Could not parse color from value '"+("string"==typeof b?b:JSON.stringify(b))+"'")}if("number"===this.type.kind){for(var g=null,h=0,i=this.args;h<i.length;h+=1){if(null===(g=i[h].evaluate(a)))return 0;var j=Number(g);if(!isNaN(j))return j}throw new ve("Could not convert "+JSON.stringify(g)+" to number.")}return"formatted"===this.type.kind?te.fromString(O(this.args[0].evaluate(a))):O(this.args[0].evaluate(a))},Ae.prototype.eachChild=function(a){this.args.forEach(a)},Ae.prototype.possibleOutputs=function(){var a;return(a=[]).concat.apply(a,this.args.map(function(a){return a.possibleOutputs()}))},Ae.prototype.serialize=function(){if("formatted"===this.type.kind)return new ye([{text:this.args[0],scale:null,font:null}]).serialize();var a=["to-"+this.type.kind];return this.eachChild(function(b){a.push(b.serialize())}),a};var Be=["Unknown","Point","LineString","Polygon"],Ce=function(){this.globals=null,this.feature=null,this.featureState=null,this._parseColorCache={}};Ce.prototype.id=function(){return this.feature&&"id"in this.feature?this.feature.id:null},Ce.prototype.geometryType=function(){return this.feature?"number"==typeof this.feature.type?Be[this.feature.type]:this.feature.type:null},Ce.prototype.properties=function(){return this.feature&&this.feature.properties||{}},Ce.prototype.parseColor=function(a){var b=this._parseColorCache[a];return b||(b=this._parseColorCache[a]=qe.parse(a)),b};var De=function(a,b,c,d){this.name=a,this.type=b,this._evaluate=c,this.args=d};De.prototype.evaluate=function(a){return this._evaluate(a,this.args)},De.prototype.eachChild=function(a){this.args.forEach(a)},De.prototype.possibleOutputs=function(){return[void 0]},De.prototype.serialize=function(){return[this.name].concat(this.args.map(function(a){return a.serialize()}))},De.parse=function(a,b){var c,d=a[0],e=De.definitions[d];if(!e)return b.error('Unknown expression "'+d+'". If you wanted a literal array, use ["literal", [...]].',0);for(var f=Array.isArray(e)?e[0]:e.type,g=Array.isArray(e)?[[e[1],e[2]]]:e.overloads,h=g.filter(function(b){var c=b[0];return!Array.isArray(c)||c.length===a.length-1}),i=null,j=0,k=h;j<k.length;j+=1){var l=k[j],m=l[0],n=l[1];i=new Ge(b.registry,b.path,null,b.scope);for(var o=[],p=!1,q=1;q<a.length;q++){var r=a[q],s=Array.isArray(m)?m[q-1]:m.type,t=i.parse(r,1+o.length,s);if(!t){p=!0;break}o.push(t)}if(!p)if(Array.isArray(m)&&m.length!==o.length)i.error("Expected "+m.length+" arguments, but found "+o.length+" instead.");else{for(var u=0;u<o.length;u++){var v=Array.isArray(m)?m[u]:m.type,w=o[u];i.concat(u+1).checkSubtype(v,w.type)}if(0===i.errors.length)return new De(d,f,n,o)}}if(1===h.length)(c=b.errors).push.apply(c,i.errors);else{for(var x=(h.length?h:g).map(function(a){var b;return b=a[0],Array.isArray(b)?"("+b.map(K).join(", ")+")":"("+K(b.type)+"...)"}).join(" | "),y=[],z=1;z<a.length;z++){var A=b.parse(a[z],1+y.length);if(!A)return null;y.push(K(A.type))}b.error("Expected arguments of type "+x+", but found ("+y.join(", ")+") instead.")}return null},De.register=function(a,b){for(var c in De.definitions=b,b)a[c]=De};var Ee=function(a,b,c){this.type=me,this.locale=c,this.caseSensitive=a,this.diacriticSensitive=b};Ee.parse=function(a,b){if(2!==a.length)return b.error("Expected one argument.");var c=a[1];if("object"!=typeof c||Array.isArray(c))return b.error("Collator options argument must be an object.");var d=b.parse(void 0!==c["case-sensitive"]&&c["case-sensitive"],1,ie);if(!d)return null;var e=b.parse(void 0!==c["diacritic-sensitive"]&&c["diacritic-sensitive"],1,ie);if(!e)return null;var f=null;return c.locale&&!(f=b.parse(c.locale,1,he))?null:new Ee(d,e,f)},Ee.prototype.evaluate=function(a){return new re(this.caseSensitive.evaluate(a),this.diacriticSensitive.evaluate(a),this.locale?this.locale.evaluate(a):null)},Ee.prototype.eachChild=function(a){a(this.caseSensitive),a(this.diacriticSensitive),this.locale&&a(this.locale)},Ee.prototype.possibleOutputs=function(){return[void 0]},Ee.prototype.serialize=function(){var a={};return a["case-sensitive"]=this.caseSensitive.serialize(),a["diacritic-sensitive"]=this.diacriticSensitive.serialize(),this.locale&&(a.locale=this.locale.serialize()),["collator",a]};var Fe=function(a,b){this.type=b.type,this.name=a,this.boundExpression=b};Fe.parse=function(a,b){if(2!==a.length||"string"!=typeof a[1])return b.error("'var' expression requires exactly one string literal argument.");var c=a[1];return b.scope.has(c)?new Fe(c,b.scope.get(c)):b.error('Unknown variable "'+c+'". Make sure "'+c+'" has been bound in an enclosing "let" expression before using it.',1)},Fe.prototype.evaluate=function(a){return this.boundExpression.evaluate(a)},Fe.prototype.eachChild=function(){},Fe.prototype.possibleOutputs=function(){return[void 0]},Fe.prototype.serialize=function(){return["var",this.name]};var Ge=function(a,b,c,d,e){void 0===b&&(b=[]),void 0===d&&(d=new ee),void 0===e&&(e=[]),this.registry=a,this.path=b,this.key=b.map(function(a){return"["+a+"]"}).join(""),this.scope=d,this.errors=e,this.expectedType=c};Ge.prototype.parse=function(a,b,c,d,e){return void 0===e&&(e={}),b?this.concat(b,c,d)._parse(a,e):this._parse(a,e)},Ge.prototype._parse=function(a,b){function c(a,b,c){return"assert"===c?new xe(b,[a]):"coerce"===c?new Ae(b,[a]):a}if(null!==a&&"string"!=typeof a&&"boolean"!=typeof a&&"number"!=typeof a||(a=["literal",a]),Array.isArray(a)){if(0===a.length)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');var d=a[0];if("string"!=typeof d)return this.error("Expression name must be a string, but found "+typeof d+' instead. If you wanted a literal array, use ["literal", [...]].',0),null;var e=this.registry[d];if(e){var f=e.parse(a,this);if(!f)return null;if(this.expectedType){var g=this.expectedType,h=f.type;if("string"!==g.kind&&"number"!==g.kind&&"boolean"!==g.kind&&"object"!==g.kind&&"array"!==g.kind||"value"!==h.kind)if("color"!==g.kind&&"formatted"!==g.kind||"value"!==h.kind&&"string"!==h.kind){if(this.checkSubtype(g,h))return null}else f=c(f,g,b.typeAnnotation||"coerce");else f=c(f,g,b.typeAnnotation||"assert")}if(!(f instanceof ue)&&function a(b){if(b instanceof Fe)return a(b.boundExpression);if(b instanceof De&&"error"===b.name)return!1;if(b instanceof Ee)return!1;var c=b instanceof Ae||b instanceof xe,d=!0;return b.eachChild(function(b){d=c?d&&a(b):d&&b instanceof ue}),!!d&&(P(b)&&R(b,["zoom","heatmap-density","line-progress","accumulated","is-supported-script"]))}(f)){var i=new Ce;try{f=new ue(f.type,f.evaluate(i))}catch(a){return this.error(a.message),null}}return f}return this.error('Unknown expression "'+d+'". If you wanted a literal array, use ["literal", [...]].',0)}return void 0===a?this.error("'undefined' value invalid. Use null instead."):"object"==typeof a?this.error('Bare objects invalid. Use ["literal", {...}] instead.'):this.error("Expected an array, but found "+typeof a+" instead.")},Ge.prototype.concat=function(a,b,c){var d="number"==typeof a?this.path.concat(a):this.path,e=c?this.scope.concat(c):this.scope;return new Ge(this.registry,d,b||null,e,this.errors)},Ge.prototype.error=function(a){for(var b=[],c=arguments.length-1;c-- >0;)b[c]=arguments[c+1];var d=""+this.key+b.map(function(a){return"["+a+"]"}).join("");this.errors.push(new de(d,a))},Ge.prototype.checkSubtype=function(a,b){var c=L(a,b);return c&&this.error(c),c};var He=function(a,b,c){this.type=a,this.input=b,this.labels=[],this.outputs=[];for(var d=0,e=c;d<e.length;d+=1){var f=e[d],g=f[0],h=f[1];this.labels.push(g),this.outputs.push(h)}};He.parse=function(a,b){var c=a[1],d=a.slice(2);if(a.length-1<4)return b.error("Expected at least 4 arguments, but found only "+(a.length-1)+".");if((a.length-1)%2!=0)return b.error("Expected an even number of arguments.");if(!(c=b.parse(c,1,ge)))return null;var e=[],f=null;b.expectedType&&"value"!==b.expectedType.kind&&(f=b.expectedType),d.unshift(-1/0);for(var g=0;g<d.length;g+=2){var h=d[g],i=d[g+1],j=g+1,k=g+2;if("number"!=typeof h)return b.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',j);if(e.length&&e[e.length-1][0]>=h)return b.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',j);var l=b.parse(i,k,f);if(!l)return null;f=f||l.type,e.push([h,l])}return new He(f,c,e)},He.prototype.evaluate=function(a){var b=this.labels,c=this.outputs;if(1===b.length)return c[0].evaluate(a);var d=this.input.evaluate(a);if(d<=b[0])return c[0].evaluate(a);var e=b.length;return d>=b[e-1]?c[e-1].evaluate(a):c[S(b,d)].evaluate(a)},He.prototype.eachChild=function(a){a(this.input);for(var b=0,c=this.outputs;b<c.length;b+=1)a(c[b])},He.prototype.possibleOutputs=function(){var a;return(a=[]).concat.apply(a,this.outputs.map(function(a){return a.possibleOutputs()}))},He.prototype.serialize=function(){for(var a=["step",this.input.serialize()],b=0;b<this.labels.length;b++)b>0&&a.push(this.labels[b]),a.push(this.outputs[b].serialize());return a};var Ie=Object.freeze({number:T,color:function(a,b,c){return new qe(T(a.r,b.r,c),T(a.g,b.g,c),T(a.b,b.b,c),T(a.a,b.a,c))},array:function(a,b,c){return a.map(function(a,d){return T(a,b[d],c)})}}),Je=.95047,Ke=1,Le=1.08883,Me=4/29,Ne=6/29,Oe=3*Ne*Ne,Pe=Ne*Ne*Ne,Qe=Math.PI/180,Re=180/Math.PI,Se={forward:Y,reverse:Z,interpolate:function(a,b,c){return{l:T(a.l,b.l,c),a:T(a.a,b.a,c),b:T(a.b,b.b,c),alpha:T(a.alpha,b.alpha,c)}}},Te={forward:function(a){var b=Y(a),c=b.l,d=b.a,e=b.b,f=Math.atan2(e,d)*Re;return{h:f<0?f+360:f,c:Math.sqrt(d*d+e*e),l:c,alpha:a.a}},reverse:function(a){var b=a.h*Qe,c=a.c;return Z({l:a.l,a:Math.cos(b)*c,b:Math.sin(b)*c,alpha:a.alpha})},interpolate:function(a,b,c){return{h:$(a.h,b.h,c),c:T(a.c,b.c,c),l:T(a.l,b.l,c),alpha:T(a.alpha,b.alpha,c)}}},Ue=Object.freeze({lab:Se,hcl:Te}),Ve=function(a,b,c,d,e){this.type=a,this.operator=b,this.interpolation=c,this.input=d,this.labels=[],this.outputs=[];for(var f=0,g=e;f<g.length;f+=1){var h=g[f],i=h[0],j=h[1];this.labels.push(i),this.outputs.push(j)}};Ve.interpolationFactor=function(a,b,c,d){var e=0;if("exponential"===a.name)e=_(b,a.base,c,d);else if("linear"===a.name)e=_(b,1,c,d);else if("cubic-bezier"===a.name){var f=a.controlPoints;e=new qd(f[0],f[1],f[2],f[3]).solve(_(b,1,c,d))}return e},Ve.parse=function(a,b){var c=a[0],d=a[1],e=a[2],f=a.slice(3);if(!Array.isArray(d)||0===d.length)return b.error("Expected an interpolation type expression.",1);if("linear"===d[0])d={name:"linear"};else if("exponential"===d[0]){var g=d[1];if("number"!=typeof g)return b.error("Exponential interpolation requires a numeric base.",1,1);d={name:"exponential",base:g}}else{if("cubic-bezier"!==d[0])return b.error("Unknown interpolation type "+String(d[0]),1,0);var h=d.slice(1);if(4!==h.length||h.some(function(a){return"number"!=typeof a||a<0||a>1}))return b.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);d={name:"cubic-bezier",controlPoints:h}}if(a.length-1<4)return b.error("Expected at least 4 arguments, but found only "+(a.length-1)+".");if((a.length-1)%2!=0)return b.error("Expected an even number of arguments.");if(!(e=b.parse(e,2,ge)))return null;var i=[],j=null;"interpolate-hcl"===c||"interpolate-lab"===c?j=je:b.expectedType&&"value"!==b.expectedType.kind&&(j=b.expectedType);for(var k=0;k<f.length;k+=2){var l=f[k],m=f[k+1],n=k+3,o=k+4;if("number"!=typeof l)return b.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',n);if(i.length&&i[i.length-1][0]>=l)return b.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',n);var p=b.parse(m,o,j);if(!p)return null;j=j||p.type,i.push([l,p])}return"number"===j.kind||"color"===j.kind||"array"===j.kind&&"number"===j.itemType.kind&&"number"==typeof j.N?new Ve(j,c,d,e,i):b.error("Type "+K(j)+" is not interpolatable.")},Ve.prototype.evaluate=function(a){var b=this.labels,c=this.outputs;if(1===b.length)return c[0].evaluate(a);var d=this.input.evaluate(a);if(d<=b[0])return c[0].evaluate(a);var e=b.length;if(d>=b[e-1])return c[e-1].evaluate(a);var f=S(b,d),g=b[f],h=b[f+1],i=Ve.interpolationFactor(this.interpolation,d,g,h),j=c[f].evaluate(a),k=c[f+1].evaluate(a);return"interpolate"===this.operator?Ie[this.type.kind.toLowerCase()](j,k,i):"interpolate-hcl"===this.operator?Te.reverse(Te.interpolate(Te.forward(j),Te.forward(k),i)):Se.reverse(Se.interpolate(Se.forward(j),Se.forward(k),i))},Ve.prototype.eachChild=function(a){a(this.input);for(var b=0,c=this.outputs;b<c.length;b+=1)a(c[b])},Ve.prototype.possibleOutputs=function(){var a;return(a=[]).concat.apply(a,this.outputs.map(function(a){return a.possibleOutputs()}))},Ve.prototype.serialize=function(){var a;a="linear"===this.interpolation.name?["linear"]:"exponential"===this.interpolation.name?1===this.interpolation.base?["linear"]:["exponential",this.interpolation.base]:["cubic-bezier"].concat(this.interpolation.controlPoints);for(var b=[this.operator,a,this.input.serialize()],c=0;c<this.labels.length;c++)b.push(this.labels[c],this.outputs[c].serialize());return b};var We=function(a,b){this.type=a,this.args=b};We.parse=function(a,b){if(a.length<2)return b.error("Expectected at least one argument.");var c=null,d=b.expectedType;d&&"value"!==d.kind&&(c=d);for(var e=[],f=0,g=a.slice(1);f<g.length;f+=1){var h=g[f],i=b.parse(h,1+e.length,c,void 0,{typeAnnotation:"omit"});if(!i)return null;c=c||i.type,e.push(i)}var j=d&&e.some(function(a){return L(d,a.type)});return new We(j?le:c,e)},We.prototype.evaluate=function(a){for(var b=null,c=0,d=this.args;c<d.length&&null===(b=d[c].evaluate(a));c+=1);return b},We.prototype.eachChild=function(a){this.args.forEach(a)},We.prototype.possibleOutputs=function(){var a;return(a=[]).concat.apply(a,this.args.map(function(a){return a.possibleOutputs()}))},We.prototype.serialize=function(){var a=["coalesce"];return this.eachChild(function(b){a.push(b.serialize())}),a};var Xe=function(a,b){this.type=b.type,this.bindings=[].concat(a),this.result=b};Xe.prototype.evaluate=function(a){return this.result.evaluate(a)},Xe.prototype.eachChild=function(a){for(var b=0,c=this.bindings;b<c.length;b+=1)a(c[b][1]);a(this.result)},Xe.parse=function(a,b){if(a.length<4)return b.error("Expected at least 3 arguments, but found "+(a.length-1)+" instead.");for(var c=[],d=1;d<a.length-1;d+=2){var e=a[d];if("string"!=typeof e)return b.error("Expected string, but found "+typeof e+" instead.",d);if(/[^a-zA-Z0-9_]/.test(e))return b.error("Variable names must contain only alphanumeric characters or '_'.",d);var f=b.parse(a[d+1],d+1);if(!f)return null;c.push([e,f])}var g=b.parse(a[a.length-1],a.length-1,b.expectedType,c);return g?new Xe(c,g):null},Xe.prototype.possibleOutputs=function(){return this.result.possibleOutputs()},Xe.prototype.serialize=function(){for(var a=["let"],b=0,c=this.bindings;b<c.length;b+=1){var d=c[b],e=d[0],f=d[1];a.push(e,f.serialize())}return a.push(this.result.serialize()),a};var Ye=function(a,b,c){this.type=a,this.index=b,this.input=c};Ye.parse=function(a,b){if(3!==a.length)return b.error("Expected 2 arguments, but found "+(a.length-1)+" instead.");var c=b.parse(a[1],1,ge),d=b.parse(a[2],2,J(b.expectedType||le));if(!c||!d)return null;var e=d.type;return new Ye(e.itemType,c,d)},Ye.prototype.evaluate=function(a){var b=this.index.evaluate(a),c=this.input.evaluate(a);if(b<0)throw new ve("Array index out of bounds: "+b+" < 0.");if(b>=c.length)throw new ve("Array index out of bounds: "+b+" > "+(c.length-1)+".");if(b!==Math.floor(b))throw new ve("Array index must be an integer, but found "+b+" instead.");return c[b]},Ye.prototype.eachChild=function(a){a(this.index),a(this.input)},Ye.prototype.possibleOutputs=function(){return[void 0]},Ye.prototype.serialize=function(){return["at",this.index.serialize(),this.input.serialize()]};var Ze=function(a,b,c,d,e,f){this.inputType=a,this.type=b,this.input=c,this.cases=d,this.outputs=e,this.otherwise=f};Ze.parse=function(a,b){if(a.length<5)return b.error("Expected at least 4 arguments, but found only "+(a.length-1)+".");if(a.length%2!=1)return b.error("Expected an even number of arguments.");var c,d;b.expectedType&&"value"!==b.expectedType.kind&&(d=b.expectedType);for(var e={},f=[],g=2;g<a.length-1;g+=2){var h=a[g],i=a[g+1];Array.isArray(h)||(h=[h]);var j=b.concat(g);if(0===h.length)return j.error("Expected at least one branch label.");for(var k=0,l=h;k<l.length;k+=1){var m=l[k];if("number"!=typeof m&&"string"!=typeof m)return j.error("Branch labels must be numbers or strings.");if("number"==typeof m&&Math.abs(m)>Number.MAX_SAFE_INTEGER)return j.error("Branch labels must be integers no larger than "+Number.MAX_SAFE_INTEGER+".");if("number"==typeof m&&Math.floor(m)!==m)return j.error("Numeric branch labels must be integer values.");if(c){if(j.checkSubtype(c,N(m)))return null}else c=N(m);if(void 0!==e[String(m)])return j.error("Branch labels must be unique.");e[String(m)]=f.length}var n=b.parse(i,g,d);if(!n)return null;d=d||n.type,f.push(n)}var o=b.parse(a[1],1,le);if(!o)return null;var p=b.parse(a[a.length-1],a.length-1,d);return p?"value"!==o.type.kind&&b.concat(1).checkSubtype(c,o.type)?null:new Ze(c,d,o,e,f,p):null},Ze.prototype.evaluate=function(a){var b=this.input.evaluate(a);return(N(b)===this.inputType&&this.outputs[this.cases[b]]||this.otherwise).evaluate(a)},Ze.prototype.eachChild=function(a){a(this.input),this.outputs.forEach(a),a(this.otherwise)},Ze.prototype.possibleOutputs=function(){var a;return(a=[]).concat.apply(a,this.outputs.map(function(a){return a.possibleOutputs()})).concat(this.otherwise.possibleOutputs())},Ze.prototype.serialize=function(){for(var a=this,b=["match",this.input.serialize()],c=[],d={},e=0,f=Object.keys(this.cases).sort();e<f.length;e+=1){var g=f[e];void 0===(l=d[this.cases[g]])?(d[this.cases[g]]=c.length,c.push([this.cases[g],[g]])):c[l][1].push(g)}for(var h=function(b){return"number"===a.inputType.kind?Number(b):b},i=0,j=c;i<j.length;i+=1){var k=j[i],l=k[0],m=k[1];1===m.length?b.push(h(m[0])):b.push(m.map(h)),b.push(this.outputs[outputIndex$1].serialize())}return b.push(this.otherwise.serialize()),b};var $e=function(a,b,c){this.type=a,this.branches=b,this.otherwise=c};$e.parse=function(a,b){if(a.length<4)return b.error("Expected at least 3 arguments, but found only "+(a.length-1)+".");if(a.length%2!=0)return b.error("Expected an odd number of arguments.");var c;b.expectedType&&"value"!==b.expectedType.kind&&(c=b.expectedType);for(var d=[],e=1;e<a.length-1;e+=2){var f=b.parse(a[e],e,ie);if(!f)return null;var g=b.parse(a[e+1],e+1,c);if(!g)return null;d.push([f,g]),c=c||g.type}var h=b.parse(a[a.length-1],a.length-1,c);return h?new $e(c,d,h):null},$e.prototype.evaluate=function(a){for(var b=0,c=this.branches;b<c.length;b+=1){var d=c[b],e=d[0],f=d[1];if(e.evaluate(a))return f.evaluate(a)}return this.otherwise.evaluate(a)},$e.prototype.eachChild=function(a){for(var b=0,c=this.branches;b<c.length;b+=1){var d=c[b],e=d[0],f=d[1];a(e),a(f)}a(this.otherwise)},$e.prototype.possibleOutputs=function(){var a;return(a=[]).concat.apply(a,this.branches.map(function(a){return a[0],a[1].possibleOutputs()})).concat(this.otherwise.possibleOutputs())},$e.prototype.serialize=function(){var a=["case"];return this.eachChild(function(b){a.push(b.serialize())}),a};var _e=ca("==",function(a,b,c){return b===c},ba),af=ca("!=",function(a,b,c){return b!==c},function(a,b,c,d){return!ba(0,b,c,d)}),bf=ca("<",function(a,b,c){return b<c},function(a,b,c,d){return d.compare(b,c)<0}),cf=ca(">",function(a,b,c){return b>c},function(a,b,c,d){return d.compare(b,c)>0}),df=ca("<=",function(a,b,c){return b<=c},function(a,b,c,d){return d.compare(b,c)<=0}),ef=ca(">=",function(a,b,c){return b>=c},function(a,b,c,d){return d.compare(b,c)>=0}),ff=function(a,b,c,d,e){this.type=he,this.number=a,this.locale=b,this.currency=c,this.minFractionDigits=d,this.maxFractionDigits=e};ff.parse=function(a,b){if(3!==a.length)return b.error("Expected two arguments.");var c=b.parse(a[1],1,ge);if(!c)return null;var d=a[2];if("object"!=typeof d||Array.isArray(d))return b.error("NumberFormat options argument must be an object.");var e=null;if(d.locale&&!(e=b.parse(d.locale,1,he)))return null;var f=null;if(d.currency&&!(f=b.parse(d.currency,1,he)))return null;var g=null;if(d["min-fraction-digits"]&&!(g=b.parse(d["min-fraction-digits"],1,ge)))return null;var h=null;return d["max-fraction-digits"]&&!(h=b.parse(d["max-fraction-digits"],1,ge))?null:new ff(c,e,f,g,h)},ff.prototype.evaluate=function(a){return new Intl.NumberFormat(this.locale?this.locale.evaluate(a):[],{style:this.currency?"currency":"decimal",currency:this.currency?this.currency.evaluate(a):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(a):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(a):void 0}).format(this.number.evaluate(a))},ff.prototype.eachChild=function(a){a(this.number),this.locale&&a(this.locale),this.currency&&a(this.currency),this.minFractionDigits&&a(this.minFractionDigits),this.maxFractionDigits&&a(this.maxFractionDigits)},ff.prototype.possibleOutputs=function(){return[void 0]},ff.prototype.serialize=function(){var a={};return this.locale&&(a.locale=this.locale.serialize()),this.currency&&(a.currency=this.currency.serialize()),this.minFractionDigits&&(a["min-fraction-digits"]=this.minFractionDigits.serialize()),this.maxFractionDigits&&(a["max-fraction-digits"]=this.maxFractionDigits.serialize()),["number-format",this.number.serialize(),a]};var gf=function(a){this.type=ge,this.input=a};gf.parse=function(a,b){if(2!==a.length)return b.error("Expected 1 argument, but found "+(a.length-1)+" instead.");var c=b.parse(a[1],1);return c?"array"!==c.type.kind&&"string"!==c.type.kind&&"value"!==c.type.kind?b.error("Expected argument of type string or array, but found "+K(c.type)+" instead."):new gf(c):null},gf.prototype.evaluate=function(a){var b=this.input.evaluate(a);if("string"==typeof b)return b.length;if(Array.isArray(b))return b.length;throw new ve("Expected value to be of type string or array, but found "+K(N(b))+" instead.")},gf.prototype.eachChild=function(a){a(this.input)},gf.prototype.possibleOutputs=function(){return[void 0]},gf.prototype.serialize=function(){var a=["length"];return this.eachChild(function(b){a.push(b.serialize())}),a};var hf={"==":_e,"!=":af,">":cf,"<":bf,">=":ef,"<=":df,array:xe,at:Ye,boolean:xe,case:$e,coalesce:We,collator:Ee,format:ye,interpolate:Ve,"interpolate-hcl":Ve,"interpolate-lab":Ve,length:gf,let:Xe,literal:ue,match:Ze,number:xe,"number-format":ff,object:xe,step:He,string:xe,"to-boolean":Ae,"to-color":Ae,"to-number":Ae,"to-string":Ae,var:Fe};De.register(hf,{error:[{kind:"error"},[he],function(a,b){var c=b[0];throw new ve(c.evaluate(a))}],typeof:[he,[le],function(a,b){return K(N(b[0].evaluate(a)))}],"to-rgba":[J(ge,4),[je],function(a,b){return b[0].evaluate(a).toArray()}],rgb:[je,[ge,ge,ge],da],rgba:[je,[ge,ge,ge,ge],da],has:{type:ie,overloads:[[[he],function(a,b){return ea(b[0].evaluate(a),a.properties())}],[[he,ke],function(a,b){var c=b[0],d=b[1];return ea(c.evaluate(a),d.evaluate(a))}]]},get:{type:le,overloads:[[[he],function(a,b){return fa(b[0].evaluate(a),a.properties())}],[[he,ke],function(a,b){var c=b[0],d=b[1];return fa(c.evaluate(a),d.evaluate(a))}]]},"feature-state":[le,[he],function(a,b){return fa(b[0].evaluate(a),a.featureState||{})}],properties:[ke,[],function(a){return a.properties()}],"geometry-type":[he,[],function(a){return a.geometryType()}],id:[le,[],function(a){return a.id()}],zoom:[ge,[],function(a){return a.globals.zoom}],"heatmap-density":[ge,[],function(a){return a.globals.heatmapDensity||0}],"line-progress":[ge,[],function(a){return a.globals.lineProgress||0}],accumulated:[le,[],function(a){return void 0===a.globals.accumulated?null:a.globals.accumulated}],"+":[ge,ga(ge),function(a,b){for(var c=0,d=0,e=b;d<e.length;d+=1)c+=e[d].evaluate(a);return c}],"*":[ge,ga(ge),function(a,b){for(var c=1,d=0,e=b;d<e.length;d+=1)c*=e[d].evaluate(a);return c}],"-":{type:ge,overloads:[[[ge,ge],function(a,b){var c=b[0],d=b[1];return c.evaluate(a)-d.evaluate(a)}],[[ge],function(a,b){return-b[0].evaluate(a)}]]},"/":[ge,[ge,ge],function(a,b){var c=b[0],d=b[1];return c.evaluate(a)/d.evaluate(a)}],"%":[ge,[ge,ge],function(a,b){var c=b[0],d=b[1];return c.evaluate(a)%d.evaluate(a)}],ln2:[ge,[],function(){return Math.LN2}],pi:[ge,[],function(){return Math.PI}],e:[ge,[],function(){return Math.E}],"^":[ge,[ge,ge],function(a,b){var c=b[0],d=b[1];return Math.pow(c.evaluate(a),d.evaluate(a))}],sqrt:[ge,[ge],function(a,b){var c=b[0];return Math.sqrt(c.evaluate(a))}],log10:[ge,[ge],function(a,b){var c=b[0];return Math.log(c.evaluate(a))/Math.LN10}],ln:[ge,[ge],function(a,b){var c=b[0];return Math.log(c.evaluate(a))}],log2:[ge,[ge],function(a,b){var c=b[0];return Math.log(c.evaluate(a))/Math.LN2}],sin:[ge,[ge],function(a,b){var c=b[0];return Math.sin(c.evaluate(a))}],cos:[ge,[ge],function(a,b){var c=b[0];return Math.cos(c.evaluate(a))}],tan:[ge,[ge],function(a,b){var c=b[0];return Math.tan(c.evaluate(a))}],asin:[ge,[ge],function(a,b){var c=b[0];return Math.asin(c.evaluate(a))}],acos:[ge,[ge],function(a,b){var c=b[0];return Math.acos(c.evaluate(a))}],atan:[ge,[ge],function(a,b){var c=b[0];return Math.atan(c.evaluate(a))}],min:[ge,ga(ge),function(a,b){return Math.min.apply(Math,b.map(function(b){return b.evaluate(a)}))}],max:[ge,ga(ge),function(a,b){return Math.max.apply(Math,b.map(function(b){return b.evaluate(a)}))}],abs:[ge,[ge],function(a,b){var c=b[0];return Math.abs(c.evaluate(a))}],round:[ge,[ge],function(a,b){var c=b[0].evaluate(a);return c<0?-Math.round(-c):Math.round(c)}],floor:[ge,[ge],function(a,b){var c=b[0];return Math.floor(c.evaluate(a))}],ceil:[ge,[ge],function(a,b){var c=b[0];return Math.ceil(c.evaluate(a))}],"filter-==":[ie,[he,le],function(a,b){
var c=b[0],d=b[1];return a.properties()[c.value]===d.value}],"filter-id-==":[ie,[le],function(a,b){var c=b[0];return a.id()===c.value}],"filter-type-==":[ie,[he],function(a,b){var c=b[0];return a.geometryType()===c.value}],"filter-<":[ie,[he,le],function(a,b){var c=b[0],d=b[1],e=a.properties()[c.value],f=d.value;return typeof e==typeof f&&e<f}],"filter-id-<":[ie,[le],function(a,b){var c=b[0],d=a.id(),e=c.value;return typeof d==typeof e&&d<e}],"filter->":[ie,[he,le],function(a,b){var c=b[0],d=b[1],e=a.properties()[c.value],f=d.value;return typeof e==typeof f&&e>f}],"filter-id->":[ie,[le],function(a,b){var c=b[0],d=a.id(),e=c.value;return typeof d==typeof e&&d>e}],"filter-<=":[ie,[he,le],function(a,b){var c=b[0],d=b[1],e=a.properties()[c.value],f=d.value;return typeof e==typeof f&&e<=f}],"filter-id-<=":[ie,[le],function(a,b){var c=b[0],d=a.id(),e=c.value;return typeof d==typeof e&&d<=e}],"filter->=":[ie,[he,le],function(a,b){var c=b[0],d=b[1],e=a.properties()[c.value],f=d.value;return typeof e==typeof f&&e>=f}],"filter-id->=":[ie,[le],function(a,b){var c=b[0],d=a.id(),e=c.value;return typeof d==typeof e&&d>=e}],"filter-has":[ie,[le],function(a,b){return b[0].value in a.properties()}],"filter-has-id":[ie,[],function(a){return null!==a.id()}],"filter-type-in":[ie,[J(he)],function(a,b){return b[0].value.indexOf(a.geometryType())>=0}],"filter-id-in":[ie,[J(le)],function(a,b){return b[0].value.indexOf(a.id())>=0}],"filter-in-small":[ie,[he,J(le)],function(a,b){var c=b[0];return b[1].value.indexOf(a.properties()[c.value])>=0}],"filter-in-large":[ie,[he,J(le)],function(a,b){var c=b[0],d=b[1];return function(a,b,c,d){for(;c<=d;){var e=c+d>>1;if(b[e]===a)return!0;b[e]>a?d=e-1:c=e+1}return!1}(a.properties()[c.value],d.value,0,d.value.length-1)}],all:{type:ie,overloads:[[[ie,ie],function(a,b){var c=b[0],d=b[1];return c.evaluate(a)&&d.evaluate(a)}],[ga(ie),function(a,b){for(var c=0,d=b;c<d.length;c+=1)if(!d[c].evaluate(a))return!1;return!0}]]},any:{type:ie,overloads:[[[ie,ie],function(a,b){var c=b[0],d=b[1];return c.evaluate(a)||d.evaluate(a)}],[ga(ie),function(a,b){for(var c=0,d=b;c<d.length;c+=1)if(d[c].evaluate(a))return!0;return!1}]]},"!":[ie,[ie],function(a,b){return!b[0].evaluate(a)}],"is-supported-script":[ie,[he],function(a,b){var c=b[0],d=a.globals&&a.globals.isSupportedScript;return!d||d(c.evaluate(a))}],upcase:[he,[he],function(a,b){return b[0].evaluate(a).toUpperCase()}],downcase:[he,[he],function(a,b){return b[0].evaluate(a).toLowerCase()}],concat:[he,ga(le),function(a,b){return b.map(function(b){return O(b.evaluate(a))}).join("")}],"resolved-locale":[he,[me],function(a,b){return b[0].evaluate(a).resolvedLocale()}]});var jf=function(a,b){var c;this.expression=a,this._warningHistory={},this._evaluator=new Ce,this._defaultValue=b?"color"===(c=b).type&&na(c.default)?new qe(0,0,0,0):"color"===c.type?qe.parse(c.default)||null:void 0===c.default?null:c.default:null,this._enumValues=b&&"enum"===b.type?b.values:null};jf.prototype.evaluateWithoutErrorHandling=function(a,b,c){return this._evaluator.globals=a,this._evaluator.feature=b,this._evaluator.featureState=c,this.expression.evaluate(this._evaluator)},jf.prototype.evaluate=function(a,b,c){this._evaluator.globals=a,this._evaluator.feature=b||null,this._evaluator.featureState=c||null;try{var d=this.expression.evaluate(this._evaluator);if(null==d)return this._defaultValue;if(this._enumValues&&!(d in this._enumValues))throw new ve("Expected value to be one of "+Object.keys(this._enumValues).map(function(a){return JSON.stringify(a)}).join(", ")+", but found "+JSON.stringify(d)+" instead.");return d}catch(a){return this._warningHistory[a.message]||(this._warningHistory[a.message]=!0,"undefined"!=typeof console&&console.warn(a.message)),this._defaultValue}};var kf=function(a,b){this.kind=a,this._styleExpression=b,this.isStateDependent="constant"!==a&&!Q(b.expression)};kf.prototype.evaluateWithoutErrorHandling=function(a,b,c){return this._styleExpression.evaluateWithoutErrorHandling(a,b,c)},kf.prototype.evaluate=function(a,b,c){return this._styleExpression.evaluate(a,b,c)};var lf=function(a,b,c){this.kind=a,this.zoomStops=c.labels,this._styleExpression=b,this.isStateDependent="camera"!==a&&!Q(b.expression),c instanceof Ve&&(this._interpolationType=c.interpolation)};lf.prototype.evaluateWithoutErrorHandling=function(a,b,c){return this._styleExpression.evaluateWithoutErrorHandling(a,b,c)},lf.prototype.evaluate=function(a,b,c){return this._styleExpression.evaluate(a,b,c)},lf.prototype.interpolationFactor=function(a,b,c){return this._interpolationType?Ve.interpolationFactor(this._interpolationType,a,b,c):0};var mf=function(a,b){this._parameters=a,this._specification=b,G(this,function a(b,c){var d,e,f,g="color"===c.type,h=b.stops&&"object"==typeof b.stops[0][0],i=h||void 0!==b.property,j=h||!i,k=b.type||(la(c)?"exponential":"interval");if(g&&((b=G({},b)).stops&&(b.stops=b.stops.map(function(a){return[a[0],qe.parse(a[1])]})),b.default?b.default=qe.parse(b.default):b.default=qe.parse(c.default)),b.colorSpace&&"rgb"!==b.colorSpace&&!Ue[b.colorSpace])throw new Error("Unknown color space: "+b.colorSpace);if("exponential"===k)d=sa;else if("interval"===k)d=ra;else if("categorical"===k){d=qa,e=Object.create(null);for(var l=0,m=b.stops;l<m.length;l+=1){var n=m[l];e[n[0]]=n[1]}f=typeof b.stops[0][0]}else{if("identity"!==k)throw new Error('Unknown function type "'+k+'"');d=ta}if(h){for(var o={},p=[],q=0;q<b.stops.length;q++){var r=b.stops[q],s=r[0].zoom;void 0===o[s]&&(o[s]={zoom:s,type:b.type,property:b.property,default:b.default,stops:[]},p.push(s)),o[s].stops.push([r[0].value,r[1]])}for(var t=[],u=0,v=p;u<v.length;u+=1){var w=v[u];t.push([o[w].zoom,a(o[w],c)])}return{kind:"composite",interpolationFactor:Ve.interpolationFactor.bind(void 0,{name:"linear"}),zoomStops:t.map(function(a){return a[0]}),evaluate:function(a,d){var e=a.zoom;return sa({stops:t,base:b.base},c,e).evaluate(e,d)}}}return j?{kind:"camera",interpolationFactor:"exponential"===k?Ve.interpolationFactor.bind(void 0,{name:"exponential",base:void 0!==b.base?b.base:1}):function(){return 0},zoomStops:b.stops.map(function(a){return a[0]}),evaluate:function(a){var g=a.zoom;return d(b,c,g,e,f)}}:{kind:"source",evaluate:function(a,g){var h=g&&g.properties?g.properties[b.property]:void 0;return void 0===h?pa(b.default,c.default):d(b,c,h,e,f)}}}(this._parameters,this._specification))};mf.deserialize=function(a){return new mf(a._parameters,a._specification)},mf.serialize=function(a){return{_parameters:a._parameters,_specification:a._specification}};var nf={type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}},of={"*":function(){return[]},array:Aa,boolean:function(a){var b=a.value,c=a.key,d=ma(b);return"boolean"!==d?[new ce(c,b,"boolean expected, "+d+" found")]:[]},number:Ba,color:function(a){var b=a.key,c=a.value,d=ma(c);return"string"!==d?[new ce(b,c,"color expected, "+d+" found")]:null===pe(c)?[new ce(b,c,'color expected, "'+c+'" found')]:[]},constants:F,enum:Ea,filter:Na,function:Ca,layer:Ra,object:za,source:Sa,light:Ta,string:Ua,formatted:function(a){return 0===Ua(a).length?[]:Da(a)}};Xa.source=Za(Sa),Xa.light=Za(Ta),Xa.layer=Za(Ra),Xa.filter=Za(Na),Xa.paintProperty=Za(Pa),Xa.layoutProperty=Za(Qa);var pf=Xa,qf=Xa.light,rf=Xa.paintProperty,sf=Xa.layoutProperty,tf=_a,uf=3;_a.prototype.insert=function(a,b,c,d,e){this._forEachCell(b,c,d,e,this._insertCell,this.uid++),this.keys.push(a),this.bboxes.push(b),this.bboxes.push(c),this.bboxes.push(d),this.bboxes.push(e)},_a.prototype._insertReadonly=function(){throw"Cannot insert into a GridIndex created from an ArrayBuffer."},_a.prototype._insertCell=function(a,b,c,d,e,f){this.cells[e].push(f)},_a.prototype.query=function(a,b,c,d,e){var f=this.min,g=this.max;if(a<=f&&b<=f&&g<=c&&g<=d&&!e)return Array.prototype.slice.call(this.keys);var h=[];return this._forEachCell(a,b,c,d,this._queryCell,h,{},e),h},_a.prototype._queryCell=function(a,b,c,d,e,f,g,h){var i=this.cells[e];if(null!==i)for(var j=this.keys,k=this.bboxes,l=0;l<i.length;l++){var m=i[l];if(void 0===g[m]){var n=4*m;(h?h(k[n+0],k[n+1],k[n+2],k[n+3]):a<=k[n+2]&&b<=k[n+3]&&c>=k[n+0]&&d>=k[n+1])?(g[m]=!0,f.push(j[m])):g[m]=!1}}},_a.prototype._forEachCell=function(a,b,c,d,e,f,g,h){for(var i=this._convertToCellCoord(a),j=this._convertToCellCoord(b),k=this._convertToCellCoord(c),l=this._convertToCellCoord(d),m=i;m<=k;m++)for(var n=j;n<=l;n++){var o=this.d*n+m;if((!h||h(this._convertFromCellCoord(m),this._convertFromCellCoord(n),this._convertFromCellCoord(m+1),this._convertFromCellCoord(n+1)))&&e.call(this,a,b,c,d,o,f,g,h))return}},_a.prototype._convertFromCellCoord=function(a){return(a-this.padding)/this.scale},_a.prototype._convertToCellCoord=function(a){return Math.max(0,Math.min(this.d-1,Math.floor(a*this.scale)+this.padding))},_a.prototype.toArrayBuffer=function(){if(this.arrayBuffer)return this.arrayBuffer;for(var a=this.cells,b=uf+this.cells.length+1+1,c=0,d=0;d<this.cells.length;d++)c+=this.cells[d].length;var e=new Int32Array(b+c+this.keys.length+this.bboxes.length);e[0]=this.extent,e[1]=this.n,e[2]=this.padding;for(var f=b,g=0;g<a.length;g++){var h=a[g];e[uf+g]=f,e.set(h,f),f+=h.length}return e[uf+a.length]=f,e.set(this.keys,f),f+=this.keys.length,e[uf+a.length+1]=f,e.set(this.bboxes,f),f+=this.bboxes.length,e.buffer};var vf=self.ImageData,wf={};for(var xf in ab("Object",Object),tf.serialize=function(a,b){var c=a.toArrayBuffer();return b&&b.push(c),{buffer:c}},tf.deserialize=function(a){return new tf(a.buffer)},ab("Grid",tf),ab("Color",qe),ab("Error",Error),ab("StylePropertyFunction",mf),ab("StyleExpression",jf,{omit:["_evaluator"]}),ab("ZoomDependentExpression",lf),ab("ZoomConstantExpression",kf),ab("CompoundExpression",De,{omit:["_evaluate"]}),hf)hf[xf]._classRegistryKey||ab("Expression_"+xf,hf[xf]);var yf=function(){this.first=!0};yf.prototype.update=function(a,b){var c=Math.floor(a);return this.first?(this.first=!1,this.lastIntegerZoom=c,this.lastIntegerZoomTime=0,this.lastZoom=a,this.lastFloorZoom=c,!0):(this.lastFloorZoom>c?(this.lastIntegerZoom=c+1,this.lastIntegerZoomTime=b):this.lastFloorZoom<c&&(this.lastIntegerZoom=c,this.lastIntegerZoomTime=b),a!==this.lastZoom&&(this.lastZoom=a,this.lastFloorZoom=c,!0))};var zf,Af={"Latin-1 Supplement":function(a){return a>=128&&a<=255},Arabic:function(a){return a>=1536&&a<=1791},"Arabic Supplement":function(a){return a>=1872&&a<=1919},"Arabic Extended-A":function(a){return a>=2208&&a<=2303},"Hangul Jamo":function(a){return a>=4352&&a<=4607},"Unified Canadian Aboriginal Syllabics":function(a){return a>=5120&&a<=5759},Khmer:function(a){return a>=6016&&a<=6143},"Unified Canadian Aboriginal Syllabics Extended":function(a){return a>=6320&&a<=6399},"General Punctuation":function(a){return a>=8192&&a<=8303},"Letterlike Symbols":function(a){return a>=8448&&a<=8527},"Number Forms":function(a){return a>=8528&&a<=8591},"Miscellaneous Technical":function(a){return a>=8960&&a<=9215},"Control Pictures":function(a){return a>=9216&&a<=9279},"Optical Character Recognition":function(a){return a>=9280&&a<=9311},"Enclosed Alphanumerics":function(a){return a>=9312&&a<=9471},"Geometric Shapes":function(a){return a>=9632&&a<=9727},"Miscellaneous Symbols":function(a){return a>=9728&&a<=9983},"Miscellaneous Symbols and Arrows":function(a){return a>=11008&&a<=11263},"CJK Radicals Supplement":function(a){return a>=11904&&a<=12031},"Kangxi Radicals":function(a){return a>=12032&&a<=12255},"Ideographic Description Characters":function(a){return a>=12272&&a<=12287},"CJK Symbols and Punctuation":function(a){return a>=12288&&a<=12351},Hiragana:function(a){return a>=12352&&a<=12447},Katakana:function(a){return a>=12448&&a<=12543},Bopomofo:function(a){return a>=12544&&a<=12591},"Hangul Compatibility Jamo":function(a){return a>=12592&&a<=12687},Kanbun:function(a){return a>=12688&&a<=12703},"Bopomofo Extended":function(a){return a>=12704&&a<=12735},"CJK Strokes":function(a){return a>=12736&&a<=12783},"Katakana Phonetic Extensions":function(a){return a>=12784&&a<=12799},"Enclosed CJK Letters and Months":function(a){return a>=12800&&a<=13055},"CJK Compatibility":function(a){return a>=13056&&a<=13311},"CJK Unified Ideographs Extension A":function(a){return a>=13312&&a<=19903},"Yijing Hexagram Symbols":function(a){return a>=19904&&a<=19967},"CJK Unified Ideographs":function(a){return a>=19968&&a<=40959},"Yi Syllables":function(a){return a>=40960&&a<=42127},"Yi Radicals":function(a){return a>=42128&&a<=42191},"Hangul Jamo Extended-A":function(a){return a>=43360&&a<=43391},"Hangul Syllables":function(a){return a>=44032&&a<=55215},"Hangul Jamo Extended-B":function(a){return a>=55216&&a<=55295},"Private Use Area":function(a){return a>=57344&&a<=63743},"CJK Compatibility Ideographs":function(a){return a>=63744&&a<=64255},"Arabic Presentation Forms-A":function(a){return a>=64336&&a<=65023},"Vertical Forms":function(a){return a>=65040&&a<=65055},"CJK Compatibility Forms":function(a){return a>=65072&&a<=65103},"Small Form Variants":function(a){return a>=65104&&a<=65135},"Arabic Presentation Forms-B":function(a){return a>=65136&&a<=65279},"Halfwidth and Fullwidth Forms":function(a){return a>=65280&&a<=65519}},Bf=!1,Cf=null,Df=!1,Ef=new ae,Ff={applyArabicShaping:null,processBidirectionalText:null,processStyledBidirectionalText:null,isLoaded:function(){return Df||null!=Ff.applyArabicShaping}},Gf=function(a,b){this.zoom=a,b?(this.now=b.now,this.fadeDuration=b.fadeDuration,this.zoomHistory=b.zoomHistory,this.transition=b.transition):(this.now=0,this.fadeDuration=0,this.zoomHistory=new yf,this.transition={})};Gf.prototype.isSupportedScript=function(a){return function(a,b){for(var c=0,d=a;c<d.length;c+=1)if(!hb(d[c].charCodeAt(0),b))return!1;return!0}(a,Ff.isLoaded())},Gf.prototype.crossFadingFactor=function(){return 0===this.fadeDuration?1:Math.min((this.now-this.zoomHistory.lastIntegerZoomTime)/this.fadeDuration,1)},Gf.prototype.getCrossfadeParameters=function(){var a=this.zoom,b=a-Math.floor(a),c=this.crossFadingFactor();return a>this.zoomHistory.lastIntegerZoom?{fromScale:2,toScale:1,t:b+(1-b)*c}:{fromScale:.5,toScale:1,t:1-(1-c)*b}};var Hf=function(a,b){this.property=a,this.value=b,this.expression=ya(void 0===b?a.specification.default:b,a.specification)};Hf.prototype.isDataDriven=function(){return"source"===this.expression.kind||"composite"===this.expression.kind},Hf.prototype.possiblyEvaluate=function(a){return this.property.possiblyEvaluate(this,a)};var If=function(a){this.property=a,this.value=new Hf(a,void 0)};If.prototype.transitioned=function(a,b){return new Kf(this.property,this.value,b,i({},a.transition,this.transition),a.now)},If.prototype.untransitioned=function(){return new Kf(this.property,this.value,null,{},0)};var Jf=function(a){this._properties=a,this._values=Object.create(a.defaultTransitionablePropertyValues)};Jf.prototype.getValue=function(a){return q(this._values[a].value.value)},Jf.prototype.setValue=function(a,b){this._values.hasOwnProperty(a)||(this._values[a]=new If(this._values[a].property)),this._values[a].value=new Hf(this._values[a].property,null===b?void 0:q(b))},Jf.prototype.getTransition=function(a){return q(this._values[a].transition)},Jf.prototype.setTransition=function(a,b){this._values.hasOwnProperty(a)||(this._values[a]=new If(this._values[a].property)),this._values[a].transition=q(b)||void 0},Jf.prototype.serialize=function(){for(var a={},b=0,c=Object.keys(this._values);b<c.length;b+=1){var d=c[b],e=this.getValue(d);void 0!==e&&(a[d]=e);var f=this.getTransition(d);void 0!==f&&(a[d+"-transition"]=f)}return a},Jf.prototype.transitioned=function(a,b){for(var c=new Lf(this._properties),d=0,e=Object.keys(this._values);d<e.length;d+=1){var f=e[d];c._values[f]=this._values[f].transitioned(a,b._values[f])}return c},Jf.prototype.untransitioned=function(){for(var a=new Lf(this._properties),b=0,c=Object.keys(this._values);b<c.length;b+=1){var d=c[b];a._values[d]=this._values[d].untransitioned()}return a};var Kf=function(a,b,c,d,e){this.property=a,this.value=b,this.begin=e+d.delay||0,this.end=this.begin+d.duration||0,a.specification.transition&&(d.delay||d.duration)&&(this.prior=c)};Kf.prototype.possiblyEvaluate=function(a){var b=a.now||0,c=this.value.possiblyEvaluate(a),d=this.prior;if(d){if(b>this.end)return this.prior=null,c;if(this.value.isDataDriven())return this.prior=null,c;if(b<this.begin)return d.possiblyEvaluate(a);var e=(b-this.begin)/(this.end-this.begin);return this.property.interpolate(d.possiblyEvaluate(a),c,function(a){if(a<=0)return 0;if(a>=1)return 1;var b=a*a,c=b*a;return 4*(a<.5?c:3*(a-b)+c-.75)}(e))}return c};var Lf=function(a){this._properties=a,this._values=Object.create(a.defaultTransitioningPropertyValues)};Lf.prototype.possiblyEvaluate=function(a){for(var b=new Of(this._properties),c=0,d=Object.keys(this._values);c<d.length;c+=1){var e=d[c];b._values[e]=this._values[e].possiblyEvaluate(a)}return b},Lf.prototype.hasTransition=function(){for(var a=0,b=Object.keys(this._values);a<b.length;a+=1){var c=b[a];if(this._values[c].prior)return!0}return!1};var Mf=function(a){this._properties=a,this._values=Object.create(a.defaultPropertyValues)};Mf.prototype.getValue=function(a){return q(this._values[a].value)},Mf.prototype.setValue=function(a,b){this._values[a]=new Hf(this._values[a].property,null===b?void 0:q(b))},Mf.prototype.serialize=function(){for(var a={},b=0,c=Object.keys(this._values);b<c.length;b+=1){var d=c[b],e=this.getValue(d);void 0!==e&&(a[d]=e)}return a},Mf.prototype.possiblyEvaluate=function(a){for(var b=new Of(this._properties),c=0,d=Object.keys(this._values);c<d.length;c+=1){var e=d[c];b._values[e]=this._values[e].possiblyEvaluate(a)}return b};var Nf=function(a,b,c){this.property=a,this.value=b,this.parameters=c};Nf.prototype.isConstant=function(){return"constant"===this.value.kind},Nf.prototype.constantOr=function(a){return"constant"===this.value.kind?this.value.value:a},Nf.prototype.evaluate=function(a,b){return this.property.evaluate(this.value,this.parameters,a,b)};var Of=function(a){this._properties=a,this._values=Object.create(a.defaultPossiblyEvaluatedValues)};Of.prototype.get=function(a){return this._values[a]};var Pf=function(a){this.specification=a};Pf.prototype.possiblyEvaluate=function(a,b){return a.expression.evaluate(b)},Pf.prototype.interpolate=function(a,b,c){var d=Ie[this.specification.type];return d?d(a,b,c):a};var Qf=function(a){this.specification=a};Qf.prototype.possiblyEvaluate=function(a,b){return"constant"===a.expression.kind||"camera"===a.expression.kind?new Nf(this,{kind:"constant",value:a.expression.evaluate(b)},b):new Nf(this,a.expression,b)},Qf.prototype.interpolate=function(a,b,c){if("constant"!==a.value.kind||"constant"!==b.value.kind)return a;if(void 0===a.value.value||void 0===b.value.value)return new Nf(this,{kind:"constant",value:void 0},a.parameters);var d=Ie[this.specification.type];return d?new Nf(this,{kind:"constant",value:d(a.value.value,b.value.value,c)},a.parameters):a},Qf.prototype.evaluate=function(a,b,c,d){return"constant"===a.kind?a.value:a.evaluate(b,c,d)};var Rf=function(a){function b(){a.apply(this,arguments)}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.possiblyEvaluate=function(a,b){if(void 0===a.value)return new Nf(this,{kind:"constant",value:void 0},b);if("constant"===a.expression.kind){var c=a.expression.evaluate(b),d=this._calculate(c,c,c,b);return new Nf(this,{kind:"constant",value:d},b)}if("camera"===a.expression.kind){var e=this._calculate(a.expression.evaluate({zoom:b.zoom-1}),a.expression.evaluate({zoom:b.zoom}),a.expression.evaluate({zoom:b.zoom+1}),b);return new Nf(this,{kind:"constant",value:e},b)}return new Nf(this,a.expression,b)},b.prototype.evaluate=function(a,b,c,d){if("source"===a.kind){var e=a.evaluate(b,c,d);return this._calculate(e,e,e,b)}return"composite"===a.kind?this._calculate(a.evaluate({zoom:Math.floor(b.zoom)-1},c,d),a.evaluate({zoom:Math.floor(b.zoom)},c,d),a.evaluate({zoom:Math.floor(b.zoom)+1},c,d),b):a.value},b.prototype._calculate=function(a,b,c,d){return d.zoom>d.zoomHistory.lastIntegerZoom?{from:a,to:b}:{from:c,to:b}},b.prototype.interpolate=function(a){return a},b}(Qf),Sf=function(a){this.specification=a};Sf.prototype.possiblyEvaluate=function(a,b){if(void 0!==a.value){if("constant"===a.expression.kind){var c=a.expression.evaluate(b);return this._calculate(c,c,c,b)}return this._calculate(a.expression.evaluate(new Gf(Math.floor(b.zoom-1),b)),a.expression.evaluate(new Gf(Math.floor(b.zoom),b)),a.expression.evaluate(new Gf(Math.floor(b.zoom+1),b)),b)}},Sf.prototype._calculate=function(a,b,c,d){return d.zoom>d.zoomHistory.lastIntegerZoom?{from:a,to:b}:{from:c,to:b}},Sf.prototype.interpolate=function(a){return a};var Tf=function(a){this.specification=a};Tf.prototype.possiblyEvaluate=function(a,b){return!!a.expression.evaluate(b)},Tf.prototype.interpolate=function(){return!1};var Uf=function(a){for(var b in this.properties=a,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},a){var c=a[b],d=this.defaultPropertyValues[b]=new Hf(c,void 0),e=this.defaultTransitionablePropertyValues[b]=new If(c);this.defaultTransitioningPropertyValues[b]=e.untransitioned(),this.defaultPossiblyEvaluatedValues[b]=d.possiblyEvaluate({})}};ab("DataDrivenProperty",Qf),ab("DataConstantProperty",Pf),ab("CrossFadedDataDrivenProperty",Rf),ab("CrossFadedProperty",Sf),ab("ColorRampProperty",Tf);var Vf=function(a){function b(b,c){if(a.call(this),this.id=b.id,this.type=b.type,this.visibility="visible",this._featureFilter=function(){return!0},"custom"!==b.type&&(b=b,this.metadata=b.metadata,this.minzoom=b.minzoom,this.maxzoom=b.maxzoom,"background"!==b.type&&(this.source=b.source,this.sourceLayer=b["source-layer"],this.filter=b.filter),c.layout&&(this._unevaluatedLayout=new Mf(c.layout)),c.paint)){for(var d in this._transitionablePaint=new Jf(c.paint),b.paint)this.setPaintProperty(d,b.paint[d],{validate:!1});for(var e in b.layout)this.setLayoutProperty(e,b.layout[e],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned()}}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.getCrossfadeParameters=function(){return this._crossfadeParameters},b.prototype.getLayoutProperty=function(a){return"visibility"===a?this.visibility:this._unevaluatedLayout.getValue(a)},b.prototype.setLayoutProperty=function(a,b,c){if(void 0===c&&(c={}),null!=b){var d="layers."+this.id+".layout."+a;if(this._validate(sf,d,a,b,c))return}"visibility"!==a?this._unevaluatedLayout.setValue(a,b):this.visibility="none"===b?b:"visible"},b.prototype.getPaintProperty=function(a){return n(a,"-transition")?this._transitionablePaint.getTransition(a.slice(0,-"-transition".length)):this._transitionablePaint.getValue(a)},b.prototype.setPaintProperty=function(a,b,c){if(void 0===c&&(c={}),null!=b){var d="layers."+this.id+".paint."+a;if(this._validate(rf,d,a,b,c))return!1}if(n(a,"-transition"))return this._transitionablePaint.setTransition(a.slice(0,-"-transition".length),b||void 0),!1;var e=this._transitionablePaint._values[a],f="cross-faded-data-driven"===e.property.specification["property-type"]&&!e.value.value&&b,g=this._transitionablePaint._values[a].value.isDataDriven();this._transitionablePaint.setValue(a,b);var h=this._transitionablePaint._values[a].value.isDataDriven();return this._handleSpecialPaintPropertyUpdate(a),h||g||f},b.prototype._handleSpecialPaintPropertyUpdate=function(a){},b.prototype.isHidden=function(a){return!!(this.minzoom&&a<this.minzoom)||!!(this.maxzoom&&a>=this.maxzoom)||"none"===this.visibility},b.prototype.updateTransitions=function(a){this._transitioningPaint=this._transitionablePaint.transitioned(a,this._transitioningPaint)},b.prototype.hasTransition=function(){return this._transitioningPaint.hasTransition()},b.prototype.recalculate=function(a){a.getCrossfadeParameters&&(this._crossfadeParameters=a.getCrossfadeParameters()),this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(a)),this.paint=this._transitioningPaint.possiblyEvaluate(a)},b.prototype.serialize=function(){var a={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return"none"===this.visibility&&(a.layout=a.layout||{},a.layout.visibility="none"),p(a,function(a,b){return!(void 0===a||"layout"===b&&!Object.keys(a).length||"paint"===b&&!Object.keys(a).length)})},b.prototype._validate=function(a,b,c,d,e){return void 0===e&&(e={}),(!e||!1!==e.validate)&&$a(this,a.call(pf,{key:b,layerType:this.type,objectKey:c,value:d,styleSpec:be,style:{glyphs:!0,sprite:!0}}))},b.prototype.hasOffscreenPass=function(){return!1},b.prototype.resize=function(){},b.prototype.isStateDependent=function(){for(var a in this.paint._values){var b=this.paint.get(a);if(b instanceof Nf&&ja(b.property.specification)&&("source"===b.value.kind||"composite"===b.value.kind)&&b.value.isStateDependent)return!0}return!1},b}(ae),Wf={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array},Xf=function(a,b){this._structArray=a,this._pos1=b*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8},Yf=function(){this.isTransferred=!1,this.capacity=-1,this.resize(0)};Yf.serialize=function(a,b){return a._trim(),b&&(a.isTransferred=!0,b.push(a.arrayBuffer)),{length:a.length,arrayBuffer:a.arrayBuffer}},Yf.deserialize=function(a){var b=Object.create(this.prototype);return b.arrayBuffer=a.arrayBuffer,b.length=a.length,b.capacity=a.arrayBuffer.byteLength/b.bytesPerElement,b._refreshViews(),b},Yf.prototype._trim=function(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())},Yf.prototype.clear=function(){this.length=0},Yf.prototype.resize=function(a){this.reserve(a),this.length=a},Yf.prototype.reserve=function(a){if(a>this.capacity){this.capacity=Math.max(a,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);var b=this.uint8;this._refreshViews(),b&&this.uint8.set(b)}},Yf.prototype._refreshViews=function(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")};var Zf=function(a){function b(){a.apply(this,arguments)}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},b.prototype.emplaceBack=function(a,b){var c=this.length;return this.resize(c+1),this.emplace(c,a,b)},b.prototype.emplace=function(a,b,c){var d=2*a;return this.int16[d+0]=b,this.int16[d+1]=c,a},b}(Yf);Zf.prototype.bytesPerElement=4,ab("StructArrayLayout2i4",Zf);var $f=function(a){function b(){a.apply(this,arguments)}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},b.prototype.emplaceBack=function(a,b,c,d){var e=this.length;return this.resize(e+1),this.emplace(e,a,b,c,d)},b.prototype.emplace=function(a,b,c,d,e){var f=4*a;return this.int16[f+0]=b,this.int16[f+1]=c,this.int16[f+2]=d,this.int16[f+3]=e,a},b}(Yf);$f.prototype.bytesPerElement=8,ab("StructArrayLayout4i8",$f);var _f=function(a){function b(){a.apply(this,arguments)}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},b.prototype.emplaceBack=function(a,b,c,d,e,f){var g=this.length;return this.resize(g+1),this.emplace(g,a,b,c,d,e,f)},b.prototype.emplace=function(a,b,c,d,e,f,g){var h=6*a;return this.int16[h+0]=b,this.int16[h+1]=c,this.int16[h+2]=d,this.int16[h+3]=e,this.int16[h+4]=f,this.int16[h+5]=g,a},b}(Yf);_f.prototype.bytesPerElement=12,ab("StructArrayLayout2i4i12",_f);var ag=function(a){function b(){a.apply(this,arguments)}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},b.prototype.emplaceBack=function(a,b,c,d,e,f,g,h){var i=this.length;return this.resize(i+1),this.emplace(i,a,b,c,d,e,f,g,h)},b.prototype.emplace=function(a,b,c,d,e,f,g,h,i){var j=6*a,k=12*a;return this.int16[j+0]=b,this.int16[j+1]=c,this.int16[j+2]=d,this.int16[j+3]=e,this.uint8[k+8]=f,this.uint8[k+9]=g,this.uint8[k+10]=h,this.uint8[k+11]=i,a},b}(Yf);ag.prototype.bytesPerElement=12,ab("StructArrayLayout4i4ub12",ag);var bg=function(a){function b(){a.apply(this,arguments)}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},b.prototype.emplaceBack=function(a,b,c,d,e,f,g,h){var i=this.length;return this.resize(i+1),this.emplace(i,a,b,c,d,e,f,g,h)},b.prototype.emplace=function(a,b,c,d,e,f,g,h,i){var j=8*a;return this.uint16[j+0]=b,this.uint16[j+1]=c,this.uint16[j+2]=d,this.uint16[j+3]=e,this.uint16[j+4]=f,this.uint16[j+5]=g,this.uint16[j+6]=h,this.uint16[j+7]=i,a},b}(Yf);bg.prototype.bytesPerElement=16,ab("StructArrayLayout8ui16",bg);var cg=function(a){function b(){a.apply(this,arguments)}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},b.prototype.emplaceBack=function(a,b,c,d,e,f,g,h){var i=this.length;return this.resize(i+1),this.emplace(i,a,b,c,d,e,f,g,h)},b.prototype.emplace=function(a,b,c,d,e,f,g,h,i){var j=8*a;return this.int16[j+0]=b,this.int16[j+1]=c,this.int16[j+2]=d,this.int16[j+3]=e,this.uint16[j+4]=f,this.uint16[j+5]=g,this.uint16[j+6]=h,this.uint16[j+7]=i,a},b}(Yf);cg.prototype.bytesPerElement=16,ab("StructArrayLayout4i4ui16",cg);var dg=function(a){function b(){a.apply(this,arguments)}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},b.prototype.emplaceBack=function(a,b,c){var d=this.length;return this.resize(d+1),this.emplace(d,a,b,c)},b.prototype.emplace=function(a,b,c,d){var e=3*a;return this.float32[e+0]=b,this.float32[e+1]=c,this.float32[e+2]=d,a},b}(Yf);dg.prototype.bytesPerElement=12,ab("StructArrayLayout3f12",dg);var eg=function(a){function b(){a.apply(this,arguments)}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)},b.prototype.emplaceBack=function(a){var b=this.length;return this.resize(b+1),this.emplace(b,a)},b.prototype.emplace=function(a,b){var c=1*a;return this.uint32[c+0]=b,a},b}(Yf);eg.prototype.bytesPerElement=4,ab("StructArrayLayout1ul4",eg);var fg=function(a){function b(){a.apply(this,arguments)}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},
b.prototype.emplaceBack=function(a,b,c,d,e,f,g,h,i,j,k){var l=this.length;return this.resize(l+1),this.emplace(l,a,b,c,d,e,f,g,h,i,j,k)},b.prototype.emplace=function(a,b,c,d,e,f,g,h,i,j,k,l){var m=12*a,n=6*a;return this.int16[m+0]=b,this.int16[m+1]=c,this.int16[m+2]=d,this.int16[m+3]=e,this.int16[m+4]=f,this.int16[m+5]=g,this.uint32[n+3]=h,this.uint16[m+8]=i,this.uint16[m+9]=j,this.int16[m+10]=k,this.int16[m+11]=l,a},b}(Yf);fg.prototype.bytesPerElement=24,ab("StructArrayLayout6i1ul2ui2i24",fg);var gg=function(a){function b(){a.apply(this,arguments)}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},b.prototype.emplaceBack=function(a,b,c,d,e,f){var g=this.length;return this.resize(g+1),this.emplace(g,a,b,c,d,e,f)},b.prototype.emplace=function(a,b,c,d,e,f,g){var h=6*a;return this.int16[h+0]=b,this.int16[h+1]=c,this.int16[h+2]=d,this.int16[h+3]=e,this.int16[h+4]=f,this.int16[h+5]=g,a},b}(Yf);gg.prototype.bytesPerElement=12,ab("StructArrayLayout2i2i2i12",gg);var hg=function(a){function b(){a.apply(this,arguments)}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer)},b.prototype.emplaceBack=function(a,b){var c=this.length;return this.resize(c+1),this.emplace(c,a,b)},b.prototype.emplace=function(a,b,c){var d=4*a;return this.uint8[d+0]=b,this.uint8[d+1]=c,a},b}(Yf);hg.prototype.bytesPerElement=4,ab("StructArrayLayout2ub4",hg);var ig=function(a){function b(){a.apply(this,arguments)}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},b.prototype.emplaceBack=function(a,b,c,d,e,f,g,h,i,j,k,l,m,n){var o=this.length;return this.resize(o+1),this.emplace(o,a,b,c,d,e,f,g,h,i,j,k,l,m,n)},b.prototype.emplace=function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o){var p=20*a,q=10*a,r=40*a;return this.int16[p+0]=b,this.int16[p+1]=c,this.uint16[p+2]=d,this.uint16[p+3]=e,this.uint32[q+2]=f,this.uint32[q+3]=g,this.uint32[q+4]=h,this.uint16[p+10]=i,this.uint16[p+11]=j,this.uint16[p+12]=k,this.float32[q+7]=l,this.float32[q+8]=m,this.uint8[r+36]=n,this.uint8[r+37]=o,a},b}(Yf);ig.prototype.bytesPerElement=40,ab("StructArrayLayout2i2ui3ul3ui2f2ub40",ig);var jg=function(a){function b(){a.apply(this,arguments)}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)},b.prototype.emplaceBack=function(a,b,c,d,e,f,g,h,i,j,k,l,m,n){var o=this.length;return this.resize(o+1),this.emplace(o,a,b,c,d,e,f,g,h,i,j,k,l,m,n)},b.prototype.emplace=function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o){var p=16*a,q=8*a;return this.int16[p+0]=b,this.int16[p+1]=c,this.int16[p+2]=d,this.int16[p+3]=e,this.uint16[p+4]=f,this.uint16[p+5]=g,this.uint16[p+6]=h,this.uint16[p+7]=i,this.uint16[p+8]=j,this.uint16[p+9]=k,this.uint16[p+10]=l,this.uint16[p+11]=m,this.uint16[p+12]=n,this.uint32[q+7]=o,a},b}(Yf);jg.prototype.bytesPerElement=32,ab("StructArrayLayout4i9ui1ul32",jg);var kg=function(a){function b(){a.apply(this,arguments)}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},b.prototype.emplaceBack=function(a){var b=this.length;return this.resize(b+1),this.emplace(b,a)},b.prototype.emplace=function(a,b){var c=1*a;return this.float32[c+0]=b,a},b}(Yf);kg.prototype.bytesPerElement=4,ab("StructArrayLayout1f4",kg);var lg=function(a){function b(){a.apply(this,arguments)}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},b.prototype.emplaceBack=function(a,b,c){var d=this.length;return this.resize(d+1),this.emplace(d,a,b,c)},b.prototype.emplace=function(a,b,c,d){var e=3*a;return this.int16[e+0]=b,this.int16[e+1]=c,this.int16[e+2]=d,a},b}(Yf);lg.prototype.bytesPerElement=6,ab("StructArrayLayout3i6",lg);var mg=function(a){function b(){a.apply(this,arguments)}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},b.prototype.emplaceBack=function(a,b,c){var d=this.length;return this.resize(d+1),this.emplace(d,a,b,c)},b.prototype.emplace=function(a,b,c,d){var e=2*a,f=4*a;return this.uint32[e+0]=b,this.uint16[f+2]=c,this.uint16[f+3]=d,a},b}(Yf);mg.prototype.bytesPerElement=8,ab("StructArrayLayout1ul2ui8",mg);var ng=function(a){function b(){a.apply(this,arguments)}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},b.prototype.emplaceBack=function(a,b,c){var d=this.length;return this.resize(d+1),this.emplace(d,a,b,c)},b.prototype.emplace=function(a,b,c,d){var e=3*a;return this.uint16[e+0]=b,this.uint16[e+1]=c,this.uint16[e+2]=d,a},b}(Yf);ng.prototype.bytesPerElement=6,ab("StructArrayLayout3ui6",ng);var og=function(a){function b(){a.apply(this,arguments)}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},b.prototype.emplaceBack=function(a,b){var c=this.length;return this.resize(c+1),this.emplace(c,a,b)},b.prototype.emplace=function(a,b,c){var d=2*a;return this.uint16[d+0]=b,this.uint16[d+1]=c,a},b}(Yf);og.prototype.bytesPerElement=4,ab("StructArrayLayout2ui4",og);var pg=function(a){function b(){a.apply(this,arguments)}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},b.prototype.emplaceBack=function(a){var b=this.length;return this.resize(b+1),this.emplace(b,a)},b.prototype.emplace=function(a,b){var c=1*a;return this.uint16[c+0]=b,a},b}(Yf);pg.prototype.bytesPerElement=2,ab("StructArrayLayout1ui2",pg);var qg=function(a){function b(){a.apply(this,arguments)}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},b.prototype.emplaceBack=function(a,b){var c=this.length;return this.resize(c+1),this.emplace(c,a,b)},b.prototype.emplace=function(a,b,c){var d=2*a;return this.float32[d+0]=b,this.float32[d+1]=c,a},b}(Yf);qg.prototype.bytesPerElement=8,ab("StructArrayLayout2f8",qg);var rg=function(a){function b(){a.apply(this,arguments)}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},b.prototype.emplaceBack=function(a,b,c,d){var e=this.length;return this.resize(e+1),this.emplace(e,a,b,c,d)},b.prototype.emplace=function(a,b,c,d,e){var f=4*a;return this.float32[f+0]=b,this.float32[f+1]=c,this.float32[f+2]=d,this.float32[f+3]=e,a},b}(Yf);rg.prototype.bytesPerElement=16,ab("StructArrayLayout4f16",rg);var sg=function(a){function b(){a.apply(this,arguments)}a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b;var c={anchorPointX:{configurable:!0},anchorPointY:{configurable:!0},x1:{configurable:!0},y1:{configurable:!0},x2:{configurable:!0},y2:{configurable:!0},featureIndex:{configurable:!0},sourceLayerIndex:{configurable:!0},bucketIndex:{configurable:!0},radius:{configurable:!0},signedDistanceFromAnchor:{configurable:!0},anchorPoint:{configurable:!0}};return c.anchorPointX.get=function(){return this._structArray.int16[this._pos2+0]},c.anchorPointX.set=function(a){this._structArray.int16[this._pos2+0]=a},c.anchorPointY.get=function(){return this._structArray.int16[this._pos2+1]},c.anchorPointY.set=function(a){this._structArray.int16[this._pos2+1]=a},c.x1.get=function(){return this._structArray.int16[this._pos2+2]},c.x1.set=function(a){this._structArray.int16[this._pos2+2]=a},c.y1.get=function(){return this._structArray.int16[this._pos2+3]},c.y1.set=function(a){this._structArray.int16[this._pos2+3]=a},c.x2.get=function(){return this._structArray.int16[this._pos2+4]},c.x2.set=function(a){this._structArray.int16[this._pos2+4]=a},c.y2.get=function(){return this._structArray.int16[this._pos2+5]},c.y2.set=function(a){this._structArray.int16[this._pos2+5]=a},c.featureIndex.get=function(){return this._structArray.uint32[this._pos4+3]},c.featureIndex.set=function(a){this._structArray.uint32[this._pos4+3]=a},c.sourceLayerIndex.get=function(){return this._structArray.uint16[this._pos2+8]},c.sourceLayerIndex.set=function(a){this._structArray.uint16[this._pos2+8]=a},c.bucketIndex.get=function(){return this._structArray.uint16[this._pos2+9]},c.bucketIndex.set=function(a){this._structArray.uint16[this._pos2+9]=a},c.radius.get=function(){return this._structArray.int16[this._pos2+10]},c.radius.set=function(a){this._structArray.int16[this._pos2+10]=a},c.signedDistanceFromAnchor.get=function(){return this._structArray.int16[this._pos2+11]},c.signedDistanceFromAnchor.set=function(a){this._structArray.int16[this._pos2+11]=a},c.anchorPoint.get=function(){return new rd(this.anchorPointX,this.anchorPointY)},Object.defineProperties(b.prototype,c),b}(Xf);sg.prototype.size=24;var tg=function(a){function b(){a.apply(this,arguments)}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.get=function(a){return new sg(this,a)},b}(fg);ab("CollisionBoxArray",tg);var ug=function(a){function b(){a.apply(this,arguments)}a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b;var c={anchorX:{configurable:!0},anchorY:{configurable:!0},glyphStartIndex:{configurable:!0},numGlyphs:{configurable:!0},vertexStartIndex:{configurable:!0},lineStartIndex:{configurable:!0},lineLength:{configurable:!0},segment:{configurable:!0},lowerSize:{configurable:!0},upperSize:{configurable:!0},lineOffsetX:{configurable:!0},lineOffsetY:{configurable:!0},writingMode:{configurable:!0},hidden:{configurable:!0}};return c.anchorX.get=function(){return this._structArray.int16[this._pos2+0]},c.anchorX.set=function(a){this._structArray.int16[this._pos2+0]=a},c.anchorY.get=function(){return this._structArray.int16[this._pos2+1]},c.anchorY.set=function(a){this._structArray.int16[this._pos2+1]=a},c.glyphStartIndex.get=function(){return this._structArray.uint16[this._pos2+2]},c.glyphStartIndex.set=function(a){this._structArray.uint16[this._pos2+2]=a},c.numGlyphs.get=function(){return this._structArray.uint16[this._pos2+3]},c.numGlyphs.set=function(a){this._structArray.uint16[this._pos2+3]=a},c.vertexStartIndex.get=function(){return this._structArray.uint32[this._pos4+2]},c.vertexStartIndex.set=function(a){this._structArray.uint32[this._pos4+2]=a},c.lineStartIndex.get=function(){return this._structArray.uint32[this._pos4+3]},c.lineStartIndex.set=function(a){this._structArray.uint32[this._pos4+3]=a},c.lineLength.get=function(){return this._structArray.uint32[this._pos4+4]},c.lineLength.set=function(a){this._structArray.uint32[this._pos4+4]=a},c.segment.get=function(){return this._structArray.uint16[this._pos2+10]},c.segment.set=function(a){this._structArray.uint16[this._pos2+10]=a},c.lowerSize.get=function(){return this._structArray.uint16[this._pos2+11]},c.lowerSize.set=function(a){this._structArray.uint16[this._pos2+11]=a},c.upperSize.get=function(){return this._structArray.uint16[this._pos2+12]},c.upperSize.set=function(a){this._structArray.uint16[this._pos2+12]=a},c.lineOffsetX.get=function(){return this._structArray.float32[this._pos4+7]},c.lineOffsetX.set=function(a){this._structArray.float32[this._pos4+7]=a},c.lineOffsetY.get=function(){return this._structArray.float32[this._pos4+8]},c.lineOffsetY.set=function(a){this._structArray.float32[this._pos4+8]=a},c.writingMode.get=function(){return this._structArray.uint8[this._pos1+36]},c.writingMode.set=function(a){this._structArray.uint8[this._pos1+36]=a},c.hidden.get=function(){return this._structArray.uint8[this._pos1+37]},c.hidden.set=function(a){this._structArray.uint8[this._pos1+37]=a},Object.defineProperties(b.prototype,c),b}(Xf);ug.prototype.size=40;var vg=function(a){function b(){a.apply(this,arguments)}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.get=function(a){return new ug(this,a)},b}(ig);ab("PlacedSymbolArray",vg);var wg=function(a){function b(){a.apply(this,arguments)}a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b;var c={anchorX:{configurable:!0},anchorY:{configurable:!0},horizontalPlacedTextSymbolIndex:{configurable:!0},verticalPlacedTextSymbolIndex:{configurable:!0},key:{configurable:!0},textBoxStartIndex:{configurable:!0},textBoxEndIndex:{configurable:!0},iconBoxStartIndex:{configurable:!0},iconBoxEndIndex:{configurable:!0},featureIndex:{configurable:!0},numGlyphVertices:{configurable:!0},numVerticalGlyphVertices:{configurable:!0},numIconVertices:{configurable:!0},crossTileID:{configurable:!0}};return c.anchorX.get=function(){return this._structArray.int16[this._pos2+0]},c.anchorX.set=function(a){this._structArray.int16[this._pos2+0]=a},c.anchorY.get=function(){return this._structArray.int16[this._pos2+1]},c.anchorY.set=function(a){this._structArray.int16[this._pos2+1]=a},c.horizontalPlacedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+2]},c.horizontalPlacedTextSymbolIndex.set=function(a){this._structArray.int16[this._pos2+2]=a},c.verticalPlacedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+3]},c.verticalPlacedTextSymbolIndex.set=function(a){this._structArray.int16[this._pos2+3]=a},c.key.get=function(){return this._structArray.uint16[this._pos2+4]},c.key.set=function(a){this._structArray.uint16[this._pos2+4]=a},c.textBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+5]},c.textBoxStartIndex.set=function(a){this._structArray.uint16[this._pos2+5]=a},c.textBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+6]},c.textBoxEndIndex.set=function(a){this._structArray.uint16[this._pos2+6]=a},c.iconBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+7]},c.iconBoxStartIndex.set=function(a){this._structArray.uint16[this._pos2+7]=a},c.iconBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+8]},c.iconBoxEndIndex.set=function(a){this._structArray.uint16[this._pos2+8]=a},c.featureIndex.get=function(){return this._structArray.uint16[this._pos2+9]},c.featureIndex.set=function(a){this._structArray.uint16[this._pos2+9]=a},c.numGlyphVertices.get=function(){return this._structArray.uint16[this._pos2+10]},c.numGlyphVertices.set=function(a){this._structArray.uint16[this._pos2+10]=a},c.numVerticalGlyphVertices.get=function(){return this._structArray.uint16[this._pos2+11]},c.numVerticalGlyphVertices.set=function(a){this._structArray.uint16[this._pos2+11]=a},c.numIconVertices.get=function(){return this._structArray.uint16[this._pos2+12]},c.numIconVertices.set=function(a){this._structArray.uint16[this._pos2+12]=a},c.crossTileID.get=function(){return this._structArray.uint32[this._pos4+7]},c.crossTileID.set=function(a){this._structArray.uint32[this._pos4+7]=a},Object.defineProperties(b.prototype,c),b}(Xf);wg.prototype.size=32;var xg=function(a){function b(){a.apply(this,arguments)}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.get=function(a){return new wg(this,a)},b}(jg);ab("SymbolInstanceArray",xg);var yg=function(a){function b(){a.apply(this,arguments)}a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b;var c={offsetX:{configurable:!0}};return c.offsetX.get=function(){return this._structArray.float32[this._pos4+0]},c.offsetX.set=function(a){this._structArray.float32[this._pos4+0]=a},Object.defineProperties(b.prototype,c),b}(Xf);yg.prototype.size=4;var zg=function(a){function b(){a.apply(this,arguments)}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.getoffsetX=function(a){return this.float32[1*a+0]},b.prototype.get=function(a){return new yg(this,a)},b}(kg);ab("GlyphOffsetArray",zg);var Ag=function(a){function b(){a.apply(this,arguments)}a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b;var c={x:{configurable:!0},y:{configurable:!0},tileUnitDistanceFromAnchor:{configurable:!0}};return c.x.get=function(){return this._structArray.int16[this._pos2+0]},c.x.set=function(a){this._structArray.int16[this._pos2+0]=a},c.y.get=function(){return this._structArray.int16[this._pos2+1]},c.y.set=function(a){this._structArray.int16[this._pos2+1]=a},c.tileUnitDistanceFromAnchor.get=function(){return this._structArray.int16[this._pos2+2]},c.tileUnitDistanceFromAnchor.set=function(a){this._structArray.int16[this._pos2+2]=a},Object.defineProperties(b.prototype,c),b}(Xf);Ag.prototype.size=6;var Bg=function(a){function b(){a.apply(this,arguments)}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.getx=function(a){return this.int16[3*a+0]},b.prototype.gety=function(a){return this.int16[3*a+1]},b.prototype.gettileUnitDistanceFromAnchor=function(a){return this.int16[3*a+2]},b.prototype.get=function(a){return new Ag(this,a)},b}(lg);ab("SymbolLineVertexArray",Bg);var Cg=function(a){function b(){a.apply(this,arguments)}a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b;var c={featureIndex:{configurable:!0},sourceLayerIndex:{configurable:!0},bucketIndex:{configurable:!0}};return c.featureIndex.get=function(){return this._structArray.uint32[this._pos4+0]},c.featureIndex.set=function(a){this._structArray.uint32[this._pos4+0]=a},c.sourceLayerIndex.get=function(){return this._structArray.uint16[this._pos2+2]},c.sourceLayerIndex.set=function(a){this._structArray.uint16[this._pos2+2]=a},c.bucketIndex.get=function(){return this._structArray.uint16[this._pos2+3]},c.bucketIndex.set=function(a){this._structArray.uint16[this._pos2+3]=a},Object.defineProperties(b.prototype,c),b}(Xf);Cg.prototype.size=8;var Dg=function(a){function b(){a.apply(this,arguments)}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.get=function(a){return new Cg(this,a)},b}(mg);ab("FeatureIndexArray",Dg);var Eg=ib([{name:"a_pos",components:2,type:"Int16"}],4),Fg=Eg.members,Gg=(Eg.size,Eg.alignment,function(a){void 0===a&&(a=[]),this.segments=a});Gg.prototype.prepareSegment=function(a,b,c,d){var e=this.segments[this.segments.length-1];return a>Gg.MAX_VERTEX_ARRAY_LENGTH&&r("Max vertices per segment is "+Gg.MAX_VERTEX_ARRAY_LENGTH+": bucket requested "+a),(!e||e.vertexLength+a>Gg.MAX_VERTEX_ARRAY_LENGTH||e.sortKey!==d)&&(e={vertexOffset:b.length,primitiveOffset:c.length,vertexLength:0,primitiveLength:0},void 0!==d&&(e.sortKey=d),this.segments.push(e)),e},Gg.prototype.get=function(){return this.segments},Gg.prototype.destroy=function(){for(var a=0,b=this.segments;a<b.length;a+=1){var c=b[a];for(var d in c.vaos)c.vaos[d].destroy()}},Gg.simpleSegment=function(a,b,c,d){return new Gg([{vertexOffset:a,primitiveOffset:b,vertexLength:c,primitiveLength:d,vaos:{},sortKey:0}])},Gg.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,ab("SegmentVector",Gg);var Hg=function(){this.ids=[],this.positions=[],this.indexed=!1};Hg.prototype.add=function(a,b,c,d){this.ids.push(a),this.positions.push(b,c,d)},Hg.prototype.getPositions=function(a){for(var b=0,c=this.ids.length-1;b<c;){var d=b+c>>1;this.ids[d]>=a?c=d:b=d+1}for(var e=[];this.ids[b]===a;){var f=this.positions[3*b],g=this.positions[3*b+1],h=this.positions[3*b+2];e.push({index:f,start:g,end:h}),b++}return e},Hg.serialize=function(a,b){var c=new Float64Array(a.ids),d=new Uint32Array(a.positions);return function a(b,c,d,e){if(!(d>=e)){for(var f=b[d+e>>1],g=d-1,h=e+1;;){do{g++}while(b[g]<f);do{h--}while(b[h]>f);if(g>=h)break;lb(b,g,h),lb(c,3*g,3*h),lb(c,3*g+1,3*h+1),lb(c,3*g+2,3*h+2)}a(b,c,d,h),a(b,c,h+1,e)}}(c,d,0,c.length-1),b.push(c.buffer,d.buffer),{ids:c,positions:d}},Hg.deserialize=function(a){var b=new Hg;return b.ids=a.ids,b.positions=a.positions,b.indexed=!0,b},ab("FeaturePositionMap",Hg);var Ig=function(a,b){this.gl=a.gl,this.location=b},Jg=function(a){function b(b,c){a.call(this,b,c),this.current=0}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.set=function(a){this.current!==a&&(this.current=a,this.gl.uniform1i(this.location,a))},b}(Ig),Kg=function(a){function b(b,c){a.call(this,b,c),this.current=0}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.set=function(a){this.current!==a&&(this.current=a,this.gl.uniform1f(this.location,a))},b}(Ig),Lg=function(a){function b(b,c){a.call(this,b,c),this.current=[0,0]}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.set=function(a){a[0]===this.current[0]&&a[1]===this.current[1]||(this.current=a,this.gl.uniform2f(this.location,a[0],a[1]))},b}(Ig),Mg=function(a){function b(b,c){a.call(this,b,c),this.current=[0,0,0]}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.set=function(a){a[0]===this.current[0]&&a[1]===this.current[1]&&a[2]===this.current[2]||(this.current=a,this.gl.uniform3f(this.location,a[0],a[1],a[2]))},b}(Ig),Ng=function(a){function b(b,c){a.call(this,b,c),this.current=[0,0,0,0]}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.set=function(a){a[0]===this.current[0]&&a[1]===this.current[1]&&a[2]===this.current[2]&&a[3]===this.current[3]||(this.current=a,this.gl.uniform4f(this.location,a[0],a[1],a[2],a[3]))},b}(Ig),Og=function(a){function b(b,c){a.call(this,b,c),this.current=qe.transparent}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.set=function(a){a.r===this.current.r&&a.g===this.current.g&&a.b===this.current.b&&a.a===this.current.a||(this.current=a,this.gl.uniform4f(this.location,a.r,a.g,a.b,a.a))},b}(Ig),Pg=new Float32Array(16),Qg=function(a){function b(b,c){a.call(this,b,c),this.current=Pg}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.set=function(a){if(a[12]!==this.current[12]||a[0]!==this.current[0])return this.current=a,void this.gl.uniformMatrix4fv(this.location,!1,a);for(var b=1;b<16;b++)if(a[b]!==this.current[b]){this.current=a,this.gl.uniformMatrix4fv(this.location,!1,a);break}},b}(Ig),Rg=function(a,b,c){this.value=a,this.names=b,this.uniformNames=this.names.map(function(a){return"u_"+a}),this.type=c,this.maxValue=-1/0};Rg.prototype.defines=function(){return this.names.map(function(a){return"#define HAS_UNIFORM_u_"+a})},Rg.prototype.setConstantPatternPositions=function(){},Rg.prototype.populatePaintArray=function(){},Rg.prototype.updatePaintArray=function(){},Rg.prototype.upload=function(){},Rg.prototype.destroy=function(){},Rg.prototype.setUniforms=function(a,b,c,d){b.set(d.constantOr(this.value))},Rg.prototype.getBinding=function(a,b){return"color"===this.type?new Og(a,b):new Kg(a,b)},Rg.serialize=function(a){var b=a.value,c=a.names,d=a.type;return{value:bb(b),names:c,type:d}},Rg.deserialize=function(a){var b=a.value,c=a.names,d=a.type;return new Rg(cb(b),c,d)};var Sg=function(a,b,c){this.value=a,this.names=b,this.uniformNames=this.names.map(function(a){return"u_"+a}),this.type=c,this.maxValue=-1/0,this.patternPositions={patternTo:null,patternFrom:null}};Sg.prototype.defines=function(){return this.names.map(function(a){return"#define HAS_UNIFORM_u_"+a})},Sg.prototype.populatePaintArray=function(){},Sg.prototype.updatePaintArray=function(){},Sg.prototype.upload=function(){},Sg.prototype.destroy=function(){},Sg.prototype.setConstantPatternPositions=function(a,b){this.patternPositions.patternTo=a.tlbr,this.patternPositions.patternFrom=b.tlbr},Sg.prototype.setUniforms=function(a,b,c,d,e){var f=this.patternPositions;"u_pattern_to"===e&&f.patternTo&&b.set(f.patternTo),"u_pattern_from"===e&&f.patternFrom&&b.set(f.patternFrom)},Sg.prototype.getBinding=function(a,b){return new Ng(a,b)};var Tg=function(a,b,c,d){this.expression=a,this.names=b,this.type=c,this.uniformNames=this.names.map(function(a){return"a_"+a}),this.maxValue=-1/0,this.paintVertexAttributes=b.map(function(a){return{name:"a_"+a,type:"Float32",components:"color"===c?2:1,offset:0}}),this.paintVertexArray=new d};Tg.prototype.defines=function(){return[]},Tg.prototype.setConstantPatternPositions=function(){},Tg.prototype.populatePaintArray=function(a,b){var c=this.paintVertexArray,d=c.length;c.reserve(a);var e=this.expression.evaluate(new Gf(0),b,{});if("color"===this.type)for(var f=mb(e),g=d;g<a;g++)c.emplaceBack(f[0],f[1]);else{for(var h=d;h<a;h++)c.emplaceBack(e);this.maxValue=Math.max(this.maxValue,e)}},Tg.prototype.updatePaintArray=function(a,b,c,d){var e=this.paintVertexArray,f=this.expression.evaluate({zoom:0},c,d);if("color"===this.type)for(var g=mb(f),h=a;h<b;h++)e.emplace(h,g[0],g[1]);else{for(var i=a;i<b;i++)e.emplace(i,f);this.maxValue=Math.max(this.maxValue,f)}},Tg.prototype.upload=function(a){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=a.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))},Tg.prototype.destroy=function(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()},Tg.prototype.setUniforms=function(a,b){b.set(0)},Tg.prototype.getBinding=function(a,b){return new Kg(a,b)};var Ug=function(a,b,c,d,e,f){this.expression=a,this.names=b,this.uniformNames=this.names.map(function(a){return"a_"+a+"_t"}),this.type=c,this.useIntegerZoom=d,this.zoom=e,this.maxValue=-1/0;var g=f;this.paintVertexAttributes=b.map(function(a){return{name:"a_"+a,type:"Float32",components:"color"===c?4:2,offset:0}}),this.paintVertexArray=new g};Ug.prototype.defines=function(){return[]},Ug.prototype.setConstantPatternPositions=function(){},Ug.prototype.populatePaintArray=function(a,b){var c=this.paintVertexArray,d=c.length;c.reserve(a);var e=this.expression.evaluate(new Gf(this.zoom),b,{}),f=this.expression.evaluate(new Gf(this.zoom+1),b,{});if("color"===this.type)for(var g=mb(e),h=mb(f),i=d;i<a;i++)c.emplaceBack(g[0],g[1],h[0],h[1]);else{for(var j=d;j<a;j++)c.emplaceBack(e,f);this.maxValue=Math.max(this.maxValue,e,f)}},Ug.prototype.updatePaintArray=function(a,b,c,d){var e=this.paintVertexArray,f=this.expression.evaluate({zoom:this.zoom},c,d),g=this.expression.evaluate({zoom:this.zoom+1},c,d);if("color"===this.type)for(var h=mb(f),i=mb(g),j=a;j<b;j++)e.emplace(j,h[0],h[1],i[0],i[1]);else{for(var k=a;k<b;k++)e.emplace(k,f,g);this.maxValue=Math.max(this.maxValue,f,g)}},Ug.prototype.upload=function(a){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=a.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))},Ug.prototype.destroy=function(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()},Ug.prototype.interpolationFactor=function(a){return this.useIntegerZoom?this.expression.interpolationFactor(Math.floor(a),this.zoom,this.zoom+1):this.expression.interpolationFactor(a,this.zoom,this.zoom+1)},Ug.prototype.setUniforms=function(a,b,c){b.set(this.interpolationFactor(c.zoom))},Ug.prototype.getBinding=function(a,b){return new Kg(a,b)};var Vg=function(a,b,c,d,e,f,g){this.expression=a,this.names=b,this.type=c,this.uniformNames=this.names.map(function(a){return"a_"+a+"_t"}),this.useIntegerZoom=d,this.zoom=e,this.maxValue=-1/0,this.layerId=g,this.paintVertexAttributes=b.map(function(a){return{name:"a_"+a,type:"Uint16",components:4,offset:0}}),this.zoomInPaintVertexArray=new f,this.zoomOutPaintVertexArray=new f};Vg.prototype.defines=function(){return[]},Vg.prototype.setConstantPatternPositions=function(){},Vg.prototype.populatePaintArray=function(a,b,c){var d=this.zoomInPaintVertexArray,e=this.zoomOutPaintVertexArray,f=this.layerId,g=d.length;if(d.reserve(a),e.reserve(a),c&&b.patterns&&b.patterns[f]){var h=b.patterns[f],i=h.min,j=h.mid,k=h.max,l=c[i],m=c[j],n=c[k];if(!l||!m||!n)return;for(var o=g;o<a;o++)d.emplaceBack(m.tl[0],m.tl[1],m.br[0],m.br[1],l.tl[0],l.tl[1],l.br[0],l.br[1]),e.emplaceBack(m.tl[0],m.tl[1],m.br[0],m.br[1],n.tl[0],n.tl[1],n.br[0],n.br[1])}},Vg.prototype.updatePaintArray=function(a,b,c,d,e){var f=this.zoomInPaintVertexArray,g=this.zoomOutPaintVertexArray,h=this.layerId;if(e&&c.patterns&&c.patterns[h]){var i=c.patterns[h],j=i.min,k=i.mid,l=i.max,m=e[j],n=e[k],o=e[l];if(!m||!n||!o)return;for(var p=a;p<b;p++)f.emplace(p,n.tl[0],n.tl[1],n.br[0],n.br[1],m.tl[0],m.tl[1],m.br[0],m.br[1]),g.emplace(p,n.tl[0],n.tl[1],n.br[0],n.br[1],o.tl[0],o.tl[1],o.br[0],o.br[1])}},Vg.prototype.upload=function(a){this.zoomInPaintVertexArray&&this.zoomInPaintVertexArray.arrayBuffer&&this.zoomOutPaintVertexArray&&this.zoomOutPaintVertexArray.arrayBuffer&&(this.zoomInPaintVertexBuffer=a.createVertexBuffer(this.zoomInPaintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent),this.zoomOutPaintVertexBuffer=a.createVertexBuffer(this.zoomOutPaintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))},Vg.prototype.destroy=function(){this.zoomOutPaintVertexBuffer&&this.zoomOutPaintVertexBuffer.destroy(),this.zoomInPaintVertexBuffer&&this.zoomInPaintVertexBuffer.destroy()},Vg.prototype.setUniforms=function(a,b){b.set(0)},Vg.prototype.getBinding=function(a,b){return new Kg(a,b)};var Wg=function(){this.binders={},this.cacheKey="",this._buffers=[],this._featureMap=new Hg,this._bufferOffset=0};Wg.createDynamic=function(a,b,c){var d=new Wg,e=[];for(var f in a.paint._values)if(c(f)){var g=a.paint.get(f);if(g instanceof Nf&&ja(g.property.specification)){var h=nb(f,a.type),i=g.property.specification.type,j=g.property.useIntegerZoom;if("cross-faded"===g.property.specification["property-type"]||"cross-faded-data-driven"===g.property.specification["property-type"])if("constant"===g.value.kind)d.binders[f]=new Sg(g.value.value,h,i),e.push("/u_"+f);else{var k=ob(f,i,"source");d.binders[f]=new Vg(g.value,h,i,j,b,k,a.id),e.push("/a_"+f)}else if("constant"===g.value.kind)d.binders[f]=new Rg(g.value.value,h,i),e.push("/u_"+f);else if("source"===g.value.kind){var l=ob(f,i,"source");d.binders[f]=new Tg(g.value,h,i,l),e.push("/a_"+f)}else{var m=ob(f,i,"composite");d.binders[f]=new Ug(g.value,h,i,j,b,m),e.push("/z_"+f)}}}return d.cacheKey=e.sort().join(""),d},Wg.prototype.populatePaintArrays=function(a,b,c,d){for(var e in this.binders)this.binders[e].populatePaintArray(a,b,d)
;void 0!==b.id&&this._featureMap.add(+b.id,c,this._bufferOffset,a),this._bufferOffset=a},Wg.prototype.setConstantPatternPositions=function(a,b){for(var c in this.binders)this.binders[c].setConstantPatternPositions(a,b)},Wg.prototype.updatePaintArrays=function(a,b,c,d){var e=!1;for(var f in a)for(var g=0,h=this._featureMap.getPositions(+f);g<h.length;g+=1){var i=h[g],j=b.feature(i.index);for(var k in this.binders){var l=this.binders[k];if(!(l instanceof Rg||l instanceof Sg)&&!0===l.expression.isStateDependent){var m=c.paint.get(k);l.expression=m.value,l.updatePaintArray(i.start,i.end,j,a[f],d),e=!0}}}return e},Wg.prototype.defines=function(){var a=[];for(var b in this.binders)a.push.apply(a,this.binders[b].defines());return a},Wg.prototype.getPaintVertexBuffers=function(){return this._buffers},Wg.prototype.getUniforms=function(a,b){var c={};for(var d in this.binders)for(var e=this.binders[d],f=0,g=e.uniformNames;f<g.length;f+=1){var h=g[f];c[h]=e.getBinding(a,b[h])}return c},Wg.prototype.setUniforms=function(a,b,c,d){for(var e in this.binders)for(var f=this.binders[e],g=0,h=f.uniformNames;g<h.length;g+=1){var i=h[g];f.setUniforms(a,b[i],d,c.get(e),i)}},Wg.prototype.updatePatternPaintBuffers=function(a){var b=[];for(var c in this.binders){var d=this.binders[c];if(d instanceof Vg){var e=2===a.fromScale?d.zoomInPaintVertexBuffer:d.zoomOutPaintVertexBuffer;e&&b.push(e)}else(d instanceof Tg||d instanceof Ug)&&d.paintVertexBuffer&&b.push(d.paintVertexBuffer)}this._buffers=b},Wg.prototype.upload=function(a){for(var b in this.binders)this.binders[b].upload(a);var c=[];for(var d in this.binders){var e=this.binders[d];(e instanceof Tg||e instanceof Ug)&&e.paintVertexBuffer&&c.push(e.paintVertexBuffer)}this._buffers=c},Wg.prototype.destroy=function(){for(var a in this.binders)this.binders[a].destroy()};var Xg=function(a,b,c,d){void 0===d&&(d=function(){return!0}),this.programConfigurations={};for(var e=0,f=b;e<f.length;e+=1){var g=f[e];this.programConfigurations[g.id]=Wg.createDynamic(g,c,d),this.programConfigurations[g.id].layoutAttributes=a}this.needsUpload=!1};Xg.prototype.populatePaintArrays=function(a,b,c,d){for(var e in this.programConfigurations)this.programConfigurations[e].populatePaintArrays(a,b,c,d);this.needsUpload=!0},Xg.prototype.updatePaintArrays=function(a,b,c,d){for(var e=0,f=c;e<f.length;e+=1){var g=f[e];this.needsUpload=this.programConfigurations[g.id].updatePaintArrays(a,b,g,d)||this.needsUpload}},Xg.prototype.get=function(a){return this.programConfigurations[a]},Xg.prototype.upload=function(a){if(this.needsUpload){for(var b in this.programConfigurations)this.programConfigurations[b].upload(a);this.needsUpload=!1}},Xg.prototype.destroy=function(){for(var a in this.programConfigurations)this.programConfigurations[a].destroy()},ab("ConstantBinder",Rg),ab("CrossFadedConstantBinder",Sg),ab("SourceExpressionBinder",Tg),ab("CrossFadedCompositeBinder",Vg),ab("CompositeExpressionBinder",Ug),ab("ProgramConfiguration",Wg,{omit:["_buffers"]}),ab("ProgramConfigurationSet",Xg);var Yg,Zg=8192,$g=(Yg=16,{min:-1*Math.pow(2,Yg-1),max:Math.pow(2,Yg-1)-1}),_g=function(a){this.zoom=a.zoom,this.overscaling=a.overscaling,this.layers=a.layers,this.layerIds=this.layers.map(function(a){return a.id}),this.index=a.index,this.hasPattern=!1,this.layoutVertexArray=new Zf,this.indexArray=new ng,this.segments=new Gg,this.programConfigurations=new Xg(Fg,a.layers,a.zoom),this.stateDependentLayerIds=this.layers.filter(function(a){return a.isStateDependent()}).map(function(a){return a.id})};_g.prototype.populate=function(a,b){for(var c=0,d=a;c<d.length;c+=1){var e=d[c],f=e.feature,g=e.index,h=e.sourceLayerIndex;if(this.layers[0]._featureFilter(new Gf(this.zoom),f)){var i=pb(f);this.addFeature(f,i,g),b.featureIndex.insert(f,i,g,h,this.index)}}},_g.prototype.update=function(a,b,c){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(a,b,this.stateDependentLayers,c)},_g.prototype.isEmpty=function(){return 0===this.layoutVertexArray.length},_g.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},_g.prototype.upload=function(a){this.uploaded||(this.layoutVertexBuffer=a.createVertexBuffer(this.layoutVertexArray,Fg),this.indexBuffer=a.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(a),this.uploaded=!0},_g.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())},_g.prototype.addFeature=function(a,b,c){for(var d=0,e=b;d<e.length;d+=1)for(var f=0,g=e[d];f<g.length;f+=1){var h=g[f],i=h.x,j=h.y;if(!(i<0||i>=Zg||j<0||j>=Zg)){var k=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray),l=k.vertexLength;qb(this.layoutVertexArray,i,j,-1,-1),qb(this.layoutVertexArray,i,j,1,-1),qb(this.layoutVertexArray,i,j,1,1),qb(this.layoutVertexArray,i,j,-1,1),this.indexArray.emplaceBack(l,l+1,l+2),this.indexArray.emplaceBack(l,l+3,l+2),k.vertexLength+=4,k.primitiveLength+=2}}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,a,c,{})},ab("CircleBucket",_g,{omit:["layers"]});var ah={paint:new Uf({"circle-radius":new Qf(be.paint_circle["circle-radius"]),"circle-color":new Qf(be.paint_circle["circle-color"]),"circle-blur":new Qf(be.paint_circle["circle-blur"]),"circle-opacity":new Qf(be.paint_circle["circle-opacity"]),"circle-translate":new Pf(be.paint_circle["circle-translate"]),"circle-translate-anchor":new Pf(be.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new Pf(be.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new Pf(be.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new Qf(be.paint_circle["circle-stroke-width"]),"circle-stroke-color":new Qf(be.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new Qf(be.paint_circle["circle-stroke-opacity"])})},bh="undefined"!=typeof Float32Array?Float32Array:Array;Math.PI;Gb(),function(){var a;a=new bh(4),bh!=Float32Array&&(a[0]=0,a[1]=0,a[2]=0,a[3]=0)}();Gb(),Hb(1,0,0),Hb(0,1,0),Jb(),Jb(),Fb(),function(){var a;a=new bh(2),bh!=Float32Array&&(a[0]=0,a[1]=0)}();var ch=function(a){function b(b){a.call(this,b,ah)}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.createBucket=function(a){return new _g(a)},b.prototype.queryRadius=function(a){var b=a;return Cb("circle-radius",this,b)+Cb("circle-stroke-width",this,b)+Db(this.paint.get("circle-translate"))},b.prototype.queryIntersectsFeature=function(a,b,c,d,e,f,g,h){for(var i=Eb(a,this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),f.angle,g),j=this.paint.get("circle-radius").evaluate(b,c)+this.paint.get("circle-stroke-width").evaluate(b,c),k="map"===this.paint.get("circle-pitch-alignment"),l=k?i:function(a,b){return a.map(function(a){return Kb(a,b)})}(i,h),m=k?j*g:j,n=0,o=d;n<o.length;n+=1)for(var p=0,q=o[n];p<q.length;p+=1){var r=q[p],s=k?r:Kb(r,h),t=m,u=Ib([],[r.x,r.y,0,1],h);if("viewport"===this.paint.get("circle-pitch-scale")&&"map"===this.paint.get("circle-pitch-alignment")?t*=u[3]/f.cameraToCenterDistance:"map"===this.paint.get("circle-pitch-scale")&&"viewport"===this.paint.get("circle-pitch-alignment")&&(t*=f.cameraToCenterDistance/u[3]),sb(l,s,t))return!0}return!1},b}(Vf),dh=function(a){function b(){a.apply(this,arguments)}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b}(_g);ab("HeatmapBucket",dh,{omit:["layers"]});var eh=function(a,b){Lb(this,a,1,b)};eh.prototype.resize=function(a){Mb(this,a,1)},eh.prototype.clone=function(){return new eh({width:this.width,height:this.height},new Uint8Array(this.data))},eh.copy=function(a,b,c,d,e){Nb(a,b,c,d,e,1)};var fh=function(a,b){Lb(this,a,4,b)};fh.prototype.resize=function(a){Mb(this,a,4)},fh.prototype.clone=function(){return new fh({width:this.width,height:this.height},new Uint8Array(this.data))},fh.copy=function(a,b,c,d,e){Nb(a,b,c,d,e,4)},ab("AlphaImage",eh),ab("RGBAImage",fh);var gh={paint:new Uf({"heatmap-radius":new Qf(be.paint_heatmap["heatmap-radius"]),"heatmap-weight":new Qf(be.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new Pf(be.paint_heatmap["heatmap-intensity"]),"heatmap-color":new Tf(be.paint_heatmap["heatmap-color"]),"heatmap-opacity":new Pf(be.paint_heatmap["heatmap-opacity"])})},hh=function(a){function b(b){a.call(this,b,gh),this._updateColorRamp()}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.createBucket=function(a){return new dh(a)},b.prototype._handleSpecialPaintPropertyUpdate=function(a){"heatmap-color"===a&&this._updateColorRamp()},b.prototype._updateColorRamp=function(){var a=this._transitionablePaint._values["heatmap-color"].value.expression;this.colorRamp=Ob(a,"heatmapDensity"),this.colorRampTexture=null},b.prototype.resize=function(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)},b.prototype.queryRadius=function(){return 0},b.prototype.queryIntersectsFeature=function(){return!1},b.prototype.hasOffscreenPass=function(){return 0!==this.paint.get("heatmap-opacity")&&"none"!==this.visibility},b}(Vf),ih={paint:new Uf({"hillshade-illumination-direction":new Pf(be.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new Pf(be.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new Pf(be.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new Pf(be.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new Pf(be.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new Pf(be.paint_hillshade["hillshade-accent-color"])})},jh=function(a){function b(b){a.call(this,b,ih)}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.hasOffscreenPass=function(){return 0!==this.paint.get("hillshade-exaggeration")&&"none"!==this.visibility},b}(Vf),kh=ib([{name:"a_pos",components:2,type:"Int16"}],4),lh=kh.members,mh=(kh.size,kh.alignment,Pb),nh=Pb;Pb.deviation=function(a,b,c,d){var e=b&&b.length,f=e?b[0]*c:a.length,g=Math.abs(jc(a,0,f,c));if(e)for(var h=0,i=b.length;h<i;h++){var j=b[h]*c,k=h<i-1?b[h+1]*c:a.length;g-=Math.abs(jc(a,j,k,c))}var l=0;for(h=0;h<d.length;h+=3){var m=d[h]*c,n=d[h+1]*c,o=d[h+2]*c;l+=Math.abs((a[m]-a[o])*(a[n+1]-a[m+1])-(a[m]-a[n])*(a[o+1]-a[m+1]))}return 0===g&&0===l?0:Math.abs((l-g)/g)},Pb.flatten=function(a){for(var b=a[0][0].length,c={vertices:[],holes:[],dimensions:b},d=0,e=0;e<a.length;e++){for(var f=0;f<a[e].length;f++)for(var g=0;g<b;g++)c.vertices.push(a[e][f][g]);e>0&&(d+=a[e-1].length,c.holes.push(d))}return c},mh.default=nh;var oh=function(a){this.zoom=a.zoom,this.overscaling=a.overscaling,this.layers=a.layers,this.layerIds=this.layers.map(function(a){return a.id}),this.index=a.index,this.hasPattern=!1,this.layoutVertexArray=new Zf,this.indexArray=new ng,this.indexArray2=new og,this.programConfigurations=new Xg(lh,a.layers,a.zoom),this.segments=new Gg,this.segments2=new Gg,this.stateDependentLayerIds=this.layers.filter(function(a){return a.isStateDependent()}).map(function(a){return a.id})};oh.prototype.populate=function(a,b){this.features=[],this.hasPattern=pc("fill",this.layers,b);for(var c=0,d=a;c<d.length;c+=1){var e=d[c],f=e.feature,g=e.index,h=e.sourceLayerIndex;if(this.layers[0]._featureFilter(new Gf(this.zoom),f)){var i=pb(f),j={sourceLayerIndex:h,index:g,geometry:i,properties:f.properties,type:f.type,patterns:{}};void 0!==f.id&&(j.id=f.id),this.hasPattern?this.features.push(qc("fill",this.layers,j,this.zoom,b)):this.addFeature(j,i,g,{}),b.featureIndex.insert(f,i,g,h,this.index)}}},oh.prototype.update=function(a,b,c){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(a,b,this.stateDependentLayers,c)},oh.prototype.addFeatures=function(a,b){for(var c=0,d=this.features;c<d.length;c+=1){var e=d[c],f=e.geometry;this.addFeature(e,f,e.index,b)}},oh.prototype.isEmpty=function(){return 0===this.layoutVertexArray.length},oh.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},oh.prototype.upload=function(a){this.uploaded||(this.layoutVertexBuffer=a.createVertexBuffer(this.layoutVertexArray,lh),this.indexBuffer=a.createIndexBuffer(this.indexArray),this.indexBuffer2=a.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(a),this.uploaded=!0},oh.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())},oh.prototype.addFeature=function(a,b,c,d){for(var e=0,f=nc(b,500);e<f.length;e+=1){for(var g=f[e],h=0,i=0,j=g;i<j.length;i+=1)h+=j[i].length;for(var k=this.segments.prepareSegment(h,this.layoutVertexArray,this.indexArray),l=k.vertexLength,m=[],n=[],o=0,p=g;o<p.length;o+=1){var q=p[o];if(0!==q.length){q!==g[0]&&n.push(m.length/2);var r=this.segments2.prepareSegment(q.length,this.layoutVertexArray,this.indexArray2),s=r.vertexLength;this.layoutVertexArray.emplaceBack(q[0].x,q[0].y),this.indexArray2.emplaceBack(s+q.length-1,s),m.push(q[0].x),m.push(q[0].y);for(var t=1;t<q.length;t++)this.layoutVertexArray.emplaceBack(q[t].x,q[t].y),this.indexArray2.emplaceBack(s+t-1,s+t),m.push(q[t].x),m.push(q[t].y);r.vertexLength+=q.length,r.primitiveLength+=q.length}}for(var u=mh(m,n),v=0;v<u.length;v+=3)this.indexArray.emplaceBack(l+u[v],l+u[v+1],l+u[v+2]);k.vertexLength+=h,k.primitiveLength+=u.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,a,c,d)},ab("FillBucket",oh,{omit:["layers","features"]});var ph={paint:new Uf({"fill-antialias":new Pf(be.paint_fill["fill-antialias"]),"fill-opacity":new Qf(be.paint_fill["fill-opacity"]),"fill-color":new Qf(be.paint_fill["fill-color"]),"fill-outline-color":new Qf(be.paint_fill["fill-outline-color"]),"fill-translate":new Pf(be.paint_fill["fill-translate"]),"fill-translate-anchor":new Pf(be.paint_fill["fill-translate-anchor"]),"fill-pattern":new Rf(be.paint_fill["fill-pattern"])})},qh=function(a){function b(b){a.call(this,b,ph)}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.recalculate=function(b){a.prototype.recalculate.call(this,b);var c=this.paint._values["fill-outline-color"];"constant"===c.value.kind&&void 0===c.value.value&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])},b.prototype.createBucket=function(a){return new oh(a)},b.prototype.queryRadius=function(){return Db(this.paint.get("fill-translate"))},b.prototype.queryIntersectsFeature=function(a,b,c,d,e,f,g){return tb(Eb(a,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),f.angle,g),d)},b}(Vf),rh=ib([{name:"a_pos",components:2,type:"Int16"},{name:"a_normal_ed",components:4,type:"Int16"}],4),sh=rh.members,th=(rh.size,rh.alignment,Math.pow(2,13)),uh=function(a){this.zoom=a.zoom,this.overscaling=a.overscaling,this.layers=a.layers,this.layerIds=this.layers.map(function(a){return a.id}),this.index=a.index,this.hasPattern=!1,this.layoutVertexArray=new _f,this.indexArray=new ng,this.programConfigurations=new Xg(sh,a.layers,a.zoom),this.segments=new Gg,this.stateDependentLayerIds=this.layers.filter(function(a){return a.isStateDependent()}).map(function(a){return a.id})};uh.prototype.populate=function(a,b){this.features=[],this.hasPattern=pc("fill-extrusion",this.layers,b);for(var c=0,d=a;c<d.length;c+=1){var e=d[c],f=e.feature,g=e.index,h=e.sourceLayerIndex;if(this.layers[0]._featureFilter(new Gf(this.zoom),f)){var i=pb(f),j={sourceLayerIndex:h,index:g,geometry:i,properties:f.properties,type:f.type,patterns:{}};void 0!==f.id&&(j.id=f.id),this.hasPattern?this.features.push(qc("fill-extrusion",this.layers,j,this.zoom,b)):this.addFeature(j,i,g,{}),b.featureIndex.insert(f,i,g,h,this.index,!0)}}},uh.prototype.addFeatures=function(a,b){for(var c=0,d=this.features;c<d.length;c+=1){var e=d[c],f=e.geometry;this.addFeature(e,f,e.index,b)}},uh.prototype.update=function(a,b,c){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(a,b,this.stateDependentLayers,c)},uh.prototype.isEmpty=function(){return 0===this.layoutVertexArray.length},uh.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},uh.prototype.upload=function(a){this.uploaded||(this.layoutVertexBuffer=a.createVertexBuffer(this.layoutVertexArray,sh),this.indexBuffer=a.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(a),this.uploaded=!0},uh.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())},uh.prototype.addFeature=function(a,b,c,d){for(var e=0,f=nc(b,500);e<f.length;e+=1){for(var g=f[e],h=0,i=0,j=g;i<j.length;i+=1)h+=j[i].length;for(var k=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray),l=0,m=g;l<m.length;l+=1){var n=m[l];if(0!==n.length&&!tc(n))for(var o=0,p=0;p<n.length;p++){var q=n[p];if(p>=1){var r=n[p-1];if(!sc(q,r)){k.vertexLength+4>Gg.MAX_VERTEX_ARRAY_LENGTH&&(k=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray));var s=q.sub(r)._perp()._unit(),t=r.dist(q);o+t>32768&&(o=0),rc(this.layoutVertexArray,q.x,q.y,s.x,s.y,0,0,o),rc(this.layoutVertexArray,q.x,q.y,s.x,s.y,0,1,o),o+=t,rc(this.layoutVertexArray,r.x,r.y,s.x,s.y,0,0,o),rc(this.layoutVertexArray,r.x,r.y,s.x,s.y,0,1,o);var u=k.vertexLength;this.indexArray.emplaceBack(u,u+2,u+1),this.indexArray.emplaceBack(u+1,u+2,u+3),k.vertexLength+=4,k.primitiveLength+=2}}}}k.vertexLength+h>Gg.MAX_VERTEX_ARRAY_LENGTH&&(k=this.segments.prepareSegment(h,this.layoutVertexArray,this.indexArray));for(var v=[],w=[],x=k.vertexLength,y=0,z=g;y<z.length;y+=1){var A=z[y];if(0!==A.length){A!==g[0]&&w.push(v.length/2);for(var B=0;B<A.length;B++){var C=A[B];rc(this.layoutVertexArray,C.x,C.y,0,0,1,1,0),v.push(C.x),v.push(C.y)}}}for(var D=mh(v,w),E=0;E<D.length;E+=3)this.indexArray.emplaceBack(x+D[E],x+D[E+2],x+D[E+1]);k.primitiveLength+=D.length/3,k.vertexLength+=h}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,a,c,d)},ab("FillExtrusionBucket",uh,{omit:["layers","features"]});var vh={paint:new Uf({"fill-extrusion-opacity":new Pf(be["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new Qf(be["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new Pf(be["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new Pf(be["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new Rf(be["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new Qf(be["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new Qf(be["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new Pf(be["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"])})},wh=function(a){function b(b){a.call(this,b,vh)}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.createBucket=function(a){return new uh(a)},b.prototype.queryRadius=function(){return Db(this.paint.get("fill-extrusion-translate"))},b.prototype.queryIntersectsFeature=function(a,b,c,d,e,f,g,h){var i=Eb(a,this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),f.angle,g),j=this.paint.get("fill-extrusion-height").evaluate(b,c),k=this.paint.get("fill-extrusion-base").evaluate(b,c),l=function(a,b,c,d){for(var e=[],f=0,g=a;f<g.length;f+=1){var h=g[f],i=[h.x,h.y,0,1];Ib(i,i,b),e.push(new rd(i[0]/i[3],i[1]/i[3]))}return e}(i,h),m=function(a,b,c,d){for(var e=[],f=[],g=d[8]*b,h=d[9]*b,i=d[10]*b,j=d[11]*b,k=d[8]*c,l=d[9]*c,m=d[10]*c,n=d[11]*c,o=0,p=a;o<p.length;o+=1){for(var q=p[o],r=[],s=[],t=0,u=q;t<u.length;t+=1){var v=u[t],w=v.x,x=v.y,y=d[0]*w+d[4]*x+d[12],z=d[1]*w+d[5]*x+d[13],A=d[2]*w+d[6]*x+d[14],B=d[3]*w+d[7]*x+d[15],C=y+g,D=z+h,E=A+i,F=B+j,G=y+k,H=z+l,I=A+m,J=B+n,K=new rd(C/F,D/F);K.z=E/F,r.push(K);var L=new rd(G/J,H/J);L.z=I/J,s.push(L)}e.push(r),f.push(s)}return[e,f]}(d,k,j,h);return function(a,b,c){var d=1/0;tb(c,b)&&(d=vc(c,b[0]));for(var e=0;e<b.length;e++)for(var f=b[e],g=a[e],h=0;h<f.length-1;h++){var i=f[h],j=f[h+1],k=g[h],l=g[h+1],m=[i,j,l,k,i];rb(c,m)&&(d=Math.min(d,vc(c,m)))}return d!==1/0&&d}(m[0],m[1],l)},b.prototype.hasOffscreenPass=function(){return 0!==this.paint.get("fill-extrusion-opacity")&&"none"!==this.visibility},b.prototype.resize=function(){this.viewportFrame&&(this.viewportFrame.destroy(),this.viewportFrame=null)},b}(Vf),xh=ib([{name:"a_pos_normal",components:4,type:"Int16"},{name:"a_data",components:4,type:"Uint8"}],4),yh=xh.members,zh=(xh.size,xh.alignment,wc);wc.types=["Unknown","Point","LineString","Polygon"],wc.prototype.loadGeometry=function(){var a=this._pbf;a.pos=this._geometry;for(var b,c=a.readVarint()+a.pos,d=1,e=0,f=0,g=0,h=[];a.pos<c;){if(e<=0){var i=a.readVarint();d=7&i,e=i>>3}if(e--,1===d||2===d)f+=a.readSVarint(),g+=a.readSVarint(),1===d&&(b&&h.push(b),b=[]),b.push(new rd(f,g));else{if(7!==d)throw new Error("unknown command "+d);b&&b.push(b[0].clone())}}return b&&h.push(b),h},wc.prototype.bbox=function(){var a=this._pbf;a.pos=this._geometry;for(var b=a.readVarint()+a.pos,c=1,d=0,e=0,f=0,g=1/0,h=-1/0,i=1/0,j=-1/0;a.pos<b;){if(d<=0){var k=a.readVarint();c=7&k,d=k>>3}if(d--,1===c||2===c)(e+=a.readSVarint())<g&&(g=e),e>h&&(h=e),(f+=a.readSVarint())<i&&(i=f),f>j&&(j=f);else if(7!==c)throw new Error("unknown command "+c)}return[g,i,h,j]},wc.prototype.toGeoJSON=function(a,b,c){function d(a){for(var b=0;b<a.length;b++){var c=a[b],d=180-360*(c.y+i)/g;a[b]=[360*(c.x+h)/g-180,360/Math.PI*Math.atan(Math.exp(d*Math.PI/180))-90]}}var e,f,g=this.extent*Math.pow(2,c),h=this.extent*a,i=this.extent*b,j=this.loadGeometry(),k=wc.types[this.type];switch(this.type){case 1:var l=[];for(e=0;e<j.length;e++)l[e]=j[e][0];d(j=l);break;case 2:for(e=0;e<j.length;e++)d(j[e]);break;case 3:for(j=function(a){var b=a.length;if(b<=1)return[a];for(var c,d,e=[],f=0;f<b;f++){var g=yc(a[f]);0!==g&&(void 0===d&&(d=g<0),d===g<0?(c&&e.push(c),c=[a[f]]):c.push(a[f]))}return c&&e.push(c),e}(j),e=0;e<j.length;e++)for(f=0;f<j[e].length;f++)d(j[e][f])}1===j.length?j=j[0]:k="Multi"+k;var m={type:"Feature",geometry:{type:k,coordinates:j},properties:this.properties};return"id"in this&&(m.id=this.id),m};var Ah=zc;zc.prototype.feature=function(a){if(a<0||a>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[a];var b=this._pbf.readVarint()+this._pbf.pos;return new zh(this._pbf,b,this.extent,this._keys,this._values)};var Bh={VectorTile:function(a,b){this.layers=a.readFields(Bc,{},b)},VectorTileFeature:zh,VectorTileLayer:Ah},Ch=Bh.VectorTileFeature.types,Dh=63,Eh=Math.cos(Math.PI/180*37.5),Fh=.5,Gh=Math.pow(2,14)/Fh,Hh=function(a){this.zoom=a.zoom,this.overscaling=a.overscaling,this.layers=a.layers,this.layerIds=this.layers.map(function(a){return a.id}),this.index=a.index,this.features=[],this.hasPattern=!1,this.layoutVertexArray=new ag,this.indexArray=new ng,this.programConfigurations=new Xg(yh,a.layers,a.zoom),this.segments=new Gg,this.stateDependentLayerIds=this.layers.filter(function(a){return a.isStateDependent()}).map(function(a){return a.id})};Hh.prototype.populate=function(a,b){this.features=[],this.hasPattern=pc("line",this.layers,b);for(var c=0,d=a;c<d.length;c+=1){var e=d[c],f=e.feature,g=e.index,h=e.sourceLayerIndex;if(this.layers[0]._featureFilter(new Gf(this.zoom),f)){var i=pb(f),j={sourceLayerIndex:h,index:g,geometry:i,properties:f.properties,type:f.type,patterns:{}};void 0!==f.id&&(j.id=f.id),this.hasPattern?this.features.push(qc("line",this.layers,j,this.zoom,b)):this.addFeature(j,i,g,{}),b.featureIndex.insert(f,i,g,h,this.index)}}},Hh.prototype.update=function(a,b,c){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(a,b,this.stateDependentLayers,c)},Hh.prototype.addFeatures=function(a,b){for(var c=0,d=this.features;c<d.length;c+=1){var e=d[c],f=e.geometry;this.addFeature(e,f,e.index,b)}},Hh.prototype.isEmpty=function(){return 0===this.layoutVertexArray.length},Hh.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},Hh.prototype.upload=function(a){this.uploaded||(this.layoutVertexBuffer=a.createVertexBuffer(this.layoutVertexArray,yh),this.indexBuffer=a.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(a),this.uploaded=!0},Hh.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())},Hh.prototype.addFeature=function(a,b,c,d){for(var e=this.layers[0].layout,f=e.get("line-join").evaluate(a,{}),g=e.get("line-cap"),h=e.get("line-miter-limit"),i=e.get("line-round-limit"),j=0,k=b;j<k.length;j+=1){var l=k[j];this.addLine(l,a,f,g,h,i,c,d)}},Hh.prototype.addLine=function(a,b,c,d,e,f,g,h){var i=null;b.properties&&b.properties.hasOwnProperty("mapbox_clip_start")&&b.properties.hasOwnProperty("mapbox_clip_end")&&(i={start:b.properties.mapbox_clip_start,end:b.properties.mapbox_clip_end,tileTotal:void 0});for(var j="Polygon"===Ch[b.type],k=a.length;k>=2&&a[k-1].equals(a[k-2]);)k--;for(var l=0;l<k-1&&a[l].equals(a[l+1]);)l++;if(!(k<(j?3:2))){i&&(i.tileTotal=function(a,b,c){for(var d,e,f=0,g=b;g<c-1;g++)d=a[g],e=a[g+1],f+=d.dist(e);return f}(a,l,k)),"bevel"===c&&(e=1.05);var m=Zg/(512*this.overscaling)*15,n=a[l],o=this.segments.prepareSegment(10*k,this.layoutVertexArray,this.indexArray);this.distance=0;var p,q,r,s=d,t=j?"butt":d,u=!0,v=void 0,w=void 0,x=void 0,y=void 0;this.e1=this.e2=this.e3=-1,j&&(p=a[k-2],y=n.sub(p)._unit()._perp());for(var z=l;z<k;z++)if(!(w=j&&z===k-1?a[l+1]:a[z+1])||!a[z].equals(w)){y&&(x=y),p&&(v=p),p=a[z],y=w?w.sub(p)._unit()._perp():x;var A=(x=x||y).add(y);0===A.x&&0===A.y||A._unit();var B=A.x*y.x+A.y*y.y,C=0!==B?1/B:1/0,D=B<Eh&&v&&w;if(D&&z>l){var E=p.dist(v);if(E>2*m){var F=p.sub(p.sub(v)._mult(m/E)._round());this.distance+=F.dist(v),this.addCurrentVertex(F,this.distance,x.mult(1),0,0,!1,o,i),v=F}}var G=v&&w,H=G?c:w?s:t;if(G&&"round"===H&&(C<f?H="miter":C<=2&&(H="fakeround")),"miter"===H&&C>e&&(H="bevel"),"bevel"===H&&(C>2&&(H="flipbevel"),C<e&&(H="miter")),v&&(this.distance+=p.dist(v)),"miter"===H)A._mult(C),this.addCurrentVertex(p,this.distance,A,0,0,!1,o,i);else if("flipbevel"===H){if(C>100)A=y.clone().mult(-1);else{var I=x.x*y.y-x.y*y.x>0?-1:1,J=C*x.add(y).mag()/x.sub(y).mag();A._perp()._mult(J*I)}this.addCurrentVertex(p,this.distance,A,0,0,!1,o,i),this.addCurrentVertex(p,this.distance,A.mult(-1),0,0,!1,o,i)}else if("bevel"===H||"fakeround"===H){var K=x.x*y.y-x.y*y.x>0,L=-Math.sqrt(C*C-1);if(K?(r=0,q=L):(q=0,r=L),u||this.addCurrentVertex(p,this.distance,x,q,r,!1,o,i),"fakeround"===H){for(var M=Math.floor(8*(.5-(B-.5))),N=void 0,O=0;O<M;O++)N=y.mult((O+1)/(M+1))._add(x)._unit(),this.addPieSliceVertex(p,this.distance,N,K,o,i);this.addPieSliceVertex(p,this.distance,A,K,o,i);for(var P=M-1;P>=0;P--)N=x.mult((P+1)/(M+1))._add(y)._unit(),this.addPieSliceVertex(p,this.distance,N,K,o,i)}w&&this.addCurrentVertex(p,this.distance,y,-q,-r,!1,o,i)}else"butt"===H?(u||this.addCurrentVertex(p,this.distance,x,0,0,!1,o,i),w&&this.addCurrentVertex(p,this.distance,y,0,0,!1,o,i)):"square"===H?(u||(this.addCurrentVertex(p,this.distance,x,1,1,!1,o,i),this.e1=this.e2=-1),w&&this.addCurrentVertex(p,this.distance,y,-1,-1,!1,o,i)):"round"===H&&(u||(this.addCurrentVertex(p,this.distance,x,0,0,!1,o,i),this.addCurrentVertex(p,this.distance,x,1,1,!0,o,i),this.e1=this.e2=-1),w&&(this.addCurrentVertex(p,this.distance,y,-1,-1,!0,o,i),this.addCurrentVertex(p,this.distance,y,0,0,!1,o,i)));if(D&&z<k-1){var Q=p.dist(w);if(Q>2*m){var R=p.add(w.sub(p)._mult(m/Q)._round());this.distance+=R.dist(p),this.addCurrentVertex(R,this.distance,y.mult(1),0,0,!1,o,i),p=R}}u=!1}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,b,g,h)}},Hh.prototype.addCurrentVertex=function(a,b,c,d,e,f,g,h){var i,j=this.layoutVertexArray,k=this.indexArray;h&&(b=Dc(b,h)),i=c.clone(),d&&i._sub(c.perp()._mult(d)),Cc(j,a,i,f,!1,d,b),this.e3=g.vertexLength++,this.e1>=0&&this.e2>=0&&(k.emplaceBack(this.e1,this.e2,this.e3),g.primitiveLength++),this.e1=this.e2,this.e2=this.e3,i=c.mult(-1),e&&i._sub(c.perp()._mult(e)),Cc(j,a,i,f,!0,-e,b),this.e3=g.vertexLength++,this.e1>=0&&this.e2>=0&&(k.emplaceBack(this.e1,this.e2,this.e3),g.primitiveLength++),this.e1=this.e2,this.e2=this.e3,b>Gh/2&&!h&&(this.distance=0,this.addCurrentVertex(a,this.distance,c,d,e,f,g))},Hh.prototype.addPieSliceVertex=function(a,b,c,d,e,f){c=c.mult(d?-1:1);var g=this.layoutVertexArray,h=this.indexArray;f&&(b=Dc(b,f)),Cc(g,a,c,!1,d,0,b),this.e3=e.vertexLength++,this.e1>=0&&this.e2>=0&&(h.emplaceBack(this.e1,this.e2,this.e3),e.primitiveLength++),d?this.e2=this.e3:this.e1=this.e3},ab("LineBucket",Hh,{omit:["layers","features"]});var Ih=new Uf({"line-cap":new Pf(be.layout_line["line-cap"]),"line-join":new Qf(be.layout_line["line-join"]),"line-miter-limit":new Pf(be.layout_line["line-miter-limit"]),"line-round-limit":new Pf(be.layout_line["line-round-limit"])}),Jh={paint:new Uf({"line-opacity":new Qf(be.paint_line["line-opacity"]),"line-color":new Qf(be.paint_line["line-color"]),"line-translate":new Pf(be.paint_line["line-translate"]),"line-translate-anchor":new Pf(be.paint_line["line-translate-anchor"]),"line-width":new Qf(be.paint_line["line-width"]),"line-gap-width":new Qf(be.paint_line["line-gap-width"]),"line-offset":new Qf(be.paint_line["line-offset"]),"line-blur":new Qf(be.paint_line["line-blur"]),"line-dasharray":new Sf(be.paint_line["line-dasharray"]),"line-pattern":new Rf(be.paint_line["line-pattern"]),"line-gradient":new Tf(be.paint_line["line-gradient"])}),layout:Ih},Kh=new(function(a){function b(){a.apply(this,arguments)}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.possiblyEvaluate=function(b,c){return c=new Gf(Math.floor(c.zoom),{now:c.now,fadeDuration:c.fadeDuration,zoomHistory:c.zoomHistory,transition:c.transition}),a.prototype.possiblyEvaluate.call(this,b,c)},b.prototype.evaluate=function(b,c,d,e){return c=i({},c,{zoom:Math.floor(c.zoom)}),a.prototype.evaluate.call(this,b,c,d,e)},b}(Qf))(Jh.paint.properties["line-width"].specification);Kh.useIntegerZoom=!0;var Lh=function(a){function b(b){a.call(this,b,Jh)}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype._handleSpecialPaintPropertyUpdate=function(a){"line-gradient"===a&&this._updateGradient()},b.prototype._updateGradient=function(){var a=this._transitionablePaint._values["line-gradient"].value.expression;this.gradient=Ob(a,"lineProgress"),this.gradientTexture=null},b.prototype.recalculate=function(b){a.prototype.recalculate.call(this,b),this.paint._values["line-floorwidth"]=Kh.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,b)},b.prototype.createBucket=function(a){return new Hh(a)},b.prototype.queryRadius=function(a){var b=a,c=Ec(Cb("line-width",this,b),Cb("line-gap-width",this,b)),d=Cb("line-offset",this,b);return c/2+Math.abs(d)+Db(this.paint.get("line-translate"))},b.prototype.queryIntersectsFeature=function(a,b,c,d,e,f,g){var h=Eb(a,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),f.angle,g),i=g/2*Ec(this.paint.get("line-width").evaluate(b,c),this.paint.get("line-gap-width").evaluate(b,c)),j=this.paint.get("line-offset").evaluate(b,c);return j&&(d=function(a,b){for(var c=[],d=new rd(0,0),e=0;e<a.length;e++){for(var f=a[e],g=[],h=0;h<f.length;h++){var i=f[h-1],j=f[h],k=f[h+1],l=0===h?d:j.sub(i)._unit()._perp(),m=h===f.length-1?d:k.sub(j)._unit()._perp(),n=l._add(m)._unit(),o=n.x*m.x+n.y*m.y;n._mult(1/o),g.push(n._mult(b)._add(j))}c.push(g)}return c}(d,j*g)),function(a,b,c){
for(var d=0;d<b.length;d++){var e=b[d];if(a.length>=3)for(var f=0;f<e.length;f++)if(Ab(a,e[f]))return!0;if(ub(a,e,c))return!0}return!1}(h,d,i)},b}(Vf),Mh=ib([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_data",components:4,type:"Uint16"}]),Nh=ib([{name:"a_projected_pos",components:3,type:"Float32"}],4),Oh=(ib([{name:"a_fade_opacity",components:1,type:"Uint32"}],4),ib([{name:"a_placed",components:2,type:"Uint8"}],4)),Ph=(ib([{type:"Int16",name:"anchorPointX"},{type:"Int16",name:"anchorPointY"},{type:"Int16",name:"x1"},{type:"Int16",name:"y1"},{type:"Int16",name:"x2"},{type:"Int16",name:"y2"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"},{type:"Int16",name:"radius"},{type:"Int16",name:"signedDistanceFromAnchor"}]),ib([{name:"a_pos",components:2,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4)),Qh=ib([{name:"a_pos",components:2,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4);ib([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"hidden"}]),ib([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Int16",name:"horizontalPlacedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint32",name:"crossTileID"}]),ib([{type:"Float32",name:"offsetX"}]),ib([{type:"Int16",name:"x"},{type:"Int16",name:"y"},{type:"Int16",name:"tileUnitDistanceFromAnchor"}]);var Rh={"!":"︕","#":"＃",$:"＄","%":"％","&":"＆","(":"︵",")":"︶","*":"＊","+":"＋",",":"︐","-":"︲",".":"・","/":"／",":":"︓",";":"︔","<":"︿","=":"＝",">":"﹀","?":"︖","@":"＠","[":"﹇","\\":"＼","]":"﹈","^":"＾",_:"︳","`":"｀","{":"︷","|":"―","}":"︸","~":"～","¢":"￠","£":"￡","¥":"￥","¦":"￤","¬":"￢","¯":"￣","–":"︲","—":"︱","‘":"﹃","’":"﹄","“":"﹁","”":"﹂","…":"︙","‧":"・","₩":"￦","、":"︑","。":"︒","〈":"︿","〉":"﹀","《":"︽","》":"︾","「":"﹁","」":"﹂","『":"﹃","』":"﹄","【":"︻","】":"︼","〔":"︹","〕":"︺","〖":"︗","〗":"︘","！":"︕","（":"︵","）":"︶","，":"︐","－":"︲","．":"・","：":"︓","；":"︔","＜":"︿","＞":"﹀","？":"︖","［":"﹇","］":"﹈","＿":"︳","｛":"︷","｜":"―","｝":"︸","｟":"︵","｠":"︶","｡":"︒","｢":"﹁","｣":"﹂"},Sh=function(a){function b(b,c,d,e){a.call(this,b,c),this.angle=d,void 0!==e&&(this.segment=e)}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.clone=function(){return new b(this.x,this.y,this.angle,this.segment)},b}(rd);ab("Anchor",Sh);var Th=Bh.VectorTileFeature.types,Uh=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}],Vh=function(a){this.layoutVertexArray=new cg,this.indexArray=new ng,this.programConfigurations=a,this.segments=new Gg,this.dynamicLayoutVertexArray=new dg,this.opacityVertexArray=new eg,this.placedSymbolArray=new vg};Vh.prototype.upload=function(a,b,c,d){c&&(this.layoutVertexBuffer=a.createVertexBuffer(this.layoutVertexArray,Mh.members),this.indexBuffer=a.createIndexBuffer(this.indexArray,b),this.dynamicLayoutVertexBuffer=a.createVertexBuffer(this.dynamicLayoutVertexArray,Nh.members,!0),this.opacityVertexBuffer=a.createVertexBuffer(this.opacityVertexArray,Uh,!0),this.opacityVertexBuffer.itemSize=1),(c||d)&&this.programConfigurations.upload(a)},Vh.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy())},ab("SymbolBuffers",Vh);var Wh=function(a,b,c){this.layoutVertexArray=new a,this.layoutAttributes=b,this.indexArray=new c,this.segments=new Gg,this.collisionVertexArray=new hg};Wh.prototype.upload=function(a){this.layoutVertexBuffer=a.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=a.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=a.createVertexBuffer(this.collisionVertexArray,Oh.members,!0)},Wh.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy())},ab("CollisionBuffers",Wh);var Xh=function(a){this.collisionBoxArray=a.collisionBoxArray,this.zoom=a.zoom,this.overscaling=a.overscaling,this.layers=a.layers,this.layerIds=this.layers.map(function(a){return a.id}),this.index=a.index,this.pixelRatio=a.pixelRatio,this.sourceLayerIndex=a.sourceLayerIndex,this.hasPattern=!1;var b=this.layers[0]._unevaluatedLayout._values;this.textSizeData=Gc(this.zoom,b["text-size"]),this.iconSizeData=Gc(this.zoom,b["icon-size"]);var c=this.layers[0].layout,d=c.get("symbol-sort-key"),e=c.get("symbol-z-order");this.sortFeaturesByKey="viewport-y"!==e&&void 0!==d.constantOr(1);var f="viewport-y"===e||"auto"===e&&!this.sortFeaturesByKey;this.sortFeaturesByY=f&&(c.get("text-allow-overlap")||c.get("icon-allow-overlap")||c.get("text-ignore-placement")||c.get("icon-ignore-placement")),this.stateDependentLayerIds=this.layers.filter(function(a){return a.isStateDependent()}).map(function(a){return a.id}),this.sourceID=a.sourceID};Xh.prototype.createArrays=function(){this.text=new Vh(new Xg(Mh.members,this.layers,this.zoom,function(a){return/^text/.test(a)})),this.icon=new Vh(new Xg(Mh.members,this.layers,this.zoom,function(a){return/^icon/.test(a)})),this.collisionBox=new Wh(gg,Ph.members,og),this.collisionCircle=new Wh(gg,Qh.members,ng),this.glyphOffsetArray=new zg,this.lineVertexArray=new Bg,this.symbolInstances=new xg},Xh.prototype.calculateGlyphDependencies=function(a,b,c,d){for(var e=0;e<a.length;e++)if(b[a.charCodeAt(e)]=!0,c&&d){var f=Rh[a.charAt(e)];f&&(b[f.charCodeAt(0)]=!0)}},Xh.prototype.populate=function(a,b){var c=this.layers[0],d=c.layout,e=d.get("text-font"),f=d.get("text-field"),g=d.get("icon-image"),h=("constant"!==f.value.kind||f.value.value.toString().length>0)&&("constant"!==e.value.kind||e.value.value.length>0),i="constant"!==g.value.kind||g.value.value&&g.value.value.length>0,j=d.get("symbol-sort-key");if(this.features=[],h||i){for(var k=b.iconDependencies,l=b.glyphDependencies,m=new Gf(this.zoom),n=0,o=a;n<o.length;n+=1){var p=o[n],q=p.feature,r=p.index,s=p.sourceLayerIndex;if(c._featureFilter(m,q)){var t=void 0;if(h){var u=c.getValueAndResolveTokens("text-field",q);t=Fc(u instanceof te?u:te.fromString(u),c,q)}var v=void 0;if(i&&(v=c.getValueAndResolveTokens("icon-image",q)),t||v){var w=this.sortFeaturesByKey?j.evaluate(q,{}):void 0,x={text:t,icon:v,index:r,sourceLayerIndex:s,geometry:pb(q),properties:q.properties,type:Th[q.type],sortKey:w};if(void 0!==q.id&&(x.id=q.id),this.features.push(x),v&&(k[v]=!0),t)for(var y=e.evaluate(q,{}).join(","),z="map"===d.get("text-rotation-alignment")&&"point"!==d.get("symbol-placement"),A=0,B=t.sections;A<B.length;A+=1){var C=B[A],D=db(t.toString()),E=C.fontStack||y,F=l[E]=l[E]||{};this.calculateGlyphDependencies(C.text,F,z,D)}}}}"line"===d.get("symbol-placement")&&(this.features=function(a){function b(b){h.push(a[b]),i++}function c(a,b,c){var d=g[a];return delete g[a],g[b]=d,h[d].geometry[0].pop(),h[d].geometry[0]=h[d].geometry[0].concat(c[0]),d}function d(a,b,c){var d=f[b];return delete f[b],f[a]=d,h[d].geometry[0].shift(),h[d].geometry[0]=c[0].concat(h[d].geometry[0]),d}function e(a,b,c){var d=c?b[0][b[0].length-1]:b[0][0];return a+":"+d.x+":"+d.y}for(var f={},g={},h=[],i=0,j=0;j<a.length;j++){var k=a[j],l=k.geometry,m=k.text?k.text.toString():null;if(m){var n=e(m,l),o=e(m,l,!0);if(n in g&&o in f&&g[n]!==f[o]){var p=d(n,o,l),q=c(n,o,h[p].geometry);delete f[n],delete g[o],g[e(m,h[q].geometry,!0)]=q,h[p].geometry=null}else n in g?c(n,o,l):o in f?d(n,o,l):(b(j),f[n]=i-1,g[o]=i-1)}else b(j)}return h.filter(function(a){return a.geometry})}(this.features)),this.sortFeaturesByKey&&this.features.sort(function(a,b){return a.sortKey-b.sortKey})}},Xh.prototype.update=function(a,b,c){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(a,b,this.layers,c),this.icon.programConfigurations.updatePaintArrays(a,b,this.layers,c))},Xh.prototype.isEmpty=function(){return 0===this.symbolInstances.length},Xh.prototype.uploadPending=function(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload},Xh.prototype.upload=function(a){this.uploaded||(this.collisionBox.upload(a),this.collisionCircle.upload(a)),this.text.upload(a,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(a,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0},Xh.prototype.destroy=function(){this.text.destroy(),this.icon.destroy(),this.collisionBox.destroy(),this.collisionCircle.destroy()},Xh.prototype.addToLineVertexArray=function(a,b){var c=this.lineVertexArray.length;if(void 0!==a.segment){for(var d=a.dist(b[a.segment+1]),e=a.dist(b[a.segment]),f={},g=a.segment+1;g<b.length;g++)f[g]={x:b[g].x,y:b[g].y,tileUnitDistanceFromAnchor:d},g<b.length-1&&(d+=b[g+1].dist(b[g]));for(var h=a.segment||0;h>=0;h--)f[h]={x:b[h].x,y:b[h].y,tileUnitDistanceFromAnchor:e},h>0&&(e+=b[h-1].dist(b[h]));for(var i=0;i<b.length;i++){var j=f[i];this.lineVertexArray.emplaceBack(j.x,j.y,j.tileUnitDistanceFromAnchor)}}return{lineStartIndex:c,lineLength:this.lineVertexArray.length-c}},Xh.prototype.addSymbols=function(a,b,c,d,e,f,g,h,i,j){for(var k=a.indexArray,l=a.layoutVertexArray,m=a.dynamicLayoutVertexArray,n=a.segments.prepareSegment(4*b.length,a.layoutVertexArray,a.indexArray,f.sortKey),o=this.glyphOffsetArray.length,p=n.vertexLength,q=0,r=b;q<r.length;q+=1){var s=r[q],t=s.tl,u=s.tr,v=s.bl,w=s.br,x=s.tex,y=n.vertexLength,z=s.glyphOffset[1];Hc(l,h.x,h.y,t.x,z+t.y,x.x,x.y,c),Hc(l,h.x,h.y,u.x,z+u.y,x.x+x.w,x.y,c),Hc(l,h.x,h.y,v.x,z+v.y,x.x,x.y+x.h,c),Hc(l,h.x,h.y,w.x,z+w.y,x.x+x.w,x.y+x.h,c),Ic(m,h,0),k.emplaceBack(y,y+1,y+2),k.emplaceBack(y+1,y+2,y+3),n.vertexLength+=4,n.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(s.glyphOffset[0])}a.placedSymbolArray.emplaceBack(h.x,h.y,o,this.glyphOffsetArray.length-o,p,i,j,h.segment,c?c[0]:0,c?c[1]:0,d[0],d[1],g,!1),a.programConfigurations.populatePaintArrays(a.layoutVertexArray.length,f,f.index,{})},Xh.prototype._addCollisionDebugVertex=function(a,b,c,d,e,f){return b.emplaceBack(0,0),a.emplaceBack(c.x,c.y,d,e,Math.round(f.x),Math.round(f.y))},Xh.prototype.addCollisionDebugVertices=function(a,b,c,d,e,f,g,h){var i=e.segments.prepareSegment(4,e.layoutVertexArray,e.indexArray),j=i.vertexLength,k=e.layoutVertexArray,l=e.collisionVertexArray,m=g.anchorX,n=g.anchorY;if(this._addCollisionDebugVertex(k,l,f,m,n,new rd(a,b)),this._addCollisionDebugVertex(k,l,f,m,n,new rd(c,b)),this._addCollisionDebugVertex(k,l,f,m,n,new rd(c,d)),this._addCollisionDebugVertex(k,l,f,m,n,new rd(a,d)),i.vertexLength+=4,h){var o=e.indexArray;o.emplaceBack(j,j+1,j+2),o.emplaceBack(j,j+2,j+3),i.primitiveLength+=2}else{var p=e.indexArray;p.emplaceBack(j,j+1),p.emplaceBack(j+1,j+2),p.emplaceBack(j+2,j+3),p.emplaceBack(j+3,j),i.primitiveLength+=4}},Xh.prototype.addDebugCollisionBoxes=function(a,b,c){for(var d=a;d<b;d++){var e=this.collisionBoxArray.get(d),f=e.x1,g=e.y1,h=e.x2,i=e.y2,j=e.radius>0;this.addCollisionDebugVertices(f,g,h,i,j?this.collisionCircle:this.collisionBox,e.anchorPoint,c,j)}},Xh.prototype.generateCollisionDebugBuffers=function(){for(var a=0;a<this.symbolInstances.length;a++){var b=this.symbolInstances.get(a);this.addDebugCollisionBoxes(b.textBoxStartIndex,b.textBoxEndIndex,b),this.addDebugCollisionBoxes(b.iconBoxStartIndex,b.iconBoxEndIndex,b)}},Xh.prototype._deserializeCollisionBoxesForSymbol=function(a,b,c,d,e){for(var f={},g=b;g<c;g++){var h=a.get(g);if(0===h.radius){f.textBox={x1:h.x1,y1:h.y1,x2:h.x2,y2:h.y2,anchorPointX:h.anchorPointX,anchorPointY:h.anchorPointY},f.textFeatureIndex=h.featureIndex;break}f.textCircles||(f.textCircles=[],f.textFeatureIndex=h.featureIndex),f.textCircles.push(h.anchorPointX,h.anchorPointY,h.radius,h.signedDistanceFromAnchor,1)}for(var i=d;i<e;i++){var j=a.get(i);if(0===j.radius){f.iconBox={x1:j.x1,y1:j.y1,x2:j.x2,y2:j.y2,anchorPointX:j.anchorPointX,anchorPointY:j.anchorPointY},f.iconFeatureIndex=j.featureIndex;break}}return f},Xh.prototype.deserializeCollisionBoxes=function(a){this.collisionArrays=[];for(var b=0;b<this.symbolInstances.length;b++){var c=this.symbolInstances.get(b);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(a,c.textBoxStartIndex,c.textBoxEndIndex,c.iconBoxStartIndex,c.iconBoxEndIndex))}},Xh.prototype.hasTextData=function(){return this.text.segments.get().length>0},Xh.prototype.hasIconData=function(){return this.icon.segments.get().length>0},Xh.prototype.hasCollisionBoxData=function(){return this.collisionBox.segments.get().length>0},Xh.prototype.hasCollisionCircleData=function(){return this.collisionCircle.segments.get().length>0},Xh.prototype.addIndicesForPlacedTextSymbol=function(a){for(var b=this.text.placedSymbolArray.get(a),c=b.vertexStartIndex+4*b.numGlyphs,d=b.vertexStartIndex;d<c;d+=4)this.text.indexArray.emplaceBack(d,d+1,d+2),this.text.indexArray.emplaceBack(d+1,d+2,d+3)},Xh.prototype.sortFeatures=function(a){if(this.sortFeaturesByY&&this.sortedAngle!==a&&(this.sortedAngle=a,!(this.text.segments.get().length>1||this.icon.segments.get().length>1))){for(var b=[],c=0;c<this.symbolInstances.length;c++)b.push(c);for(var d=Math.sin(a),e=Math.cos(a),f=[],g=[],h=0;h<this.symbolInstances.length;h++){var i=this.symbolInstances.get(h);f.push(0|Math.round(d*i.anchorX+e*i.anchorY)),g.push(i.featureIndex)}b.sort(function(a,b){return f[a]-f[b]||g[b]-g[a]}),this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(var j=0,k=b;j<k.length;j+=1){var l=k[j],m=this.symbolInstances.get(l);this.featureSortOrder.push(m.featureIndex),m.horizontalPlacedTextSymbolIndex>=0&&this.addIndicesForPlacedTextSymbol(m.horizontalPlacedTextSymbolIndex),m.verticalPlacedTextSymbolIndex>=0&&this.addIndicesForPlacedTextSymbol(m.verticalPlacedTextSymbolIndex);var n=this.icon.placedSymbolArray.get(l);if(n.numGlyphs){var o=n.vertexStartIndex;this.icon.indexArray.emplaceBack(o,o+1,o+2),this.icon.indexArray.emplaceBack(o+1,o+2,o+3)}}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}},ab("SymbolBucket",Xh,{omit:["layers","collisionBoxArray","features","compareText"]}),Xh.MAX_GLYPHS=65535,Xh.addDynamicAttributes=Ic;var Yh=new Uf({"symbol-placement":new Pf(be.layout_symbol["symbol-placement"]),"symbol-spacing":new Pf(be.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new Pf(be.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new Qf(be.layout_symbol["symbol-sort-key"]),"symbol-z-order":new Pf(be.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new Pf(be.layout_symbol["icon-allow-overlap"]),"icon-ignore-placement":new Pf(be.layout_symbol["icon-ignore-placement"]),"icon-optional":new Pf(be.layout_symbol["icon-optional"]),"icon-rotation-alignment":new Pf(be.layout_symbol["icon-rotation-alignment"]),"icon-size":new Qf(be.layout_symbol["icon-size"]),"icon-text-fit":new Pf(be.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new Pf(be.layout_symbol["icon-text-fit-padding"]),"icon-image":new Qf(be.layout_symbol["icon-image"]),"icon-rotate":new Qf(be.layout_symbol["icon-rotate"]),"icon-padding":new Pf(be.layout_symbol["icon-padding"]),"icon-keep-upright":new Pf(be.layout_symbol["icon-keep-upright"]),"icon-offset":new Qf(be.layout_symbol["icon-offset"]),"icon-anchor":new Qf(be.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new Pf(be.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new Pf(be.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new Pf(be.layout_symbol["text-rotation-alignment"]),"text-field":new Qf(be.layout_symbol["text-field"]),"text-font":new Qf(be.layout_symbol["text-font"]),"text-size":new Qf(be.layout_symbol["text-size"]),"text-max-width":new Qf(be.layout_symbol["text-max-width"]),"text-line-height":new Pf(be.layout_symbol["text-line-height"]),"text-letter-spacing":new Qf(be.layout_symbol["text-letter-spacing"]),"text-justify":new Qf(be.layout_symbol["text-justify"]),"text-anchor":new Qf(be.layout_symbol["text-anchor"]),"text-max-angle":new Pf(be.layout_symbol["text-max-angle"]),"text-rotate":new Qf(be.layout_symbol["text-rotate"]),"text-padding":new Pf(be.layout_symbol["text-padding"]),"text-keep-upright":new Pf(be.layout_symbol["text-keep-upright"]),"text-transform":new Qf(be.layout_symbol["text-transform"]),"text-offset":new Qf(be.layout_symbol["text-offset"]),"text-allow-overlap":new Pf(be.layout_symbol["text-allow-overlap"]),"text-ignore-placement":new Pf(be.layout_symbol["text-ignore-placement"]),"text-optional":new Pf(be.layout_symbol["text-optional"])}),Zh={paint:new Uf({"icon-opacity":new Qf(be.paint_symbol["icon-opacity"]),"icon-color":new Qf(be.paint_symbol["icon-color"]),"icon-halo-color":new Qf(be.paint_symbol["icon-halo-color"]),"icon-halo-width":new Qf(be.paint_symbol["icon-halo-width"]),"icon-halo-blur":new Qf(be.paint_symbol["icon-halo-blur"]),"icon-translate":new Pf(be.paint_symbol["icon-translate"]),"icon-translate-anchor":new Pf(be.paint_symbol["icon-translate-anchor"]),"text-opacity":new Qf(be.paint_symbol["text-opacity"]),"text-color":new Qf(be.paint_symbol["text-color"]),"text-halo-color":new Qf(be.paint_symbol["text-halo-color"]),"text-halo-width":new Qf(be.paint_symbol["text-halo-width"]),"text-halo-blur":new Qf(be.paint_symbol["text-halo-blur"]),"text-translate":new Pf(be.paint_symbol["text-translate"]),"text-translate-anchor":new Pf(be.paint_symbol["text-translate-anchor"])}),layout:Yh},$h=function(a){function b(b){a.call(this,b,Zh)}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.recalculate=function(b){a.prototype.recalculate.call(this,b),"auto"===this.layout.get("icon-rotation-alignment")&&("point"!==this.layout.get("symbol-placement")?this.layout._values["icon-rotation-alignment"]="map":this.layout._values["icon-rotation-alignment"]="viewport"),"auto"===this.layout.get("text-rotation-alignment")&&("point"!==this.layout.get("symbol-placement")?this.layout._values["text-rotation-alignment"]="map":this.layout._values["text-rotation-alignment"]="viewport"),"auto"===this.layout.get("text-pitch-alignment")&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")),"auto"===this.layout.get("icon-pitch-alignment")&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment"))},b.prototype.getValueAndResolveTokens=function(a,b){var c,d=this.layout.get(a).evaluate(b,{}),e=this._unevaluatedLayout._values[a];return e.isDataDriven()||va(e.value)?d:(c=b.properties,d.replace(/{([^{}]+)}/g,function(a,b){return b in c?String(c[b]):""}))},b.prototype.createBucket=function(a){return new Xh(a)},b.prototype.queryRadius=function(){return 0},b.prototype.queryIntersectsFeature=function(){return!1},b}(Vf),_h={paint:new Uf({"background-color":new Pf(be.paint_background["background-color"]),"background-pattern":new Sf(be.paint_background["background-pattern"]),"background-opacity":new Pf(be.paint_background["background-opacity"])})},ai=function(a){function b(b){a.call(this,b,_h)}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b}(Vf),bi={paint:new Uf({"raster-opacity":new Pf(be.paint_raster["raster-opacity"]),"raster-hue-rotate":new Pf(be.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new Pf(be.paint_raster["raster-brightness-min"]),"raster-brightness-max":new Pf(be.paint_raster["raster-brightness-max"]),"raster-saturation":new Pf(be.paint_raster["raster-saturation"]),"raster-contrast":new Pf(be.paint_raster["raster-contrast"]),"raster-resampling":new Pf(be.paint_raster["raster-resampling"]),"raster-fade-duration":new Pf(be.paint_raster["raster-fade-duration"])})},ci=function(a){function b(b){a.call(this,b,bi)}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b}(Vf),di=function(a){function b(b){a.call(this,b,{}),this.implementation=b}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.hasOffscreenPass=function(){return void 0!==this.implementation.prerender||"3d"===this.implementation.renderingMode},b.prototype.recalculate=function(){},b.prototype.updateTransitions=function(){},b.prototype.hasTransition=function(){},b.prototype.serialize=function(){},b.prototype.resize=function(){this.viewportFrame&&(this.viewportFrame.destroy(),this.viewportFrame=null)},b.prototype.onAdd=function(a){this.implementation.onAdd&&this.implementation.onAdd(a,a.painter.context.gl)},b.prototype.onRemove=function(a){this.implementation.onRemove&&this.implementation.onRemove(a)},b}(Vf),ei={circle:ch,heatmap:hh,hillshade:jh,fill:qh,"fill-extrusion":wh,line:Lh,symbol:$h,background:ai,raster:ci},fi=function(a,b){var c=b.pixelRatio;this.paddedRect=a,this.pixelRatio=c},gi={tl:{configurable:!0},br:{configurable:!0},tlbr:{configurable:!0},displaySize:{configurable:!0}};gi.tl.get=function(){return[this.paddedRect.x+1,this.paddedRect.y+1]},gi.br.get=function(){return[this.paddedRect.x+this.paddedRect.w-1,this.paddedRect.y+this.paddedRect.h-1]},gi.tlbr.get=function(){return this.tl.concat(this.br)},gi.displaySize.get=function(){return[(this.paddedRect.w-2)/this.pixelRatio,(this.paddedRect.h-2)/this.pixelRatio]},Object.defineProperties(fi.prototype,gi);var hi=function(a,b){var c={},d={},e=[];for(var f in a){var g=a[f],h={x:0,y:0,w:g.data.width+2,h:g.data.height+2};e.push(h),c[f]=new fi(h,g)}for(var i in b){var j=b[i],k={x:0,y:0,w:j.data.width+2,h:j.data.height+2};e.push(k),d[i]=new fi(k,j)}var l=Jc(e),m=l.w,n=l.h,o=new fh({width:m||1,height:n||1});for(var p in a){var q=a[p],r=c[p].paddedRect;fh.copy(q.data,o,{x:0,y:0},{x:r.x+1,y:r.y+1},q.data)}for(var s in b){var t=b[s],u=d[s].paddedRect,v=u.x+1,w=u.y+1,x=t.data.width,y=t.data.height;fh.copy(t.data,o,{x:0,y:0},{x:v,y:w},t.data),fh.copy(t.data,o,{x:0,y:y-1},{x:v,y:w-1},{width:x,height:1}),fh.copy(t.data,o,{x:0,y:0},{x:v,y:w+y},{width:x,height:1}),fh.copy(t.data,o,{x:x-1,y:0},{x:v-1,y:w},{width:1,height:y}),fh.copy(t.data,o,{x:0,y:0},{x:v+x,y:w},{width:1,height:y})}this.image=o,this.iconPositions=c,this.patternPositions=d};ab("ImagePosition",fi),ab("ImageAtlas",hi);var ii=self.HTMLImageElement,ji=self.HTMLCanvasElement,ki=self.HTMLVideoElement,li=self.ImageData,mi=function(a,b,c,d){this.context=a,this.format=c,this.texture=a.gl.createTexture(),this.update(b,d)};mi.prototype.update=function(a,b){var c=a.width,d=a.height,e=!this.size||this.size[0]!==c||this.size[1]!==d,f=this.context,g=f.gl;this.useMipmap=Boolean(b&&b.useMipmap),g.bindTexture(g.TEXTURE_2D,this.texture),f.pixelStoreUnpackFlipY.set(!1),f.pixelStoreUnpack.set(1),f.pixelStoreUnpackPremultiplyAlpha.set(this.format===g.RGBA&&(!b||!1!==b.premultiply)),e?(this.size=[c,d],a instanceof ii||a instanceof ji||a instanceof ki||a instanceof li?g.texImage2D(g.TEXTURE_2D,0,this.format,this.format,g.UNSIGNED_BYTE,a):g.texImage2D(g.TEXTURE_2D,0,this.format,c,d,0,this.format,g.UNSIGNED_BYTE,a.data)):a instanceof ii||a instanceof ji||a instanceof ki||a instanceof li?g.texSubImage2D(g.TEXTURE_2D,0,0,0,g.RGBA,g.UNSIGNED_BYTE,a):g.texSubImage2D(g.TEXTURE_2D,0,0,0,c,d,g.RGBA,g.UNSIGNED_BYTE,a.data),this.useMipmap&&this.isSizePowerOfTwo()&&g.generateMipmap(g.TEXTURE_2D)},mi.prototype.bind=function(a,b,c){var d=this.context.gl;d.bindTexture(d.TEXTURE_2D,this.texture),c!==d.LINEAR_MIPMAP_NEAREST||this.isSizePowerOfTwo()||(c=d.LINEAR),a!==this.filter&&(d.texParameteri(d.TEXTURE_2D,d.TEXTURE_MAG_FILTER,a),d.texParameteri(d.TEXTURE_2D,d.TEXTURE_MIN_FILTER,c||a),this.filter=a),b!==this.wrap&&(d.texParameteri(d.TEXTURE_2D,d.TEXTURE_WRAP_S,b),d.texParameteri(d.TEXTURE_2D,d.TEXTURE_WRAP_T,b),this.wrap=b)},mi.prototype.isSizePowerOfTwo=function(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0},mi.prototype.destroy=function(){this.context.gl.deleteTexture(this.texture),this.texture=null};var ni=function(a,b,c,d,e){var f,g,h=8*e-d-1,i=(1<<h)-1,j=i>>1,k=-7,l=c?e-1:0,m=c?-1:1,n=a[b+l];for(l+=m,f=n&(1<<-k)-1,n>>=-k,k+=h;k>0;f=256*f+a[b+l],l+=m,k-=8);for(g=f&(1<<-k)-1,f>>=-k,k+=d;k>0;g=256*g+a[b+l],l+=m,k-=8);if(0===f)f=1-j;else{if(f===i)return g?NaN:1/0*(n?-1:1);g+=Math.pow(2,d),f-=j}return(n?-1:1)*g*Math.pow(2,f-d)},oi=function(a,b,c,d,e,f){var g,h,i,j=8*f-e-1,k=(1<<j)-1,l=k>>1,m=23===e?Math.pow(2,-24)-Math.pow(2,-77):0,n=d?0:f-1,o=d?1:-1,p=b<0||0===b&&1/b<0?1:0;for(b=Math.abs(b),isNaN(b)||b===1/0?(h=isNaN(b)?1:0,g=k):(g=Math.floor(Math.log(b)/Math.LN2),b*(i=Math.pow(2,-g))<1&&(g--,i*=2),(b+=g+l>=1?m/i:m*Math.pow(2,1-l))*i>=2&&(g++,i/=2),g+l>=k?(h=0,g=k):g+l>=1?(h=(b*i-1)*Math.pow(2,e),g+=l):(h=b*Math.pow(2,l-1)*Math.pow(2,e),g=0));e>=8;a[c+n]=255&h,n+=o,h/=256,e-=8);for(g=g<<e|h,j+=e;j>0;a[c+n]=255&g,n+=o,g/=256,j-=8);a[c+n-o]|=128*p},pi=Kc;Kc.Varint=0,Kc.Fixed64=1,Kc.Bytes=2,Kc.Fixed32=5,Kc.prototype={destroy:function(){this.buf=null},readFields:function(a,b,c){for(c=c||this.length;this.pos<c;){var d=this.readVarint(),e=d>>3,f=this.pos;this.type=7&d,a(e,b,this),this.pos===f&&this.skip(d)}return b},readMessage:function(a,b){return this.readFields(a,b,this.readVarint()+this.pos)},readFixed32:function(){var a=Xc(this.buf,this.pos);return this.pos+=4,a},readSFixed32:function(){var a=Zc(this.buf,this.pos);return this.pos+=4,a},readFixed64:function(){var a=Xc(this.buf,this.pos)+4294967296*Xc(this.buf,this.pos+4);return this.pos+=8,a},readSFixed64:function(){var a=Xc(this.buf,this.pos)+4294967296*Zc(this.buf,this.pos+4);return this.pos+=8,a},readFloat:function(){var a=ni(this.buf,this.pos,!0,23,4);return this.pos+=4,a},readDouble:function(){var a=ni(this.buf,this.pos,!0,52,8);return this.pos+=8,a},readVarint:function(a){var b,c,d=this.buf;return b=127&(c=d[this.pos++]),c<128?b:(b|=(127&(c=d[this.pos++]))<<7,c<128?b:(b|=(127&(c=d[this.pos++]))<<14,c<128?b:(b|=(127&(c=d[this.pos++]))<<21,c<128?b:function(a,b,c){var d,e,f=c.buf;if(e=f[c.pos++],d=(112&e)>>4,e<128)return Mc(a,d,b);if(e=f[c.pos++],d|=(127&e)<<3,e<128)return Mc(a,d,b);if(e=f[c.pos++],d|=(127&e)<<10,e<128)return Mc(a,d,b);if(e=f[c.pos++],d|=(127&e)<<17,e<128)return Mc(a,d,b);if(e=f[c.pos++],d|=(127&e)<<24,e<128)return Mc(a,d,b);if(e=f[c.pos++],d|=(1&e)<<31,e<128)return Mc(a,d,b);throw new Error("Expected varint not more than 10 bytes")}(b|=(15&(c=d[this.pos]))<<28,a,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var a=this.readVarint();return a%2==1?(a+1)/-2:a/2},readBoolean:function(){return Boolean(this.readVarint())},readString:function(){var a=this.readVarint()+this.pos,b=function(a,b,c){for(var d="",e=b;e<c;){var f,g,h,i=a[e],j=null,k=i>239?4:i>223?3:i>191?2:1;if(e+k>c)break;1===k?i<128&&(j=i):2===k?128==(192&(f=a[e+1]))&&(j=(31&i)<<6|63&f)<=127&&(j=null):3===k?(f=a[e+1],g=a[e+2],128==(192&f)&&128==(192&g)&&((j=(15&i)<<12|(63&f)<<6|63&g)<=2047||j>=55296&&j<=57343)&&(j=null)):4===k&&(f=a[e+1],g=a[e+2],h=a[e+3],128==(192&f)&&128==(192&g)&&128==(192&h)&&((j=(15&i)<<18|(63&f)<<12|(63&g)<<6|63&h)<=65535||j>=1114112)&&(j=null)),null===j?(j=65533,k=1):j>65535&&(j-=65536,d+=String.fromCharCode(j>>>10&1023|55296),j=56320|1023&j),d+=String.fromCharCode(j),e+=k}return d}(this.buf,this.pos,a);return this.pos=a,b},readBytes:function(){var a=this.readVarint()+this.pos,b=this.buf.subarray(this.pos,a);return this.pos=a,b},readPackedVarint:function(a,b){var c=Lc(this);for(a=a||[];this.pos<c;)a.push(this.readVarint(b));return a},readPackedSVarint:function(a){var b=Lc(this);for(a=a||[];this.pos<b;)a.push(this.readSVarint());return a},readPackedBoolean:function(a){var b=Lc(this);for(a=a||[];this.pos<b;)a.push(this.readBoolean());return a},readPackedFloat:function(a){var b=Lc(this);for(a=a||[];this.pos<b;)a.push(this.readFloat());return a},readPackedDouble:function(a){var b=Lc(this);for(a=a||[];this.pos<b;)a.push(this.readDouble());return a},readPackedFixed32:function(a){var b=Lc(this);for(a=a||[];this.pos<b;)a.push(this.readFixed32());return a},readPackedSFixed32:function(a){var b=Lc(this);for(a=a||[];this.pos<b;)a.push(this.readSFixed32());return a},readPackedFixed64:function(a){var b=Lc(this);for(a=a||[];this.pos<b;)a.push(this.readFixed64());return a},readPackedSFixed64:function(a){var b=Lc(this);for(a=a||[];this.pos<b;)a.push(this.readSFixed64());return a},skip:function(a){var b=7&a;if(b===Kc.Varint)for(;this.buf[this.pos++]>127;);else if(b===Kc.Bytes)this.pos=this.readVarint()+this.pos;else if(b===Kc.Fixed32)this.pos+=4;else{if(b!==Kc.Fixed64)throw new Error("Unimplemented type: "+b);this.pos+=8}},writeTag:function(a,b){this.writeVarint(a<<3|b)},realloc:function(a){for(var b=this.length||16;b<this.pos+a;)b*=2;if(b!==this.length){var c=new Uint8Array(b);c.set(this.buf),this.buf=c,this.length=b}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(a){this.realloc(4),Yc(this.buf,a,this.pos),this.pos+=4},writeSFixed32:function(a){this.realloc(4),Yc(this.buf,a,this.pos),this.pos+=4},writeFixed64:function(a){this.realloc(8),Yc(this.buf,-1&a,this.pos),Yc(this.buf,Math.floor(a*(1/4294967296)),this.pos+4),this.pos+=8},writeSFixed64:function(a){this.realloc(8),Yc(this.buf,-1&a,this.pos),Yc(this.buf,Math.floor(a*(1/4294967296)),this.pos+4),this.pos+=8},writeVarint:function(a){(a=+a||0)>268435455||a<0?function(a,b){var c,d;if(a>=0?(c=a%4294967296|0,d=a/4294967296|0):(d=~(-a/4294967296),4294967295^(c=~(-a%4294967296))?c=c+1|0:(c=0,d=d+1|0)),a>=0x10000000000000000||a<-0x10000000000000000)throw new Error("Given varint doesn't fit into 10 bytes");b.realloc(10),function(a,b,c){c.buf[c.pos++]=127&a|128,a>>>=7,c.buf[c.pos++]=127&a|128,a>>>=7,c.buf[c.pos++]=127&a|128,a>>>=7,c.buf[c.pos++]=127&a|128,a>>>=7,c.buf[c.pos]=127&a}(c,0,b),function(a,b){var c=(7&a)<<4;b.buf[b.pos++]|=c|((a>>>=3)?128:0),a&&(b.buf[b.pos++]=127&a|((a>>>=7)?128:0),a&&(b.buf[b.pos++]=127&a|((a>>>=7)?128:0),a&&(b.buf[b.pos++]=127&a|((a>>>=7)?128:0),a&&(b.buf[b.pos++]=127&a|((a>>>=7)?128:0),a&&(b.buf[b.pos++]=127&a)))))}(d,b)}(a,this):(this.realloc(4),this.buf[this.pos++]=127&a|(a>127?128:0),a<=127||(this.buf[this.pos++]=127&(a>>>=7)|(a>127?128:0),a<=127||(this.buf[this.pos++]=127&(a>>>=7)|(a>127?128:0),a<=127||(this.buf[this.pos++]=a>>>7&127))))},writeSVarint:function(a){this.writeVarint(a<0?2*-a-1:2*a)},writeBoolean:function(a){this.writeVarint(Boolean(a))},writeString:function(a){a=String(a),this.realloc(4*a.length),this.pos++;var b=this.pos;this.pos=function(a,b,c){for(var d,e,f=0;f<b.length;f++){if((d=b.charCodeAt(f))>55295&&d<57344){if(!e){d>56319||f+1===b.length?(a[c++]=239,a[c++]=191,a[c++]=189):e=d;continue}if(d<56320){a[c++]=239,a[c++]=191,a[c++]=189,e=d;continue}d=e-55296<<10|d-56320|65536,e=null}else e&&(a[c++]=239,a[c++]=191,a[c++]=189,e=null);d<128?a[c++]=d:(d<2048?a[c++]=d>>6|192:(d<65536?a[c++]=d>>12|224:(a[c++]=d>>18|240,a[c++]=d>>12&63|128),a[c++]=d>>6&63|128),a[c++]=63&d|128)}return c}(this.buf,a,this.pos);var c=this.pos-b;c>=128&&Nc(b,c,this),this.pos=b-1,this.writeVarint(c),this.pos+=c},writeFloat:function(a){this.realloc(4),oi(this.buf,a,this.pos,!0,23,4),this.pos+=4},writeDouble:function(a){this.realloc(8),
oi(this.buf,a,this.pos,!0,52,8),this.pos+=8},writeBytes:function(a){var b=a.length;this.writeVarint(b),this.realloc(b);for(var c=0;c<b;c++)this.buf[this.pos++]=a[c]},writeRawMessage:function(a,b){this.pos++;var c=this.pos;a(b,this);var d=this.pos-c;d>=128&&Nc(c,d,this),this.pos=c-1,this.writeVarint(d),this.pos+=d},writeMessage:function(a,b,c){this.writeTag(a,Kc.Bytes),this.writeRawMessage(b,c)},writePackedVarint:function(a,b){this.writeMessage(a,Oc,b)},writePackedSVarint:function(a,b){this.writeMessage(a,Pc,b)},writePackedBoolean:function(a,b){this.writeMessage(a,Sc,b)},writePackedFloat:function(a,b){this.writeMessage(a,Qc,b)},writePackedDouble:function(a,b){this.writeMessage(a,Rc,b)},writePackedFixed32:function(a,b){this.writeMessage(a,Tc,b)},writePackedSFixed32:function(a,b){this.writeMessage(a,Uc,b)},writePackedFixed64:function(a,b){this.writeMessage(a,Vc,b)},writePackedSFixed64:function(a,b){this.writeMessage(a,Wc,b)},writeBytesField:function(a,b){this.writeTag(a,Kc.Bytes),this.writeBytes(b)},writeFixed32Field:function(a,b){this.writeTag(a,Kc.Fixed32),this.writeFixed32(b)},writeSFixed32Field:function(a,b){this.writeTag(a,Kc.Fixed32),this.writeSFixed32(b)},writeFixed64Field:function(a,b){this.writeTag(a,Kc.Fixed64),this.writeFixed64(b)},writeSFixed64Field:function(a,b){this.writeTag(a,Kc.Fixed64),this.writeSFixed64(b)},writeVarintField:function(a,b){this.writeTag(a,Kc.Varint),this.writeVarint(b)},writeSVarintField:function(a,b){this.writeTag(a,Kc.Varint),this.writeSVarint(b)},writeStringField:function(a,b){this.writeTag(a,Kc.Bytes),this.writeString(b)},writeFloatField:function(a,b){this.writeTag(a,Kc.Fixed32),this.writeFloat(b)},writeDoubleField:function(a,b){this.writeTag(a,Kc.Fixed64),this.writeDouble(b)},writeBooleanField:function(a,b){this.writeVarintField(a,Boolean(b))}};var qi=3,ri=qi,si=function(a,b,c){this.target=a,this.parent=b,this.mapId=c,this.callbacks={},this.callbackID=0,m(["receive"],this),this.target.addEventListener("message",this.receive,!1)};si.prototype.send=function(a,b,c,d){var e=this,f=c?this.mapId+":"+this.callbackID++:null;c&&(this.callbacks[f]=c);var g=[];if(this.target.postMessage({targetMapId:d,sourceMapId:this.mapId,type:a,id:String(f),data:bb(b,g)},g),c)return{cancel:function(){return e.target.postMessage({targetMapId:d,sourceMapId:e.mapId,type:"<cancel>",id:String(f)})}}},si.prototype.receive=function(a){var b,c=this,d=a.data,e=d.id;if(!d.targetMapId||this.mapId===d.targetMapId){var f=function(a,b){delete c.callbacks[e];var d=[];c.target.postMessage({sourceMapId:c.mapId,type:"<response>",id:String(e),error:a?bb(a):null,data:bb(b,d)},d)};if("<response>"===d.type||"<cancel>"===d.type)b=this.callbacks[d.id],delete this.callbacks[d.id],b&&d.error?b(cb(d.error)):b&&b(null,cb(d.data));else if(void 0!==d.id&&this.parent[d.type]){this.callbacks[d.id]=null;var g=this.parent[d.type](d.sourceMapId,cb(d.data),f);g&&null===this.callbacks[d.id]&&(this.callbacks[d.id]=g)}else if(void 0!==d.id&&this.parent.getWorkerSource){var h=d.type.split("."),i=cb(d.data);this.parent.getWorkerSource(d.sourceMapId,h[0],i.source)[h[1]](i,f)}else this.parent[d.type](cb(d.data))}},si.prototype.remove=function(){this.target.removeEventListener("message",this.receive,!1)};var ti=function(a,b){a&&(b?this.setSouthWest(a).setNorthEast(b):4===a.length?this.setSouthWest([a[0],a[1]]).setNorthEast([a[2],a[3]]):this.setSouthWest(a[0]).setNorthEast(a[1]))};ti.prototype.setNorthEast=function(a){return this._ne=a instanceof ui?new ui(a.lng,a.lat):ui.convert(a),this},ti.prototype.setSouthWest=function(a){return this._sw=a instanceof ui?new ui(a.lng,a.lat):ui.convert(a),this},ti.prototype.extend=function(a){var b,c,d=this._sw,e=this._ne;if(a instanceof ui)b=a,c=a;else{if(!(a instanceof ti))return Array.isArray(a)?a.every(Array.isArray)?this.extend(ti.convert(a)):this.extend(ui.convert(a)):this;if(b=a._sw,c=a._ne,!b||!c)return this}return d||e?(d.lng=Math.min(b.lng,d.lng),d.lat=Math.min(b.lat,d.lat),e.lng=Math.max(c.lng,e.lng),e.lat=Math.max(c.lat,e.lat)):(this._sw=new ui(b.lng,b.lat),this._ne=new ui(c.lng,c.lat)),this},ti.prototype.getCenter=function(){return new ui((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)},ti.prototype.getSouthWest=function(){return this._sw},ti.prototype.getNorthEast=function(){return this._ne},ti.prototype.getNorthWest=function(){return new ui(this.getWest(),this.getNorth())},ti.prototype.getSouthEast=function(){return new ui(this.getEast(),this.getSouth())},ti.prototype.getWest=function(){return this._sw.lng},ti.prototype.getSouth=function(){return this._sw.lat},ti.prototype.getEast=function(){return this._ne.lng},ti.prototype.getNorth=function(){return this._ne.lat},ti.prototype.toArray=function(){return[this._sw.toArray(),this._ne.toArray()]},ti.prototype.toString=function(){return"LngLatBounds("+this._sw.toString()+", "+this._ne.toString()+")"},ti.prototype.isEmpty=function(){return!(this._sw&&this._ne)},ti.convert=function(a){return!a||a instanceof ti?a:new ti(a)};var ui=function(a,b){if(isNaN(a)||isNaN(b))throw new Error("Invalid LngLat object: ("+a+", "+b+")");if(this.lng=+a,this.lat=+b,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")};ui.prototype.wrap=function(){return new ui(h(this.lng,-180,180),this.lat)},ui.prototype.toArray=function(){return[this.lng,this.lat]},ui.prototype.toString=function(){return"LngLat("+this.lng+", "+this.lat+")"},ui.prototype.toBounds=function(a){void 0===a&&(a=0);var b=360*a/40075017,c=b/Math.cos(Math.PI/180*this.lat);return new ti(new ui(this.lng-c,this.lat-b),new ui(this.lng+c,this.lat+b))},ui.convert=function(a){if(a instanceof ui)return a;if(Array.isArray(a)&&(2===a.length||3===a.length))return new ui(Number(a[0]),Number(a[1]));if(!Array.isArray(a)&&"object"==typeof a&&null!==a)return new ui(Number("lng"in a?a.lng:a.lon),Number(a.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")};var vi=function(a,b,c){void 0===c&&(c=0),this.x=+a,this.y=+b,this.z=+c};vi.fromLngLat=function(a,b){void 0===b&&(b=0);var c=ui.convert(a);return new vi(dd(c.lng),ed(c.lat),fd(b,c.lat))},vi.prototype.toLngLat=function(){return new ui(360*this.x-180,gd(this.y))},vi.prototype.toAltitude=function(){return a=this.z,b=this.y,a*cd(gd(b));var a,b};var wi=function(a,b,c){this.z=a,this.x=b,this.y=c,this.key=hd(0,a,b,c)};wi.prototype.equals=function(a){return this.z===a.z&&this.x===a.x&&this.y===a.y},wi.prototype.url=function(a,b){var c,d,e,f,g,h=(c=this.x,d=this.y,e=this.z,f=bd(256*c,256*(d=Math.pow(2,e)-d-1),e),g=bd(256*(c+1),256*(d+1),e),f[0]+","+f[1]+","+g[0]+","+g[1]),i=function(a,b,c){for(var d,e="",f=a;f>0;f--)e+=(b&(d=1<<f-1)?1:0)+(c&d?2:0);return e}(this.z,this.x,this.y);return a[(this.x+this.y)%a.length].replace("{prefix}",(this.x%16).toString(16)+(this.y%16).toString(16)).replace("{z}",String(this.z)).replace("{x}",String(this.x)).replace("{y}",String("tms"===b?Math.pow(2,this.z)-this.y-1:this.y)).replace("{quadkey}",i).replace("{bbox-epsg-3857}",h)},wi.prototype.getTilePoint=function(a){var b=Math.pow(2,this.z);return new rd((a.x*b-this.x)*Zg,(a.y*b-this.y)*Zg)};var xi=function(a,b){this.wrap=a,this.canonical=b,this.key=hd(a,b.z,b.x,b.y)},yi=function(a,b,c,d,e){this.overscaledZ=a,this.wrap=b,this.canonical=new wi(c,+d,+e),this.key=hd(b,a,d,e)};yi.prototype.equals=function(a){return this.overscaledZ===a.overscaledZ&&this.wrap===a.wrap&&this.canonical.equals(a.canonical)},yi.prototype.scaledTo=function(a){var b=this.canonical.z-a;return a>this.canonical.z?new yi(a,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new yi(a,this.wrap,a,this.canonical.x>>b,this.canonical.y>>b)},yi.prototype.isChildOf=function(a){if(a.wrap!==this.wrap)return!1;var b=this.canonical.z-a.canonical.z;return 0===a.overscaledZ||a.overscaledZ<this.overscaledZ&&a.canonical.x===this.canonical.x>>b&&a.canonical.y===this.canonical.y>>b},yi.prototype.children=function(a){if(this.overscaledZ>=a)return[new yi(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];var b=this.canonical.z+1,c=2*this.canonical.x,d=2*this.canonical.y;return[new yi(b,this.wrap,b,c,d),new yi(b,this.wrap,b,c+1,d),new yi(b,this.wrap,b,c,d+1),new yi(b,this.wrap,b,c+1,d+1)]},yi.prototype.isLessThan=function(a){return this.wrap<a.wrap||!(this.wrap>a.wrap)&&(this.overscaledZ<a.overscaledZ||!(this.overscaledZ>a.overscaledZ)&&(this.canonical.x<a.canonical.x||!(this.canonical.x>a.canonical.x)&&this.canonical.y<a.canonical.y))},yi.prototype.wrapped=function(){return new yi(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)},yi.prototype.unwrapTo=function(a){return new yi(this.overscaledZ,a,this.canonical.z,this.canonical.x,this.canonical.y)},yi.prototype.overscaleFactor=function(){return Math.pow(2,this.overscaledZ-this.canonical.z)},yi.prototype.toUnwrapped=function(){return new xi(this.wrap,this.canonical)},yi.prototype.toString=function(){return this.overscaledZ+"/"+this.canonical.x+"/"+this.canonical.y},yi.prototype.getTilePoint=function(a){return this.canonical.getTilePoint(new vi(a.x-this.wrap,a.y))},ab("CanonicalTileID",wi),ab("OverscaledTileID",yi,{omit:["posMatrix"]});var zi=function(a,b,c){if(this.uid=a,b.height!==b.width)throw new RangeError("DEM tiles must be square");if(c&&"mapbox"!==c&&"terrarium"!==c)return r('"'+c+'" is not a valid encoding type. Valid types include "mapbox" and "terrarium".');var d=this.dim=b.height;this.stride=this.dim+2,this.data=new Int32Array(this.stride*this.stride);for(var e=b.data,f="terrarium"===c?this._unpackTerrarium:this._unpackMapbox,g=0;g<d;g++)for(var h=0;h<d;h++){var i=4*(g*d+h);this.set(h,g,f(e[i],e[i+1],e[i+2]))}for(var j=0;j<d;j++)this.set(-1,j,this.get(0,j)),this.set(d,j,this.get(d-1,j)),this.set(j,-1,this.get(j,0)),this.set(j,d,this.get(j,d-1));this.set(-1,-1,this.get(0,0)),this.set(d,-1,this.get(d-1,0)),this.set(-1,d,this.get(0,d-1)),this.set(d,d,this.get(d-1,d-1))};zi.prototype.set=function(a,b,c){this.data[this._idx(a,b)]=c+65536},zi.prototype.get=function(a,b){return this.data[this._idx(a,b)]-65536},zi.prototype._idx=function(a,b){if(a<-1||a>=this.dim+1||b<-1||b>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(b+1)*this.stride+(a+1)},zi.prototype._unpackMapbox=function(a,b,c){return(256*a*256+256*b+c)/10-1e4},zi.prototype._unpackTerrarium=function(a,b,c){return 256*a+b+c/256-32768},zi.prototype.getPixels=function(){return new fh({width:this.stride,height:this.stride},new Uint8Array(this.data.buffer))},zi.prototype.backfillBorder=function(a,b,c){if(this.dim!==a.dim)throw new Error("dem dimension mismatch");var d=b*this.dim,e=b*this.dim+this.dim,f=c*this.dim,g=c*this.dim+this.dim;switch(b){case-1:d=e-1;break;case 1:e=d+1}switch(c){case-1:f=g-1;break;case 1:g=f+1}for(var h=-b*this.dim,i=-c*this.dim,j=f;j<g;j++)for(var k=d;k<e;k++)this.set(k,j,a.get(k+h,j+i))},ab("DEMData",zi);var Ai=ib([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]),Bi=function(a){this._stringToNumber={},this._numberToString=[];for(var b=0;b<a.length;b++){var c=a[b];this._stringToNumber[c]=b,this._numberToString[b]=c}};Bi.prototype.encode=function(a){return this._stringToNumber[a]},Bi.prototype.decode=function(a){return this._numberToString[a]};var Ci=function(a,b,c,d){this.type="Feature",this._vectorTileFeature=a,a._z=b,a._x=c,a._y=d,this.properties=a.properties,null!=a.id&&(this.id=a.id)},Di={geometry:{configurable:!0}};Di.geometry.get=function(){return void 0===this._geometry&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._vectorTileFeature._x,this._vectorTileFeature._y,this._vectorTileFeature._z).geometry),this._geometry},Di.geometry.set=function(a){this._geometry=a},Ci.prototype.toJSON=function(){var a={geometry:this.geometry};for(var b in this)"_geometry"!==b&&"_vectorTileFeature"!==b&&(a[b]=this[b]);return a},Object.defineProperties(Ci.prototype,Di);var Ei=function(){this.state={},this.stateChanges={},this.deletedStates={}};Ei.prototype.updateState=function(a,b,c){var d=String(b);if(this.stateChanges[a]=this.stateChanges[a]||{},this.stateChanges[a][d]=this.stateChanges[a][d]||{},i(this.stateChanges[a][d],c),null===this.deletedStates[a])for(var e in this.deletedStates[a]={},this.state[a])e!==d&&(this.deletedStates[a][e]=null);else if(this.deletedStates[a]&&null===this.deletedStates[a][d])for(var f in this.deletedStates[a][d]={},this.state[a][d])c[f]||(this.deletedStates[a][d][f]=null);else for(var g in c)this.deletedStates[a]&&this.deletedStates[a][d]&&null===this.deletedStates[a][d][g]&&delete this.deletedStates[a][d][g]},Ei.prototype.removeFeatureState=function(a,b,c){if(null!==this.deletedStates[a]){var d=String(b);if(this.deletedStates[a]=this.deletedStates[a]||{},c&&b)null!==this.deletedStates[a][d]&&(this.deletedStates[a][d]=this.deletedStates[a][d]||{},this.deletedStates[a][d][c]=null);else if(b)if(this.stateChanges[a]&&this.stateChanges[a][d])for(c in this.deletedStates[a][d]={},this.stateChanges[a][d])this.deletedStates[a][d][c]=null;else this.deletedStates[a][d]=null;else this.deletedStates[a]=null}},Ei.prototype.getState=function(a,b){var c=String(b),d=this.state[a]||{},e=this.stateChanges[a]||{},f=i({},d[c],e[c]);if(null===this.deletedStates[a])return{};if(this.deletedStates[a]){var g=this.deletedStates[a][b];if(null===g)return{};for(var h in g)delete f[h]}return f},Ei.prototype.initializeTileState=function(a,b){a.setFeatureState(this.state,b)},Ei.prototype.coalesceChanges=function(a,b){var c={};for(var d in this.stateChanges){this.state[d]=this.state[d]||{};var e={};for(var f in this.stateChanges[d])this.state[d][f]||(this.state[d][f]={}),i(this.state[d][f],this.stateChanges[d][f]),e[f]=this.state[d][f];c[d]=e}for(var g in this.deletedStates){this.state[g]=this.state[g]||{};var h={};if(null===this.deletedStates[g]){for(var j in this.state[g])h[j]={};this.state[g]={}}else for(var k in this.deletedStates[g]){if(null===this.deletedStates[g][k])this.state[g][k]={};else for(var l=0,m=Object.keys(this.deletedStates[g][k]);l<m.length;l+=1){var n=m[l];delete this.state[g][k][n]}h[k]=this.state[g][k]}c[g]=c[g]||{},i(c[g],h)}if(this.stateChanges={},this.deletedStates={},0!==Object.keys(c).length)for(var o in a)a[o].setFeatureState(c,b)};var Fi=function(a,b,c){this.tileID=a,this.x=a.canonical.x,this.y=a.canonical.y,this.z=a.canonical.z,this.grid=b||new tf(Zg,16,0),this.grid3D=new tf(Zg,16,0),this.featureIndexArray=c||new Dg};Fi.prototype.insert=function(a,b,c,d,e,f){var g=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(c,d,e);for(var h=f?this.grid3D:this.grid,i=0;i<b.length;i++){for(var j=b[i],k=[1/0,1/0,-1/0,-1/0],l=0;l<j.length;l++){var m=j[l];k[0]=Math.min(k[0],m.x),k[1]=Math.min(k[1],m.y),k[2]=Math.max(k[2],m.x),k[3]=Math.max(k[3],m.y)}k[0]<Zg&&k[1]<Zg&&k[2]>=0&&k[3]>=0&&h.insert(g,k[0],k[1],k[2],k[3])}},Fi.prototype.loadVTLayers=function(){return this.vtLayers||(this.vtLayers=new Bh.VectorTile(new pi(this.rawTileData)).layers,this.sourceLayerCoder=new Bi(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"])),this.vtLayers},Fi.prototype.query=function(a,b,c){var d=this;this.loadVTLayers();for(var e=a.params||{},f=Zg/a.tileSize/a.scale,g=Ga(e.filter),h=a.queryGeometry,i=a.queryPadding*f,j=id(h),k=this.grid.query(j.minX-i,j.minY-i,j.maxX+i,j.maxY+i),l=id(a.cameraQueryGeometry),m=this.grid3D.query(l.minX-i,l.minY-i,l.maxX+i,l.maxY+i,function(b,c,d,e){return function(a,b,c,d,e){for(var f=0,g=a;f<g.length;f+=1){var h=g[f];if(b<=h.x&&c<=h.y&&d>=h.x&&e>=h.y)return!0}var i=[new rd(b,c),new rd(b,e),new rd(d,e),new rd(d,c)];if(a.length>2)for(var j=0,k=i;j<k.length;j+=1)if(Ab(a,k[j]))return!0;for(var l=0;l<a.length-1;l++)if(Bb(a[l],a[l+1],i))return!0;return!1}(a.cameraQueryGeometry,b-i,c-i,d+i,e+i)}),n=0,o=m;n<o.length;n+=1){var p=o[n];k.push(p)}k.sort(jd);for(var q,r={},s=0;s<k.length;s++)!function(i){var j=k[i];if(j!==q){q=j;var l=d.featureIndexArray.get(j),m=null;d.loadMatchingFeature(r,l.bucketIndex,l.sourceLayerIndex,l.featureIndex,g,e.layers,b,function(b,e){m||(m=pb(b));var g={};return b.id&&(g=c.getState(e.sourceLayer||"_geojsonTileLayer",b.id)),e.queryIntersectsFeature(h,b,g,m,d.z,a.transform,f,a.pixelPosMatrix)})}}(s);return r},Fi.prototype.loadMatchingFeature=function(a,b,c,d,e,f,g,h){var i=this.bucketLayerIDs[b];if(!f||function(a,b){for(var c=0;c<a.length;c++)if(b.indexOf(a[c])>=0)return!0;return!1}(f,i)){var j=this.sourceLayerCoder.decode(c),k=this.vtLayers[j].feature(d);if(e(new Gf(this.tileID.overscaledZ),k))for(var l=0;l<i.length;l++){var m=i[l];if(!(f&&f.indexOf(m)<0)){var n=g[m];if(n){var o=!h||h(k,n);if(o){var p=new Ci(k,this.z,this.x,this.y);p.layer=n.serialize();var q=a[m];void 0===q&&(q=a[m]=[]),q.push({featureIndex:d,feature:p,intersectionZ:o})}}}}}},Fi.prototype.lookupSymbolFeatures=function(a,b,c,d,e,f){var g={};this.loadVTLayers();for(var h=Ga(d),i=0,j=a;i<j.length;i+=1){var k=j[i];this.loadMatchingFeature(g,b,c,k,h,e,f)}return g},Fi.prototype.hasLayer=function(a){for(var b=0,c=this.bucketLayerIDs;b<c.length;b+=1)for(var d=0,e=c[b];d<e.length;d+=1)if(a===e[d])return!0;return!1},ab("FeatureIndex",Fi,{omit:["rawTileData","sourceLayerCoder"]});var Gi=function(a,b){this.tileID=a,this.uid=j(),this.uses=0,this.tileSize=b,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.expiredRequestCount=0,this.state="loading"};Gi.prototype.registerFadeDuration=function(a){var b=a+this.timeAdded;b<Ad.now()||this.fadeEndTime&&b<this.fadeEndTime||(this.fadeEndTime=b)},Gi.prototype.wasRequested=function(){return"errored"===this.state||"loaded"===this.state||"reloading"===this.state},Gi.prototype.loadVectorData=function(a,b,c){if(this.hasData()&&this.unloadVectorData(),this.state="loaded",a){for(var d in a.featureIndex&&(this.latestFeatureIndex=a.featureIndex,a.rawTileData?(this.latestRawTileData=a.rawTileData,this.latestFeatureIndex.rawTileData=a.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=a.collisionBoxArray,this.buckets=function(a,b){var c={};if(!b)return c;for(var d=0,e=a;d<e.length;d+=1)!function(){var a=e[d],f=a.layerIds.map(function(a){return b.getLayer(a)}).filter(Boolean);if(0!==f.length){a.layers=f,a.stateDependentLayerIds&&(a.stateDependentLayers=a.stateDependentLayerIds.map(function(a){return f.filter(function(b){return b.id===a})[0]}));for(var g=0,h=f;g<h.length;g+=1){var i=h[g];c[i.id]=a}}}();return c}(a.buckets,b.style),this.hasSymbolBuckets=!1,this.buckets){var e=this.buckets[d];if(e instanceof Xh){if(this.hasSymbolBuckets=!0,!c)break;e.justReloaded=!0}}for(var f in this.queryPadding=0,this.buckets){var g=this.buckets[f];this.queryPadding=Math.max(this.queryPadding,b.style.getLayer(f).queryRadius(g))}a.imageAtlas&&(this.imageAtlas=a.imageAtlas),a.glyphAtlasImage&&(this.glyphAtlasImage=a.glyphAtlasImage)}else this.collisionBoxArray=new tg},Gi.prototype.unloadVectorData=function(){for(var a in this.buckets)this.buckets[a].destroy();this.buckets={},this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.imageAtlas&&(this.imageAtlas=null),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.latestFeatureIndex=null,this.state="unloaded"},Gi.prototype.unloadDEMData=function(){this.dem=null,this.neighboringTiles=null,this.state="unloaded"},Gi.prototype.getBucket=function(a){return this.buckets[a.id]},Gi.prototype.upload=function(a){for(var b in this.buckets){var c=this.buckets[b];c.uploadPending()&&c.upload(a)}var d=a.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new mi(a,this.imageAtlas.image,d.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new mi(a,this.glyphAtlasImage,d.ALPHA),this.glyphAtlasImage=null)},Gi.prototype.queryRenderedFeatures=function(a,b,c,d,e,f,g,h,i){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({queryGeometry:c,cameraQueryGeometry:d,scale:e,tileSize:this.tileSize,pixelPosMatrix:i,transform:g,params:f,queryPadding:this.queryPadding*h},a,b):{}},Gi.prototype.querySourceFeatures=function(a,b){if(this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData){var c=this.latestFeatureIndex.loadVTLayers(),d=b?b.sourceLayer:"",e=c._geojsonTileLayer||c[d];if(e)for(var f=Ga(b&&b.filter),g=this.tileID.canonical,h=g.z,i=g.x,j=g.y,k={z:h,x:i,y:j},l=0;l<e.length;l++){var m=e.feature(l);if(f(new Gf(this.tileID.overscaledZ),m)){var n=new Ci(m,h,i,j);n.tile=k,a.push(n)}}}},Gi.prototype.clearMask=function(){this.segments&&(this.segments.destroy(),delete this.segments),this.maskedBoundsBuffer&&(this.maskedBoundsBuffer.destroy(),delete this.maskedBoundsBuffer),this.maskedIndexBuffer&&(this.maskedIndexBuffer.destroy(),delete this.maskedIndexBuffer)},Gi.prototype.setMask=function(a,b){if(!e(this.mask,a)&&(this.mask=a,this.clearMask(),!e(a,{0:!0}))){var c=new $f,d=new ng;this.segments=new Gg,this.segments.prepareSegment(0,c,d);for(var f=Object.keys(a),g=0;g<f.length;g++){var h=a[f[g]],i=Zg>>h.z,j=new rd(h.x*i,h.y*i),k=new rd(j.x+i,j.y+i),l=this.segments.prepareSegment(4,c,d);c.emplaceBack(j.x,j.y,j.x,j.y),c.emplaceBack(k.x,j.y,k.x,j.y),c.emplaceBack(j.x,k.y,j.x,k.y),c.emplaceBack(k.x,k.y,k.x,k.y);var m=l.vertexLength;d.emplaceBack(m,m+1,m+2),d.emplaceBack(m+1,m+2,m+3),l.vertexLength+=4,l.primitiveLength+=2}this.maskedBoundsBuffer=b.createVertexBuffer(c,Ai.members),this.maskedIndexBuffer=b.createIndexBuffer(d)}},Gi.prototype.hasData=function(){return"loaded"===this.state||"reloading"===this.state||"expired"===this.state},Gi.prototype.patternsLoaded=function(){return this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length},Gi.prototype.setExpiryData=function(a){var b=this.expirationTime;if(a.cacheControl){var c=function(a){var b={};if(a.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,function(a,c,d,e){var f=d||e;return b[c]=!f||f.toLowerCase(),""}),b["max-age"]){var c=parseInt(b["max-age"],10);isNaN(c)?delete b["max-age"]:b["max-age"]=c}return b}(a.cacheControl);c["max-age"]&&(this.expirationTime=Date.now()+1e3*c["max-age"])}else a.expires&&(this.expirationTime=new Date(a.expires).getTime());if(this.expirationTime){var d=Date.now(),e=!1;if(this.expirationTime>d)e=!1;else if(b)if(this.expirationTime<b)e=!0;else{var f=this.expirationTime-b;f?this.expirationTime=d+Math.max(f,3e4):e=!0}else e=!0;e?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}},Gi.prototype.getExpiryTimeout=function(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-(new Date).getTime(),Math.pow(2,31)-1)},Gi.prototype.setFeatureState=function(a,b){if(this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData&&0!==Object.keys(a).length){var c=this.latestFeatureIndex.loadVTLayers();for(var d in this.buckets){var e=this.buckets[d],f=e.layers[0].sourceLayer||"_geojsonTileLayer",g=c[f],h=a[f];g&&h&&0!==Object.keys(h).length&&(e.update(h,g,this.imageAtlas&&this.imageAtlas.patternPositions||{}),b&&b.style&&(this.queryPadding=Math.max(this.queryPadding,b.style.getLayer(d).queryRadius(e))))}}},Gi.prototype.holdingForFade=function(){return void 0!==this.symbolFadeHoldUntil},Gi.prototype.symbolFadeFinished=function(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<Ad.now()},Gi.prototype.clearFadeHold=function(){this.symbolFadeHoldUntil=void 0},Gi.prototype.setHoldDuration=function(a){this.symbolFadeHoldUntil=Ad.now()+a};var Hi={horizontal:1,vertical:2,horizontalOnly:3},Ii=function(){this.text="",this.sectionIndex=[],this.sections=[]};Ii.fromFeature=function(a,b){for(var c=new Ii,d=0;d<a.sections.length;d++){var e=a.sections[d];c.sections.push({scale:e.scale||1,fontStack:e.fontStack||b}),c.text+=e.text;for(var f=0;f<e.text.length;f++)c.sectionIndex.push(d)}return c},Ii.prototype.length=function(){return this.text.length},Ii.prototype.getSection=function(a){return this.sections[this.sectionIndex[a]]},Ii.prototype.getCharCode=function(a){return this.text.charCodeAt(a)},Ii.prototype.verticalizePunctuation=function(){this.text=function(a){for(var b="",c=0;c<a.length;c++){var d=a.charCodeAt(c+1)||null,e=a.charCodeAt(c-1)||null;d&&gb(d)&&!Rh[a[c+1]]||e&&gb(e)&&!Rh[a[c-1]]||!Rh[a[c]]?b+=a[c]:b+=Rh[a[c]]}return b}(this.text)},Ii.prototype.trim=function(){for(var a=0,b=0;b<this.text.length&&Ji[this.text.charCodeAt(b)];b++)a++;for(var c=this.text.length,d=this.text.length-1;d>=0&&d>=a&&Ji[this.text.charCodeAt(d)];d--)c--;this.text=this.text.substring(a,c),this.sectionIndex=this.sectionIndex.slice(a,c)},Ii.prototype.substring=function(a,b){var c=new Ii;return c.text=this.text.substring(a,b),c.sectionIndex=this.sectionIndex.slice(a,b),c.sections=this.sections,c},Ii.prototype.toString=function(){return this.text},Ii.prototype.getMaxScale=function(){var a=this;return this.sectionIndex.reduce(function(b,c){return Math.max(b,a.sections[c].scale)},0)};var Ji={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},Ki={};Ki[10]=!0,Ki[32]=!0,Ki[38]=!0,Ki[40]=!0,Ki[41]=!0,Ki[43]=!0,Ki[45]=!0,Ki[47]=!0,Ki[173]=!0,Ki[183]=!0,Ki[8203]=!0,Ki[8208]=!0,Ki[8211]=!0,Ki[8231]=!0,a.createCommonjsModule=b,a.window=self,a.Point=rd,a.browser=Ad,a.getJSON=function(a,b){return Wd(i(a,{type:"json"}),b)},a.normalizeSpriteURL=function(a,b,c,d){var e=z(a);return x(a)?(e.path="/styles/v1"+e.path+"/sprite"+b+c,w(e,d)):(e.path+=""+b+c,A(e))},a.ResourceType=Rd,a.getImage=Zd,a.RGBAImage=fh,a.ImagePosition=fi,a.Texture=mi,a.potpack=Jc,a.normalizeGlyphsURL=function(a,b){if(!x(a))return a;var c=z(a);return c.path="/fonts/v1"+c.path,w(c,b)},a.getArrayBuffer=Xd,a.parseGlyphPBF=function(a){return new pi(a).readFields($c,[])},a.asyncAll=function(a,b,c){if(!a.length)return c(null,[]);var d=a.length,e=new Array(a.length),f=null;a.forEach(function(a,g){b(a,function(a,b){a&&(f=a),e[g]=b,0==--d&&c(f,e)})})},a.isChar=Af,a.AlphaImage=eh,a.Properties=Uf,a.DataConstantProperty=Pf,a.styleSpec=be,a.validateLight=qf,a.endsWith=n,a.emitValidationErrors=$a,a.validateStyle=pf,a.extend=i,a.Evented=ae,a.sphericalToCartesian=function(a){var b=a[0],c=a[1],d=a[2];return c+=90,c*=Math.PI/180,d*=Math.PI/180,{x:b*Math.cos(c)*Math.sin(d),y:b*Math.sin(c)*Math.sin(d),z:b*Math.cos(d)}},a.number=T,a.Transitionable=Jf,a.warnOnce=r,a.uniqueId=j,a.Actor=si,a.normalizeSourceURL=function(a,b){if(!x(a))return a;var c=z(a);return c.path="/v4/"+c.authority+".json",c.params.push("secure"),w(c,b)},a.pick=function(a,b){for(var c={},d=0;d<b.length;d++){var e=b[d];e in a&&(c[e]=a[e])}return c},a.canonicalizeTileset=function(a,b){if(!x(b))return a.tiles||[];for(var c=[],d=0,e=a.tiles;d<e.length;d+=1){var f=e[d],g=Jd(f);c.push(g)}return c},a.LngLatBounds=ti,a.mercatorXfromLng=dd,a.mercatorYfromLat=ed,a.Event=$d,a.ErrorEvent=_d,a.postTurnstileEvent=Od,a.postMapLoadEvent=Qd,a.normalizeTileURL=function(a,b,c){if(!b||!x(b))return a;var d=z(a),e=Ad.devicePixelRatio>=2||512===c?"@2x":"",f=Cd.supported?".webp":"$1";return d.path=d.path.replace(Hd,""+e+f),d.path="/v4"+d.path,w(d)},a.OverscaledTileID=yi,a.EXTENT=Zg,a.MercatorCoordinate=vi,a.CanonicalTileID=wi,a.StructArrayLayout4i8=$f,a.rasterBoundsAttributes=Ai,a.SegmentVector=Gg,a.getVideo=function(a,b){var c,d,e=self.document.createElement("video");e.muted=!0,e.onloadstart=function(){b(null,e)};for(var f=0;f<a.length;f++){var g=self.document.createElement("source");c=a[f],d=void 0,(d=self.document.createElement("a")).href=c,(d.protocol!==self.document.location.protocol||d.host!==self.document.location.host)&&(e.crossOrigin="Anonymous"),g.src=a[f],e.appendChild(g)}return{cancel:function(){}}},a.ValidationError=ce,a.bindAll=m,a.multiply=function(a,b,c){var d=b[0],e=b[1],f=b[2],g=b[3],h=b[4],i=b[5],j=b[6],k=b[7],l=b[8],m=b[9],n=b[10],o=b[11],p=b[12],q=b[13],r=b[14],s=b[15],t=c[0],u=c[1],v=c[2],w=c[3];return a[0]=t*d+u*h+v*l+w*p,a[1]=t*e+u*i+v*m+w*q,a[2]=t*f+u*j+v*n+w*r,a[3]=t*g+u*k+v*o+w*s,t=c[4],u=c[5],v=c[6],w=c[7],a[4]=t*d+u*h+v*l+w*p,a[5]=t*e+u*i+v*m+w*q,a[6]=t*f+u*j+v*n+w*r,a[7]=t*g+u*k+v*o+w*s,t=c[8],u=c[9],v=c[10],w=c[11],a[8]=t*d+u*h+v*l+w*p,a[9]=t*e+u*i+v*m+w*q,a[10]=t*f+u*j+v*n+w*r,a[11]=t*g+u*k+v*o+w*s,t=c[12],u=c[13],v=c[14],w=c[15],a[12]=t*d+u*h+v*l+w*p,a[13]=t*e+u*i+v*m+w*q,a[14]=t*f+u*j+v*n+w*r,a[15]=t*g+u*k+v*o+w*s,a},a.identity=function(a){return a[0]=1,a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=1,a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[10]=1,a[11]=0,a[12]=0,a[13]=0,a[14]=0,a[15]=1,a},a.translate=function(a,b,c){var d,e,f,g,h,i,j,k,l,m,n,o,p=c[0],q=c[1],r=c[2];return b===a?(a[12]=b[0]*p+b[4]*q+b[8]*r+b[12],a[13]=b[1]*p+b[5]*q+b[9]*r+b[13],a[14]=b[2]*p+b[6]*q+b[10]*r+b[14],a[15]=b[3]*p+b[7]*q+b[11]*r+b[15]):(d=b[0],e=b[1],f=b[2],g=b[3],h=b[4],i=b[5],j=b[6],k=b[7],l=b[8],m=b[9],n=b[10],o=b[11],a[0]=d,a[1]=e,a[2]=f,a[3]=g,a[4]=h,a[5]=i,a[6]=j,a[7]=k,a[8]=l,a[9]=m,a[10]=n,a[11]=o,a[12]=d*p+h*q+l*r+b[12],a[13]=e*p+i*q+m*r+b[13],a[14]=f*p+j*q+n*r+b[14],a[15]=g*p+k*q+o*r+b[15]),a},a.scale=function(a,b,c){var d=c[0],e=c[1],f=c[2];return a[0]=b[0]*d,a[1]=b[1]*d,a[2]=b[2]*d,a[3]=b[3]*d,a[4]=b[4]*e,a[5]=b[5]*e,a[6]=b[6]*e,a[7]=b[7]*e,a[8]=b[8]*f,a[9]=b[9]*f,a[10]=b[10]*f,a[11]=b[11]*f,a[12]=b[12],a[13]=b[13],a[14]=b[14],a[15]=b[15],a},a.Color=qe,a.isEqual=e,a.keysDifference=function(a,b){var c=[];for(var d in a)d in b||c.push(d);return c},a.Tile=Gi,a.SourceFeatureState=Ei,a.refProperties=["type","source","source-layer","minzoom","maxzoom","filter","layout"],a.rotateZ=function(a,b,c){var d=Math.sin(c),e=Math.cos(c),f=b[0],g=b[1],h=b[2],i=b[3],j=b[4],k=b[5],l=b[6],m=b[7];return b!==a&&(a[8]=b[8],a[9]=b[9],a[10]=b[10],a[11]=b[11],a[12]=b[12],a[13]=b[13],a[14]=b[14],a[15]=b[15]),a[0]=f*e+j*d,a[1]=g*e+k*d,a[2]=h*e+l*d,a[3]=i*e+m*d,a[4]=j*e-f*d,a[5]=k*e-g*d,a[6]=l*e-h*d,a[7]=m*e-i*d,a},a.evaluateSizeForZoom=function(a,b,c){if("constant"===a.functionType)return{uSizeT:0,uSize:a.layoutSize};if("source"===a.functionType)return{uSizeT:0,uSize:0};if("camera"===a.functionType){var d=a.propertyValue,e=a.zoomRange,f=a.sizeRange,h=g(ya(d,c.specification).interpolationFactor(b,e.min,e.max),0,1);return{uSizeT:0,uSize:f.min+h*(f.max-f.min)}}var i=a.propertyValue,j=a.zoomRange;return{uSizeT:g(ya(i,c.specification).interpolationFactor(b,j.min,j.max),0,1),uSize:0}},a.WritingMode=Hi,a.transformMat4=Ib,a.evaluateSizeForFeature=function(a,b,c){var d=b;return"source"===a.functionType?c.lowerSize/256:"composite"===a.functionType?T(c.lowerSize/256,c.upperSize/256,d.uSizeT):d.uSize},a.addDynamicAttributes=Ic,a.properties=Zh,a.polygonIntersectsPolygon=rb,a.isMapboxURL=x,a.normalizeStyleURL=function(a,b){if(!x(a))return a;var c=z(a);return c.path="/styles/v1"+c.path,w(c,b)},a.createStyleLayer=function(a){return"custom"===a.type?new di(a):new ei[a.type](a)},a.clone=q,a.validateCustomStyleLayer=function(a){var b=[],c=a.id;return void 0===c&&b.push({message:"layers."+c+': missing required property "id"'}),void 0===a.render&&b.push({message:"layers."+c+': missing required method "render"'}),a.renderingMode&&"2d"!==a.renderingMode&&"3d"!==a.renderingMode&&b.push({message:"layers."+c+': property "renderingMode" must be either "2d" or "3d"'}),b},a.filterObject=p,a.mapObject=o,a.evented=Ef,a.makeRequest=Wd,a.registerForPluginAvailability=function(a){return Cf?a({pluginURL:Cf,completionCallback:zf}):Ef.once("pluginAvailable",a),a},a.ZoomHistory=yf,a.getReferrer=Vd,a.createLayout=ib,a.UniformMatrix4f=Qg,a.Uniform3f=Mg,a.Uniform1f=Kg,a.Uniform1i=Jg,a.Uniform2f=Lg,a.Uniform4f=Ng,a.create=Fb,a.fromRotation=function(a,b){var c=Math.sin(b),d=Math.cos(b);return a[0]=d,a[1]=c,a[2]=0,a[3]=-c,a[4]=d,a[5]=0,a[6]=0,a[7]=0,a[8]=1,a},a.transformMat3=function(a,b,c){var d=b[0],e=b[1],f=b[2];return a[0]=d*c[0]+e*c[3]+f*c[6],a[1]=d*c[1]+e*c[4]+f*c[7],a[2]=d*c[2]+e*c[5]+f*c[8],a},a.create$1=function(){var a=new bh(16);return bh!=Float32Array&&(a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[6]=0,a[7]=0,a[8]=0,a[9]=0,
a[11]=0,a[12]=0,a[13]=0,a[14]=0),a[0]=1,a[5]=1,a[10]=1,a[15]=1,a},a.ortho=function(a,b,c,d,e,f,g){var h=1/(b-c),i=1/(d-e),j=1/(f-g);return a[0]=-2*h,a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=-2*i,a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[10]=2*j,a[11]=0,a[12]=(b+c)*h,a[13]=(e+d)*i,a[14]=(g+f)*j,a[15]=1,a},a.UniformColor=Og,a.clamp=g,a.StructArrayLayout2i4=Zf,a.StructArrayLayout2ui4=og,a.ProgramConfiguration=Wg,a.StructArrayLayout1ui2=pg,a.StructArrayLayout3ui6=ng,a.wrap=h,a.create$2=function(){var a=new bh(4);return bh!=Float32Array&&(a[1]=0,a[2]=0),a[0]=1,a[3]=1,a},a.rotate=function(a,b,c){var d=b[0],e=b[1],f=b[2],g=b[3],h=Math.sin(c),i=Math.cos(c);return a[0]=d*i+f*h,a[1]=e*i+g*h,a[2]=d*-h+f*i,a[3]=e*-h+g*i,a},a.LngLat=ui,a.UnwrappedTileID=xi,a.perspective=function(a,b,c,d,e){var f,g=1/Math.tan(b/2);return a[0]=g/c,a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=g,a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[11]=-1,a[12]=0,a[13]=0,a[15]=0,null!=e&&e!==1/0?(f=1/(d-e),a[10]=(e+d)*f,a[14]=2*e*d*f):(a[10]=-1,a[14]=-2*d),a},a.rotateX=function(a,b,c){var d=Math.sin(c),e=Math.cos(c),f=b[4],g=b[5],h=b[6],i=b[7],j=b[8],k=b[9],l=b[10],m=b[11];return b!==a&&(a[0]=b[0],a[1]=b[1],a[2]=b[2],a[3]=b[3],a[12]=b[12],a[13]=b[13],a[14]=b[14],a[15]=b[15]),a[4]=f*e+j*d,a[5]=g*e+k*d,a[6]=h*e+l*d,a[7]=i*e+m*d,a[8]=j*e-f*d,a[9]=k*e-g*d,a[10]=l*e-h*d,a[11]=m*e-i*d,a},a.mercatorZfromAltitude=fd,a.invert=function(a,b){var c=b[0],d=b[1],e=b[2],f=b[3],g=b[4],h=b[5],i=b[6],j=b[7],k=b[8],l=b[9],m=b[10],n=b[11],o=b[12],p=b[13],q=b[14],r=b[15],s=c*h-d*g,t=c*i-e*g,u=c*j-f*g,v=d*i-e*h,w=d*j-f*h,x=e*j-f*i,y=k*p-l*o,z=k*q-m*o,A=k*r-n*o,B=l*q-m*p,C=l*r-n*p,D=m*r-n*q,E=s*D-t*C+u*B+v*A-w*z+x*y;return E?(E=1/E,a[0]=(h*D-i*C+j*B)*E,a[1]=(e*C-d*D-f*B)*E,a[2]=(p*x-q*w+r*v)*E,a[3]=(m*w-l*x-n*v)*E,a[4]=(i*A-g*D-j*z)*E,a[5]=(c*D-e*A+f*z)*E,a[6]=(q*u-o*x-r*t)*E,a[7]=(k*x-m*u+n*t)*E,a[8]=(g*C-h*A+j*y)*E,a[9]=(d*A-c*C-f*y)*E,a[10]=(o*w-p*u+r*s)*E,a[11]=(l*u-k*w-n*s)*E,a[12]=(h*z-g*B-i*y)*E,a[13]=(c*B-d*z+e*y)*E,a[14]=(p*t-o*v-q*s)*E,a[15]=(k*v-l*t+m*s)*E,a):null},a.ease=ud,a.bezier=f,a.config=Bd,a.webpSupported=Cd,a.EvaluationParameters=Gf,a.version="0.53.0",a.setRTLTextPlugin=function(a,b){if(Bf)throw new Error("setRTLTextPlugin cannot be called multiple times.");Bf=!0,Cf=Ad.resolveURL(a),zf=function(a){a?(Bf=!1,Cf=null,b&&b(a)):Df=!0},Ef.fire(new $d("pluginAvailable",{pluginURL:Cf,completionCallback:zf}))},a.featureFilter=Ga,a.values=function(a){var b=[];for(var c in a)b.push(a[c]);return b},a.Anchor=Sh,a.GLYPH_PBF_BORDER=ri,a.distToSegmentSquared=yb,a.allowsLetterSpacing=function(a){for(var b=0,c=a;b<c.length;b+=1)if(!eb(c[b].charCodeAt(0)))return!1;return!0},a.shapeText=function(a,b,c,d,e,f,g,h,i,j,k){var l=Ii.fromFeature(a,c);k===Hi.vertical&&l.verticalizePunctuation();var m,n=[],o={positionedGlyphs:n,text:l,top:i[1],bottom:i[1],left:i[0],right:i[0],writingMode:k},p=Ff.processBidirectionalText,q=Ff.processStyledBidirectionalText;if(p&&1===l.sections.length){m=[];for(var r=0,s=p(l.toString(),nd(l,h,d,b));r<s.length;r+=1){var t=s[r],u=new Ii;u.text=t,u.sections=l.sections;for(var v=0;v<t.length;v++)u.sectionIndex.push(0);m.push(u)}}else if(q){m=[];for(var w=0,x=q(l.text,l.sectionIndex,nd(l,h,d,b));w<x.length;w+=1){var y=x[w],z=new Ii;z.text=y[0],z.sectionIndex=y[1],z.sections=l.sections,m.push(z)}}else m=function(a,b){for(var c=[],d=a.text,e=0,f=0,g=b;f<g.length;f+=1){var h=g[f];c.push(a.substring(e,h)),e=h}return e<d.length&&c.push(a.substring(e,d.length)),c}(l,nd(l,h,d,b));return function(a,b,c,d,e,f,g,h,i){for(var j=0,k=-17,l=0,m=a.positionedGlyphs,n="right"===f?1:"left"===f?0:.5,o=0,p=c;o<p.length;o+=1){var q=p[o];q.trim();var r=q.getMaxScale();if(q.length()){for(var s=m.length,t=0;t<q.length();t++){var u=q.getSection(t),v=q.getCharCode(t),w=24*(r-u.scale),x=b[u.fontStack],y=x&&x[v];y&&(fb(v)&&g!==Hi.horizontal?(m.push({glyph:v,x:j,y:w,vertical:!0,scale:u.scale,fontStack:u.fontStack}),j+=i*u.scale+h):(m.push({glyph:v,x:j,y:k+w,vertical:!1,scale:u.scale,fontStack:u.fontStack}),j+=y.metrics.advance*u.scale+h))}if(m.length!==s){var z=j-h;l=Math.max(z,l),pd(m,b,s,m.length-1,n)}j=0,k+=d*r}else k+=d}var A=od(e),B=A.horizontalAlign,C=A.verticalAlign;!function(a,b,c,d,e,f,g){for(var h=(b-c)*e,i=(-d*g+.5)*f,j=0;j<a.length;j++)a[j].x+=h,a[j].y+=i}(m,n,B,C,l,d,c.length);var D=k- -17;a.top+=-C*D,a.bottom=a.top+D,a.left+=-B*l,a.right=a.left+l}(o,b,m,e,f,g,k,h,j),!!n.length&&(o.text=o.text.toString(),o)},a.allowsVerticalWritingMode=db,a.shapeIcon=function(a,b,c){var d=od(c),e=d.horizontalAlign,f=d.verticalAlign,g=b[0],h=b[1],i=g-a.displaySize[0]*e,j=i+a.displaySize[0],k=h-a.displaySize[1]*f;return{image:a,top:k,bottom:k+a.displaySize[1],left:i,right:j}},a.classifyRings=nc,a.SIZE_PACK_FACTOR=256,a.SymbolBucket=Xh,a.register=ab,a.CollisionBoxArray=tg,a.DictionaryCoder=Bi,a.FeatureIndex=Fi,a.ImageAtlas=hi,a.LineBucket=Hh,a.FillBucket=oh,a.FillExtrusionBucket=uh,a.mvt=Bh,a.Protobuf=pi,a.DEMData=zi,a.vectorTile=Bh,a.Point$1=rd,a.pbf=pi,a.createExpression=wa,a.plugin=Ff}),a(["./shared.js"],function(a){function b(a){var c=typeof a;if("number"===c||"boolean"===c||"string"===c||null==a)return JSON.stringify(a);if(Array.isArray(a)){for(var d="[",e=0,f=a;e<f.length;e+=1)d+=b(f[e])+",";return d+"]"}for(var g=Object.keys(a).sort(),h="{",i=0;i<g.length;i++)h+=JSON.stringify(g[i])+":"+b(a[g[i]])+",";return h+"}"}function c(c){for(var d="",e=0,f=a.refProperties;e<f.length;e+=1)d+="/"+b(c[f[e]]);return d}function d(a,b,c,d,e){if(void 0===b.segment)return!0;for(var f=b,g=b.segment+1,h=0;h>-c/2;){if(--g<0)return!1;h-=a[g].dist(f),f=a[g]}h+=a[g].dist(a[g+1]),g++;for(var i=[],j=0;h<c/2;){var k=a[g-1],l=a[g],m=a[g+1];if(!m)return!1;var n=k.angleTo(l)-l.angleTo(m);for(n=Math.abs((n+3*Math.PI)%(2*Math.PI)-Math.PI),i.push({distance:h,angleDelta:n}),j+=n;h-i[0].distance>d;)j-=i.shift().angleDelta;if(j>e)return!1;g++,h+=l.dist(m)}return!0}function e(a){for(var b=0,c=0;c<a.length-1;c++)b+=a[c].dist(a[c+1]);return b}function f(a,b,c){return a?.6*b*c:0}function g(a,b){return Math.max(a?a.right-a.left:0,b?b.right-b.left:0)}function h(b,c,h,i,j,k){for(var l=f(h,j,k),m=g(h,i)*k,n=0,o=e(b)/2,p=0;p<b.length-1;p++){var q=b[p],r=b[p+1],s=q.dist(r);if(n+s>o){var t=(o-n)/s,u=a.number(q.x,r.x,t),v=a.number(q.y,r.y,t),w=new a.Anchor(u,v,r.angleTo(q),p);return w._round(),!l||d(b,w,m,l,c)?w:void 0}n+=s}}function i(b,c,h,i,j,k,l,m,n){var o=f(i,k,l),p=g(i,j),q=p*l,r=0===b[0].x||b[0].x===n||0===b[0].y||b[0].y===n;return c-q<c/4&&(c=q+c/4),function b(c,f,g,h,i,j,k,l,m){for(var n=j/2,o=e(c),p=0,q=f-g,r=[],s=0;s<c.length-1;s++){for(var t=c[s],u=c[s+1],v=t.dist(u),w=u.angleTo(t);q+g<p+v;){var x=((q+=g)-p)/v,y=a.number(t.x,u.x,x),z=a.number(t.y,u.y,x);if(y>=0&&y<m&&z>=0&&z<m&&q-n>=0&&q+n<=o){var A=new a.Anchor(y,z,w,s);A._round(),h&&!d(c,A,j,h,i)||r.push(A)}}p+=v}return l||r.length||k||(r=b(c,p/2,g,h,i,j,k,!0,m)),r}(b,r?c/2*m%c:(p/2+2*k)*l*m%c,c,o,h,q,r,!1,n)}function j(a,b){return a<b?-1:a>b?1:0}function k(b,c,d){void 0===c&&(c=1),void 0===d&&(d=!1);for(var e=1/0,f=1/0,g=-1/0,h=-1/0,i=b[0],j=0;j<i.length;j++){var k=i[j];(!j||k.x<e)&&(e=k.x),(!j||k.y<f)&&(f=k.y),(!j||k.x>g)&&(g=k.x),(!j||k.y>h)&&(h=k.y)}var n=g-e,o=h-f,p=Math.min(n,o),q=p/2,r=new xa([],l);if(0===p)return new a.Point(e,f);for(var s=e;s<g;s+=p)for(var t=f;t<h;t+=p)r.push(new m(s+q,t+q,q,b));for(var u=function(a){for(var b=0,c=0,d=0,e=a[0],f=0,g=e.length,h=g-1;f<g;h=f++){var i=e[f],j=e[h],k=i.x*j.y-j.x*i.y;c+=(i.x+j.x)*k,d+=(i.y+j.y)*k,b+=3*k}return new m(c/b,d/b,0,a)}(b),v=r.length;r.length;){var w=r.pop();(w.d>u.d||!u.d)&&(u=w,d&&console.log("found best %d after %d probes",Math.round(1e4*w.d)/1e4,v)),w.max-u.d<=c||(q=w.h/2,r.push(new m(w.p.x-q,w.p.y-q,q,b)),r.push(new m(w.p.x+q,w.p.y-q,q,b)),r.push(new m(w.p.x-q,w.p.y+q,q,b)),r.push(new m(w.p.x+q,w.p.y+q,q,b)),v+=4)}return d&&(console.log("num probes: "+v),console.log("best distance: "+u.d)),u.p}function l(a,b){return b.max-a.max}function m(b,c,d,e){this.p=new a.Point(b,c),this.h=d,this.d=function(b,c){for(var d=!1,e=1/0,f=0;f<c.length;f++)for(var g=c[f],h=0,i=g.length,j=i-1;h<i;j=h++){var k=g[h],l=g[j];k.y>b.y!=l.y>b.y&&b.x<(l.x-k.x)*(b.y-k.y)/(l.y-k.y)+k.x&&(d=!d),e=Math.min(e,a.distToSegmentSquared(b,k,l))}return(d?1:-1)*Math.sqrt(e)}(this.p,e),this.max=this.d+this.h*Math.SQRT2}function n(b,c,d,e,f,g){b.createArrays();var h=512*b.overscaling;b.tilePixelRatio=a.EXTENT/h,b.compareText={},b.iconsNeedLinear=!1;var i=b.layers[0].layout,j=b.layers[0]._unevaluatedLayout._values,k={};if("composite"===b.textSizeData.functionType){var l=b.textSizeData.zoomRange,m=l.min,n=l.max;k.compositeTextSizes=[j["text-size"].possiblyEvaluate(new a.EvaluationParameters(m)),j["text-size"].possiblyEvaluate(new a.EvaluationParameters(n))]}if("composite"===b.iconSizeData.functionType){var p=b.iconSizeData.zoomRange,q=p.min,r=p.max;k.compositeIconSizes=[j["icon-size"].possiblyEvaluate(new a.EvaluationParameters(q)),j["icon-size"].possiblyEvaluate(new a.EvaluationParameters(r))]}k.layoutTextSize=j["text-size"].possiblyEvaluate(new a.EvaluationParameters(b.zoom+1)),k.layoutIconSize=j["icon-size"].possiblyEvaluate(new a.EvaluationParameters(b.zoom+1)),k.textMaxSize=j["text-size"].possiblyEvaluate(new a.EvaluationParameters(18));for(var s=24*i.get("text-line-height"),t="map"===i.get("text-rotation-alignment")&&"point"!==i.get("symbol-placement"),u=i.get("text-keep-upright"),v=0,w=b.features;v<w.length;v+=1){var x=w[v],y=i.get("text-font").evaluate(x,{}).join(","),z=d,A={},B=x.text;if(B){var C=B.toString(),D=i.get("text-offset").evaluate(x,{}).map(function(a){return 24*a}),E=24*i.get("text-letter-spacing").evaluate(x,{}),F=a.allowsLetterSpacing(C)?E:0,G=i.get("text-anchor").evaluate(x,{}),H=i.get("text-justify").evaluate(x,{}),I="point"===i.get("symbol-placement")?24*i.get("text-max-width").evaluate(x,{}):0;A.horizontal=a.shapeText(B,c,y,I,s,G,H,F,D,24,a.WritingMode.horizontal),a.allowsVerticalWritingMode(C)&&t&&u&&(A.vertical=a.shapeText(B,c,y,I,s,G,H,F,D,24,a.WritingMode.vertical))}var J=void 0;if(x.icon){var K=e[x.icon];K&&(J=a.shapeIcon(f[x.icon],i.get("icon-offset").evaluate(x,{}),i.get("icon-anchor").evaluate(x,{})),void 0===b.sdfIcons?b.sdfIcons=K.sdf:b.sdfIcons!==K.sdf&&a.warnOnce("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),K.pixelRatio!==b.pixelRatio?b.iconsNeedLinear=!0:0!==i.get("icon-rotate").constantOr(1)&&(b.iconsNeedLinear=!0))}(A.horizontal||J)&&o(b,x,A,J,z,k)}g&&b.generateCollisionDebugBuffers()}function o(b,c,d,e,f,g){var j=g.layoutTextSize.evaluate(c,{}),l=g.layoutIconSize.evaluate(c,{}),m=g.textMaxSize.evaluate(c,{});void 0===m&&(m=j);var n=b.layers[0].layout,o=n.get("text-offset").evaluate(c,{}),r=n.get("icon-offset").evaluate(c,{}),s=j/24,t=b.tilePixelRatio*s,u=b.tilePixelRatio*m/24,v=b.tilePixelRatio*l,w=b.tilePixelRatio*n.get("symbol-spacing"),x=n.get("text-padding")*b.tilePixelRatio,y=n.get("icon-padding")*b.tilePixelRatio,z=n.get("text-max-angle")/180*Math.PI,A="map"===n.get("text-rotation-alignment")&&"point"!==n.get("symbol-placement"),B="map"===n.get("icon-rotation-alignment")&&"point"!==n.get("symbol-placement"),C=n.get("symbol-placement"),D=w/2,E=function(h,i){i.x<0||i.x>=a.EXTENT||i.y<0||i.y>=a.EXTENT||function(b,c,d,e,f,g,h,i,j,k,l,m,n,o,q,r,s,t,u,v,w){var x,y,z=b.addToLineVertexArray(c,d),A=0,B=0,C=0,D=Aa(e.horizontal?e.horizontal.text:""),E=[];if(e.horizontal){var F=g.layout.get("text-rotate").evaluate(u,{});x=new wa(h,d,c,i,j,k,e.horizontal,l,m,n,b.overscaling,F),B+=p(b,c,e.horizontal,g,n,u,o,z,e.vertical?a.WritingMode.horizontal:a.WritingMode.horizontalOnly,E,v,w),e.vertical&&(C+=p(b,c,e.vertical,g,n,u,o,z,a.WritingMode.vertical,E,v,w))}var G=x?x.boxStartIndex:b.collisionBoxArray.length,H=x?x.boxEndIndex:b.collisionBoxArray.length;if(f){var I=function(b,c,d,e,f,g){var h,i,j,k,l=c.image,m=d.layout,n=c.top-1/l.pixelRatio,o=c.left-1/l.pixelRatio,p=c.bottom+1/l.pixelRatio,q=c.right+1/l.pixelRatio;if("none"!==m.get("icon-text-fit")&&f){var r=q-o,s=p-n,t=m.get("text-size").evaluate(g,{})/24,u=f.left*t,v=f.right*t,w=f.top*t,x=v-u,y=f.bottom*t-w,z=m.get("icon-text-fit-padding")[0],A=m.get("icon-text-fit-padding")[1],B=m.get("icon-text-fit-padding")[2],C=m.get("icon-text-fit-padding")[3],D="width"===m.get("icon-text-fit")?.5*(y-s):0,E="height"===m.get("icon-text-fit")?.5*(x-r):0,F="width"===m.get("icon-text-fit")||"both"===m.get("icon-text-fit")?x:r,G="height"===m.get("icon-text-fit")||"both"===m.get("icon-text-fit")?y:s;h=new a.Point(u+E-C,w+D-z),i=new a.Point(u+E+A+F,w+D-z),j=new a.Point(u+E+A+F,w+D+B+G),k=new a.Point(u+E-C,w+D+B+G)}else h=new a.Point(o,n),i=new a.Point(q,n),j=new a.Point(q,p),k=new a.Point(o,p);var H=d.layout.get("icon-rotate").evaluate(g,{})*Math.PI/180;if(H){var I=Math.sin(H),J=Math.cos(H),K=[J,-I,I,J];h._matMult(K),i._matMult(K),k._matMult(K),j._matMult(K)}return[{tl:h,tr:i,bl:k,br:j,tex:l.paddedRect,writingMode:void 0,glyphOffset:[0,0]}]}(0,f,g,0,e.horizontal,u),J=g.layout.get("icon-rotate").evaluate(u,{});y=new wa(h,d,c,i,j,k,f,q,r,!1,b.overscaling,J),A=4*I.length;var K=b.iconSizeData,L=null;"source"===K.functionType?(L=[a.SIZE_PACK_FACTOR*g.layout.get("icon-size").evaluate(u,{})])[0]>Da&&a.warnOnce(b.layerIds[0]+': Value for "icon-size" is >= 256. Reduce your "icon-size".'):"composite"===K.functionType&&((L=[a.SIZE_PACK_FACTOR*w.compositeIconSizes[0].evaluate(u,{}),a.SIZE_PACK_FACTOR*w.compositeIconSizes[1].evaluate(u,{})])[0]>Da||L[1]>Da)&&a.warnOnce(b.layerIds[0]+': Value for "icon-size" is >= 256. Reduce your "icon-size".'),b.addSymbols(b.icon,I,L,t,s,u,!1,c,z.lineStartIndex,z.lineLength)}var M=y?y.boxStartIndex:b.collisionBoxArray.length,N=y?y.boxEndIndex:b.collisionBoxArray.length;b.glyphOffsetArray.length>=a.SymbolBucket.MAX_GLYPHS&&a.warnOnce("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),b.symbolInstances.emplaceBack(c.x,c.y,E.length>0?E[0]:-1,E.length>1?E[1]:-1,D,G,H,M,N,i,B,C,A,0)}(b,i,h,d,e,b.layers[0],b.collisionBoxArray,c.index,c.sourceLayerIndex,b.index,t,x,A,o,v,y,B,r,c,f,g)};if("line"===C)for(var F=0,G=function(b,c,d,e,f){for(var g=[],h=0;h<b.length;h++)for(var i=b[h],j=void 0,k=0;k<i.length-1;k++){var l=i[k],m=i[k+1];l.x<0&&m.x<0||(l.x<0?l=new a.Point(0,l.y+(m.y-l.y)*((0-l.x)/(m.x-l.x)))._round():m.x<0&&(m=new a.Point(0,l.y+(m.y-l.y)*((0-l.x)/(m.x-l.x)))._round()),l.y<0&&m.y<0||(l.y<0?l=new a.Point(l.x+(m.x-l.x)*((0-l.y)/(m.y-l.y)),0)._round():m.y<0&&(m=new a.Point(l.x+(m.x-l.x)*((0-l.y)/(m.y-l.y)),0)._round()),l.x>=e&&m.x>=e||(l.x>=e?l=new a.Point(e,l.y+(m.y-l.y)*((e-l.x)/(m.x-l.x)))._round():m.x>=e&&(m=new a.Point(e,l.y+(m.y-l.y)*((e-l.x)/(m.x-l.x)))._round()),l.y>=f&&m.y>=f||(l.y>=f?l=new a.Point(l.x+(m.x-l.x)*((f-l.y)/(m.y-l.y)),f)._round():m.y>=f&&(m=new a.Point(l.x+(m.x-l.x)*((f-l.y)/(m.y-l.y)),f)._round()),j&&l.equals(j[j.length-1])||(j=[l],g.push(j)),j.push(m)))))}return g}(c.geometry,0,0,a.EXTENT,a.EXTENT);F<G.length;F+=1)for(var H=G[F],I=0,J=i(H,w,z,d.vertical||d.horizontal,e,24,u,b.overscaling,a.EXTENT);I<J.length;I+=1){var K=J[I],L=d.horizontal;L&&q(b,L.text,D,K)||E(H,K)}else if("line-center"===C)for(var M=0,N=c.geometry;M<N.length;M+=1){var O=N[M];if(O.length>1){var P=h(O,z,d.vertical||d.horizontal,e,24,u);P&&E(O,P)}}else if("Polygon"===c.type)for(var Q=0,R=a.classifyRings(c.geometry,0);Q<R.length;Q+=1){var S=R[Q],T=k(S,16);E(S[0],new a.Anchor(T.x,T.y,0))}else if("LineString"===c.type)for(var U=0,V=c.geometry;U<V.length;U+=1){var W=V[U];E(W,new a.Anchor(W[0].x,W[0].y,0))}else if("Point"===c.type)for(var X=0,Y=c.geometry;X<Y.length;X+=1)for(var Z=0,$=Y[X];Z<$.length;Z+=1){var _=$[Z];E([_],new a.Anchor(_.x,_.y,0))}}function p(b,c,d,e,f,g,h,i,j,k,l,m){var n=function(b,c,d,e,f,g){for(var h=d.layout.get("text-rotate").evaluate(f,{})*Math.PI/180,i=d.layout.get("text-offset").evaluate(f,{}).map(function(a){return 24*a}),j=c.positionedGlyphs,k=[],l=0;l<j.length;l++){var m=j[l],n=g[m.fontStack],o=n&&n[m.glyph];if(o){var p=o.rect;if(p){var q=a.GLYPH_PBF_BORDER+1,r=o.metrics.advance*m.scale/2,s=e?[m.x+r,m.y]:[0,0],t=e?[0,0]:[m.x+r+i[0],m.y+i[1]],u=(o.metrics.left-q)*m.scale-r+t[0],v=(-o.metrics.top-q)*m.scale+t[1],w=u+p.w*m.scale,x=v+p.h*m.scale,y=new a.Point(u,v),z=new a.Point(w,v),A=new a.Point(u,x),B=new a.Point(w,x);if(e&&m.vertical){var C=new a.Point(-r,r),D=-Math.PI/2,E=new a.Point(5,0);y._rotateAround(D,C)._add(E),z._rotateAround(D,C)._add(E),A._rotateAround(D,C)._add(E),B._rotateAround(D,C)._add(E)}if(h){var F=Math.sin(h),G=Math.cos(h),H=[G,-F,F,G];y._matMult(H),z._matMult(H),A._matMult(H),B._matMult(H)}k.push({tl:y,tr:z,bl:A,br:B,tex:p,writingMode:c.writingMode,glyphOffset:s})}}}return k}(0,d,e,f,g,l),o=b.textSizeData,p=null;return"source"===o.functionType?(p=[a.SIZE_PACK_FACTOR*e.layout.get("text-size").evaluate(g,{})])[0]>Da&&a.warnOnce(b.layerIds[0]+': Value for "text-size" is >= 256. Reduce your "text-size".'):"composite"===o.functionType&&((p=[a.SIZE_PACK_FACTOR*m.compositeTextSizes[0].evaluate(g,{}),a.SIZE_PACK_FACTOR*m.compositeTextSizes[1].evaluate(g,{})])[0]>Da||p[1]>Da)&&a.warnOnce(b.layerIds[0]+': Value for "text-size" is >= 256. Reduce your "text-size".'),b.addSymbols(b.text,n,p,h,f,g,j,c,i.lineStartIndex,i.lineLength),k.push(b.text.placedSymbolArray.length-1),4*n.length}function q(a,b,c,d){var e=a.compareText;if(b in e){for(var f=e[b],g=f.length-1;g>=0;g--)if(d.dist(f[g])<c)return!0}else e[b]=[];return e[b].push(d),!1}function r(b,c){for(var d=new a.EvaluationParameters(c),e=0,f=b;e<f.length;e+=1)f[e].recalculate(d)}function s(b,c){var d=a.getArrayBuffer(b.request,function(b,d,e,f){b?c(b):d&&c(null,{vectorTile:new a.mvt.VectorTile(new a.Protobuf(d)),rawData:d,cacheControl:e,expires:f})});return function(){d.cancel(),c()}}function t(a){var b=0;if(a&&a.length>0){b+=Math.abs(u(a[0]));for(var c=1;c<a.length;c++)b-=Math.abs(u(a[c]))}return b}function u(a){var b,c,d,e,f,g,h=0,i=a.length;if(i>2){for(g=0;g<i;g++)g===i-2?(d=i-2,e=i-1,f=0):g===i-1?(d=i-1,e=0,f=1):(d=g,e=g+1,f=g+2),b=a[d],c=a[e],h+=(v(a[f][0])-v(b[0]))*Math.sin(v(c[1]));h=h*La.RADIUS*La.RADIUS/2}return h}function v(a){return a*Math.PI/180}function w(a,b){return function(c){return a(c,b)}}function x(a,b){b=!!b,a[0]=y(a[0],b);for(var c=1;c<a.length;c++)a[c]=y(a[c],!b);return a}function y(a,b){return function(a){return Ma.ring(a)>=0}(a)===b?a:a.reverse()}function z(a,b){this.options=b||{},this.features=a,this.length=a.length}function A(a,b){this.id="number"==typeof a.id?a.id:void 0,this.type=a.type,this.rawGeometry=1===a.type?[a.geometry]:a.geometry,this.properties=a.tags,this.extent=b||4096}function B(b){var c=new a.pbf;return function(a,b){for(var c in a.layers)b.writeMessage(3,C,a.layers[c])}(b,c),c.finish()}function C(a,b){var c;b.writeVarintField(15,a.version||1),b.writeStringField(1,a.name||""),b.writeVarintField(5,a.extent||4096);var d={keys:[],values:[],keycache:{},valuecache:{}};for(c=0;c<a.length;c++)d.feature=a.feature(c),b.writeMessage(2,D,d);var e=d.keys;for(c=0;c<e.length;c++)b.writeStringField(3,e[c]);var f=d.values;for(c=0;c<f.length;c++)b.writeMessage(4,I,f[c])}function D(a,b){var c=a.feature;void 0!==c.id&&b.writeVarintField(1,c.id),b.writeMessage(2,E,a),b.writeVarintField(3,c.type),b.writeMessage(4,H,c)}function E(a,b){var c=a.feature,d=a.keys,e=a.values,f=a.keycache,g=a.valuecache;for(var h in c.properties){var i=f[h];void 0===i&&(d.push(h),i=d.length-1,f[h]=i),b.writeVarint(i);var j=c.properties[h],k=typeof j;"string"!==k&&"boolean"!==k&&"number"!==k&&(j=JSON.stringify(j));var l=k+":"+j,m=g[l];void 0===m&&(e.push(j),m=e.length-1,g[l]=m),b.writeVarint(m)}}function F(a,b){return(b<<3)+(7&a)}function G(a){return a<<1^a>>31}function H(a,b){for(var c=a.loadGeometry(),d=a.type,e=0,f=0,g=c.length,h=0;h<g;h++){var i=c[h],j=1;1===d&&(j=i.length),b.writeVarint(F(1,j));for(var k=3===d?i.length-1:i.length,l=0;l<k;l++){1===l&&1!==d&&b.writeVarint(F(2,k-1));var m=i[l].x-e,n=i[l].y-f;b.writeVarint(G(m)),b.writeVarint(G(n)),e+=m,f+=n}3===d&&b.writeVarint(F(7,1))}}function I(a,b){var c=typeof a;"string"===c?b.writeStringField(1,a):"boolean"===c?b.writeBooleanField(7,a):"number"===c&&(a%1!=0?b.writeDoubleField(3,a):a<0?b.writeSVarintField(6,a):b.writeVarintField(5,a))}function J(a,b,c,d,e,f){if(!(e-d<=c)){var g=d+e>>1;!function a(b,c,d,e,f,g){for(;f>e;){if(f-e>600){var h=f-e+1,i=d-e+1,j=Math.log(h),k=.5*Math.exp(2*j/3),l=.5*Math.sqrt(j*k*(h-k)/h)*(i-h/2<0?-1:1);a(b,c,d,Math.max(e,Math.floor(d-i*k/h+l)),Math.min(f,Math.floor(d+(h-i)*k/h+l)),g)}var m=c[2*d+g],n=e,o=f;for(K(b,c,e,d),c[2*f+g]>m&&K(b,c,e,f);n<o;){for(K(b,c,n,o),n++,o--;c[2*n+g]<m;)n++;for(;c[2*o+g]>m;)o--}c[2*e+g]===m?K(b,c,e,o):K(b,c,++o,f),o<=d&&(e=o+1),d<=o&&(f=o-1)}}(a,b,g,d,e,f%2),J(a,b,c,d,g-1,f+1),J(a,b,c,g+1,e,f+1)}}function K(a,b,c,d){L(a,c,d),L(b,2*c,2*d),L(b,2*c+1,2*d+1)}function L(a,b,c){var d=a[b];a[b]=a[c],a[c]=d}function M(a,b,c,d){var e=a-c,f=b-d;return e*e+f*f}function N(a,b,c,d,e){return{x:a,y:b,zoom:1/0,id:c,parentId:-1,numPoints:d,properties:e}}function O(a,b){var c=a.geometry.coordinates,d=c[0],e=c[1];return{x:R(d),y:S(e),zoom:1/0,index:b,parentId:-1}}function P(a){return{type:"Feature",id:a.id,properties:Q(a),geometry:{type:"Point",coordinates:[360*(a.x-.5),(b=a.y,c=(180-360*b)*Math.PI/180,360*Math.atan(Math.exp(c))/Math.PI-90)]}};var b,c}function Q(a){var b=a.numPoints,c=b>=1e4?Math.round(b/1e3)+"k":b>=1e3?Math.round(b/100)/10+"k":b;return T(T({},a.properties),{cluster:!0,cluster_id:a.id,point_count:b,point_count_abbreviated:c})}function R(a){return a/360+.5}function S(a){var b=Math.sin(a*Math.PI/180),c=.5-.25*Math.log((1+b)/(1-b))/Math.PI;return c<0?0:c>1?1:c}function T(a,b){for(var c in b)a[c]=b[c];return a}function U(a){return a.x}function V(a){return a.y}function W(a,b,c,d,e,f){var g=e-c,h=f-d;if(0!==g||0!==h){var i=((a-c)*g+(b-d)*h)/(g*g+h*h);i>1?(c=e,d=f):i>0&&(c+=g*i,d+=h*i)}return(g=a-c)*g+(h=b-d)*h}function X(a,b,c,d){var e={id:void 0===a?null:a,type:b,geometry:c,tags:d,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};return function(a){var b=a.geometry,c=a.type;if("Point"===c||"MultiPoint"===c||"LineString"===c)Y(a,b);else if("Polygon"===c||"MultiLineString"===c)for(var d=0;d<b.length;d++)Y(a,b[d]);else if("MultiPolygon"===c)for(d=0;d<b.length;d++)for(var e=0;e<b[d].length;e++)Y(a,b[d][e])}(e),e}function Y(a,b){for(var c=0;c<b.length;c+=3)a.minX=Math.min(a.minX,b[c]),a.minY=Math.min(a.minY,b[c+1]),a.maxX=Math.max(a.maxX,b[c]),a.maxY=Math.max(a.maxY,b[c+1])}function Z(a,b,c,d){if(b.geometry){var e=b.geometry.coordinates,f=b.geometry.type,g=Math.pow(c.tolerance/((1<<c.maxZoom)*c.extent),2),h=[],i=b.id;if(c.promoteId?i=b.properties[c.promoteId]:c.generateId&&(i=d||0),"Point"===f)$(e,h);else if("MultiPoint"===f)for(var j=0;j<e.length;j++)$(e[j],h);else if("LineString"===f)_(e,h,g,!1);else if("MultiLineString"===f){if(c.lineMetrics){for(j=0;j<e.length;j++)h=[],_(e[j],h,g,!1),a.push(X(i,"LineString",h,b.properties));return}aa(e,h,g,!1)}else if("Polygon"===f)aa(e,h,g,!0);else{if("MultiPolygon"!==f){if("GeometryCollection"===f){for(j=0;j<b.geometry.geometries.length;j++)Z(a,{id:i,geometry:b.geometry.geometries[j],properties:b.properties},c,d);return}throw new Error("Input data is not a valid GeoJSON object.")}for(j=0;j<e.length;j++){var k=[];aa(e[j],k,g,!0),h.push(k)}}a.push(X(i,f,h,b.properties))}}function $(a,b){b.push(ba(a[0])),b.push(ca(a[1])),b.push(0)}function _(a,b,c,d){for(var e,f,g=0,h=0;h<a.length;h++){var i=ba(a[h][0]),j=ca(a[h][1]);b.push(i),b.push(j),b.push(0),h>0&&(g+=d?(e*j-i*f)/2:Math.sqrt(Math.pow(i-e,2)+Math.pow(j-f,2))),e=i,f=j}var k=b.length-3;b[2]=1,function a(b,c,d,e){for(var f,g=e,h=d-c>>1,i=d-c,j=b[c],k=b[c+1],l=b[d],m=b[d+1],n=c+3;n<d;n+=3){var o=W(b[n],b[n+1],j,k,l,m);if(o>g)f=n,g=o;else if(o===g){var p=Math.abs(n-h);p<i&&(f=n,i=p)}}g>e&&(f-c>3&&a(b,c,f,e),b[f+2]=g,d-f>3&&a(b,f,d,e))}(b,0,k,c),b[k+2]=1,b.size=Math.abs(g),b.start=0,b.end=b.size}function aa(a,b,c,d){for(var e=0;e<a.length;e++){var f=[];_(a[e],f,c,d),b.push(f)}}function ba(a){return a/360+.5}function ca(a){var b=Math.sin(a*Math.PI/180),c=.5-.25*Math.log((1+b)/(1-b))/Math.PI;return c<0?0:c>1?1:c}function da(a,b,c,d,e,f,g,h){if(d/=b,f>=(c/=b)&&g<d)return a;if(g<c||f>=d)return null;for(var i=[],j=0;j<a.length;j++){var k=a[j],l=k.geometry,m=k.type,n=0===e?k.minX:k.minY,o=0===e?k.maxX:k.maxY;if(n>=c&&o<d)i.push(k);else if(!(o<c||n>=d)){var p=[];if("Point"===m||"MultiPoint"===m)ea(l,p,c,d,e);else if("LineString"===m)fa(l,p,c,d,e,!1,h.lineMetrics);else if("MultiLineString"===m)ha(l,p,c,d,e,!1);else if("Polygon"===m)ha(l,p,c,d,e,!0);else if("MultiPolygon"===m)for(var q=0;q<l.length;q++){var r=[];ha(l[q],r,c,d,e,!0),r.length&&p.push(r)}if(p.length){if(h.lineMetrics&&"LineString"===m){for(q=0;q<p.length;q++)i.push(X(k.id,m,p[q],k.tags));continue}"LineString"!==m&&"MultiLineString"!==m||(1===p.length?(m="LineString",p=p[0]):m="MultiLineString"),"Point"!==m&&"MultiPoint"!==m||(m=3===p.length?"Point":"MultiPoint"),i.push(X(k.id,m,p,k.tags))}}}return i.length?i:null}function ea(a,b,c,d,e){for(var f=0;f<a.length;f+=3){var g=a[f+e];g>=c&&g<=d&&(b.push(a[f]),b.push(a[f+1]),b.push(a[f+2]))}}function fa(a,b,c,d,e,f,g){for(var h,i,j=ga(a),k=0===e?ja:ka,l=a.start,m=0;m<a.length-3;m+=3){var n=a[m],o=a[m+1],p=a[m+2],q=a[m+3],r=a[m+4],s=0===e?n:o,t=0===e?q:r,u=!1;g&&(h=Math.sqrt(Math.pow(n-q,2)+Math.pow(o-r,2))),s<c?t>c&&(i=k(j,n,o,q,r,c),g&&(j.start=l+h*i)):s>d?t<d&&(i=k(j,n,o,q,r,d),g&&(j.start=l+h*i)):ia(j,n,o,p),t<c&&s>=c&&(i=k(j,n,o,q,r,c),u=!0),t>d&&s<=d&&(i=k(j,n,o,q,r,d),u=!0),!f&&u&&(g&&(j.end=l+h*i),b.push(j),j=ga(a)),g&&(l+=h)}var v=a.length-3;n=a[v],o=a[v+1],p=a[v+2],(s=0===e?n:o)>=c&&s<=d&&ia(j,n,o,p),v=j.length-3,f&&v>=3&&(j[v]!==j[0]||j[v+1]!==j[1])&&ia(j,j[0],j[1],j[2]),j.length&&b.push(j)}function ga(a){var b=[];return b.size=a.size,b.start=a.start,b.end=a.end,b}function ha(a,b,c,d,e,f){for(var g=0;g<a.length;g++)fa(a[g],b,c,d,e,f,!1)}function ia(a,b,c,d){a.push(b),a.push(c),a.push(d)}function ja(a,b,c,d,e,f){var g=(f-b)/(d-b);return a.push(f),a.push(c+(e-c)*g),a.push(1),g}function ka(a,b,c,d,e,f){var g=(f-c)/(e-c);return a.push(b+(d-b)*g),a.push(f),a.push(1),g}function la(a,b){for(var c=[],d=0;d<a.length;d++){var e,f=a[d],g=f.type;if("Point"===g||"MultiPoint"===g||"LineString"===g)e=ma(f.geometry,b);else if("MultiLineString"===g||"Polygon"===g){e=[];for(var h=0;h<f.geometry.length;h++)e.push(ma(f.geometry[h],b))}else if("MultiPolygon"===g)for(e=[],h=0;h<f.geometry.length;h++){for(var i=[],j=0;j<f.geometry[h].length;j++)i.push(ma(f.geometry[h][j],b));e.push(i)}c.push(X(f.id,g,e,f.tags))}return c}function ma(a,b){var c=[];c.size=a.size,void 0!==a.start&&(c.start=a.start,c.end=a.end);for(var d=0;d<a.length;d+=3)c.push(a[d]+b,a[d+1],a[d+2]);return c}function na(a,b){if(a.transformed)return a;var c,d,e,f=1<<a.z,g=a.x,h=a.y;for(c=0;c<a.features.length;c++){var i=a.features[c],j=i.geometry,k=i.type;if(i.geometry=[],1===k)for(d=0;d<j.length;d+=2)i.geometry.push(oa(j[d],j[d+1],b,f,g,h));else for(d=0;d<j.length;d++){var l=[];for(e=0;e<j[d].length;e+=2)l.push(oa(j[d][e],j[d][e+1],b,f,g,h));i.geometry.push(l)}}return a.transformed=!0,a}function oa(a,b,c,d,e,f){return[Math.round(c*(a*d-e)),Math.round(c*(b*d-f))]}function pa(a,b,c,d,e){for(var f=b===e.maxZoom?0:e.tolerance/((1<<b)*e.extent),g={features:[],numPoints:0,numSimplified:0,numFeatures:0,source:null,x:c,y:d,z:b,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0},h=0;h<a.length;h++){g.numFeatures++,qa(g,a[h],f,e);var i=a[h].minX,j=a[h].minY,k=a[h].maxX,l=a[h].maxY;i<g.minX&&(g.minX=i),j<g.minY&&(g.minY=j),k>g.maxX&&(g.maxX=k),l>g.maxY&&(g.maxY=l)}return g}function qa(a,b,c,d){var e=b.geometry,f=b.type,g=[];if("Point"===f||"MultiPoint"===f)for(var h=0;h<e.length;h+=3)g.push(e[h]),g.push(e[h+1]),a.numPoints++,a.numSimplified++;else if("LineString"===f)ra(g,e,a,c,!1,!1);else if("MultiLineString"===f||"Polygon"===f)for(h=0;h<e.length;h++)ra(g,e[h],a,c,"Polygon"===f,0===h);else if("MultiPolygon"===f)for(var i=0;i<e.length;i++){var j=e[i];for(h=0;h<j.length;h++)ra(g,j[h],a,c,!0,0===h)}if(g.length){var k=b.tags||null;if("LineString"===f&&d.lineMetrics){for(var l in k={},b.tags)k[l]=b.tags[l];k.mapbox_clip_start=e.start/e.size,k.mapbox_clip_end=e.end/e.size}var m={geometry:g,type:"Polygon"===f||"MultiPolygon"===f?3:"LineString"===f||"MultiLineString"===f?2:1,tags:k};null!==b.id&&(m.id=b.id),a.features.push(m)}}function ra(a,b,c,d,e,f){var g=d*d;if(d>0&&b.size<(e?g:d))c.numPoints+=b.length/3;else{for(var h=[],i=0;i<b.length;i+=3)(0===d||b[i+2]>g)&&(c.numSimplified++,h.push(b[i]),h.push(b[i+1])),c.numPoints++;e&&function(a,b){for(var c=0,d=0,e=a.length,f=e-2;d<e;f=d,d+=2)c+=(a[d]-a[f])*(a[d+1]+a[f+1]);if(c>0===b)for(d=0,e=a.length;d<e/2;d+=2){var g=a[d],h=a[d+1];a[d]=a[e-2-d],a[d+1]=a[e-1-d],a[e-2-d]=g,a[e-1-d]=h}}(h,f),a.push(h)}}function sa(a,b){var c=(b=this.options=function(a,b){for(var c in b)a[c]=b[c];return a}(Object.create(this.options),b)).debug;if(c&&console.time("preprocess data"),b.maxZoom<0||b.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(b.promoteId&&b.generateId)throw new Error("promoteId and generateId cannot be used together.");var d=function(a,b){var c=[];if("FeatureCollection"===a.type)for(var d=0;d<a.features.length;d++)Z(c,a.features[d],b,d);else"Feature"===a.type?Z(c,a,b):Z(c,{geometry:a},b);return c}(a,b);this.tiles={},this.tileCoords=[],c&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",b.indexMaxZoom,b.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),(d=function(a,b){var c=b.buffer/b.extent,d=a,e=da(a,1,-1-c,c,0,-1,2,b),f=da(a,1,1-c,2+c,0,-1,2,b);return(e||f)&&(d=da(a,1,-c,1+c,0,-1,2,b)||[],e&&(d=la(e,1).concat(d)),f&&(d=d.concat(la(f,-1)))),d}(d,b)).length&&this.splitTile(d,0,0,0),c&&(d.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}function ta(a,b,c){return 32*((1<<a)*c+b)+a}function ua(a,b){var c=a.tileID.canonical;if(!this._geoJSONIndex)return b(null,null);var d=this._geoJSONIndex.getTile(c.z,c.x,c.y);if(!d)return b(null,null);var e=new Qa(d.features),f=Ta(e);0===f.byteOffset&&f.byteLength===f.buffer.byteLength||(f=new Uint8Array(f)),b(null,{vectorTile:e,rawData:f.buffer})}var va=function(a){a&&this.replace(a)};va.prototype.replace=function(a){this._layerConfigs={},this._layers={},this.update(a,[])},va.prototype.update=function(b,d){for(var e=this,f=0,g=b;f<g.length;f+=1){var h=g[f];this._layerConfigs[h.id]=h;var i=this._layers[h.id]=a.createStyleLayer(h);i._featureFilter=a.featureFilter(i.filter)}for(var j=0,k=d;j<k.length;j+=1){var l=k[j];delete this._layerConfigs[l],delete this._layers[l]}this.familiesBySource={};for(var m=0,n=function(a){for(var b={},d=0;d<a.length;d++){var e=c(a[d]),f=b[e];f||(f=b[e]=[]),f.push(a[d])}var g=[];for(var h in b)g.push(b[h]);return g}(a.values(this._layerConfigs));m<n.length;m+=1){var o=n[m].map(function(a){return e._layers[a.id]}),p=o[0];if("none"!==p.visibility){var q=p.source||"",r=this.familiesBySource[q];r||(r=this.familiesBySource[q]={});var s=p.sourceLayer||"_geojsonTileLayer",t=r[s];t||(t=r[s]=[]),t.push(o)}}};var wa=function(b,c,d,e,f,g,h,i,j,k,l,m){var n=h.top*i-j,o=h.bottom*i+j,p=h.left*i-j,q=h.right*i+j;if(this.boxStartIndex=b.length,k){var r=o-n,s=q-p;r>0&&(r=Math.max(10*i,r),this._addLineCollisionCircles(b,c,d,d.segment,s,r,e,f,g,l))}else{if(m){var t=new a.Point(p,n),u=new a.Point(q,n),v=new a.Point(p,o),w=new a.Point(q,o),x=m*Math.PI/180;t._rotate(x),u._rotate(x),v._rotate(x),w._rotate(x),p=Math.min(t.x,u.x,v.x,w.x),q=Math.max(t.x,u.x,v.x,w.x),n=Math.min(t.y,u.y,v.y,w.y),o=Math.max(t.y,u.y,v.y,w.y)}b.emplaceBack(d.x,d.y,p,n,q,o,e,f,g,0,0)}this.boxEndIndex=b.length};wa.prototype._addLineCollisionCircles=function(a,b,c,d,e,f,g,h,i,j){var k=f/2,l=Math.floor(e/k)||1,m=1+.4*Math.log(j)/Math.LN2,n=Math.floor(l*m/2),o=-f/2,p=c,q=d+1,r=o,s=-e/2,t=s-e/4;do{if(--q<0){if(r>s)return;q=0;break}r-=b[q].dist(p),p=b[q]}while(r>t);for(var u=b[q].dist(b[q+1]),v=-n;v<l+n;v++){var w=v*k,x=s+w;if(w<0&&(x+=w),w>e&&(x+=w-e),!(x<r)){for(;r+u<x;){if(r+=u,++q+1>=b.length)return;u=b[q].dist(b[q+1])}
var y=x-r,z=b[q],A=b[q+1].sub(z)._unit()._mult(y)._add(z)._round(),B=Math.abs(x-o)<k?0:.8*(x-o);a.emplaceBack(A.x,A.y,-f/2,-f/2,f/2,f/2,g,h,i,f/2,B)}}};var xa=function(a,b){if(void 0===a&&(a=[]),void 0===b&&(b=j),this.data=a,this.length=this.data.length,this.compare=b,this.length>0)for(var c=(this.length>>1)-1;c>=0;c--)this._down(c)};xa.prototype.push=function(a){this.data.push(a),this.length++,this._up(this.length-1)},xa.prototype.pop=function(){if(0!==this.length){var a=this.data[0];return this.length--,this.length>0&&(this.data[0]=this.data[this.length],this._down(0)),this.data.pop(),a}},xa.prototype.peek=function(){return this.data[0]},xa.prototype._up=function(a){for(var b=this.data,c=this.compare,d=b[a];a>0;){var e=a-1>>1,f=b[e];if(c(d,f)>=0)break;b[a]=f,a=e}b[a]=d},xa.prototype._down=function(a){for(var b=this.data,c=this.compare,d=this.length>>1,e=b[a];a<d;){var f=1+(a<<1),g=b[f],h=f+1;if(h<this.length&&c(b[h],g)<0&&(f=h,g=b[h]),c(g,e)>=0)break;b[a]=g,a=f}b[a]=e};var ya=a.createCommonjsModule(function(a){a.exports=function(a,b){var c,d,e,f,g,h,i,j;for(c=3&a.length,d=a.length-c,e=b,g=3432918353,h=461845907,j=0;j<d;)i=255&a.charCodeAt(j)|(255&a.charCodeAt(++j))<<8|(255&a.charCodeAt(++j))<<16|(255&a.charCodeAt(++j))<<24,++j,e=27492+(65535&(f=5*(65535&(e=(e^=i=(65535&(i=(i=(65535&i)*g+(((i>>>16)*g&65535)<<16)&4294967295)<<15|i>>>17))*h+(((i>>>16)*h&65535)<<16)&4294967295)<<13|e>>>19))+((5*(e>>>16)&65535)<<16)&4294967295))+((58964+(f>>>16)&65535)<<16);switch(i=0,c){case 3:i^=(255&a.charCodeAt(j+2))<<16;case 2:i^=(255&a.charCodeAt(j+1))<<8;case 1:e^=i=(65535&(i=(i=(65535&(i^=255&a.charCodeAt(j)))*g+(((i>>>16)*g&65535)<<16)&4294967295)<<15|i>>>17))*h+(((i>>>16)*h&65535)<<16)&4294967295}return e^=a.length,e=2246822507*(65535&(e^=e>>>16))+((2246822507*(e>>>16)&65535)<<16)&4294967295,e=3266489909*(65535&(e^=e>>>13))+((3266489909*(e>>>16)&65535)<<16)&4294967295,(e^=e>>>16)>>>0}}),za=a.createCommonjsModule(function(a){a.exports=function(a,b){for(var c,d=a.length,e=b^d,f=0;d>=4;)c=1540483477*(65535&(c=255&a.charCodeAt(f)|(255&a.charCodeAt(++f))<<8|(255&a.charCodeAt(++f))<<16|(255&a.charCodeAt(++f))<<24))+((1540483477*(c>>>16)&65535)<<16),e=1540483477*(65535&e)+((1540483477*(e>>>16)&65535)<<16)^(c=1540483477*(65535&(c^=c>>>24))+((1540483477*(c>>>16)&65535)<<16)),d-=4,++f;switch(d){case 3:e^=(255&a.charCodeAt(f+2))<<16;case 2:e^=(255&a.charCodeAt(f+1))<<8;case 1:e=1540483477*(65535&(e^=255&a.charCodeAt(f)))+((1540483477*(e>>>16)&65535)<<16)}return e=1540483477*(65535&(e^=e>>>13))+((1540483477*(e>>>16)&65535)<<16),(e^=e>>>15)>>>0}}),Aa=ya,Ba=ya,Ca=za;Aa.murmur3=Ba,Aa.murmur2=Ca;var Da=65535,Ea=function(b){var c={},d=[];for(var e in b){var f=b[e],g=c[e]={};for(var h in f){var i=f[+h];if(i&&0!==i.bitmap.width&&0!==i.bitmap.height){var j={x:0,y:0,w:i.bitmap.width+2,h:i.bitmap.height+2};d.push(j),g[h]={rect:j,metrics:i.metrics}}}}var k=a.potpack(d),l=k.w,m=k.h,n=new a.AlphaImage({width:l||1,height:m||1});for(var o in b){var p=b[o];for(var q in p){var r=p[+q];if(r&&0!==r.bitmap.width&&0!==r.bitmap.height){var s=c[o][q].rect;a.AlphaImage.copy(r.bitmap,n,{x:0,y:0},{x:s.x+1,y:s.y+1},r.bitmap)}}}this.image=n,this.positions=c};a.register("GlyphAtlas",Ea);var Fa=function(b){this.tileID=new a.OverscaledTileID(b.tileID.overscaledZ,b.tileID.wrap,b.tileID.canonical.z,b.tileID.canonical.x,b.tileID.canonical.y),this.uid=b.uid,this.zoom=b.zoom,this.pixelRatio=b.pixelRatio,this.tileSize=b.tileSize,this.source=b.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=b.showCollisionBoxes,this.collectResourceTiming=!!b.collectResourceTiming,this.returnDependencies=!!b.returnDependencies};Fa.prototype.parse=function(b,c,d,e){function f(){if(j)return e(j);if(k&&l&&m){var b=new Ea(k),c=new a.ImageAtlas(l,m);for(var d in o){var f=o[d];f instanceof a.SymbolBucket?(r(f.layers,this.zoom),n(f,k,b.positions,l,c.iconPositions,this.showCollisionBoxes)):f.hasPattern&&(f instanceof a.LineBucket||f instanceof a.FillBucket||f instanceof a.FillExtrusionBucket)&&(r(f.layers,this.zoom),f.addFeatures(p,c.patternPositions))}this.status="done",e(null,{buckets:a.values(o).filter(function(a){return!a.isEmpty()}),featureIndex:i,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:b.image,imageAtlas:c,glyphMap:this.returnDependencies?k:null,iconMap:this.returnDependencies?l:null,glyphPositions:this.returnDependencies?b.positions:null})}}var g=this;this.status="parsing",this.data=b,this.collisionBoxArray=new a.CollisionBoxArray;var h=new a.DictionaryCoder(Object.keys(b.layers).sort()),i=new a.FeatureIndex(this.tileID);i.bucketLayerIDs=[];var j,k,l,m,o={},p={featureIndex:i,iconDependencies:{},patternDependencies:{},glyphDependencies:{}},q=c.familiesBySource[this.source];for(var s in q){var t=b.layers[s];if(t){1===t.version&&a.warnOnce('Vector tile source "'+this.source+'" layer "'+s+'" does not use vector tile spec v2 and therefore may have some rendering errors.');for(var u=h.encode(s),v=[],w=0;w<t.length;w++){var x=t.feature(w);v.push({feature:x,index:w,sourceLayerIndex:u})}for(var y=0,z=q[s];y<z.length;y+=1){var A=z[y],B=A[0];B.minzoom&&this.zoom<Math.floor(B.minzoom)||B.maxzoom&&this.zoom>=B.maxzoom||"none"!==B.visibility&&(r(A,this.zoom),(o[B.id]=B.createBucket({index:i.bucketLayerIDs.length,layers:A,zoom:this.zoom,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:u,sourceID:this.source})).populate(v,p),i.bucketLayerIDs.push(A.map(function(a){return a.id})))}}}var C=a.mapObject(p.glyphDependencies,function(a){return Object.keys(a).map(Number)});Object.keys(C).length?d.send("getGlyphs",{uid:this.uid,stacks:C},function(a,b){j||(j=a,k=b,f.call(g))}):k={};var D=Object.keys(p.iconDependencies);D.length?d.send("getImages",{icons:D},function(a,b){j||(j=a,l=b,f.call(g))}):l={};var E=Object.keys(p.patternDependencies);E.length?d.send("getImages",{icons:E},function(a,b){j||(j=a,m=b,f.call(g))}):m={},f.call(this)};var Ga="undefined"!=typeof performance,Ha={getEntriesByName:function(a){return!!(Ga&&performance&&performance.getEntriesByName)&&performance.getEntriesByName(a)},mark:function(a){return!!(Ga&&performance&&performance.mark)&&performance.mark(a)},measure:function(a,b,c){return!!(Ga&&performance&&performance.measure)&&performance.measure(a,b,c)},clearMarks:function(a){return!!(Ga&&performance&&performance.clearMarks)&&performance.clearMarks(a)},clearMeasures:function(a){return!!(Ga&&performance&&performance.clearMeasures)&&performance.clearMeasures(a)}},Ia=function(a){this._marks={start:[a.url,"start"].join("#"),end:[a.url,"end"].join("#"),measure:a.url.toString()},Ha.mark(this._marks.start)};Ia.prototype.finish=function(){Ha.mark(this._marks.end);var a=Ha.getEntriesByName(this._marks.measure);return 0===a.length&&(Ha.measure(this._marks.measure,this._marks.start,this._marks.end),a=Ha.getEntriesByName(this._marks.measure),Ha.clearMarks(this._marks.start),Ha.clearMarks(this._marks.end),Ha.clearMeasures(this._marks.measure)),a},Ha.Performance=Ia;var Ja=function(a,b,c){this.actor=a,this.layerIndex=b,this.loadVectorData=c||s,this.loading={},this.loaded={}};Ja.prototype.loadTile=function(b,c){var d=this,e=b.uid;this.loading||(this.loading={});var f=!!(b&&b.request&&b.request.collectResourceTiming)&&new Ha.Performance(b.request),g=this.loading[e]=new Fa(b);g.abort=this.loadVectorData(b,function(b,h){if(delete d.loading[e],b||!h)return g.status="done",d.loaded[e]=g,c(b);var i=h.rawData,j={};h.expires&&(j.expires=h.expires),h.cacheControl&&(j.cacheControl=h.cacheControl);var k={};if(f){var l=f.finish();l&&(k.resourceTiming=JSON.parse(JSON.stringify(l)))}g.vectorTile=h.vectorTile,g.parse(h.vectorTile,d.layerIndex,d.actor,function(b,d){if(b||!d)return c(b);c(null,a.extend({rawTileData:i.slice(0)},d,j,k))}),d.loaded=d.loaded||{},d.loaded[e]=g})},Ja.prototype.reloadTile=function(a,b){var c=this.loaded,d=a.uid,e=this;if(c&&c[d]){var f=c[d];f.showCollisionBoxes=a.showCollisionBoxes;var g=function(a,c){var d=f.reloadCallback;d&&(delete f.reloadCallback,f.parse(f.vectorTile,e.layerIndex,e.actor,d)),b(a,c)};"parsing"===f.status?f.reloadCallback=g:"done"===f.status&&(f.vectorTile?f.parse(f.vectorTile,this.layerIndex,this.actor,g):g())}},Ja.prototype.abortTile=function(a,b){var c=this.loading,d=a.uid;c&&c[d]&&c[d].abort&&(c[d].abort(),delete c[d]),b()},Ja.prototype.removeTile=function(a,b){var c=this.loaded,d=a.uid;c&&c[d]&&delete c[d],b()};var Ka=function(){this.loaded={}};Ka.prototype.loadTile=function(b,c){var d=b.uid,e=b.encoding,f=b.rawImageData,g=new a.DEMData(d,f,e);this.loaded=this.loaded||{},this.loaded[d]=g,c(null,g)},Ka.prototype.removeTile=function(a){var b=this.loaded,c=a.uid;b&&b[c]&&delete b[c]};var La={RADIUS:6378137,FLATTENING:1/298.257223563,POLAR_RADIUS:6356752.3142},Ma={geometry:function a(b){var c,d=0;switch(b.type){case"Polygon":return t(b.coordinates);case"MultiPolygon":for(c=0;c<b.coordinates.length;c++)d+=t(b.coordinates[c]);return d;case"Point":case"MultiPoint":case"LineString":case"MultiLineString":return 0;case"GeometryCollection":for(c=0;c<b.geometries.length;c++)d+=a(b.geometries[c]);return d}},ring:u},Na=function a(b,c){switch(b&&b.type||null){case"FeatureCollection":return b.features=b.features.map(w(a,c)),b;case"GeometryCollection":return b.geometries=b.geometries.map(w(a,c)),b;case"Feature":return b.geometry=a(b.geometry,c),b;case"Polygon":case"MultiPolygon":return function(a,b){return"Polygon"===a.type?a.coordinates=x(a.coordinates,b):"MultiPolygon"===a.type&&(a.coordinates=a.coordinates.map(w(x,b))),a}(b,c);default:return b}},Oa=a.mvt.VectorTileFeature.prototype.toGeoJSON,Pa=function(b){this._feature=b,this.extent=a.EXTENT,this.type=b.type,this.properties=b.tags,"id"in b&&!isNaN(b.id)&&(this.id=parseInt(b.id,10))};Pa.prototype.loadGeometry=function(){if(1===this._feature.type){for(var b=[],c=0,d=this._feature.geometry;c<d.length;c+=1){var e=d[c];b.push([new a.Point(e[0],e[1])])}return b}for(var f=[],g=0,h=this._feature.geometry;g<h.length;g+=1){for(var i=[],j=0,k=h[g];j<k.length;j+=1){var l=k[j];i.push(new a.Point(l[0],l[1]))}f.push(i)}return f},Pa.prototype.toGeoJSON=function(a,b,c){return Oa.call(this,a,b,c)};var Qa=function(b){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=a.EXTENT,this.length=b.length,this._features=b};Qa.prototype.feature=function(a){return new Pa(this._features[a])};var Ra=a.vectorTile.VectorTileFeature,Sa=z;z.prototype.feature=function(a){return new A(this.features[a],this.options.extent)},A.prototype.loadGeometry=function(){var b=this.rawGeometry;this.geometry=[];for(var c=0;c<b.length;c++){for(var d=b[c],e=[],f=0;f<d.length;f++)e.push(new a.Point$1(d[f][0],d[f][1]));this.geometry.push(e)}return this.geometry},A.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var a=this.geometry,b=1/0,c=-1/0,d=1/0,e=-1/0,f=0;f<a.length;f++)for(var g=a[f],h=0;h<g.length;h++){var i=g[h];b=Math.min(b,i.x),c=Math.max(c,i.x),d=Math.min(d,i.y),e=Math.max(e,i.y)}return[b,d,c,e]},A.prototype.toGeoJSON=Ra.prototype.toGeoJSON;var Ta=B,Ua=B,Va=function(a,b){b=b||{};var c={};for(var d in a)c[d]=new Sa(a[d].features,b),c[d].name=d,c[d].version=b.version,c[d].extent=b.extent;return B({layers:c})},Wa=Sa;Ta.fromVectorTileJs=Ua,Ta.fromGeojsonVt=Va,Ta.GeoJSONWrapper=Wa;var Xa=function(a){return a[0]},Ya=function(a){return a[1]},Za=function(a,b,c,d,e){void 0===b&&(b=Xa),void 0===c&&(c=Ya),void 0===d&&(d=64),void 0===e&&(e=Float64Array),this.nodeSize=d,this.points=a;for(var f=a.length<65536?Uint16Array:Uint32Array,g=this.ids=new f(a.length),h=this.coords=new e(2*a.length),i=0;i<a.length;i++)g[i]=i,h[2*i]=b(a[i]),h[2*i+1]=c(a[i]);J(g,h,d,0,g.length-1,0)};Za.prototype.range=function(a,b,c,d){return function(a,b,c,d,e,f,g){for(var h,i,j=[0,a.length-1,0],k=[];j.length;){var l=j.pop(),m=j.pop(),n=j.pop();if(m-n<=g)for(var o=n;o<=m;o++)h=b[2*o],i=b[2*o+1],h>=c&&h<=e&&i>=d&&i<=f&&k.push(a[o]);else{var p=Math.floor((n+m)/2);h=b[2*p],i=b[2*p+1],h>=c&&h<=e&&i>=d&&i<=f&&k.push(a[p]);var q=(l+1)%2;(0===l?c<=h:d<=i)&&(j.push(n),j.push(p-1),j.push(q)),(0===l?e>=h:f>=i)&&(j.push(p+1),j.push(m),j.push(q))}}return k}(this.ids,this.coords,a,b,c,d,this.nodeSize)},Za.prototype.within=function(a,b,c){return function(a,b,c,d,e,f){for(var g=[0,a.length-1,0],h=[],i=e*e;g.length;){var j=g.pop(),k=g.pop(),l=g.pop();if(k-l<=f)for(var m=l;m<=k;m++)M(b[2*m],b[2*m+1],c,d)<=i&&h.push(a[m]);else{var n=Math.floor((l+k)/2),o=b[2*n],p=b[2*n+1];M(o,p,c,d)<=i&&h.push(a[n]);var q=(j+1)%2;(0===j?c-e<=o:d-e<=p)&&(g.push(l),g.push(n-1),g.push(q)),(0===j?c+e>=o:d+e>=p)&&(g.push(n+1),g.push(k),g.push(q))}}return h}(this.ids,this.coords,a,b,c,this.nodeSize)};var $a={minZoom:0,maxZoom:16,radius:40,extent:512,nodeSize:64,log:!1,reduce:null,map:function(a){return a}},_a=function(a){this.options=T(Object.create($a),a),this.trees=new Array(this.options.maxZoom+1)};_a.prototype.load=function(a){var b=this.options,c=b.log,d=b.minZoom,e=b.maxZoom,f=b.nodeSize;c&&console.time("total time");var g="prepare "+a.length+" points";c&&console.time(g),this.points=a;for(var h=[],i=0;i<a.length;i++)a[i].geometry&&h.push(O(a[i],i));this.trees[e+1]=new Za(h,U,V,f,Float32Array),c&&console.timeEnd(g);for(var j=e;j>=d;j--){var k=+Date.now();h=this._cluster(h,j),this.trees[j]=new Za(h,U,V,f,Float32Array),c&&console.log("z%d: %d clusters in %dms",j,h.length,+Date.now()-k)}return c&&console.timeEnd("total time"),this},_a.prototype.getClusters=function(a,b){var c=((a[0]+180)%360+360)%360-180,d=Math.max(-90,Math.min(90,a[1])),e=180===a[2]?180:((a[2]+180)%360+360)%360-180,f=Math.max(-90,Math.min(90,a[3]));if(a[2]-a[0]>=360)c=-180,e=180;else if(c>e){var g=this.getClusters([c,d,180,f],b),h=this.getClusters([-180,d,e,f],b);return g.concat(h)}for(var i=this.trees[this._limitZoom(b)],j=[],k=0,l=i.range(R(c),S(f),R(e),S(d));k<l.length;k+=1){var m=l[k],n=i.points[m];j.push(n.numPoints?P(n):this.points[n.index])}return j},_a.prototype.getChildren=function(a){var b=a>>5,c=a%32,d="No cluster with the specified id.",e=this.trees[c];if(!e)throw new Error(d);var f=e.points[b];if(!f)throw new Error(d);for(var g=this.options.radius/(this.options.extent*Math.pow(2,c-1)),h=[],i=0,j=e.within(f.x,f.y,g);i<j.length;i+=1){var k=j[i],l=e.points[k];l.parentId===a&&h.push(l.numPoints?P(l):this.points[l.index])}if(0===h.length)throw new Error(d);return h},_a.prototype.getLeaves=function(a,b,c){b=b||10,c=c||0;var d=[];return this._appendLeaves(d,a,b,c,0),d},_a.prototype.getTile=function(a,b,c){var d=this.trees[this._limitZoom(a)],e=Math.pow(2,a),f=this.options,g=f.extent,h=f.radius/g,i=(c-h)/e,j=(c+1+h)/e,k={features:[]};return this._addTileFeatures(d.range((b-h)/e,i,(b+1+h)/e,j),d.points,b,c,e,k),0===b&&this._addTileFeatures(d.range(1-h/e,i,1,j),d.points,e,c,e,k),b===e-1&&this._addTileFeatures(d.range(0,i,h/e,j),d.points,-1,c,e,k),k.features.length?k:null},_a.prototype.getClusterExpansionZoom=function(a){for(var b=a%32-1;b<=this.options.maxZoom;){var c=this.getChildren(a);if(b++,1!==c.length)break;a=c[0].properties.cluster_id}return b},_a.prototype._appendLeaves=function(a,b,c,d,e){for(var f=0,g=this.getChildren(b);f<g.length;f+=1){var h=g[f],i=h.properties;if(i&&i.cluster?e+i.point_count<=d?e+=i.point_count:e=this._appendLeaves(a,i.cluster_id,c,d,e):e<d?e++:a.push(h),a.length===c)break}return e},_a.prototype._addTileFeatures=function(a,b,c,d,e,f){for(var g=0,h=a;g<h.length;g+=1){var i=b[h[g]],j={type:1,geometry:[[Math.round(this.options.extent*(i.x*e-c)),Math.round(this.options.extent*(i.y*e-d))]],tags:i.numPoints?Q(i):this.points[i.index].properties},k=i.numPoints?i.id:this.points[i.index].id;void 0!==k&&(j.id=k),f.features.push(j)}},_a.prototype._limitZoom=function(a){return Math.max(this.options.minZoom,Math.min(a,this.options.maxZoom+1))},_a.prototype._cluster=function(a,b){for(var c=[],d=this.options,e=d.radius,f=d.extent,g=d.reduce,h=e/(f*Math.pow(2,b)),i=0;i<a.length;i++){var j=a[i];if(!(j.zoom<=b)){j.zoom=b;for(var k=this.trees[b+1],l=k.within(j.x,j.y,h),m=j.numPoints||1,n=j.x*m,o=j.y*m,p=g?this._map(j,!0):null,q=(i<<5)+(b+1),r=0,s=l;r<s.length;r+=1){var t=s[r],u=k.points[t];if(!(u.zoom<=b)){u.zoom=b;var v=u.numPoints||1;n+=u.x*v,o+=u.y*v,m+=v,u.parentId=q,g&&g(p,this._map(u))}}1===m?c.push(j):(j.parentId=q,c.push(N(n/m,o/m,q,m,p)))}}return c},_a.prototype._map=function(a,b){if(a.numPoints)return b?T({},a.properties):a.properties;var c=this.points[a.index].properties,d=this.options.map(c);return b&&d===c?T({},d):d},sa.prototype.options={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0},sa.prototype.splitTile=function(a,b,c,d,e,f,g){for(var h=[a,b,c,d],i=this.options,j=i.debug;h.length;){d=h.pop(),c=h.pop(),b=h.pop(),a=h.pop();var k=1<<b,l=ta(b,c,d),m=this.tiles[l];if(!m&&(j>1&&console.time("creation"),m=this.tiles[l]=pa(a,b,c,d,i),this.tileCoords.push({z:b,x:c,y:d}),j)){j>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",b,c,d,m.numFeatures,m.numPoints,m.numSimplified),console.timeEnd("creation"));var n="z"+b;this.stats[n]=(this.stats[n]||0)+1,this.total++}if(m.source=a,e){if(b===i.maxZoom||b===e)continue;var o=1<<e-b;if(c!==Math.floor(f/o)||d!==Math.floor(g/o))continue}else if(b===i.indexMaxZoom||m.numPoints<=i.indexMaxPoints)continue;if(m.source=null,0!==a.length){j>1&&console.time("clipping");var p,q,r,s,t,u,v=.5*i.buffer/i.extent,w=.5-v,x=.5+v,y=1+v;p=q=r=s=null,t=da(a,k,c-v,c+x,0,m.minX,m.maxX,i),u=da(a,k,c+w,c+y,0,m.minX,m.maxX,i),a=null,t&&(p=da(t,k,d-v,d+x,1,m.minY,m.maxY,i),q=da(t,k,d+w,d+y,1,m.minY,m.maxY,i),t=null),u&&(r=da(u,k,d-v,d+x,1,m.minY,m.maxY,i),s=da(u,k,d+w,d+y,1,m.minY,m.maxY,i),u=null),j>1&&console.timeEnd("clipping"),h.push(p||[],b+1,2*c,2*d),h.push(q||[],b+1,2*c,2*d+1),h.push(r||[],b+1,2*c+1,2*d),h.push(s||[],b+1,2*c+1,2*d+1)}}},sa.prototype.getTile=function(a,b,c){var d=this.options,e=d.extent,f=d.debug;if(a<0||a>24)return null;var g=1<<a,h=ta(a,b=(b%g+g)%g,c);if(this.tiles[h])return na(this.tiles[h],e);f>1&&console.log("drilling down to z%d-%d-%d",a,b,c);for(var i,j=a,k=b,l=c;!i&&j>0;)j--,k=Math.floor(k/2),l=Math.floor(l/2),i=this.tiles[ta(j,k,l)];return i&&i.source?(f>1&&console.log("found parent tile z%d-%d-%d",j,k,l),f>1&&console.time("drilling down"),this.splitTile(i.source,j,k,l,a,b,c),f>1&&console.timeEnd("drilling down"),this.tiles[h]?na(this.tiles[h],e):null):null};var ab=function(b){function c(a,c,d){b.call(this,a,c,ua),d&&(this.loadGeoJSON=d)}return b&&(c.__proto__=b),c.prototype=Object.create(b&&b.prototype),c.prototype.constructor=c,c.prototype.loadData=function(a,b){this._pendingCallback&&this._pendingCallback(null,{abandoned:!0}),this._pendingCallback=b,this._pendingLoadDataParams=a,this._state&&"Idle"!==this._state?this._state="NeedsLoadData":(this._state="Coalescing",this._loadData())},c.prototype._loadData=function(){var b=this;if(this._pendingCallback&&this._pendingLoadDataParams){var c=this._pendingCallback,d=this._pendingLoadDataParams;delete this._pendingCallback,delete this._pendingLoadDataParams;var e=!!(d&&d.request&&d.request.collectResourceTiming)&&new Ha.Performance(d.request);this.loadGeoJSON(d,function(f,g){if(f||!g)return c(f);if("object"!=typeof g)return c(new Error("Input data is not a valid GeoJSON object."));Na(g,!0);try{b._geoJSONIndex=d.cluster?new _a(function(b){var c=b.superclusterOptions,d=b.clusterProperties;if(!d||!c)return c;for(var e={},f={},g={accumulated:null,zoom:0},h={properties:null},i=Object.keys(d),j=0,k=i;j<k.length;j+=1){var l=k[j],m=d[l],n=m[0],o=m[1],p=a.createExpression(o),q=a.createExpression("string"==typeof n?[n,["accumulated"],["get",l]]:n);e[l]=p.value,f[l]=q.value}return c.map=function(a){h.properties=a;for(var b={},c=0,d=i;c<d.length;c+=1){var f=d[c];b[f]=e[f].evaluate(g,h)}return b},c.reduce=function(a,b){h.properties=b;for(var c=0,d=i;c<d.length;c+=1){var e=d[c];g.accumulated=a[e],a[e]=f[e].evaluate(g,h)}},c}(d)).load(g.features):function(a,b){return new sa(a,b)}(g,d.geojsonVtOptions)}catch(f){return c(f)}b.loaded={};var h={};if(e){var i=e.finish();i&&(h.resourceTiming={},h.resourceTiming[d.source]=JSON.parse(JSON.stringify(i)))}c(null,h)})}},c.prototype.coalesce=function(){"Coalescing"===this._state?this._state="Idle":"NeedsLoadData"===this._state&&(this._state="Coalescing",this._loadData())},c.prototype.reloadTile=function(a,c){var d=this.loaded,e=a.uid;return d&&d[e]?b.prototype.reloadTile.call(this,a,c):this.loadTile(a,c)},c.prototype.loadGeoJSON=function(b,c){if(b.request)a.getJSON(b.request,c);else{if("string"!=typeof b.data)return c(new Error("Input data is not a valid GeoJSON object."));try{return c(null,JSON.parse(b.data))}catch(a){return c(new Error("Input data is not a valid GeoJSON object."))}}},c.prototype.removeSource=function(a,b){this._pendingCallback&&this._pendingCallback(null,{abandoned:!0}),b()},c.prototype.getClusterExpansionZoom=function(a,b){b(null,this._geoJSONIndex.getClusterExpansionZoom(a.clusterId))},c.prototype.getClusterChildren=function(a,b){b(null,this._geoJSONIndex.getChildren(a.clusterId))},c.prototype.getClusterLeaves=function(a,b){b(null,this._geoJSONIndex.getLeaves(a.clusterId,a.limit,a.offset))},c}(Ja),bb=function(b){var c=this;this.self=b,this.actor=new a.Actor(b,this),this.layerIndexes={},this.workerSourceTypes={vector:Ja,geojson:ab},this.workerSources={},this.demWorkerSources={},this.self.registerWorkerSource=function(a,b){if(c.workerSourceTypes[a])throw new Error('Worker source with name "'+a+'" already registered.');c.workerSourceTypes[a]=b},this.self.registerRTLTextPlugin=function(b){if(a.plugin.isLoaded())throw new Error("RTL text plugin already registered.");a.plugin.applyArabicShaping=b.applyArabicShaping,a.plugin.processBidirectionalText=b.processBidirectionalText,a.plugin.processStyledBidirectionalText=b.processStyledBidirectionalText}};return bb.prototype.setReferrer=function(a,b){this.referrer=b},bb.prototype.setLayers=function(a,b,c){this.getLayerIndex(a).replace(b),c()},bb.prototype.updateLayers=function(a,b,c){this.getLayerIndex(a).update(b.layers,b.removedIds),c()},bb.prototype.loadTile=function(a,b,c){this.getWorkerSource(a,b.type,b.source).loadTile(b,c)},bb.prototype.loadDEMTile=function(a,b,c){this.getDEMWorkerSource(a,b.source).loadTile(b,c)},bb.prototype.reloadTile=function(a,b,c){this.getWorkerSource(a,b.type,b.source).reloadTile(b,c)},bb.prototype.abortTile=function(a,b,c){this.getWorkerSource(a,b.type,b.source).abortTile(b,c)},bb.prototype.removeTile=function(a,b,c){this.getWorkerSource(a,b.type,b.source).removeTile(b,c)},bb.prototype.removeDEMTile=function(a,b){this.getDEMWorkerSource(a,b.source).removeTile(b)},bb.prototype.removeSource=function(a,b,c){if(this.workerSources[a]&&this.workerSources[a][b.type]&&this.workerSources[a][b.type][b.source]){var d=this.workerSources[a][b.type][b.source];delete this.workerSources[a][b.type][b.source],void 0!==d.removeSource?d.removeSource(b,c):c()}},bb.prototype.loadWorkerSource=function(a,b,c){try{this.self.importScripts(b.url),c()}catch(a){c(a.toString())}},bb.prototype.loadRTLTextPlugin=function(b,c,d){try{a.plugin.isLoaded()||(this.self.importScripts(c),d(a.plugin.isLoaded()?null:new Error("RTL Text Plugin failed to import scripts from "+c)))}catch(a){d(a.toString())}},bb.prototype.getLayerIndex=function(a){var b=this.layerIndexes[a];return b||(b=this.layerIndexes[a]=new va),b},bb.prototype.getWorkerSource=function(a,b,c){var d=this;if(this.workerSources[a]||(this.workerSources[a]={}),this.workerSources[a][b]||(this.workerSources[a][b]={}),!this.workerSources[a][b][c]){var e={send:function(b,c,e){d.actor.send(b,c,e,a)}};this.workerSources[a][b][c]=new this.workerSourceTypes[b](e,this.getLayerIndex(a))}return this.workerSources[a][b][c]},bb.prototype.getDEMWorkerSource=function(a,b){return this.demWorkerSources[a]||(this.demWorkerSources[a]={}),this.demWorkerSources[a][b]||(this.demWorkerSources[a][b]=new Ka),this.demWorkerSources[a][b]},"undefined"!=typeof WorkerGlobalScope&&"undefined"!=typeof self&&self instanceof WorkerGlobalScope&&(self.worker=new bb(self)),bb}),a(["./shared.js"],function(a){function b(a){if(!oa)return null;for(var b=0;b<a.length;b++)if(a[b]in oa)return a[b];return a[0]}function c(a,b,c,d,e,f){this.fontSize=a||24,this.buffer=void 0===b?3:b,this.cutoff=d||.25,this.fontFamily=e||"sans-serif",this.fontWeight=f||"normal",this.radius=c||8;var g=this.size=this.fontSize+2*this.buffer;this.canvas=document.createElement("canvas"),this.canvas.width=this.canvas.height=g,this.ctx=this.canvas.getContext("2d"),this.ctx.font=this.fontWeight+" "+this.fontSize+"px "+this.fontFamily,this.ctx.textBaseline="middle",this.ctx.fillStyle="black",this.gridOuter=new Float64Array(g*g),this.gridInner=new Float64Array(g*g),this.f=new Float64Array(g),this.d=new Float64Array(g),this.z=new Float64Array(g+1),this.v=new Int16Array(g),this.middle=Math.round(g/2*(navigator.userAgent.indexOf("Gecko/")>=0?1.2:1))}function d(a,b,c,d,f,g,h){for(var i=0;i<b;i++){for(var j=0;j<c;j++)d[j]=a[j*b+i];for(e(d,f,g,h,c),j=0;j<c;j++)a[j*b+i]=f[j]}for(j=0;j<c;j++){for(i=0;i<b;i++)d[i]=a[j*b+i];for(e(d,f,g,h,b),i=0;i<b;i++)a[j*b+i]=Math.sqrt(f[i])}}function e(a,b,c,d,e){c[0]=0,d[0]=-wa,d[1]=+wa;for(var f=1,g=0;f<e;f++){for(var h=(a[f]+f*f-(a[c[g]]+c[g]*c[g]))/(2*f-2*c[g]);h<=d[g];)g--,h=(a[f]+f*f-(a[c[g]]+c[g]*c[g]))/(2*f-2*c[g]);c[++g]=f,d[g]=h,d[g+1]=+wa}for(f=0,g=0;f<e;f++){for(;d[g+1]<f;)g++;b[f]=(f-c[g])*(f-c[g])+a[c[g]]}}function f(b,c,d){var e=function(c,e){if(c)return d(c);if(e){var f=a.pick(e,["tiles","minzoom","maxzoom","attribution","mapbox_logo","bounds"]);e.vector_layers&&(f.vectorLayers=e.vector_layers,f.vectorLayerIds=f.vectorLayers.map(function(a){return a.id})),b.url&&(f.tiles=a.canonicalizeTileset(f,b.url)),d(null,f)}};return b.url?a.getJSON(c(a.normalizeSourceURL(b.url),a.ResourceType.Source),e):a.browser.frame(function(){return e(null,b)})}function g(b,c){var d=a.identity([]);return a.translate(d,d,[1,1,0]),a.scale(d,d,[.5*b.width,.5*b.height,1]),a.multiply(d,d,b.calculatePosMatrix(c.toUnwrapped()))}function h(a,b,c,d,e){var f=function(a,b,c){if(a)for(var d=0,e=a;d<e.length;d+=1){var f=b[e[d]];if(f&&f.source===c&&"fill-extrusion"===f.type)return!0}else for(var g in b){var h=b[g];if(h.source===c&&"fill-extrusion"===h.type)return!0}return!1}(d&&d.layers,b,a.id),h=e.maxPitchScaleFactor(),j=a.tilesIn(c,h,f);j.sort(i);for(var k=[],l=0,m=j;l<m.length;l+=1){var n=m[l];k.push({wrappedTileID:n.tileID.wrapped().key,queryResults:n.tile.queryRenderedFeatures(b,a._state,n.queryGeometry,n.cameraQueryGeometry,n.scale,d,e,h,g(a.transform,n.tileID))})}var o=function(a){for(var b={},c={},d=0,e=a;d<e.length;d+=1){var f=e[d],g=f.queryResults,h=f.wrappedTileID,i=c[h]=c[h]||{};for(var j in g)for(var k=g[j],l=i[j]=i[j]||{},m=b[j]=b[j]||[],n=0,o=k;n<o.length;n+=1){var p=o[n];l[p.featureIndex]||(l[p.featureIndex]=!0,m.push(p))}}return b}(k);for(var p in o)o[p].forEach(function(b){var c=b.feature,d=a.getFeatureState(c.layer["source-layer"],c.id);c.source=c.layer.source,c.layer["source-layer"]&&(c.sourceLayer=c.layer["source-layer"]),c.state=d});return o}function i(a,b){var c=a.tileID,d=b.tileID;return c.overscaledZ-d.overscaledZ||c.canonical.y-d.canonical.y||c.wrap-d.wrap||c.canonical.x-d.canonical.x}function j(a,b){return a%32-b%32||b-a}function k(a){return"raster"===a||"image"===a||"video"===a}function l(){return new a.window.Worker(Zd.workerUrl)}function m(b,c){var d={};for(var e in b)"ref"!==e&&(d[e]=b[e]);return a.refProperties.forEach(function(a){a in c&&(d[a]=c[a])}),d}function n(a){a=a.slice();for(var b=Object.create(null),c=0;c<a.length;c++)b[a[c].id]=a[c];for(var d=0;d<a.length;d++)"ref"in a[d]&&(a[d]=m(a[d],b[a[d].ref]));return a}function o(a,b,c){c.push({command:Gb.addSource,args:[a,b[a]]})}function p(a,b,c){b.push({command:Gb.removeSource,args:[a]}),c[a]=!0}function q(a,b,c,d){p(a,c,d),o(a,b,c)}function r(b,c,d){var e;for(e in b[d])if(b[d].hasOwnProperty(e)&&"data"!==e&&!a.isEqual(b[d][e],c[d][e]))return!1;for(e in c[d])if(c[d].hasOwnProperty(e)&&"data"!==e&&!a.isEqual(b[d][e],c[d][e]))return!1;return!0}function s(b,c,d,e,f,g){var h;for(h in c=c||{},b=b||{})b.hasOwnProperty(h)&&(a.isEqual(b[h],c[h])||d.push({command:g,args:[e,h,c[h],f]}));for(h in c)c.hasOwnProperty(h)&&!b.hasOwnProperty(h)&&(a.isEqual(b[h],c[h])||d.push({command:g,args:[e,h,c[h],f]}))}function t(a){return a.id}function u(a,b){return a[b.id]=b,a}function v(b,c){if(!b)return[{command:Gb.setStyle,args:[c]}];var d=[];try{if(!a.isEqual(b.version,c.version))return[{command:Gb.setStyle,args:[c]}];a.isEqual(b.center,c.center)||d.push({command:Gb.setCenter,args:[c.center]}),a.isEqual(b.zoom,c.zoom)||d.push({command:Gb.setZoom,args:[c.zoom]}),a.isEqual(b.bearing,c.bearing)||d.push({command:Gb.setBearing,args:[c.bearing]}),a.isEqual(b.pitch,c.pitch)||d.push({command:Gb.setPitch,args:[c.pitch]}),a.isEqual(b.sprite,c.sprite)||d.push({command:Gb.setSprite,args:[c.sprite]}),a.isEqual(b.glyphs,c.glyphs)||d.push({command:Gb.setGlyphs,args:[c.glyphs]}),a.isEqual(b.transition,c.transition)||d.push({command:Gb.setTransition,args:[c.transition]}),a.isEqual(b.light,c.light)||d.push({command:Gb.setLight,args:[c.light]});var e={},f=[];!function(b,c,d,e){var f;for(f in c=c||{},b=b||{})b.hasOwnProperty(f)&&(c.hasOwnProperty(f)||p(f,d,e));for(f in c)c.hasOwnProperty(f)&&(b.hasOwnProperty(f)?a.isEqual(b[f],c[f])||("geojson"===b[f].type&&"geojson"===c[f].type&&r(b,c,f)?d.push({command:Gb.setGeoJSONSourceData,args:[f,c[f].data]}):q(f,c,d,e)):o(f,c,d))}(b.sources,c.sources,f,e);var g=[];b.layers&&b.layers.forEach(function(a){e[a.source]?d.push({command:Gb.removeLayer,args:[a.id]}):g.push(a)}),d=d.concat(f),function(b,c,d){c=c||[];var e,f,g,h,i,j,k,l=(b=b||[]).map(t),m=c.map(t),n=b.reduce(u,{}),o=c.reduce(u,{}),p=l.slice(),q=Object.create(null);for(e=0,f=0;e<l.length;e++)g=l[e],o.hasOwnProperty(g)?f++:(d.push({command:Gb.removeLayer,args:[g]}),p.splice(p.indexOf(g,f),1));for(e=0,f=0;e<m.length;e++)g=m[m.length-1-e],p[p.length-1-e]!==g&&(n.hasOwnProperty(g)?(d.push({command:Gb.removeLayer,args:[g]}),p.splice(p.lastIndexOf(g,p.length-f),1)):f++,j=p[p.length-e],d.push({command:Gb.addLayer,args:[o[g],j]}),p.splice(p.length-e,0,g),q[g]=!0);for(e=0;e<m.length;e++)if(h=n[g=m[e]],i=o[g],!q[g]&&!a.isEqual(h,i))if(a.isEqual(h.source,i.source)&&a.isEqual(h["source-layer"],i["source-layer"])&&a.isEqual(h.type,i.type)){for(k in s(h.layout,i.layout,d,g,null,Gb.setLayoutProperty),s(h.paint,i.paint,d,g,null,Gb.setPaintProperty),a.isEqual(h.filter,i.filter)||d.push({command:Gb.setFilter,args:[g,i.filter]}),a.isEqual(h.minzoom,i.minzoom)&&a.isEqual(h.maxzoom,i.maxzoom)||d.push({command:Gb.setLayerZoomRange,args:[g,i.minzoom,i.maxzoom]}),h)h.hasOwnProperty(k)&&"layout"!==k&&"paint"!==k&&"filter"!==k&&"metadata"!==k&&"minzoom"!==k&&"maxzoom"!==k&&(0===k.indexOf("paint.")?s(h[k],i[k],d,g,k.slice(6),Gb.setPaintProperty):a.isEqual(h[k],i[k])||d.push({command:Gb.setLayerProperty,args:[g,k,i[k]]}));for(k in i)i.hasOwnProperty(k)&&!h.hasOwnProperty(k)&&"layout"!==k&&"paint"!==k&&"filter"!==k&&"metadata"!==k&&"minzoom"!==k&&"maxzoom"!==k&&(0===k.indexOf("paint.")?s(h[k],i[k],d,g,k.slice(6),Gb.setPaintProperty):a.isEqual(h[k],i[k])||d.push({command:Gb.setLayerProperty,args:[g,k,i[k]]}))}else d.push({command:Gb.removeLayer,args:[g]}),j=p[p.lastIndexOf(g)+1],d.push({command:Gb.addLayer,args:[i,j]})}(g,c.layers,d)}catch(a){console.warn("Unable to compute style diff:",a),d=[{command:Gb.setStyle,args:[c]}]}return d}function w(b,c,d,e,f){var g=a.identity(new Float32Array(16));return c?(a.identity(g),a.scale(g,g,[1/f,1/f,1]),d||a.rotateZ(g,g,e.angle)):(a.scale(g,g,[e.width/2,-e.height/2,1]),a.translate(g,g,[1,-1,0]),a.multiply(g,g,b)),g}function x(b,c,d,e,f){var g=a.identity(new Float32Array(16));return c?(a.multiply(g,g,b),a.scale(g,g,[f,f,1]),d||a.rotateZ(g,g,-e.angle)):(a.scale(g,g,[1,-1,1]),a.translate(g,g,[-1,-1,0]),a.scale(g,g,[2/e.width,2/e.height,1])),g}function y(b,c){var d=[b.x,b.y,0,1];H(d,d,c);var e=d[3];return{point:new a.Point(d[0]/e,d[1]/e),signedDistanceFromCamera:e}}function z(a,b){
var c=a[0]/a[3],d=a[1]/a[3];return c>=-b[0]&&c<=b[0]&&d>=-b[1]&&d<=b[1]}function A(b,c,d,e,f,g,h,i){var j=e?b.textSizeData:b.iconSizeData,k=a.evaluateSizeForZoom(j,d.transform.zoom,Ib.properties[e?"text-size":"icon-size"]),l=[256/d.width*2+1,256/d.height*2+1],m=e?b.text.dynamicLayoutVertexArray:b.icon.dynamicLayoutVertexArray;m.clear();for(var n=b.lineVertexArray,o=e?b.text.placedSymbolArray:b.icon.placedSymbolArray,p=d.transform.width/d.transform.height,q=!1,r=0;r<o.length;r++){var s=o.get(r);if(s.hidden||s.writingMode===a.WritingMode.vertical&&!q)G(s.numGlyphs,m);else{q=!1;var t=[s.anchorX,s.anchorY,0,1];if(a.transformMat4(t,t,c),z(t,l)){var u=.5+t[3]/d.transform.cameraToCenterDistance*.5,v=a.evaluateSizeForFeature(j,k,s),w=h?v*u:v/u,x=new a.Point(s.anchorX,s.anchorY),A=y(x,f).point,B={},C=D(s,w,!1,i,c,f,g,b.glyphOffsetArray,n,m,A,x,B,p);q=C.useVertical,(C.notEnoughRoom||q||C.needsFlipping&&D(s,w,!0,i,c,f,g,b.glyphOffsetArray,n,m,A,x,B,p).notEnoughRoom)&&G(s.numGlyphs,m)}else G(s.numGlyphs,m)}}e?b.text.dynamicLayoutVertexBuffer.updateData(m):b.icon.dynamicLayoutVertexBuffer.updateData(m)}function B(a,b,c,d,e,f,g,h,i,j,k,l){var m=h.glyphStartIndex+h.numGlyphs,n=h.lineStartIndex,o=h.lineStartIndex+h.lineLength,p=b.getoffsetX(h.glyphStartIndex),q=b.getoffsetX(m-1),r=F(a*p,c,d,e,f,g,h.segment,n,o,i,j,k,l);if(!r)return null;var s=F(a*q,c,d,e,f,g,h.segment,n,o,i,j,k,l);return s?{first:r,last:s}:null}function C(b,c,d,e){return b===a.WritingMode.horizontal&&Math.abs(d.y-c.y)>Math.abs(d.x-c.x)*e?{useVertical:!0}:(b===a.WritingMode.vertical?c.y<d.y:c.x>d.x)?{needsFlipping:!0}:null}function D(b,c,d,e,f,g,h,i,j,k,l,m,n,o){var p,q=c/24,r=b.lineOffsetX*c,s=b.lineOffsetY*c;if(b.numGlyphs>1){var t=b.glyphStartIndex+b.numGlyphs,u=b.lineStartIndex,v=b.lineStartIndex+b.lineLength,w=B(q,i,r,s,d,l,m,b,j,g,n,!1);if(!w)return{notEnoughRoom:!0};var x=y(w.first.point,h).point,z=y(w.last.point,h).point;if(e&&!d){var A=C(b.writingMode,x,z,o);if(A)return A}p=[w.first];for(var D=b.glyphStartIndex+1;D<t-1;D++)p.push(F(q*i.getoffsetX(D),r,s,d,l,m,b.segment,u,v,j,g,n,!1));p.push(w.last)}else{if(e&&!d){var G=y(m,f).point,H=b.lineStartIndex+b.segment+1,I=new a.Point(j.getx(H),j.gety(H)),J=y(I,f),K=J.signedDistanceFromCamera>0?J.point:E(m,I,G,1,f),L=C(b.writingMode,G,K,o);if(L)return L}var M=F(q*i.getoffsetX(b.glyphStartIndex),r,s,d,l,m,b.segment,b.lineStartIndex,b.lineStartIndex+b.lineLength,j,g,n,!1);if(!M)return{notEnoughRoom:!0};p=[M]}for(var N=0,O=p;N<O.length;N+=1){var P=O[N];a.addDynamicAttributes(k,P.point,P.angle)}return{}}function E(a,b,c,d,e){var f=y(a.add(a.sub(b)._unit()),e).point,g=c.sub(f);return c.add(g._mult(d/g.mag()))}function F(b,c,d,e,f,g,h,i,j,k,l,m,n){var o=e?b-c:b+c,p=o>0?1:-1,q=0;e&&(p*=-1,q=Math.PI),p<0&&(q+=Math.PI);for(var r=p>0?i+h:i+h+1,s=r,t=f,u=f,v=0,w=0,x=Math.abs(o);v+w<=x;){if((r+=p)<i||r>=j)return null;if(u=t,void 0===(t=m[r])){var z=new a.Point(k.getx(r),k.gety(r)),A=y(z,l);if(A.signedDistanceFromCamera>0)t=m[r]=A.point;else{var B=r-p;t=E(0===v?g:new a.Point(k.getx(B),k.gety(B)),z,u,x-v+1,l)}}v+=w,w=u.dist(t)}var C=(x-v)/w,D=t.sub(u),F=D.mult(C)._add(u);return F._add(D._unit()._perp()._mult(d*p)),{point:F,angle:q+Math.atan2(t.y-u.y,t.x-u.x),tileDistance:n?{prevTileDistance:r-p===s?0:k.gettileUnitDistanceFromAnchor(r-p),lastSegmentViewportDistance:x-v}:null}}function G(a,b){for(var c=0;c<a;c++){var d=b.length;b.resize(d+4),b.float32.set(Jb,3*d)}}function H(a,b,c){var d=b[0],e=b[1];return a[0]=c[0]*d+c[4]*e+c[12],a[1]=c[1]*d+c[5]*e+c[13],a[3]=c[3]*d+c[7]*e+c[15],a}function I(a,b,c){a[b+4]=c?1:0}function J(b,c,d){return c*(a.EXTENT/(b.tileSize*Math.pow(2,d-b.tileID.overscaledZ)))}function K(a,b,c){a.emplaceBack(b?1:0,c?1:0),a.emplaceBack(b?1:0,c?1:0),a.emplaceBack(b?1:0,c?1:0),a.emplaceBack(b?1:0,c?1:0)}function L(a){if(0===a.opacity&&!a.placed)return 0;if(1===a.opacity&&a.placed)return 4294967295;var b=a.placed?1:0,c=Math.floor(127*a.opacity);return c*Rb+b*Sb+c*Tb+b*Ub+c*Vb+b*Wb+c*Xb+b}function M(a,b){var c=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,d={};return{fragmentSource:a=a.replace(c,function(a,b,c,e,f){return d[f]=!0,"define"===b?"\n#ifndef HAS_UNIFORM_u_"+f+"\nvarying "+c+" "+e+" "+f+";\n#else\nuniform "+c+" "+e+" u_"+f+";\n#endif\n":"\n#ifdef HAS_UNIFORM_u_"+f+"\n    "+c+" "+e+" "+f+" = u_"+f+";\n#endif\n"}),vertexSource:b=b.replace(c,function(a,b,c,e,f){var g="float"===e?"vec2":"vec4",h=f.match(/color/)?"color":g;return d[f]?"define"===b?"\n#ifndef HAS_UNIFORM_u_"+f+"\nuniform lowp float a_"+f+"_t;\nattribute "+c+" "+g+" a_"+f+";\nvarying "+c+" "+e+" "+f+";\n#else\nuniform "+c+" "+e+" u_"+f+";\n#endif\n":"vec4"===h?"\n#ifndef HAS_UNIFORM_u_"+f+"\n    "+f+" = a_"+f+";\n#else\n    "+c+" "+e+" "+f+" = u_"+f+";\n#endif\n":"\n#ifndef HAS_UNIFORM_u_"+f+"\n    "+f+" = unpack_mix_"+h+"(a_"+f+", a_"+f+"_t);\n#else\n    "+c+" "+e+" "+f+" = u_"+f+";\n#endif\n":"define"===b?"\n#ifndef HAS_UNIFORM_u_"+f+"\nuniform lowp float a_"+f+"_t;\nattribute "+c+" "+g+" a_"+f+";\n#else\nuniform "+c+" "+e+" u_"+f+";\n#endif\n":"vec4"===h?"\n#ifndef HAS_UNIFORM_u_"+f+"\n    "+c+" "+e+" "+f+" = a_"+f+";\n#else\n    "+c+" "+e+" "+f+" = u_"+f+";\n#endif\n":"\n#ifndef HAS_UNIFORM_u_"+f+"\n    "+c+" "+e+" "+f+" = unpack_mix_"+h+"(a_"+f+", a_"+f+"_t);\n#else\n    "+c+" "+e+" "+f+" = u_"+f+";\n#endif\n"})}}function N(b,c,d){var e=1/J(d,1,c.transform.tileZoom),f=Math.pow(2,d.tileID.overscaledZ),g=d.tileSize*Math.pow(2,c.transform.tileZoom)/f,h=g*(d.tileID.canonical.x+d.tileID.wrap*f),i=g*d.tileID.canonical.y;return{u_image:0,u_texsize:d.imageAtlasTexture.size,u_scale:[a.browser.devicePixelRatio,e,b.fromScale,b.toScale],u_fade:b.t,u_pixel_coord_upper:[h>>16,i>>16],u_pixel_coord_lower:[65535&h,65535&i]}}function O(b,c){var d=Math.pow(2,c.canonical.z),e=c.canonical.y;return[new a.MercatorCoordinate(0,e/d).toLngLat().lat,new a.MercatorCoordinate(0,(e+1)/d).toLngLat().lat]}function P(a,b){return 1/J(a,1,b.tileZoom)}function Q(a,b,c){return a.translatePosMatrix(b.tileID.posMatrix,b,c.paint.get("line-translate"),c.paint.get("line-translate-anchor"))}function R(a){a*=Math.PI/180;var b=Math.sin(a),c=Math.cos(a);return[(2*c+1)/3,(-Math.sqrt(3)*b-c+1)/3,(Math.sqrt(3)*b-c+1)/3]}function S(b,c){for(var d=b.sort(function(a,b){return a.tileID.isLessThan(b.tileID)?-1:b.tileID.isLessThan(a.tileID)?1:0}),e=0;e<d.length;e++){var f={},g=d[e],h=d.slice(e+1);T(g.tileID.wrapped(),g.tileID,h,new a.OverscaledTileID(0,g.tileID.wrap+1,0,0,0),f),g.setMask(f,c)}}function T(b,c,d,e,f){for(var g=0;g<d.length;g++){var h=d[g];if(e.isLessThan(h.tileID))break;if(c.key===h.tileID.key)return;if(h.tileID.isChildOf(c)){for(var i=c.children(1/0),j=0;j<i.length;j++)T(b,i[j],d.slice(g),e,f);return}}var k=c.overscaledZ-b.overscaledZ,l=new a.CanonicalTileID(k,c.canonical.x-(b.canonical.x<<k),c.canonical.y-(b.canonical.y<<k));f[l.key]=f[l.key]||l}function U(a,b,c,d,e){for(var f=a.context,g=f.gl,h=e?a.useProgram("collisionCircle"):a.useProgram("collisionBox"),i=0;i<d.length;i++){var j=d[i],k=b.getTile(j),l=k.getBucket(c);if(l){var m=e?l.collisionCircle:l.collisionBox;m&&h.draw(f,e?g.TRIANGLES:g.LINES,xb.disabled,yb.disabled,a.colorModeForRenderPass(),Ab.disabled,Uc(j.posMatrix,a.transform,k),c.id,m.layoutVertexBuffer,m.indexBuffer,m.segments,null,a.transform.zoom,null,null,m.collisionVertexBuffer)}}}function V(b,c,d,e,f,g,h,i,j,k,l,m){for(var n,o,p=b.context,q=p.gl,r=b.transform,s="map"===i,t="map"===j,u=s&&"point"!==d.layout.get("symbol-placement"),v=s&&!t&&!u,y=void 0!==d.layout.get("symbol-sort-key").constantOr(1),z=b.depthModeForSublayer(0,xb.ReadOnly),B=[],C=0,D=e;C<D.length;C+=1){var E=D[C],F=c.getTile(E),G=F.getBucket(d);if(G){var H=f?G.text:G.icon;if(H&&H.segments.get().length){var I=H.programConfigurations.get(d.id),K=f||G.sdfIcons,L=f?G.textSizeData:G.iconSizeData;n||(n=b.useProgram(K?"symbolSDF":"symbolIcon",I),o=a.evaluateSizeForZoom(L,r.zoom,kd.properties[f?"text-size":"icon-size"])),p.activeTexture.set(q.TEXTURE0);var M=void 0,N=void 0,O=void 0;if(f)N=F.glyphAtlasTexture,O=q.LINEAR,M=F.glyphAtlasTexture.size;else{var P=1!==d.layout.get("icon-size").constantOr(0)||G.iconsNeedLinear,Q=t||0!==r.pitch;N=F.imageAtlasTexture,O=K||b.options.rotating||b.options.zooming||P||Q?q.LINEAR:q.NEAREST,M=F.imageAtlasTexture.size}var R=J(F,1,b.transform.zoom),S=w(E.posMatrix,t,s,b.transform,R),T=x(E.posMatrix,t,s,b.transform,R);u&&A(G,E.posMatrix,b,f,S,T,t,k);var U=b.translatePosMatrix(E.posMatrix,F,g,h),V=u?jd:S,X=b.translatePosMatrix(T,F,g,h,!0),Y=K&&0!==d.paint.get(f?"text-halo-width":"icon-halo-width").constantOr(1),Z={program:n,buffers:H,uniformValues:K?fd(L.functionType,o,v,t,b,U,V,X,f,M,!0):ed(L.functionType,o,v,t,b,U,V,X,f,M),atlasTexture:N,atlasInterpolation:O,isSDF:K,hasHalo:Y};if(y)for(var $=0,_=H.segments.get();$<_.length;$+=1){var aa=_[$];B.push({segments:new a.SegmentVector([aa]),sortKey:aa.sortKey,state:Z})}else B.push({segments:H.segments,sortKey:0,state:Z})}}}y&&B.sort(function(a,b){return a.sortKey-b.sortKey});for(var ba=0,ca=B;ba<ca.length;ba+=1){var da=ca[ba],ea=da.state;if(ea.atlasTexture.bind(ea.atlasInterpolation,q.CLAMP_TO_EDGE),ea.isSDF){var fa=ea.uniformValues;ea.hasHalo&&(fa.u_is_halo=1,W(ea.buffers,da.segments,d,b,ea.program,z,l,m,fa)),fa.u_is_halo=0}W(ea.buffers,da.segments,d,b,ea.program,z,l,m,ea.uniformValues)}}function W(a,b,c,d,e,f,g,h,i){var j=d.context,k=j.gl;e.draw(j,k.TRIANGLES,f,g,h,Ab.disabled,i,c.id,a.layoutVertexBuffer,a.indexBuffer,b,c.paint,d.transform.zoom,a.programConfigurations.get(c.id),a.dynamicLayoutVertexBuffer,a.opacityVertexBuffer)}function X(a,b,c,d,e,f,g){var h,i,j,k,l,m=a.context.gl,n=c.paint.get("fill-pattern"),o=n&&n.constantOr(1),p=c.getCrossfadeParameters();g?(i=o&&!c.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",h=m.LINES):(i=o?"fillPattern":"fill",h=m.TRIANGLES);for(var q=0,r=d;q<r.length;q+=1){var s=r[q],t=b.getTile(s);if(!o||t.patternsLoaded()){var u=t.getBucket(c);if(u){var v=u.programConfigurations.get(c.id),w=a.useProgram(i,v);o&&(a.context.activeTexture.set(m.TEXTURE0),t.imageAtlasTexture.bind(m.LINEAR,m.CLAMP_TO_EDGE),v.updatePatternPaintBuffers(p));var x=n.constantOr(null);if(x&&t.imageAtlas){var y=t.imageAtlas.patternPositions[x.to],z=t.imageAtlas.patternPositions[x.from];y&&z&&v.setConstantPatternPositions(y,z)}var A=a.translatePosMatrix(s.posMatrix,t,c.paint.get("fill-translate"),c.paint.get("fill-translate-anchor"));if(g){k=u.indexBuffer2,l=u.segments2;var B=[m.drawingBufferWidth,m.drawingBufferHeight];j="fillOutlinePattern"===i&&o?Rc(A,a,p,t,B):Qc(A,B)}else k=u.indexBuffer,l=u.segments,j=o?Pc(A,a,p,t):Oc(A);w.draw(a.context,h,e,a.stencilModeForClipping(s),f,Ab.disabled,j,c.id,u.layoutVertexBuffer,k,l,c.paint,a.transform.zoom,v)}}}}function Y(b,c){var d=b.context,e=d.gl,f=c.viewportFrame;if(b.depthRboNeedsClear&&b.setupOffscreenDepthRenderbuffer(),!f){var g=new a.Texture(d,{width:b.width,height:b.height,data:null},e.RGBA);g.bind(e.LINEAR,e.CLAMP_TO_EDGE),(f=c.viewportFrame=d.createFramebuffer(b.width,b.height)).colorAttachment.set(g.texture)}d.bindFramebuffer.set(f.framebuffer),f.depthAttachment.set(b.depthRbo),b.depthRboNeedsClear&&(d.clear({depth:1}),b.depthRboNeedsClear=!1),d.clear({color:a.Color.transparent}),d.setStencilMode(yb.disabled),d.setDepthMode(new xb(e.LEQUAL,xb.ReadWrite,[0,1])),d.setColorMode(b.colorModeForRenderPass())}function Z(a,b,c){var d=b.viewportFrame;if(d){var e=a.context,f=e.gl;e.activeTexture.set(f.TEXTURE0),f.bindTexture(f.TEXTURE_2D,d.colorAttachment.get()),a.useProgram("extrusionTexture").draw(e,f.TRIANGLES,xb.disabled,yb.disabled,a.colorModeForRenderPass(),Ab.disabled,Nc(a,c,0),b.id,a.viewportBuffer,a.quadTriangleIndexBuffer,a.viewportSegments,b.paint,a.transform.zoom)}}function $(a,b,c,d,e,f){var g=a.context,h=g.gl,i=b.fbo;if(i){var j=a.useProgram("hillshade");g.activeTexture.set(h.TEXTURE0),h.bindTexture(h.TEXTURE_2D,i.colorAttachment.get());var k=Zc(a,b,c);b.maskedBoundsBuffer&&b.maskedIndexBuffer&&b.segments?j.draw(g,h.TRIANGLES,d,e,f,Ab.disabled,k,c.id,b.maskedBoundsBuffer,b.maskedIndexBuffer,b.segments):j.draw(g,h.TRIANGLES,d,e,f,Ab.disabled,k,c.id,a.rasterBoundsBuffer,a.quadTriangleIndexBuffer,a.rasterBoundsSegments)}}function _(b,c,d,e,f,g,h){var i=b.context,j=i.gl;if(c.dem&&c.dem.data){var k=c.dem.dim,l=c.dem.stride,m=c.dem.getPixels();if(i.activeTexture.set(j.TEXTURE1),i.pixelStoreUnpackPremultiplyAlpha.set(!1),c.demTexture=c.demTexture||b.getTileTexture(l),c.demTexture){var n=c.demTexture;n.update(m,{premultiply:!1}),n.bind(j.NEAREST,j.CLAMP_TO_EDGE)}else c.demTexture=new a.Texture(i,m,j.RGBA,{premultiply:!1}),c.demTexture.bind(j.NEAREST,j.CLAMP_TO_EDGE);i.activeTexture.set(j.TEXTURE0);var o=c.fbo;if(!o){var p=new a.Texture(i,{width:k,height:k,data:null},j.RGBA);p.bind(j.LINEAR,j.CLAMP_TO_EDGE),(o=c.fbo=i.createFramebuffer(k,k)).colorAttachment.set(p.texture)}i.bindFramebuffer.set(o.framebuffer),i.viewport.set([0,0,k,k]),b.useProgram("hillshadePrepare").draw(i,j.TRIANGLES,f,g,h,Ab.disabled,$c(c,e),d.id,b.rasterBoundsBuffer,b.quadTriangleIndexBuffer,b.rasterBoundsSegments),c.needsHillshadePrepare=!1}}function aa(b,c,d,e,f){var g=e.paint.get("raster-fade-duration");if(g>0){var h=a.browser.now(),i=(h-b.timeAdded)/g,j=c?(h-c.timeAdded)/g:-1,k=d.getSource(),l=f.coveringZoomLevel({tileSize:k.tileSize,roundZoom:k.roundZoom}),m=!c||Math.abs(c.tileID.overscaledZ-l)>Math.abs(b.tileID.overscaledZ-l),n=m&&b.refreshedUponExpiration?1:a.clamp(m?i:1-j,0,1);return b.refreshedUponExpiration&&i>=1&&(b.refreshedUponExpiration=!1),c?{opacity:1,mix:1-n}:{opacity:n,mix:0}}return{opacity:1,mix:0}}function ba(b,c,d){var e=b.context,f=e.gl,g=d.posMatrix,h=b.useProgram("debug"),i=xb.disabled,j=yb.disabled,k=b.colorModeForRenderPass(),l="$debug";h.draw(e,f.LINE_STRIP,i,j,k,Ab.disabled,Vc(g,a.Color.red),l,b.debugBuffer,b.tileBorderIndexBuffer,b.debugSegments);for(var m=function(a,b,c,d){d=d||1;var e,f,g,h,i,j,k,l,m=[];for(e=0,f=a.length;e<f;e++)if(i=ld[a[e]]){for(l=null,g=0,h=i[1].length;g<h;g+=2)-1===i[1][g]&&-1===i[1][g+1]?l=null:(j=b+i[1][g]*d,k=200-i[1][g+1]*d,l&&m.push(l.x,l.y,j,k),l={x:j,y:k});b+=i[0]*d}return m}(d.toString(),50,0,5),n=new a.StructArrayLayout2i4,o=new a.StructArrayLayout2ui4,p=0;p<m.length;p+=2)n.emplaceBack(m[p],m[p+1]),o.emplaceBack(p,p+1);for(var q=e.createVertexBuffer(n,hc.members),r=e.createIndexBuffer(o),s=a.SegmentVector.simpleSegment(0,0,n.length/2,n.length/2),t=c.getTile(d).tileSize,u=a.EXTENT/(Math.pow(2,b.transform.zoom-d.overscaledZ)*t),v=[[-1,-1],[-1,1],[1,-1],[1,1]],w=0;w<v.length;w++){var x=v[w];h.draw(e,f.LINES,i,j,k,Ab.disabled,Vc(a.translate([],g,[u*x[0],u*x[1],0]),a.Color.white),l,q,r,s)}h.draw(e,f.LINES,i,j,k,Ab.disabled,Vc(g,a.Color.black),l,q,r,s)}function ca(a,b){if(a.y>b.y){var c=a;a=b,b=c}return{x0:a.x,y0:a.y,x1:b.x,y1:b.y,dx:b.x-a.x,dy:b.y-a.y}}function da(a,b,c,d,e){var f=Math.max(c,Math.floor(b.y0)),g=Math.min(d,Math.ceil(b.y1));if(a.x0===b.x0&&a.y0===b.y0?a.x0+b.dy/a.dy*a.dx<b.x1:a.x1-b.dy/a.dy*a.dx<b.x0){var h=a;a=b,b=h}for(var i=a.dx/a.dy,j=b.dx/b.dy,k=a.dx>0,l=b.dx<0,m=f;m<g;m++){var n=i*Math.max(0,Math.min(a.dy,m+k-a.y0))+a.x0,o=j*Math.max(0,Math.min(b.dy,m+l-b.y0))+b.x0;e(Math.floor(o),Math.ceil(n),m)}}function ea(a,b,c,d,e,f){var g,h=ca(a,b),i=ca(b,c),j=ca(c,a);h.dy>i.dy&&(g=h,h=i,i=g),h.dy>j.dy&&(g=h,h=j,j=g),i.dy>j.dy&&(g=i,i=j,j=g),h.dy&&da(j,h,d,e,f),i.dy&&da(j,i,d,e,f)}function fa(a){return a*(2-a)}function ga(a){a.parentNode&&a.parentNode.removeChild(a)}function ha(b,c,d){if(b=new a.LngLat(b.lng,b.lat),c){var e=new a.LngLat(b.lng-360,b.lat),f=new a.LngLat(b.lng+360,b.lat),g=d.locationPoint(b).distSqr(c);d.locationPoint(e).distSqr(c)<g?b=e:d.locationPoint(f).distSqr(c)<g&&(b=f)}for(;Math.abs(b.lng-d.center.lng)>180;){var h=d.locationPoint(b);if(h.x>=0&&h.y>=0&&h.x<=d.width&&h.y<=d.height)break;b.lng>d.center.lng?b.lng-=360:b.lng+=360}return b}function ia(a,b,c){var d=a.classList;for(var e in Qd)d.remove("mapboxgl-"+c+"-anchor-"+e);d.add("mapboxgl-"+c+"-anchor-"+b)}function ja(a,b,c){var d,e,f,g,h,i,j=c&&c.maxWidth||100,k=a._container.clientHeight/2,l=(d=a.unproject([0,k]),e=a.unproject([j,k]),f=Math.PI/180,g=d.lat*f,h=e.lat*f,i=Math.sin(g)*Math.sin(h)+Math.cos(g)*Math.cos(h)*Math.cos((e.lng-d.lng)*f),6371e3*Math.acos(Math.min(i,1)));if(c&&"imperial"===c.unit){var m=3.2808*l;m>5280?ka(b,j,m/5280,"mi"):ka(b,j,m,"ft")}else c&&"nautical"===c.unit?ka(b,j,l/1852,"nm"):ka(b,j,l,"m")}function ka(a,b,c,d){var e,f,g,h=(e=c,f=Math.pow(10,(""+Math.floor(e)).length-1),g=(g=e/f)>=10?10:g>=5?5:g>=3?3:g>=2?2:g>=1?1:function(a){var b=Math.pow(10,Math.ceil(-Math.log(a)/Math.LN10));return Math.round(a*b)/b}(g),f*g),i=h/c;"m"===d&&h>=1e3&&(h/=1e3,d="km"),a.style.width=b*i+"px",a.innerHTML=h+d}var la,ma=a.createCommonjsModule(function(a){function b(a){return!!("undefined"!=typeof window&&"undefined"!=typeof document&&Array.prototype&&Array.prototype.every&&Array.prototype.filter&&Array.prototype.forEach&&Array.prototype.indexOf&&Array.prototype.lastIndexOf&&Array.prototype.map&&Array.prototype.some&&Array.prototype.reduce&&Array.prototype.reduceRight&&Array.isArray&&Function.prototype&&Function.prototype.bind&&Object.keys&&Object.create&&Object.getPrototypeOf&&Object.getOwnPropertyNames&&Object.isSealed&&Object.isFrozen&&Object.isExtensible&&Object.getOwnPropertyDescriptor&&Object.defineProperty&&Object.defineProperties&&Object.seal&&Object.freeze&&Object.preventExtensions&&"JSON"in window&&"parse"in JSON&&"stringify"in JSON&&function(){if(!("Worker"in window&&"Blob"in window&&"URL"in window))return!1;var a,b,c=new Blob([""],{type:"text/javascript"}),d=URL.createObjectURL(c);try{b=new Worker(d),a=!0}catch(b){a=!1}return b&&b.terminate(),URL.revokeObjectURL(d),a}()&&"Uint8ClampedArray"in window&&ArrayBuffer.isView&&function(a){return void 0===c[a]&&(c[a]=function(a){var c=document.createElement("canvas"),d=Object.create(b.webGLContextAttributes);return d.failIfMajorPerformanceCaveat=a,c.probablySupportsContext?c.probablySupportsContext("webgl",d)||c.probablySupportsContext("experimental-webgl",d):c.supportsContext?c.supportsContext("webgl",d)||c.supportsContext("experimental-webgl",d):c.getContext("webgl",d)||c.getContext("experimental-webgl",d)}(a)),c[a]}(a&&a.failIfMajorPerformanceCaveat))}a.exports?a.exports=b:window&&(window.mapboxgl=window.mapboxgl||{},window.mapboxgl.supported=b);var c={};b.webGLContextAttributes={antialias:!1,alpha:!0,stencil:!0,depth:!0}}),na={create:function(b,c,d){var e=a.window.document.createElement(b);return c&&(e.className=c),d&&d.appendChild(e),e},createNS:function(b,c){return a.window.document.createElementNS(b,c)}},oa=a.window.document?a.window.document.documentElement.style:null,pa=b(["userSelect","MozUserSelect","WebkitUserSelect","msUserSelect"]);na.disableDrag=function(){oa&&pa&&(la=oa[pa],oa[pa]="none")},na.enableDrag=function(){oa&&pa&&(oa[pa]=la)};var qa=b(["transform","WebkitTransform"]);na.setTransform=function(a,b){a.style[qa]=b};var ra=!1;try{var sa=Object.defineProperty({},"passive",{get:function(){ra=!0}});a.window.addEventListener("test",sa,sa),a.window.removeEventListener("test",sa,sa)}catch(a){ra=!1}na.addEventListener=function(a,b,c,d){void 0===d&&(d={}),"passive"in d&&ra?a.addEventListener(b,c,d):a.addEventListener(b,c,d.capture)},na.removeEventListener=function(a,b,c,d){void 0===d&&(d={}),"passive"in d&&ra?a.removeEventListener(b,c,d):a.removeEventListener(b,c,d.capture)};var ta=function(b){b.preventDefault(),b.stopPropagation(),a.window.removeEventListener("click",ta,!0)};na.suppressClick=function(){a.window.addEventListener("click",ta,!0),a.window.setTimeout(function(){a.window.removeEventListener("click",ta,!0)},0)},na.mousePos=function(b,c){var d=b.getBoundingClientRect();return c=c.touches?c.touches[0]:c,new a.Point(c.clientX-d.left-b.clientLeft,c.clientY-d.top-b.clientTop)},na.touchPos=function(b,c){for(var d=b.getBoundingClientRect(),e=[],f="touchend"===c.type?c.changedTouches:c.touches,g=0;g<f.length;g++)e.push(new a.Point(f[g].clientX-d.left-b.clientLeft,f[g].clientY-d.top-b.clientTop));return e},na.mouseButton=function(b){return void 0!==a.window.InstallTrigger&&2===b.button&&b.ctrlKey&&a.window.navigator.platform.toUpperCase().indexOf("MAC")>=0?0:b.button},na.remove=function(a){a.parentNode&&a.parentNode.removeChild(a)};var ua=function(){this.images={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new a.RGBAImage({width:1,height:1}),this.dirty=!0};ua.prototype.isLoaded=function(){return this.loaded},ua.prototype.setLoaded=function(a){if(this.loaded!==a&&(this.loaded=a,a)){for(var b=0,c=this.requestors;b<c.length;b+=1){var d=c[b],e=d.ids,f=d.callback;this._notify(e,f)}this.requestors=[]}},ua.prototype.getImage=function(a){return this.images[a]},ua.prototype.addImage=function(a,b){this.images[a]=b},ua.prototype.removeImage=function(a){delete this.images[a],delete this.patterns[a]},ua.prototype.listImages=function(){return Object.keys(this.images)},ua.prototype.getImages=function(a,b){var c=!0;if(!this.isLoaded())for(var d=0,e=a;d<e.length;d+=1){var f=e[d];this.images[f]||(c=!1)}this.isLoaded()||c?this._notify(a,b):this.requestors.push({ids:a,callback:b})},ua.prototype._notify=function(a,b){for(var c={},d=0,e=a;d<e.length;d+=1){var f=e[d],g=this.images[f];g&&(c[f]={data:g.data.clone(),pixelRatio:g.pixelRatio,sdf:g.sdf})}b(null,c)},ua.prototype.getPixelSize=function(){var a=this.atlasImage;return{width:a.width,height:a.height}},ua.prototype.getPattern=function(b){var c=this.patterns[b];if(c)return c.position;var d=this.getImage(b);if(!d)return null;var e={w:d.data.width+2,h:d.data.height+2,x:0,y:0},f=new a.ImagePosition(e,d);return this.patterns[b]={bin:e,position:f},this._updatePatternAtlas(),f},ua.prototype.bind=function(b){var c=b.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new a.Texture(b,this.atlasImage,c.RGBA),this.atlasTexture.bind(c.LINEAR,c.CLAMP_TO_EDGE)},ua.prototype._updatePatternAtlas=function(){var b=[];for(var c in this.patterns)b.push(this.patterns[c].bin);var d=a.potpack(b),e=d.w,f=d.h,g=this.atlasImage;for(var h in g.resize({width:e||1,height:f||1}),this.patterns){var i=this.patterns[h].bin,j=i.x+1,k=i.y+1,l=this.images[h].data,m=l.width,n=l.height;a.RGBAImage.copy(l,g,{x:0,y:0},{x:j,y:k},{width:m,height:n}),a.RGBAImage.copy(l,g,{x:0,y:n-1},{x:j,y:k-1},{width:m,height:1}),a.RGBAImage.copy(l,g,{x:0,y:0},{x:j,y:k+n},{width:m,height:1}),a.RGBAImage.copy(l,g,{x:m-1,y:0},{x:j-1,y:k},{width:1,height:n}),a.RGBAImage.copy(l,g,{x:0,y:0},{x:j+m,y:k},{width:1,height:n})}this.dirty=!0};var va=c,wa=1e20;c.prototype.draw=function(a){this.ctx.clearRect(0,0,this.size,this.size),this.ctx.fillText(a,this.buffer,this.middle);for(var b=this.ctx.getImageData(0,0,this.size,this.size),c=new Uint8ClampedArray(this.size*this.size),e=0;e<this.size*this.size;e++){var f=b.data[4*e+3]/255;this.gridOuter[e]=1===f?0:0===f?wa:Math.pow(Math.max(0,.5-f),2),this.gridInner[e]=1===f?wa:0===f?0:Math.pow(Math.max(0,f-.5),2)}for(d(this.gridOuter,this.size,this.size,this.f,this.d,this.v,this.z),d(this.gridInner,this.size,this.size,this.f,this.d,this.v,this.z),e=0;e<this.size*this.size;e++){var g=this.gridOuter[e]-this.gridInner[e];c[e]=Math.max(0,Math.min(255,Math.round(255-255*(g/this.radius+this.cutoff))))}return c};var xa=function(a,b){this.requestTransform=a,this.localIdeographFontFamily=b,this.entries={}};xa.prototype.setURL=function(a){this.url=a},xa.prototype.getGlyphs=function(b,c){var d=this,e=[];for(var f in b)for(var g=0,h=b[f];g<h.length;g+=1){var i=h[g];e.push({stack:f,id:i})}a.asyncAll(e,function(a,b){var c=a.stack,e=a.id,f=d.entries[c];f||(f=d.entries[c]={glyphs:{},requests:{}});var g=f.glyphs[e];if(void 0===g)if(g=d._tinySDF(f,c,e))b(null,{stack:c,id:e,glyph:g});else{var h=Math.floor(e/256);if(256*h>65535)b(new Error("glyphs > 65535 not supported"));else{var i=f.requests[h];i||(i=f.requests[h]=[],xa.loadGlyphRange(c,h,d.url,d.requestTransform,function(a,b){if(b)for(var c in b)f.glyphs[+c]=b[+c];for(var d=0,e=i;d<e.length;d+=1)(0,e[d])(a,b);delete f.requests[h]})),i.push(function(a,d){a?b(a):d&&b(null,{stack:c,id:e,glyph:d[e]||null})})}}else b(null,{stack:c,id:e,glyph:g})},function(a,b){if(a)c(a);else if(b){for(var d={},e=0,f=b;e<f.length;e+=1){var g=f[e],h=g.stack,i=g.id,j=g.glyph;(d[h]||(d[h]={}))[i]=j&&{id:j.id,bitmap:j.bitmap.clone(),metrics:j.metrics}}c(null,d)}})},xa.prototype._tinySDF=function(b,c,d){var e=this.localIdeographFontFamily;if(e&&(a.isChar["CJK Unified Ideographs"](d)||a.isChar["Hangul Syllables"](d))){var f=b.tinySDF;if(!f){var g="400";/bold/i.test(c)?g="900":/medium/i.test(c)?g="500":/light/i.test(c)&&(g="200"),f=b.tinySDF=new xa.TinySDF(24,3,8,.25,e,g)}return{id:d,bitmap:new a.AlphaImage({width:30,height:30},f.draw(String.fromCharCode(d))),metrics:{width:24,height:24,left:0,top:-8,advance:24}}}},xa.loadGlyphRange=function(b,c,d,e,f){var g=256*c,h=g+255,i=e(a.normalizeGlyphsURL(d).replace("{fontstack}",b).replace("{range}",g+"-"+h),a.ResourceType.Glyphs);a.getArrayBuffer(i,function(b,c){if(b)f(b);else if(c){for(var d={},e=0,g=a.parseGlyphPBF(c);e<g.length;e+=1){var h=g[e];d[h.id]=h}f(null,d)}})},xa.TinySDF=va;var ya=function(){this.specification=a.styleSpec.light.position};ya.prototype.possiblyEvaluate=function(b,c){return a.sphericalToCartesian(b.expression.evaluate(c))},ya.prototype.interpolate=function(b,c,d){return{x:a.number(b.x,c.x,d),y:a.number(b.y,c.y,d),z:a.number(b.z,c.z,d)}};var za=new a.Properties({anchor:new a.DataConstantProperty(a.styleSpec.light.anchor),position:new ya,color:new a.DataConstantProperty(a.styleSpec.light.color),intensity:new a.DataConstantProperty(a.styleSpec.light.intensity)}),Aa=function(b){function c(c){b.call(this),this._transitionable=new a.Transitionable(za),this.setLight(c),this._transitioning=this._transitionable.untransitioned()}return b&&(c.__proto__=b),c.prototype=Object.create(b&&b.prototype),c.prototype.constructor=c,c.prototype.getLight=function(){return this._transitionable.serialize()},c.prototype.setLight=function(b,c){if(void 0===c&&(c={}),!this._validate(a.validateLight,b,c))for(var d in b){var e=b[d];a.endsWith(d,"-transition")?this._transitionable.setTransition(d.slice(0,-"-transition".length),e):this._transitionable.setValue(d,e)}},c.prototype.updateTransitions=function(a){this._transitioning=this._transitionable.transitioned(a,this._transitioning)},c.prototype.hasTransition=function(){return this._transitioning.hasTransition()},c.prototype.recalculate=function(a){this.properties=this._transitioning.possiblyEvaluate(a)},c.prototype._validate=function(b,c,d){return(!d||!1!==d.validate)&&a.emitValidationErrors(this,b.call(a.validateStyle,a.extend({value:c,style:{glyphs:!0,sprite:!0},styleSpec:a.styleSpec})))},c}(a.Evented),Ba=function(a,b){this.width=a,this.height=b,this.nextRow=0,this.bytes=4,this.data=new Uint8Array(this.width*this.height*this.bytes),this.positions={}};Ba.prototype.getDash=function(a,b){var c=a.join(",")+String(b);return this.positions[c]||(this.positions[c]=this.addDash(a,b)),this.positions[c]},Ba.prototype.addDash=function(b,c){var d=c?7:0,e=2*d+1;if(this.nextRow+e>this.height)return a.warnOnce("LineAtlas out of space"),null;for(var f=0,g=0;g<b.length;g++)f+=b[g];for(var h=this.width/f,i=h/2,j=b.length%2==1,k=-d;k<=d;k++)for(var l=this.nextRow+d+k,m=this.width*l,n=j?-b[b.length-1]:0,o=b[0],p=1,q=0;q<this.width;q++){for(;o<q/h;)n=o,o+=b[p],j&&p===b.length-1&&(o+=b[0]),p++;var r=Math.abs(q-n*h),s=Math.abs(q-o*h),t=Math.min(r,s),u=p%2==1,v=void 0;if(c){var w=d?k/d*(i+1):0;if(u){var x=i-Math.abs(w);v=Math.sqrt(t*t+x*x)}else v=i-Math.sqrt(t*t+w*w)}else v=(u?1:-1)*t;this.data[3+4*(m+q)]=Math.max(0,Math.min(255,v+128))}var y={y:(this.nextRow+d+.5)/this.height,height:2*d/this.height,width:f};return this.nextRow+=e,this.dirty=!0,y},Ba.prototype.bind=function(a){var b=a.gl;this.texture?(b.bindTexture(b.TEXTURE_2D,this.texture),this.dirty&&(this.dirty=!1,b.texSubImage2D(b.TEXTURE_2D,0,0,0,this.width,this.height,b.RGBA,b.UNSIGNED_BYTE,this.data))):(this.texture=b.createTexture(),b.bindTexture(b.TEXTURE_2D,this.texture),b.texParameteri(b.TEXTURE_2D,b.TEXTURE_WRAP_S,b.REPEAT),b.texParameteri(b.TEXTURE_2D,b.TEXTURE_WRAP_T,b.REPEAT),b.texParameteri(b.TEXTURE_2D,b.TEXTURE_MIN_FILTER,b.LINEAR),b.texParameteri(b.TEXTURE_2D,b.TEXTURE_MAG_FILTER,b.LINEAR),b.texImage2D(b.TEXTURE_2D,0,b.RGBA,this.width,this.height,0,b.RGBA,b.UNSIGNED_BYTE,this.data))};var Ca=function b(c,d){this.workerPool=c,this.actors=[],this.currentActor=0,this.id=a.uniqueId();for(var e=this.workerPool.acquire(this.id),f=0;f<e.length;f++){var g=e[f],h=new b.Actor(g,d,this.id);h.name="Worker "+f,this.actors.push(h)}};Ca.prototype.broadcast=function(b,c,d){d=d||function(){},a.asyncAll(this.actors,function(a,d){a.send(b,c,d)},d)},Ca.prototype.send=function(a,b,c,d){return("number"!=typeof d||isNaN(d))&&(d=this.currentActor=(this.currentActor+1)%this.actors.length),this.actors[d].send(a,b,c),d},Ca.prototype.remove=function(){this.actors.forEach(function(a){a.remove()}),this.actors=[],this.workerPool.release(this.id)},Ca.Actor=a.Actor;var Da=function(b,c,d){this.bounds=a.LngLatBounds.convert(this.validateBounds(b)),this.minzoom=c||0,this.maxzoom=d||24};Da.prototype.validateBounds=function(a){return Array.isArray(a)&&4===a.length?[Math.max(-180,a[0]),Math.max(-90,a[1]),Math.min(180,a[2]),Math.min(90,a[3])]:[-180,-90,180,90]},Da.prototype.contains=function(b){var c=Math.pow(2,b.z),d=Math.floor(a.mercatorXfromLng(this.bounds.getWest())*c),e=Math.floor(a.mercatorYfromLat(this.bounds.getNorth())*c),f=Math.ceil(a.mercatorXfromLng(this.bounds.getEast())*c),g=Math.ceil(a.mercatorYfromLat(this.bounds.getSouth())*c);return b.x>=d&&b.x<f&&b.y>=e&&b.y<g};var Ea=function(b){function c(c,d,e,f){if(b.call(this),this.id=c,this.dispatcher=e,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,a.extend(this,a.pick(d,["url","scheme","tileSize"])),this._options=a.extend({type:"vector"},d),this._collectResourceTiming=d.collectResourceTiming,512!==this.tileSize)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(f)}return b&&(c.__proto__=b),c.prototype=Object.create(b&&b.prototype),c.prototype.constructor=c,c.prototype.load=function(){var b=this;this.fire(new a.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=f(this._options,this.map._transformRequest,function(c,d){b._tileJSONRequest=null,c?b.fire(new a.ErrorEvent(c)):d&&(a.extend(b,d),d.bounds&&(b.tileBounds=new Da(d.bounds,b.minzoom,b.maxzoom)),a.postTurnstileEvent(d.tiles),a.postMapLoadEvent(d.tiles,b.map._getMapId()),b.fire(new a.Event("data",{dataType:"source",sourceDataType:"metadata"})),b.fire(new a.Event("data",{dataType:"source",sourceDataType:"content"})))})},c.prototype.hasTile=function(a){return!this.tileBounds||this.tileBounds.contains(a.canonical)},c.prototype.onAdd=function(a){this.map=a,this.load()},c.prototype.onRemove=function(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)},c.prototype.serialize=function(){return a.extend({},this._options)},c.prototype.loadTile=function(b,c){function d(a,d){return b.aborted?c(null):a&&404!==a.status?c(a):(d&&d.resourceTiming&&(b.resourceTiming=d.resourceTiming),this.map._refreshExpiredTiles&&d&&b.setExpiryData(d),b.loadVectorData(d,this.map.painter),c(null),void(b.reloadCallback&&(this.loadTile(b,b.reloadCallback),b.reloadCallback=null)))}var e=a.normalizeTileURL(b.tileID.canonical.url(this.tiles,this.scheme),this.url),f={request:this.map._transformRequest(e,a.ResourceType.Tile),uid:b.uid,tileID:b.tileID,zoom:b.tileID.overscaledZ,tileSize:this.tileSize*b.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:a.browser.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes};f.request.collectResourceTiming=this._collectResourceTiming,void 0===b.workerID||"expired"===b.state?b.workerID=this.dispatcher.send("loadTile",f,d.bind(this)):"loading"===b.state?b.reloadCallback=c:this.dispatcher.send("reloadTile",f,d.bind(this),b.workerID)},
c.prototype.abortTile=function(a){this.dispatcher.send("abortTile",{uid:a.uid,type:this.type,source:this.id},void 0,a.workerID)},c.prototype.unloadTile=function(a){a.unloadVectorData(),this.dispatcher.send("removeTile",{uid:a.uid,type:this.type,source:this.id},void 0,a.workerID)},c.prototype.hasTransition=function(){return!1},c}(a.Evented),Fa=function(b){function c(c,d,e,f){b.call(this),this.id=c,this.dispatcher=e,this.setEventedParent(f),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=a.extend({},d),a.extend(this,a.pick(d,["url","scheme","tileSize"]))}return b&&(c.__proto__=b),c.prototype=Object.create(b&&b.prototype),c.prototype.constructor=c,c.prototype.load=function(){var b=this;this.fire(new a.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=f(this._options,this.map._transformRequest,function(c,d){b._tileJSONRequest=null,c?b.fire(new a.ErrorEvent(c)):d&&(a.extend(b,d),d.bounds&&(b.tileBounds=new Da(d.bounds,b.minzoom,b.maxzoom)),a.postTurnstileEvent(d.tiles),a.postMapLoadEvent(d.tiles,b.map._getMapId()),b.fire(new a.Event("data",{dataType:"source",sourceDataType:"metadata"})),b.fire(new a.Event("data",{dataType:"source",sourceDataType:"content"})))})},c.prototype.onAdd=function(a){this.map=a,this.load()},c.prototype.onRemove=function(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)},c.prototype.serialize=function(){return a.extend({},this._options)},c.prototype.hasTile=function(a){return!this.tileBounds||this.tileBounds.contains(a.canonical)},c.prototype.loadTile=function(b,c){var d=this,e=a.normalizeTileURL(b.tileID.canonical.url(this.tiles,this.scheme),this.url,this.tileSize);b.request=a.getImage(this.map._transformRequest(e,a.ResourceType.Tile),function(e,f){if(delete b.request,b.aborted)b.state="unloaded",c(null);else if(e)b.state="errored",c(e);else if(f){d.map._refreshExpiredTiles&&b.setExpiryData(f),delete f.cacheControl,delete f.expires;var g=d.map.painter.context,h=g.gl;b.texture=d.map.painter.getTileTexture(f.width),b.texture?b.texture.update(f,{useMipmap:!0}):(b.texture=new a.Texture(g,f,h.RGBA,{useMipmap:!0}),b.texture.bind(h.LINEAR,h.CLAMP_TO_EDGE,h.LINEAR_MIPMAP_NEAREST),g.extTextureFilterAnisotropic&&h.texParameterf(h.TEXTURE_2D,g.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,g.extTextureFilterAnisotropicMax)),b.state="loaded",c(null)}})},c.prototype.abortTile=function(a,b){a.request&&(a.request.cancel(),delete a.request),b()},c.prototype.unloadTile=function(a,b){a.texture&&this.map.painter.saveTileTexture(a.texture),b()},c.prototype.hasTransition=function(){return!1},c}(a.Evented),Ga=function(b){function c(c,d,e,f){b.call(this,c,d,e,f),this.type="raster-dem",this.maxzoom=22,this._options=a.extend({},d),this.encoding=d.encoding||"mapbox"}return b&&(c.__proto__=b),c.prototype=Object.create(b&&b.prototype),c.prototype.constructor=c,c.prototype.serialize=function(){return{type:"raster-dem",url:this.url,tileSize:this.tileSize,tiles:this.tiles,bounds:this.bounds,encoding:this.encoding}},c.prototype.loadTile=function(b,c){var d=a.normalizeTileURL(b.tileID.canonical.url(this.tiles,this.scheme),this.url,this.tileSize);b.request=a.getImage(this.map._transformRequest(d,a.ResourceType.Tile),function(d,e){if(delete b.request,b.aborted)b.state="unloaded",c(null);else if(d)b.state="errored",c(d);else if(e){this.map._refreshExpiredTiles&&b.setExpiryData(e),delete e.cacheControl,delete e.expires;var f=a.browser.getImageData(e),g={uid:b.uid,coord:b.tileID,source:this.id,rawImageData:f,encoding:this.encoding};b.workerID&&"expired"!==b.state||(b.workerID=this.dispatcher.send("loadDEMTile",g,function(a,d){a&&(b.state="errored",c(a)),d&&(b.dem=d,b.needsHillshadePrepare=!0,b.state="loaded",c(null))}.bind(this)))}}.bind(this)),b.neighboringTiles=this._getNeighboringTiles(b.tileID)},c.prototype._getNeighboringTiles=function(b){var c=b.canonical,d=Math.pow(2,c.z),e=(c.x-1+d)%d,f=0===c.x?b.wrap-1:b.wrap,g=(c.x+1+d)%d,h=c.x+1===d?b.wrap+1:b.wrap,i={};return i[new a.OverscaledTileID(b.overscaledZ,f,c.z,e,c.y).key]={backfilled:!1},i[new a.OverscaledTileID(b.overscaledZ,h,c.z,g,c.y).key]={backfilled:!1},c.y>0&&(i[new a.OverscaledTileID(b.overscaledZ,f,c.z,e,c.y-1).key]={backfilled:!1},i[new a.OverscaledTileID(b.overscaledZ,b.wrap,c.z,c.x,c.y-1).key]={backfilled:!1},i[new a.OverscaledTileID(b.overscaledZ,h,c.z,g,c.y-1).key]={backfilled:!1}),c.y+1<d&&(i[new a.OverscaledTileID(b.overscaledZ,f,c.z,e,c.y+1).key]={backfilled:!1},i[new a.OverscaledTileID(b.overscaledZ,b.wrap,c.z,c.x,c.y+1).key]={backfilled:!1},i[new a.OverscaledTileID(b.overscaledZ,h,c.z,g,c.y+1).key]={backfilled:!1}),i},c.prototype.unloadTile=function(a){a.demTexture&&this.map.painter.saveTileTexture(a.demTexture),a.fbo&&(a.fbo.destroy(),delete a.fbo),a.dem&&delete a.dem,delete a.neighboringTiles,a.state="unloaded",this.dispatcher.send("removeDEMTile",{uid:a.uid,source:this.id},void 0,a.workerID)},c}(Fa),Ha=function(b){function c(c,d,e,f){b.call(this),this.id=c,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._removed=!1,this.dispatcher=e,this.setEventedParent(f),this._data=d.data,this._options=a.extend({},d),this._collectResourceTiming=d.collectResourceTiming,this._resourceTiming=[],void 0!==d.maxzoom&&(this.maxzoom=d.maxzoom),d.type&&(this.type=d.type),d.attribution&&(this.attribution=d.attribution);var g=a.EXTENT/this.tileSize;this.workerOptions=a.extend({source:this.id,cluster:d.cluster||!1,geojsonVtOptions:{buffer:(void 0!==d.buffer?d.buffer:128)*g,tolerance:(void 0!==d.tolerance?d.tolerance:.375)*g,extent:a.EXTENT,maxZoom:this.maxzoom,lineMetrics:d.lineMetrics||!1,generateId:d.generateId||!1},superclusterOptions:{maxZoom:void 0!==d.clusterMaxZoom?Math.min(d.clusterMaxZoom,this.maxzoom-1):this.maxzoom-1,extent:a.EXTENT,radius:(d.clusterRadius||50)*g,log:!1},clusterProperties:d.clusterProperties},d.workerOptions)}return b&&(c.__proto__=b),c.prototype=Object.create(b&&b.prototype),c.prototype.constructor=c,c.prototype.load=function(){var b=this;this.fire(new a.Event("dataloading",{dataType:"source"})),this._updateWorkerData(function(c){if(c)b.fire(new a.ErrorEvent(c));else{var d={dataType:"source",sourceDataType:"metadata"};b._collectResourceTiming&&b._resourceTiming&&b._resourceTiming.length>0&&(d.resourceTiming=b._resourceTiming,b._resourceTiming=[]),b.fire(new a.Event("data",d))}})},c.prototype.onAdd=function(a){this.map=a,this.load()},c.prototype.setData=function(b){var c=this;return this._data=b,this.fire(new a.Event("dataloading",{dataType:"source"})),this._updateWorkerData(function(b){if(b)c.fire(new a.ErrorEvent(b));else{var d={dataType:"source",sourceDataType:"content"};c._collectResourceTiming&&c._resourceTiming&&c._resourceTiming.length>0&&(d.resourceTiming=c._resourceTiming,c._resourceTiming=[]),c.fire(new a.Event("data",d))}}),this},c.prototype.getClusterExpansionZoom=function(a,b){return this.dispatcher.send("geojson.getClusterExpansionZoom",{clusterId:a,source:this.id},b,this.workerID),this},c.prototype.getClusterChildren=function(a,b){return this.dispatcher.send("geojson.getClusterChildren",{clusterId:a,source:this.id},b,this.workerID),this},c.prototype.getClusterLeaves=function(a,b,c,d){return this.dispatcher.send("geojson.getClusterLeaves",{source:this.id,clusterId:a,limit:b,offset:c},d,this.workerID),this},c.prototype._updateWorkerData=function(b){var c=this,d=a.extend({},this.workerOptions),e=this._data;"string"==typeof e?(d.request=this.map._transformRequest(a.browser.resolveURL(e),a.ResourceType.Source),d.request.collectResourceTiming=this._collectResourceTiming):d.data=JSON.stringify(e),this.workerID=this.dispatcher.send(this.type+".loadData",d,function(a,e){c._removed||e&&e.abandoned||(c._loaded=!0,e&&e.resourceTiming&&e.resourceTiming[c.id]&&(c._resourceTiming=e.resourceTiming[c.id].slice(0)),c.dispatcher.send(c.type+".coalesce",{source:d.source},null,c.workerID),b(a))},this.workerID)},c.prototype.loadTile=function(b,c){var d=this,e=void 0===b.workerID?"loadTile":"reloadTile",f={type:this.type,uid:b.uid,tileID:b.tileID,zoom:b.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:a.browser.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes};b.workerID=this.dispatcher.send(e,f,function(a,f){return b.unloadVectorData(),b.aborted?c(null):a?c(a):(b.loadVectorData(f,d.map.painter,"reloadTile"===e),c(null))},this.workerID)},c.prototype.abortTile=function(a){a.aborted=!0},c.prototype.unloadTile=function(a){a.unloadVectorData(),this.dispatcher.send("removeTile",{uid:a.uid,type:this.type,source:this.id},null,a.workerID)},c.prototype.onRemove=function(){this._removed=!0,this.dispatcher.send("removeSource",{type:this.type,source:this.id},null,this.workerID)},c.prototype.serialize=function(){return a.extend({},this._options,{type:this.type,data:this._data})},c.prototype.hasTransition=function(){return!1},c}(a.Evented),Ia=function(b){function c(a,c,d,e){b.call(this),this.id=a,this.dispatcher=d,this.coordinates=c.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this.setEventedParent(e),this.options=c}return b&&(c.__proto__=b),c.prototype=Object.create(b&&b.prototype),c.prototype.constructor=c,c.prototype.load=function(b,c){var d=this;this.fire(new a.Event("dataloading",{dataType:"source"})),this.url=this.options.url,a.getImage(this.map._transformRequest(this.url,a.ResourceType.Image),function(e,f){e?d.fire(new a.ErrorEvent(e)):f&&(d.image=f,b&&(d.coordinates=b),c&&c(),d._finishLoading())})},c.prototype.updateImage=function(a){var b=this;return this.image&&a.url?(this.options.url=a.url,this.load(a.coordinates,function(){b.texture=null}),this):this},c.prototype._finishLoading=function(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new a.Event("data",{dataType:"source",sourceDataType:"metadata"})))},c.prototype.onAdd=function(a){this.map=a,this.load()},c.prototype.setCoordinates=function(b){var c=this;this.coordinates=b;var d=b.map(a.MercatorCoordinate.fromLngLat);this.tileID=function(b){for(var c=1/0,d=1/0,e=-1/0,f=-1/0,g=0,h=b;g<h.length;g+=1){var i=h[g];c=Math.min(c,i.x),d=Math.min(d,i.y),e=Math.max(e,i.x),f=Math.max(f,i.y)}var j=e-c,k=f-d,l=Math.max(j,k),m=Math.max(0,Math.floor(-Math.log(l)/Math.LN2)),n=Math.pow(2,m);return new a.CanonicalTileID(m,Math.floor((c+e)/2*n),Math.floor((d+f)/2*n))}(d),this.minzoom=this.maxzoom=this.tileID.z;var e=d.map(function(a){return c.tileID.getTilePoint(a)._round()});return this._boundsArray=new a.StructArrayLayout4i8,this._boundsArray.emplaceBack(e[0].x,e[0].y,0,0),this._boundsArray.emplaceBack(e[1].x,e[1].y,a.EXTENT,0),this._boundsArray.emplaceBack(e[3].x,e[3].y,0,a.EXTENT),this._boundsArray.emplaceBack(e[2].x,e[2].y,a.EXTENT,a.EXTENT),this.boundsBuffer&&(this.boundsBuffer.destroy(),delete this.boundsBuffer),this.fire(new a.Event("data",{dataType:"source",sourceDataType:"content"})),this},c.prototype.prepare=function(){if(0!==Object.keys(this.tiles).length&&this.image){var b=this.map.painter.context,c=b.gl;for(var d in this.boundsBuffer||(this.boundsBuffer=b.createVertexBuffer(this._boundsArray,a.rasterBoundsAttributes.members)),this.boundsSegments||(this.boundsSegments=a.SegmentVector.simpleSegment(0,0,4,2)),this.texture||(this.texture=new a.Texture(b,this.image,c.RGBA),this.texture.bind(c.LINEAR,c.CLAMP_TO_EDGE)),this.tiles){var e=this.tiles[d];"loaded"!==e.state&&(e.state="loaded",e.texture=this.texture)}}},c.prototype.loadTile=function(a,b){this.tileID&&this.tileID.equals(a.tileID.canonical)?(this.tiles[String(a.tileID.wrap)]=a,a.buckets={},b(null)):(a.state="errored",b(null))},c.prototype.serialize=function(){return{type:"image",url:this.options.url,coordinates:this.coordinates}},c.prototype.hasTransition=function(){return!1},c}(a.Evented),Ja={vector:Ea,raster:Fa,"raster-dem":Ga,geojson:Ha,video:function(b){function c(a,c,d,e){b.call(this,a,c,d,e),this.roundZoom=!0,this.type="video",this.options=c}return b&&(c.__proto__=b),c.prototype=Object.create(b&&b.prototype),c.prototype.constructor=c,c.prototype.load=function(){var b=this,c=this.options;this.urls=[];for(var d=0,e=c.urls;d<e.length;d+=1){var f=e[d];this.urls.push(this.map._transformRequest(f,a.ResourceType.Source).url)}a.getVideo(this.urls,function(c,d){c?b.fire(new a.ErrorEvent(c)):d&&(b.video=d,b.video.loop=!0,b.video.addEventListener("playing",function(){b.map.triggerRepaint()}),b.map&&b.video.play(),b._finishLoading())})},c.prototype.getVideo=function(){return this.video},c.prototype.onAdd=function(a){this.map||(this.map=a,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))},c.prototype.prepare=function(){if(!(0===Object.keys(this.tiles).length||this.video.readyState<2)){var b=this.map.painter.context,c=b.gl;for(var d in this.boundsBuffer||(this.boundsBuffer=b.createVertexBuffer(this._boundsArray,a.rasterBoundsAttributes.members)),this.boundsSegments||(this.boundsSegments=a.SegmentVector.simpleSegment(0,0,4,2)),this.texture?this.video.paused||(this.texture.bind(c.LINEAR,c.CLAMP_TO_EDGE),c.texSubImage2D(c.TEXTURE_2D,0,0,0,c.RGBA,c.UNSIGNED_BYTE,this.video)):(this.texture=new a.Texture(b,this.video,c.RGBA),this.texture.bind(c.LINEAR,c.CLAMP_TO_EDGE)),this.tiles){var e=this.tiles[d];"loaded"!==e.state&&(e.state="loaded",e.texture=this.texture)}}},c.prototype.serialize=function(){return{type:"video",urls:this.urls,coordinates:this.coordinates}},c.prototype.hasTransition=function(){return this.video&&!this.video.paused},c}(Ia),image:Ia,canvas:function(b){function c(c,d,e,f){b.call(this,c,d,e,f),d.coordinates?Array.isArray(d.coordinates)&&4===d.coordinates.length&&!d.coordinates.some(function(a){return!Array.isArray(a)||2!==a.length||a.some(function(a){return"number"!=typeof a})})||this.fire(new a.ErrorEvent(new a.ValidationError("sources."+c,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new a.ErrorEvent(new a.ValidationError("sources."+c,null,'missing required property "coordinates"'))),d.animate&&"boolean"!=typeof d.animate&&this.fire(new a.ErrorEvent(new a.ValidationError("sources."+c,null,'optional "animate" property must be a boolean value'))),d.canvas?"string"==typeof d.canvas||d.canvas instanceof a.window.HTMLCanvasElement||this.fire(new a.ErrorEvent(new a.ValidationError("sources."+c,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new a.ErrorEvent(new a.ValidationError("sources."+c,null,'missing required property "canvas"'))),this.options=d,this.animate=void 0===d.animate||d.animate}return b&&(c.__proto__=b),c.prototype=Object.create(b&&b.prototype),c.prototype.constructor=c,c.prototype.load=function(){this.canvas||(this.canvas=this.options.canvas instanceof a.window.HTMLCanvasElement?this.options.canvas:a.window.document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new a.ErrorEvent(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing=!1},this._finishLoading())},c.prototype.getCanvas=function(){return this.canvas},c.prototype.onAdd=function(a){this.map=a,this.load(),this.canvas&&this.animate&&this.play()},c.prototype.onRemove=function(){this.pause()},c.prototype.prepare=function(){var b=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,b=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,b=!0),!this._hasInvalidDimensions()&&0!==Object.keys(this.tiles).length){var c=this.map.painter.context,d=c.gl;for(var e in this.boundsBuffer||(this.boundsBuffer=c.createVertexBuffer(this._boundsArray,a.rasterBoundsAttributes.members)),this.boundsSegments||(this.boundsSegments=a.SegmentVector.simpleSegment(0,0,4,2)),this.texture?(b||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new a.Texture(c,this.canvas,d.RGBA,{premultiply:!0}),this.tiles){var f=this.tiles[e];"loaded"!==f.state&&(f.state="loaded",f.texture=this.texture)}}},c.prototype.serialize=function(){return{type:"canvas",coordinates:this.coordinates}},c.prototype.hasTransition=function(){return this._playing},c.prototype._hasInvalidDimensions=function(){for(var a=0,b=[this.canvas.width,this.canvas.height];a<b.length;a+=1){var c=b[a];if(isNaN(c)||c<=0)return!0}return!1},c}(Ia)},Ka=function(b,c,d,e){var f=new Ja[c.type](b,c,d,e);if(f.id!==b)throw new Error("Expected Source id to be "+b+" instead of "+f.id);return a.bindAll(["load","abort","unload","serialize","prepare"],f),f},La=function(a,b){this.max=a,this.onRemove=b,this.reset()};La.prototype.reset=function(){for(var a in this.data)for(var b=0,c=this.data[a];b<c.length;b+=1){var d=c[b];d.timeout&&clearTimeout(d.timeout),this.onRemove(d.value)}return this.data={},this.order=[],this},La.prototype.add=function(a,b,c){var d=this,e=a.wrapped().key;void 0===this.data[e]&&(this.data[e]=[]);var f={value:b,timeout:void 0};if(void 0!==c&&(f.timeout=setTimeout(function(){d.remove(a,f)},c)),this.data[e].push(f),this.order.push(e),this.order.length>this.max){var g=this._getAndRemoveByKey(this.order[0]);g&&this.onRemove(g)}return this},La.prototype.has=function(a){return a.wrapped().key in this.data},La.prototype.getAndRemove=function(a){return this.has(a)?this._getAndRemoveByKey(a.wrapped().key):null},La.prototype._getAndRemoveByKey=function(a){var b=this.data[a].shift();return b.timeout&&clearTimeout(b.timeout),0===this.data[a].length&&delete this.data[a],this.order.splice(this.order.indexOf(a),1),b.value},La.prototype.get=function(a){return this.has(a)?this.data[a.wrapped().key][0].value:null},La.prototype.remove=function(a,b){if(!this.has(a))return this;var c=a.wrapped().key,d=void 0===b?0:this.data[c].indexOf(b),e=this.data[c][d];return this.data[c].splice(d,1),e.timeout&&clearTimeout(e.timeout),0===this.data[c].length&&delete this.data[c],this.onRemove(e.value),this.order.splice(this.order.indexOf(c),1),this},La.prototype.setMaxSize=function(a){for(this.max=a;this.order.length>this.max;){var b=this._getAndRemoveByKey(this.order[0]);b&&this.onRemove(b)}return this};var Ma=function(a,b,c){this.context=a;var d=a.gl;this.buffer=d.createBuffer(),this.dynamicDraw=Boolean(c),this.context.unbindVAO(),a.bindElementBuffer.set(this.buffer),d.bufferData(d.ELEMENT_ARRAY_BUFFER,b.arrayBuffer,this.dynamicDraw?d.DYNAMIC_DRAW:d.STATIC_DRAW),this.dynamicDraw||delete b.arrayBuffer};Ma.prototype.bind=function(){this.context.bindElementBuffer.set(this.buffer)},Ma.prototype.updateData=function(a){var b=this.context.gl;this.context.unbindVAO(),this.bind(),b.bufferSubData(b.ELEMENT_ARRAY_BUFFER,0,a.arrayBuffer)},Ma.prototype.destroy=function(){var a=this.context.gl;this.buffer&&(a.deleteBuffer(this.buffer),delete this.buffer)};var Na={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"},Oa=function(a,b,c,d){this.length=b.length,this.attributes=c,this.itemSize=b.bytesPerElement,this.dynamicDraw=d,this.context=a;var e=a.gl;this.buffer=e.createBuffer(),a.bindVertexBuffer.set(this.buffer),e.bufferData(e.ARRAY_BUFFER,b.arrayBuffer,this.dynamicDraw?e.DYNAMIC_DRAW:e.STATIC_DRAW),this.dynamicDraw||delete b.arrayBuffer};Oa.prototype.bind=function(){this.context.bindVertexBuffer.set(this.buffer)},Oa.prototype.updateData=function(a){var b=this.context.gl;this.bind(),b.bufferSubData(b.ARRAY_BUFFER,0,a.arrayBuffer)},Oa.prototype.enableAttributes=function(a,b){for(var c=0;c<this.attributes.length;c++){var d=this.attributes[c],e=b.attributes[d.name];void 0!==e&&a.enableVertexAttribArray(e)}},Oa.prototype.setVertexAttribPointers=function(a,b,c){for(var d=0;d<this.attributes.length;d++){var e=this.attributes[d],f=b.attributes[e.name];void 0!==f&&a.vertexAttribPointer(f,e.components,a[Na[e.type]],!1,this.itemSize,e.offset+this.itemSize*(c||0))}},Oa.prototype.destroy=function(){var a=this.context.gl;this.buffer&&(a.deleteBuffer(this.buffer),delete this.buffer)};var Pa=function(a){this.gl=a.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1};Pa.prototype.get=function(){return this.current},Pa.prototype.set=function(a){},Pa.prototype.getDefault=function(){return this.default},Pa.prototype.setDefault=function(){this.set(this.default)};var Qa=function(b){function c(){b.apply(this,arguments)}return b&&(c.__proto__=b),c.prototype=Object.create(b&&b.prototype),c.prototype.constructor=c,c.prototype.getDefault=function(){return a.Color.transparent},c.prototype.set=function(a){var b=this.current;(a.r!==b.r||a.g!==b.g||a.b!==b.b||a.a!==b.a||this.dirty)&&(this.gl.clearColor(a.r,a.g,a.b,a.a),this.current=a,this.dirty=!1)},c}(Pa),Ra=function(a){function b(){a.apply(this,arguments)}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.getDefault=function(){return 1},b.prototype.set=function(a){(a!==this.current||this.dirty)&&(this.gl.clearDepth(a),this.current=a,this.dirty=!1)},b}(Pa),Sa=function(a){function b(){a.apply(this,arguments)}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.getDefault=function(){return 0},b.prototype.set=function(a){(a!==this.current||this.dirty)&&(this.gl.clearStencil(a),this.current=a,this.dirty=!1)},b}(Pa),Ta=function(a){function b(){a.apply(this,arguments)}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.getDefault=function(){return[!0,!0,!0,!0]},b.prototype.set=function(a){var b=this.current;(a[0]!==b[0]||a[1]!==b[1]||a[2]!==b[2]||a[3]!==b[3]||this.dirty)&&(this.gl.colorMask(a[0],a[1],a[2],a[3]),this.current=a,this.dirty=!1)},b}(Pa),Ua=function(a){function b(){a.apply(this,arguments)}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.getDefault=function(){return!0},b.prototype.set=function(a){(a!==this.current||this.dirty)&&(this.gl.depthMask(a),this.current=a,this.dirty=!1)},b}(Pa),Va=function(a){function b(){a.apply(this,arguments)}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.getDefault=function(){return 255},b.prototype.set=function(a){(a!==this.current||this.dirty)&&(this.gl.stencilMask(a),this.current=a,this.dirty=!1)},b}(Pa),Wa=function(a){function b(){a.apply(this,arguments)}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.getDefault=function(){return{func:this.gl.ALWAYS,ref:0,mask:255}},b.prototype.set=function(a){var b=this.current;(a.func!==b.func||a.ref!==b.ref||a.mask!==b.mask||this.dirty)&&(this.gl.stencilFunc(a.func,a.ref,a.mask),this.current=a,this.dirty=!1)},b}(Pa),Xa=function(a){function b(){a.apply(this,arguments)}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.getDefault=function(){var a=this.gl;return[a.KEEP,a.KEEP,a.KEEP]},b.prototype.set=function(a){var b=this.current;(a[0]!==b[0]||a[1]!==b[1]||a[2]!==b[2]||this.dirty)&&(this.gl.stencilOp(a[0],a[1],a[2]),this.current=a,this.dirty=!1)},b}(Pa),Ya=function(a){function b(){a.apply(this,arguments)}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.getDefault=function(){return!1},b.prototype.set=function(a){if(a!==this.current||this.dirty){var b=this.gl;a?b.enable(b.STENCIL_TEST):b.disable(b.STENCIL_TEST),this.current=a,this.dirty=!1}},b}(Pa),Za=function(a){function b(){a.apply(this,arguments)}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.getDefault=function(){return[0,1]},b.prototype.set=function(a){var b=this.current;(a[0]!==b[0]||a[1]!==b[1]||this.dirty)&&(this.gl.depthRange(a[0],a[1]),this.current=a,this.dirty=!1)},b}(Pa),$a=function(a){function b(){a.apply(this,arguments)}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.getDefault=function(){return!1},b.prototype.set=function(a){if(a!==this.current||this.dirty){var b=this.gl;a?b.enable(b.DEPTH_TEST):b.disable(b.DEPTH_TEST),this.current=a,this.dirty=!1}},b}(Pa),_a=function(a){function b(){a.apply(this,arguments)}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.getDefault=function(){return this.gl.LESS},b.prototype.set=function(a){(a!==this.current||this.dirty)&&(this.gl.depthFunc(a),this.current=a,this.dirty=!1)},b}(Pa),ab=function(a){function b(){a.apply(this,arguments)}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.getDefault=function(){return!1},b.prototype.set=function(a){if(a!==this.current||this.dirty){var b=this.gl;a?b.enable(b.BLEND):b.disable(b.BLEND),this.current=a,this.dirty=!1}},b}(Pa),bb=function(a){function b(){a.apply(this,arguments)}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.getDefault=function(){var a=this.gl;return[a.ONE,a.ZERO]},b.prototype.set=function(a){var b=this.current;(a[0]!==b[0]||a[1]!==b[1]||this.dirty)&&(this.gl.blendFunc(a[0],a[1]),this.current=a,this.dirty=!1)},b}(Pa),cb=function(b){function c(){b.apply(this,arguments)}return b&&(c.__proto__=b),c.prototype=Object.create(b&&b.prototype),c.prototype.constructor=c,c.prototype.getDefault=function(){return a.Color.transparent},c.prototype.set=function(a){var b=this.current;(a.r!==b.r||a.g!==b.g||a.b!==b.b||a.a!==b.a||this.dirty)&&(this.gl.blendColor(a.r,a.g,a.b,a.a),this.current=a,this.dirty=!1)},c}(Pa),db=function(a){function b(){a.apply(this,arguments)}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.getDefault=function(){return this.gl.FUNC_ADD},b.prototype.set=function(a){(a!==this.current||this.dirty)&&(this.gl.blendEquation(a),this.current=a,this.dirty=!1)},b}(Pa),eb=function(a){function b(){a.apply(this,arguments)}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.getDefault=function(){return!1},b.prototype.set=function(a){if(a!==this.current||this.dirty){var b=this.gl;a?b.enable(b.CULL_FACE):b.disable(b.CULL_FACE),this.current=a,this.dirty=!1}},b}(Pa),fb=function(a){function b(){a.apply(this,arguments)}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.getDefault=function(){return this.gl.BACK},b.prototype.set=function(a){(a!==this.current||this.dirty)&&(this.gl.cullFace(a),this.current=a,this.dirty=!1)},b}(Pa),gb=function(a){function b(){a.apply(this,arguments)}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.getDefault=function(){return this.gl.CCW},b.prototype.set=function(a){(a!==this.current||this.dirty)&&(this.gl.frontFace(a),this.current=a,this.dirty=!1)},b}(Pa),hb=function(a){function b(){a.apply(this,arguments)}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.getDefault=function(){return null},b.prototype.set=function(a){(a!==this.current||this.dirty)&&(this.gl.useProgram(a),this.current=a,this.dirty=!1)},b}(Pa),ib=function(a){function b(){a.apply(this,arguments)}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.getDefault=function(){return this.gl.TEXTURE0},b.prototype.set=function(a){(a!==this.current||this.dirty)&&(this.gl.activeTexture(a),this.current=a,this.dirty=!1)},b}(Pa),jb=function(a){function b(){a.apply(this,arguments)}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.getDefault=function(){var a=this.gl;return[0,0,a.drawingBufferWidth,a.drawingBufferHeight]},b.prototype.set=function(a){var b=this.current;(a[0]!==b[0]||a[1]!==b[1]||a[2]!==b[2]||a[3]!==b[3]||this.dirty)&&(this.gl.viewport(a[0],a[1],a[2],a[3]),this.current=a,this.dirty=!1)},b}(Pa),kb=function(a){function b(){a.apply(this,arguments)}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.getDefault=function(){return null},b.prototype.set=function(a){if(a!==this.current||this.dirty){var b=this.gl;b.bindFramebuffer(b.FRAMEBUFFER,a),this.current=a,this.dirty=!1}},b}(Pa),lb=function(a){function b(){a.apply(this,arguments)}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.getDefault=function(){return null},b.prototype.set=function(a){if(a!==this.current||this.dirty){var b=this.gl;b.bindRenderbuffer(b.RENDERBUFFER,a),this.current=a,this.dirty=!1}},b}(Pa),mb=function(a){function b(){a.apply(this,arguments)}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.getDefault=function(){return null},b.prototype.set=function(a){if(a!==this.current||this.dirty){var b=this.gl;b.bindTexture(b.TEXTURE_2D,a),this.current=a,this.dirty=!1}},b}(Pa),nb=function(a){function b(){a.apply(this,arguments)}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.getDefault=function(){return null},b.prototype.set=function(a){if(a!==this.current||this.dirty){var b=this.gl;b.bindBuffer(b.ARRAY_BUFFER,a),this.current=a,this.dirty=!1}},b}(Pa),ob=function(a){function b(){a.apply(this,arguments)}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.getDefault=function(){return null},b.prototype.set=function(a){var b=this.gl;b.bindBuffer(b.ELEMENT_ARRAY_BUFFER,a),this.current=a,this.dirty=!1},b}(Pa),pb=function(a){function b(b){a.call(this,b),this.vao=b.extVertexArrayObject}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.getDefault=function(){return null},b.prototype.set=function(a){this.vao&&(a!==this.current||this.dirty)&&(this.vao.bindVertexArrayOES(a),this.current=a,this.dirty=!1)},b}(Pa),qb=function(a){function b(){a.apply(this,arguments)}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.getDefault=function(){return 4},b.prototype.set=function(a){if(a!==this.current||this.dirty){var b=this.gl;b.pixelStorei(b.UNPACK_ALIGNMENT,a),this.current=a,this.dirty=!1}},b}(Pa),rb=function(a){function b(){a.apply(this,arguments)}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.getDefault=function(){return!1},b.prototype.set=function(a){if(a!==this.current||this.dirty){var b=this.gl;b.pixelStorei(b.UNPACK_PREMULTIPLY_ALPHA_WEBGL,a),this.current=a,this.dirty=!1}},b}(Pa),sb=function(a){function b(){a.apply(this,arguments)}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.getDefault=function(){return!1},b.prototype.set=function(a){if(a!==this.current||this.dirty){var b=this.gl;b.pixelStorei(b.UNPACK_FLIP_Y_WEBGL,a),this.current=a,this.dirty=!1}},b}(Pa),tb=function(a){function b(b,c){a.call(this,b),this.context=b,this.parent=c}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.getDefault=function(){return null},b}(Pa),ub=function(a){function b(){a.apply(this,arguments)}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.setDirty=function(){this.dirty=!0},b.prototype.set=function(a){if(a!==this.current||this.dirty){this.context.bindFramebuffer.set(this.parent);var b=this.gl;b.framebufferTexture2D(b.FRAMEBUFFER,b.COLOR_ATTACHMENT0,b.TEXTURE_2D,a,0),this.current=a,this.dirty=!1}},b}(tb),vb=function(a){function b(){a.apply(this,arguments)}
return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.set=function(a){if(a!==this.current||this.dirty){this.context.bindFramebuffer.set(this.parent);var b=this.gl;b.framebufferRenderbuffer(b.FRAMEBUFFER,b.DEPTH_ATTACHMENT,b.RENDERBUFFER,a),this.current=a,this.dirty=!1}},b}(tb),wb=function(a,b,c){this.context=a,this.width=b,this.height=c;var d=a.gl,e=this.framebuffer=d.createFramebuffer();this.colorAttachment=new ub(a,e),this.depthAttachment=new vb(a,e)};wb.prototype.destroy=function(){var a=this.context.gl,b=this.colorAttachment.get();b&&a.deleteTexture(b);var c=this.depthAttachment.get();c&&a.deleteRenderbuffer(c),a.deleteFramebuffer(this.framebuffer)};var xb=function(a,b,c){this.func=a,this.mask=b,this.range=c};xb.ReadOnly=!1,xb.ReadWrite=!0,xb.disabled=new xb(519,xb.ReadOnly,[0,1]);var yb=function(a,b,c,d,e,f){this.test=a,this.ref=b,this.mask=c,this.fail=d,this.depthFail=e,this.pass=f};yb.disabled=new yb({func:519,mask:0},0,0,7680,7680,7680);var zb=function(a,b,c){this.blendFunction=a,this.blendColor=b,this.mask=c};zb.Replace=[1,0],zb.disabled=new zb(zb.Replace,a.Color.transparent,[!1,!1,!1,!1]),zb.unblended=new zb(zb.Replace,a.Color.transparent,[!0,!0,!0,!0]),zb.alphaBlended=new zb([1,771],a.Color.transparent,[!0,!0,!0,!0]);var Ab=function(a,b,c){this.enable=a,this.mode=b,this.frontFace=c};Ab.disabled=new Ab(!1,1029,2305),Ab.backCCW=new Ab(!0,1029,2305);var Bb=function(a){this.gl=a,this.extVertexArrayObject=this.gl.getExtension("OES_vertex_array_object"),this.clearColor=new Qa(this),this.clearDepth=new Ra(this),this.clearStencil=new Sa(this),this.colorMask=new Ta(this),this.depthMask=new Ua(this),this.stencilMask=new Va(this),this.stencilFunc=new Wa(this),this.stencilOp=new Xa(this),this.stencilTest=new Ya(this),this.depthRange=new Za(this),this.depthTest=new $a(this),this.depthFunc=new _a(this),this.blend=new ab(this),this.blendFunc=new bb(this),this.blendColor=new cb(this),this.blendEquation=new db(this),this.cullFace=new eb(this),this.cullFaceSide=new fb(this),this.frontFace=new gb(this),this.program=new hb(this),this.activeTexture=new ib(this),this.viewport=new jb(this),this.bindFramebuffer=new kb(this),this.bindRenderbuffer=new lb(this),this.bindTexture=new mb(this),this.bindVertexBuffer=new nb(this),this.bindElementBuffer=new ob(this),this.bindVertexArrayOES=this.extVertexArrayObject&&new pb(this),this.pixelStoreUnpack=new qb(this),this.pixelStoreUnpackPremultiplyAlpha=new rb(this),this.pixelStoreUnpackFlipY=new sb(this),this.extTextureFilterAnisotropic=a.getExtension("EXT_texture_filter_anisotropic")||a.getExtension("MOZ_EXT_texture_filter_anisotropic")||a.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=a.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.extTextureHalfFloat=a.getExtension("OES_texture_half_float"),this.extTextureHalfFloat&&a.getExtension("OES_texture_half_float_linear")};Bb.prototype.setDirty=function(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.extVertexArrayObject&&(this.bindVertexArrayOES.dirty=!0),this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0},Bb.prototype.createIndexBuffer=function(a,b){return new Ma(this,a,b)},Bb.prototype.createVertexBuffer=function(a,b,c){return new Oa(this,a,b,c)},Bb.prototype.createRenderbuffer=function(a,b,c){var d=this.gl,e=d.createRenderbuffer();return this.bindRenderbuffer.set(e),d.renderbufferStorage(d.RENDERBUFFER,a,b,c),this.bindRenderbuffer.set(null),e},Bb.prototype.createFramebuffer=function(a,b){return new wb(this,a,b)},Bb.prototype.clear=function(a){var b=a.color,c=a.depth,d=this.gl,e=0;b&&(e|=d.COLOR_BUFFER_BIT,this.clearColor.set(b),this.colorMask.set([!0,!0,!0,!0])),void 0!==c&&(e|=d.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(c),this.depthMask.set(!0)),d.clear(e)},Bb.prototype.setCullFace=function(a){!1===a.enable?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(a.mode),this.frontFace.set(a.frontFace))},Bb.prototype.setDepthMode=function(a){a.func!==this.gl.ALWAYS||a.mask?(this.depthTest.set(!0),this.depthFunc.set(a.func),this.depthMask.set(a.mask),this.depthRange.set(a.range)):this.depthTest.set(!1)},Bb.prototype.setStencilMode=function(a){a.test.func!==this.gl.ALWAYS||a.mask?(this.stencilTest.set(!0),this.stencilMask.set(a.mask),this.stencilOp.set([a.fail,a.depthFail,a.pass]),this.stencilFunc.set({func:a.test.func,ref:a.ref,mask:a.test.mask})):this.stencilTest.set(!1)},Bb.prototype.setColorMode=function(b){a.isEqual(b.blendFunction,zb.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(b.blendFunction),this.blendColor.set(b.blendColor)),this.colorMask.set(b.mask)},Bb.prototype.unbindVAO=function(){this.extVertexArrayObject&&this.bindVertexArrayOES.set(null)};var Cb=function(b){function c(c,d,e){var f=this;b.call(this),this.id=c,this.dispatcher=e,this.on("data",function(a){"source"===a.dataType&&"metadata"===a.sourceDataType&&(f._sourceLoaded=!0),f._sourceLoaded&&!f._paused&&"source"===a.dataType&&"content"===a.sourceDataType&&(f.reload(),f.transform&&f.update(f.transform))}),this.on("error",function(){f._sourceErrored=!0}),this._source=Ka(c,d,e,this),this._tiles={},this._cache=new La(0,this._unloadTile.bind(this)),this._timers={},this._cacheTimers={},this._maxTileCacheSize=null,this._coveredTiles={},this._state=new a.SourceFeatureState}return b&&(c.__proto__=b),c.prototype=Object.create(b&&b.prototype),c.prototype.constructor=c,c.prototype.onAdd=function(a){this.map=a,this._maxTileCacheSize=a?a._maxTileCacheSize:null,this._source&&this._source.onAdd&&this._source.onAdd(a)},c.prototype.onRemove=function(a){this._source&&this._source.onRemove&&this._source.onRemove(a)},c.prototype.loaded=function(){if(this._sourceErrored)return!0;if(!this._sourceLoaded)return!1;for(var a in this._tiles){var b=this._tiles[a];if("loaded"!==b.state&&"errored"!==b.state)return!1}return!0},c.prototype.getSource=function(){return this._source},c.prototype.pause=function(){this._paused=!0},c.prototype.resume=function(){if(this._paused){var a=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,a&&this.reload(),this.transform&&this.update(this.transform)}},c.prototype._loadTile=function(a,b){return this._source.loadTile(a,b)},c.prototype._unloadTile=function(a){if(this._source.unloadTile)return this._source.unloadTile(a,function(){})},c.prototype._abortTile=function(a){if(this._source.abortTile)return this._source.abortTile(a,function(){})},c.prototype.serialize=function(){return this._source.serialize()},c.prototype.prepare=function(a){for(var b in this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null),this._tiles)this._tiles[b].upload(a)},c.prototype.getIds=function(){return Object.keys(this._tiles).map(Number).sort(j)},c.prototype.getRenderableIds=function(b){var c=this,d=[];for(var e in this._tiles)this._isIdRenderable(+e,b)&&d.push(+e);return b?d.sort(function(b,d){var e=c._tiles[b].tileID,f=c._tiles[d].tileID,g=new a.Point(e.canonical.x,e.canonical.y)._rotate(c.transform.angle),h=new a.Point(f.canonical.x,f.canonical.y)._rotate(c.transform.angle);return e.overscaledZ-f.overscaledZ||h.y-g.y||h.x-g.x}):d.sort(j)},c.prototype.hasRenderableParent=function(a){var b=this.findLoadedParent(a,0);return!!b&&this._isIdRenderable(b.tileID.key)},c.prototype._isIdRenderable=function(a,b){return this._tiles[a]&&this._tiles[a].hasData()&&!this._coveredTiles[a]&&(b||!this._tiles[a].holdingForFade())},c.prototype.reload=function(){if(this._paused)this._shouldReloadOnResume=!0;else for(var a in this._cache.reset(),this._tiles)"errored"!==this._tiles[a].state&&this._reloadTile(a,"reloading")},c.prototype._reloadTile=function(a,b){var c=this._tiles[a];c&&("loading"!==c.state&&(c.state=b),this._loadTile(c,this._tileLoaded.bind(this,c,a,b)))},c.prototype._tileLoaded=function(b,c,d,e){if(e)return b.state="errored",void(404!==e.status?this._source.fire(new a.ErrorEvent(e,{tile:b})):this.update(this.transform));b.timeAdded=a.browser.now(),"expired"===d&&(b.refreshedUponExpiration=!0),this._setTileReloadTimer(c,b),"raster-dem"===this.getSource().type&&b.dem&&this._backfillDEM(b),this._state.initializeTileState(b,this.map?this.map.painter:null),this._source.fire(new a.Event("data",{dataType:"source",tile:b,coord:b.tileID}))},c.prototype._backfillDEM=function(a){function b(a,b){a.needsHillshadePrepare=!0;var c=b.tileID.canonical.x-a.tileID.canonical.x,d=b.tileID.canonical.y-a.tileID.canonical.y,e=Math.pow(2,a.tileID.canonical.z),f=b.tileID.key;0===c&&0===d||Math.abs(d)>1||(Math.abs(c)>1&&(1===Math.abs(c+e)?c+=e:1===Math.abs(c-e)&&(c-=e)),b.dem&&a.dem&&(a.dem.backfillBorder(b.dem,c,d),a.neighboringTiles&&a.neighboringTiles[f]&&(a.neighboringTiles[f].backfilled=!0)))}for(var c=this.getRenderableIds(),d=0;d<c.length;d++){var e=c[d];if(a.neighboringTiles&&a.neighboringTiles[e]){var f=this.getTileByID(e);b(a,f),b(f,a)}}},c.prototype.getTile=function(a){return this.getTileByID(a.key)},c.prototype.getTileByID=function(a){return this._tiles[a]},c.prototype.getZoom=function(a){return a.zoom+a.scaleZoom(a.tileSize/this._source.tileSize)},c.prototype._retainLoadedChildren=function(a,b,c,d){for(var e in this._tiles){var f=this._tiles[e];if(!(d[e]||!f.hasData()||f.tileID.overscaledZ<=b||f.tileID.overscaledZ>c)){for(var g=f.tileID;f&&f.tileID.overscaledZ>b+1;){var h=f.tileID.scaledTo(f.tileID.overscaledZ-1);(f=this._tiles[h.key])&&f.hasData()&&(g=h)}for(var i=g;i.overscaledZ>b;)if(a[(i=i.scaledTo(i.overscaledZ-1)).key]){d[g.key]=g;break}}}},c.prototype.findLoadedParent=function(a,b){for(var c=a.overscaledZ-1;c>=b;c--){var d=a.scaledTo(c);if(!d)return;var e=String(d.key),f=this._tiles[e];if(f&&f.hasData())return f;if(this._cache.has(d))return this._cache.get(d)}},c.prototype.updateCacheSize=function(a){var b=(Math.ceil(a.width/this._source.tileSize)+1)*(Math.ceil(a.height/this._source.tileSize)+1),c=Math.floor(5*b),d="number"==typeof this._maxTileCacheSize?Math.min(this._maxTileCacheSize,c):c;this._cache.setMaxSize(d)},c.prototype.handleWrapJump=function(a){var b=(a-(void 0===this._prevLng?a:this._prevLng))/360,c=Math.round(b);if(this._prevLng=a,c){var d={};for(var e in this._tiles){var f=this._tiles[e];f.tileID=f.tileID.unwrapTo(f.tileID.wrap+c),d[f.tileID.key]=f}for(var g in this._tiles=d,this._timers)clearTimeout(this._timers[g]),delete this._timers[g];for(var h in this._tiles){var i=this._tiles[h];this._setTileReloadTimer(h,i)}}},c.prototype.update=function(b){var d=this;if(this.transform=b,this._sourceLoaded&&!this._paused){var e;this.updateCacheSize(b),this.handleWrapJump(this.transform.center.lng),this._coveredTiles={},this.used?this._source.tileID?e=b.getVisibleUnwrappedCoordinates(this._source.tileID).map(function(b){return new a.OverscaledTileID(b.canonical.z,b.wrap,b.canonical.z,b.canonical.x,b.canonical.y)}):(e=b.coveringTiles({tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled}),this._source.hasTile&&(e=e.filter(function(a){return d._source.hasTile(a)}))):e=[];var f=(this._source.roundZoom?Math.round:Math.floor)(this.getZoom(b)),g=Math.max(f-c.maxOverzooming,this._source.minzoom),h=Math.max(f+c.maxUnderzooming,this._source.minzoom),i=this._updateRetainedTiles(e,f);if(k(this._source.type)){for(var j={},l={},m=0,n=Object.keys(i);m<n.length;m+=1){var o=n[m],p=i[o],q=this._tiles[o];if(q&&!(q.fadeEndTime&&q.fadeEndTime<=a.browser.now())){var r=this.findLoadedParent(p,g);r&&(this._addTile(r.tileID),j[r.tileID.key]=r.tileID),l[o]=p}}for(var s in this._retainLoadedChildren(l,f,h,i),j)i[s]||(this._coveredTiles[s]=!0,i[s]=j[s])}for(var t in i)this._tiles[t].clearFadeHold();for(var u=0,v=a.keysDifference(this._tiles,i);u<v.length;u+=1){var w=v[u],x=this._tiles[w];x.hasSymbolBuckets&&!x.holdingForFade()?x.setHoldDuration(this.map._fadeDuration):x.hasSymbolBuckets&&!x.symbolFadeFinished()||this._removeTile(w)}}},c.prototype.releaseSymbolFadeTiles=function(){for(var a in this._tiles)this._tiles[a].holdingForFade()&&this._removeTile(a)},c.prototype._updateRetainedTiles=function(a,b){for(var d={},e={},f=Math.max(b-c.maxOverzooming,this._source.minzoom),g=Math.max(b+c.maxUnderzooming,this._source.minzoom),h={},i=0,j=a;i<j.length;i+=1){var k=j[i],l=this._addTile(k);d[k.key]=k,l.hasData()||b<this._source.maxzoom&&(h[k.key]=k)}this._retainLoadedChildren(h,b,g,d);for(var m=0,n=a;m<n.length;m+=1){var o=n[m],p=this._tiles[o.key];if(!p.hasData()){if(b+1>this._source.maxzoom){var q=o.children(this._source.maxzoom)[0],r=this.getTile(q);if(r&&r.hasData()){d[q.key]=q;continue}}else{var s=o.children(this._source.maxzoom);if(d[s[0].key]&&d[s[1].key]&&d[s[2].key]&&d[s[3].key])continue}for(var t=p.wasRequested(),u=o.overscaledZ-1;u>=f;--u){var v=o.scaledTo(u);if(e[v.key])break;if(e[v.key]=!0,!(p=this.getTile(v))&&t&&(p=this._addTile(v)),p&&(d[v.key]=v,t=p.wasRequested(),p.hasData()))break}}}return d},c.prototype._addTile=function(b){var c=this._tiles[b.key];if(c)return c;(c=this._cache.getAndRemove(b))&&(this._setTileReloadTimer(b.key,c),c.tileID=b,this._state.initializeTileState(c,this.map?this.map.painter:null),this._cacheTimers[b.key]&&(clearTimeout(this._cacheTimers[b.key]),delete this._cacheTimers[b.key],this._setTileReloadTimer(b.key,c)));var d=Boolean(c);return d||(c=new a.Tile(b,this._source.tileSize*b.overscaleFactor()),this._loadTile(c,this._tileLoaded.bind(this,c,b.key,c.state))),c?(c.uses++,this._tiles[b.key]=c,d||this._source.fire(new a.Event("dataloading",{tile:c,coord:c.tileID,dataType:"source"})),c):null},c.prototype._setTileReloadTimer=function(a,b){var c=this;a in this._timers&&(clearTimeout(this._timers[a]),delete this._timers[a]);var d=b.getExpiryTimeout();d&&(this._timers[a]=setTimeout(function(){c._reloadTile(a,"expired"),delete c._timers[a]},d))},c.prototype._removeTile=function(a){var b=this._tiles[a];b&&(b.uses--,delete this._tiles[a],this._timers[a]&&(clearTimeout(this._timers[a]),delete this._timers[a]),b.uses>0||(b.hasData()?this._cache.add(b.tileID,b,b.getExpiryTimeout()):(b.aborted=!0,this._abortTile(b),this._unloadTile(b))))},c.prototype.clearTiles=function(){for(var a in this._shouldReloadOnResume=!1,this._paused=!1,this._tiles)this._removeTile(a);this._cache.reset()},c.prototype.tilesIn=function(b,c,d){var e=this,f=[],g=this.transform;if(!g)return f;for(var h=d?g.getCameraQueryGeometry(b):b,i=b.map(function(a){return g.pointCoordinate(a)}),j=h.map(function(a){return g.pointCoordinate(a)}),k=this.getIds(),l=1/0,m=1/0,n=-1/0,o=-1/0,p=0,q=j;p<q.length;p+=1){var r=q[p];l=Math.min(l,r.x),m=Math.min(m,r.y),n=Math.max(n,r.x),o=Math.max(o,r.y)}for(var s=0;s<k.length;s++)!function(b){var d=e._tiles[k[b]];if(!d.holdingForFade()){var h=d.tileID,p=Math.pow(2,g.zoom-d.tileID.overscaledZ),q=c*d.queryPadding*a.EXTENT/d.tileSize/p,r=[h.getTilePoint(new a.MercatorCoordinate(l,m)),h.getTilePoint(new a.MercatorCoordinate(n,o))];if(r[0].x-q<a.EXTENT&&r[0].y-q<a.EXTENT&&r[1].x+q>=0&&r[1].y+q>=0){var s=i.map(function(a){return h.getTilePoint(a)}),t=j.map(function(a){return h.getTilePoint(a)});f.push({tile:d,tileID:h,queryGeometry:s,cameraQueryGeometry:t,scale:p})}}}(s);return f},c.prototype.getVisibleCoordinates=function(a){for(var b=this,c=this.getRenderableIds(a).map(function(a){return b._tiles[a].tileID}),d=0,e=c;d<e.length;d+=1){var f=e[d];f.posMatrix=this.transform.calculatePosMatrix(f.toUnwrapped())}return c},c.prototype.hasTransition=function(){if(this._source.hasTransition())return!0;if(k(this._source.type))for(var b in this._tiles){var c=this._tiles[b];if(void 0!==c.fadeEndTime&&c.fadeEndTime>=a.browser.now())return!0}return!1},c.prototype.setFeatureState=function(a,b,c){a=a||"_geojsonTileLayer",this._state.updateState(a,b,c)},c.prototype.removeFeatureState=function(a,b,c){a=a||"_geojsonTileLayer",this._state.removeFeatureState(a,b,c)},c.prototype.getFeatureState=function(a,b){return a=a||"_geojsonTileLayer",this._state.getState(a,b)},c}(a.Evented);Cb.maxOverzooming=10,Cb.maxUnderzooming=3;var Db=function(){this.active={}};Db.prototype.acquire=function(a){if(!this.workers)for(this.workers=[];this.workers.length<Db.workerCount;)this.workers.push(new l);return this.active[a]=!0,this.workers.slice()},Db.prototype.release=function(a){delete this.active[a],0===Object.keys(this.active).length&&(this.workers.forEach(function(a){a.terminate()}),this.workers=null)};var Eb,Fb=Math.floor(a.browser.hardwareConcurrency/2);Db.workerCount=Math.max(Math.min(Fb,6),1);var Gb={setStyle:"setStyle",addLayer:"addLayer",removeLayer:"removeLayer",setPaintProperty:"setPaintProperty",setLayoutProperty:"setLayoutProperty",setFilter:"setFilter",addSource:"addSource",removeSource:"removeSource",setGeoJSONSourceData:"setGeoJSONSourceData",setLayerZoomRange:"setLayerZoomRange",setLayerProperty:"setLayerProperty",setCenter:"setCenter",setZoom:"setZoom",setBearing:"setBearing",setPitch:"setPitch",setSprite:"setSprite",setGlyphs:"setGlyphs",setTransition:"setTransition",setLight:"setLight"},Hb=function(a,b,c){var d=this.boxCells=[],e=this.circleCells=[];this.xCellCount=Math.ceil(a/c),this.yCellCount=Math.ceil(b/c);for(var f=0;f<this.xCellCount*this.yCellCount;f++)d.push([]),e.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=a,this.height=b,this.xScale=this.xCellCount/a,this.yScale=this.yCellCount/b,this.boxUid=0,this.circleUid=0};Hb.prototype.keysLength=function(){return this.boxKeys.length+this.circleKeys.length},Hb.prototype.insert=function(a,b,c,d,e){this._forEachCell(b,c,d,e,this._insertBoxCell,this.boxUid++),this.boxKeys.push(a),this.bboxes.push(b),this.bboxes.push(c),this.bboxes.push(d),this.bboxes.push(e)},Hb.prototype.insertCircle=function(a,b,c,d){this._forEachCell(b-d,c-d,b+d,c+d,this._insertCircleCell,this.circleUid++),this.circleKeys.push(a),this.circles.push(b),this.circles.push(c),this.circles.push(d)},Hb.prototype._insertBoxCell=function(a,b,c,d,e,f){this.boxCells[e].push(f)},Hb.prototype._insertCircleCell=function(a,b,c,d,e,f){this.circleCells[e].push(f)},Hb.prototype._query=function(a,b,c,d,e,f){if(c<0||a>this.width||d<0||b>this.height)return!e&&[];var g=[];if(a<=0&&b<=0&&this.width<=c&&this.height<=d){if(e)return!0;for(var h=0;h<this.boxKeys.length;h++)g.push({key:this.boxKeys[h],x1:this.bboxes[4*h],y1:this.bboxes[4*h+1],x2:this.bboxes[4*h+2],y2:this.bboxes[4*h+3]});for(var i=0;i<this.circleKeys.length;i++){var j=this.circles[3*i],k=this.circles[3*i+1],l=this.circles[3*i+2];g.push({key:this.circleKeys[i],x1:j-l,y1:k-l,x2:j+l,y2:k+l})}return f?g.filter(f):g}var m={hitTest:e,seenUids:{box:{},circle:{}}};return this._forEachCell(a,b,c,d,this._queryCell,g,m,f),e?g.length>0:g},Hb.prototype._queryCircle=function(a,b,c,d,e){var f=a-c,g=a+c,h=b-c,i=b+c;if(g<0||f>this.width||i<0||h>this.height)return!d&&[];var j=[],k={hitTest:d,circle:{x:a,y:b,radius:c},seenUids:{box:{},circle:{}}};return this._forEachCell(f,h,g,i,this._queryCellCircle,j,k,e),d?j.length>0:j},Hb.prototype.query=function(a,b,c,d,e){return this._query(a,b,c,d,!1,e)},Hb.prototype.hitTest=function(a,b,c,d,e){return this._query(a,b,c,d,!0,e)},Hb.prototype.hitTestCircle=function(a,b,c,d){return this._queryCircle(a,b,c,!0,d)},Hb.prototype._queryCell=function(a,b,c,d,e,f,g,h){var i=g.seenUids,j=this.boxCells[e];if(null!==j)for(var k=this.bboxes,l=0,m=j;l<m.length;l+=1){var n=m[l];if(!i.box[n]){i.box[n]=!0;var o=4*n;if(a<=k[o+2]&&b<=k[o+3]&&c>=k[o+0]&&d>=k[o+1]&&(!h||h(this.boxKeys[n]))){if(g.hitTest)return f.push(!0),!0;f.push({key:this.boxKeys[n],x1:k[o],y1:k[o+1],x2:k[o+2],y2:k[o+3]})}}}var p=this.circleCells[e];if(null!==p)for(var q=this.circles,r=0,s=p;r<s.length;r+=1){var t=s[r];if(!i.circle[t]){i.circle[t]=!0;var u=3*t;if(this._circleAndRectCollide(q[u],q[u+1],q[u+2],a,b,c,d)&&(!h||h(this.circleKeys[t]))){if(g.hitTest)return f.push(!0),!0;var v=q[u],w=q[u+1],x=q[u+2];f.push({key:this.circleKeys[t],x1:v-x,y1:w-x,x2:v+x,y2:w+x})}}}},Hb.prototype._queryCellCircle=function(a,b,c,d,e,f,g,h){var i=g.circle,j=g.seenUids,k=this.boxCells[e];if(null!==k)for(var l=this.bboxes,m=0,n=k;m<n.length;m+=1){var o=n[m];if(!j.box[o]){j.box[o]=!0;var p=4*o;if(this._circleAndRectCollide(i.x,i.y,i.radius,l[p+0],l[p+1],l[p+2],l[p+3])&&(!h||h(this.boxKeys[o])))return f.push(!0),!0}}var q=this.circleCells[e];if(null!==q)for(var r=this.circles,s=0,t=q;s<t.length;s+=1){var u=t[s];if(!j.circle[u]){j.circle[u]=!0;var v=3*u;if(this._circlesCollide(r[v],r[v+1],r[v+2],i.x,i.y,i.radius)&&(!h||h(this.circleKeys[u])))return f.push(!0),!0}}},Hb.prototype._forEachCell=function(a,b,c,d,e,f,g,h){for(var i=this._convertToXCellCoord(a),j=this._convertToYCellCoord(b),k=this._convertToXCellCoord(c),l=this._convertToYCellCoord(d),m=i;m<=k;m++)for(var n=j;n<=l;n++){var o=this.xCellCount*n+m;if(e.call(this,a,b,c,d,o,f,g,h))return}},Hb.prototype._convertToXCellCoord=function(a){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(a*this.xScale)))},Hb.prototype._convertToYCellCoord=function(a){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(a*this.yScale)))},Hb.prototype._circlesCollide=function(a,b,c,d,e,f){var g=d-a,h=e-b,i=c+f;return i*i>g*g+h*h},Hb.prototype._circleAndRectCollide=function(a,b,c,d,e,f,g){var h=(f-d)/2,i=Math.abs(a-(d+h));if(i>h+c)return!1;var j=(g-e)/2,k=Math.abs(b-(e+j));if(k>j+c)return!1;if(i<=h||k<=j)return!0;var l=i-h,m=k-j;return l*l+m*m<=c*c};var Ib=a.properties.layout,Jb=new Float32Array([-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0]),Kb=function(a,b,c){void 0===b&&(b=new Hb(a.width+200,a.height+200,25)),void 0===c&&(c=new Hb(a.width+200,a.height+200,25)),this.transform=a,this.grid=b,this.ignoredGrid=c,this.pitchfactor=Math.cos(a._pitch)*a.cameraToCenterDistance,this.screenRightBoundary=a.width+100,this.screenBottomBoundary=a.height+100,this.gridRightBoundary=a.width+200,this.gridBottomBoundary=a.height+200};Kb.prototype.placeCollisionBox=function(a,b,c,d,e){var f=this.projectAndGetPerspectiveRatio(d,a.anchorPointX,a.anchorPointY),g=c*f.perspectiveRatio,h=a.x1*g+f.point.x,i=a.y1*g+f.point.y,j=a.x2*g+f.point.x,k=a.y2*g+f.point.y;return!this.isInsideGrid(h,i,j,k)||!b&&this.grid.hitTest(h,i,j,k,e)?{box:[],offscreen:!1}:{box:[h,i,j,k],offscreen:this.isOffscreen(h,i,j,k)}},Kb.prototype.approximateTileDistance=function(a,b,c,d,e){var f=e?1:d/this.pitchfactor,g=a.lastSegmentViewportDistance*c;return a.prevTileDistance+g+(f-1)*g*Math.abs(Math.sin(b))},Kb.prototype.placeCollisionCircles=function(b,c,d,e,f,g,h,i,j,k,l,m,n){var o=[],p=this.projectAnchor(j,f.anchorX,f.anchorY),q=i/24,r=f.lineOffsetX*i,s=f.lineOffsetY*i,t=new a.Point(f.anchorX,f.anchorY),u=B(q,h,r,s,!1,y(t,k).point,t,f,g,k,{},!0),v=!1,w=!1,x=!0,z=p.perspectiveRatio*e,A=1/(e*d),C=0,D=0;u&&(C=this.approximateTileDistance(u.first.tileDistance,u.first.angle,A,p.cameraDistance,m),D=this.approximateTileDistance(u.last.tileDistance,u.last.angle,A,p.cameraDistance,m));for(var E=0;E<b.length;E+=5){var F=b[E],G=b[E+1],H=b[E+2],J=b[E+3];if(!u||J<-C||J>D)I(b,E,!1);else{var K=this.projectPoint(j,F,G),L=H*z;if(o.length>0){var M=K.x-o[o.length-4],N=K.y-o[o.length-3];if(L*L*2>M*M+N*N&&E+8<b.length){var O=b[E+8];if(O>-C&&O<D){I(b,E,!1);continue}}}var P=E/5;o.push(K.x,K.y,L,P),I(b,E,!0);var Q=K.x-L,R=K.y-L,S=K.x+L,T=K.y+L;if(x=x&&this.isOffscreen(Q,R,S,T),w=w||this.isInsideGrid(Q,R,S,T),!c&&this.grid.hitTestCircle(K.x,K.y,L,n)){if(!l)return{circles:[],offscreen:!1};v=!0}}}return{circles:v||!w?[]:o,offscreen:x}},Kb.prototype.queryRenderedSymbols=function(b){if(0===b.length||0===this.grid.keysLength()&&0===this.ignoredGrid.keysLength())return{};for(var c=[],d=1/0,e=1/0,f=-1/0,g=-1/0,h=0,i=b;h<i.length;h+=1){var j=i[h],k=new a.Point(j.x+100,j.y+100);d=Math.min(d,k.x),e=Math.min(e,k.y),f=Math.max(f,k.x),g=Math.max(g,k.y),c.push(k)}for(var l={},m={},n=0,o=this.grid.query(d,e,f,g).concat(this.ignoredGrid.query(d,e,f,g));n<o.length;n+=1){var p=o[n],q=p.key;if(void 0===l[q.bucketInstanceId]&&(l[q.bucketInstanceId]={}),!l[q.bucketInstanceId][q.featureIndex]){var r=[new a.Point(p.x1,p.y1),new a.Point(p.x2,p.y1),new a.Point(p.x2,p.y2),new a.Point(p.x1,p.y2)];a.polygonIntersectsPolygon(c,r)&&(l[q.bucketInstanceId][q.featureIndex]=!0,void 0===m[q.bucketInstanceId]&&(m[q.bucketInstanceId]=[]),m[q.bucketInstanceId].push(q.featureIndex))}}return m},Kb.prototype.insertCollisionBox=function(a,b,c,d,e){var f={bucketInstanceId:c,featureIndex:d,collisionGroupID:e};(b?this.ignoredGrid:this.grid).insert(f,a[0],a[1],a[2],a[3])},Kb.prototype.insertCollisionCircles=function(a,b,c,d,e){for(var f=b?this.ignoredGrid:this.grid,g={bucketInstanceId:c,featureIndex:d,collisionGroupID:e},h=0;h<a.length;h+=4)f.insertCircle(g,a[h],a[h+1],a[h+2])},Kb.prototype.projectAnchor=function(a,b,c){var d=[b,c,0,1];return H(d,d,a),{perspectiveRatio:.5+this.transform.cameraToCenterDistance/d[3]*.5,cameraDistance:d[3]}},Kb.prototype.projectPoint=function(b,c,d){var e=[c,d,0,1];return H(e,e,b),new a.Point((e[0]/e[3]+1)/2*this.transform.width+100,(-e[1]/e[3]+1)/2*this.transform.height+100)},Kb.prototype.projectAndGetPerspectiveRatio=function(b,c,d){var e=[c,d,0,1];return H(e,e,b),{point:new a.Point((e[0]/e[3]+1)/2*this.transform.width+100,(-e[1]/e[3]+1)/2*this.transform.height+100),perspectiveRatio:.5+this.transform.cameraToCenterDistance/e[3]*.5}},Kb.prototype.isOffscreen=function(a,b,c,d){return c<100||a>=this.screenRightBoundary||d<100||b>this.screenBottomBoundary},Kb.prototype.isInsideGrid=function(a,b,c,d){return c>=0&&a<this.gridRightBoundary&&d>=0&&b<this.gridBottomBoundary};var Lb=function(a,b,c,d){this.opacity=a?Math.max(0,Math.min(1,a.opacity+(a.placed?b:-b))):d&&c?1:0,this.placed=c};Lb.prototype.isHidden=function(){return 0===this.opacity&&!this.placed};var Mb=function(a,b,c,d,e){this.text=new Lb(a?a.text:null,b,c,e),this.icon=new Lb(a?a.icon:null,b,d,e)};Mb.prototype.isHidden=function(){return this.text.isHidden()&&this.icon.isHidden()};var Nb=function(a,b,c){this.text=a,this.icon=b,this.skipFade=c},Ob=function(a,b,c,d,e){this.bucketInstanceId=a,this.featureIndex=b,this.sourceLayerIndex=c,this.bucketIndex=d,this.tileID=e},Pb=function(a){this.crossSourceCollisions=a,this.maxGroupID=0,this.collisionGroups={}};Pb.prototype.get=function(a){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[a]){var b=++this.maxGroupID;this.collisionGroups[a]={ID:b,predicate:function(a){return a.collisionGroupID===b}}}return this.collisionGroups[a]};var Qb=function(a,b,c){this.transform=a.clone(),this.collisionIndex=new Kb(this.transform),this.placements={},this.opacities={},this.stale=!1,this.commitTime=0,this.fadeDuration=b,this.retainedQueryData={},this.collisionGroups=new Pb(c)};Qb.prototype.placeLayerTile=function(b,c,d,e){var f=c.getBucket(b),g=c.latestFeatureIndex;if(f&&g&&b.id===f.layerIds[0]){var h=c.collisionBoxArray,i=f.layers[0].layout,j=Math.pow(2,this.transform.zoom-c.tileID.overscaledZ),k=c.tileSize/a.EXTENT,l=this.transform.calculatePosMatrix(c.tileID.toUnwrapped()),m=w(l,"map"===i.get("text-pitch-alignment"),"map"===i.get("text-rotation-alignment"),this.transform,J(c,1,this.transform.zoom)),n=w(l,"map"===i.get("icon-pitch-alignment"),"map"===i.get("icon-rotation-alignment"),this.transform,J(c,1,this.transform.zoom));this.retainedQueryData[f.bucketInstanceId]=new Ob(f.bucketInstanceId,g,f.sourceLayerIndex,f.index,c.tileID),this.placeLayerBucket(f,l,m,n,j,k,d,c.holdingForFade(),e,h)}},Qb.prototype.placeLayerBucket=function(b,c,d,e,f,g,h,i,j,k){var l=b.layers[0].layout,m=a.evaluateSizeForZoom(b.textSizeData,this.transform.zoom,a.properties.layout.properties["text-size"]),n=l.get("text-optional"),o=l.get("icon-optional"),p=l.get("text-allow-overlap"),q=l.get("icon-allow-overlap"),r=p&&(q||!b.hasIconData()||o),s=q&&(p||!b.hasTextData()||n),t=this.collisionGroups.get(b.sourceID);!b.collisionArrays&&k&&b.deserializeCollisionBoxes(k);for(var u=0;u<b.symbolInstances.length;u++){var v=b.symbolInstances.get(u);if(!j[v.crossTileID]){if(i){this.placements[v.crossTileID]=new Nb(!1,!1,!1);continue}var w=!1,x=!1,y=!0,z=null,A=null,B=null,C=0,D=0,E=b.collisionArrays[u];E.textFeatureIndex&&(C=E.textFeatureIndex),E.textBox&&(w=(z=this.collisionIndex.placeCollisionBox(E.textBox,l.get("text-allow-overlap"),g,c,t.predicate)).box.length>0,y=y&&z.offscreen);var F=E.textCircles;if(F){var G=b.text.placedSymbolArray.get(v.horizontalPlacedTextSymbolIndex),H=a.evaluateSizeForFeature(b.textSizeData,m,G);A=this.collisionIndex.placeCollisionCircles(F,l.get("text-allow-overlap"),f,g,G,b.lineVertexArray,b.glyphOffsetArray,H,c,d,h,"map"===l.get("text-pitch-alignment"),t.predicate),w=l.get("text-allow-overlap")||A.circles.length>0,y=y&&A.offscreen}E.iconFeatureIndex&&(D=E.iconFeatureIndex),E.iconBox&&(x=(B=this.collisionIndex.placeCollisionBox(E.iconBox,l.get("icon-allow-overlap"),g,c,t.predicate)).box.length>0,y=y&&B.offscreen);var I=n||0===v.numGlyphVertices&&0===v.numVerticalGlyphVertices,J=o||0===v.numIconVertices;I||J?J?I||(x=x&&w):w=x&&w:x=w=x&&w,w&&z&&this.collisionIndex.insertCollisionBox(z.box,l.get("text-ignore-placement"),b.bucketInstanceId,C,t.ID),x&&B&&this.collisionIndex.insertCollisionBox(B.box,l.get("icon-ignore-placement"),b.bucketInstanceId,D,t.ID),w&&A&&this.collisionIndex.insertCollisionCircles(A.circles,l.get("text-ignore-placement"),b.bucketInstanceId,C,t.ID),this.placements[v.crossTileID]=new Nb(w||r,x||s,y||b.justReloaded),j[v.crossTileID]=!0}}b.justReloaded=!1},Qb.prototype.commit=function(a,b){this.commitTime=b;var c=!1,d=a&&0!==this.fadeDuration?(this.commitTime-a.commitTime)/this.fadeDuration:1,e=a?a.opacities:{};for(var f in this.placements){var g=this.placements[f],h=e[f];h?(this.opacities[f]=new Mb(h,d,g.text,g.icon),c=c||g.text!==h.text.placed||g.icon!==h.icon.placed):(this.opacities[f]=new Mb(null,d,g.text,g.icon,g.skipFade),c=c||g.text||g.icon)}for(var i in e){var j=e[i];if(!this.opacities[i]){var k=new Mb(j,d,!1,!1);k.isHidden()||(this.opacities[i]=k,c=c||j.text.placed||j.icon.placed)}}c?this.lastPlacementChangeTime=b:"number"!=typeof this.lastPlacementChangeTime&&(this.lastPlacementChangeTime=a?a.lastPlacementChangeTime:b)},Qb.prototype.updateLayerOpacities=function(a,b){for(var c={},d=0,e=b;d<e.length;d+=1){var f=e[d],g=f.getBucket(a);g&&f.latestFeatureIndex&&a.id===g.layerIds[0]&&this.updateBucketOpacities(g,c,f.collisionBoxArray)}},Qb.prototype.updateBucketOpacities=function(a,b,c){a.hasTextData()&&a.text.opacityVertexArray.clear(),a.hasIconData()&&a.icon.opacityVertexArray.clear(),a.hasCollisionBoxData()&&a.collisionBox.collisionVertexArray.clear(),a.hasCollisionCircleData()&&a.collisionCircle.collisionVertexArray.clear();var d=a.layers[0].layout,e=new Mb(null,0,!1,!1,!0),f=d.get("text-allow-overlap"),g=d.get("icon-allow-overlap"),h=new Mb(null,0,f&&(g||!a.hasIconData()||d.get("icon-optional")),g&&(f||!a.hasTextData()||d.get("text-optional")),!0);!a.collisionArrays&&c&&(a.hasCollisionBoxData()||a.hasCollisionCircleData())&&a.deserializeCollisionBoxes(c);for(var i=0;i<a.symbolInstances.length;i++){var j=a.symbolInstances.get(i),k=b[j.crossTileID],l=this.opacities[j.crossTileID];k?l=e:l||(l=h,this.opacities[j.crossTileID]=l),b[j.crossTileID]=!0;var m=j.numGlyphVertices>0||j.numVerticalGlyphVertices>0,n=j.numIconVertices>0;if(m){
for(var o=L(l.text),p=(j.numGlyphVertices+j.numVerticalGlyphVertices)/4,q=0;q<p;q++)a.text.opacityVertexArray.emplaceBack(o);a.text.placedSymbolArray.get(j.horizontalPlacedTextSymbolIndex).hidden=l.text.isHidden(),j.verticalPlacedTextSymbolIndex>=0&&(a.text.placedSymbolArray.get(j.verticalPlacedTextSymbolIndex).hidden=l.text.isHidden())}if(n){for(var r=L(l.icon),s=0;s<j.numIconVertices/4;s++)a.icon.opacityVertexArray.emplaceBack(r);a.icon.placedSymbolArray.get(i).hidden=l.icon.isHidden()}if(a.hasCollisionBoxData()||a.hasCollisionCircleData()){var t=a.collisionArrays[i];if(t){t.textBox&&K(a.collisionBox.collisionVertexArray,l.text.placed,!1),t.iconBox&&K(a.collisionBox.collisionVertexArray,l.icon.placed,!1);var u=t.textCircles;if(u&&a.hasCollisionCircleData())for(var v=0;v<u.length;v+=5){var w=k||0===u[v+4];K(a.collisionCircle.collisionVertexArray,l.text.placed,w)}}}}a.sortFeatures(this.transform.angle),this.retainedQueryData[a.bucketInstanceId]&&(this.retainedQueryData[a.bucketInstanceId].featureSortOrder=a.featureSortOrder),a.hasTextData()&&a.text.opacityVertexBuffer&&a.text.opacityVertexBuffer.updateData(a.text.opacityVertexArray),a.hasIconData()&&a.icon.opacityVertexBuffer&&a.icon.opacityVertexBuffer.updateData(a.icon.opacityVertexArray),a.hasCollisionBoxData()&&a.collisionBox.collisionVertexBuffer&&a.collisionBox.collisionVertexBuffer.updateData(a.collisionBox.collisionVertexArray),a.hasCollisionCircleData()&&a.collisionCircle.collisionVertexBuffer&&a.collisionCircle.collisionVertexBuffer.updateData(a.collisionCircle.collisionVertexArray)},Qb.prototype.symbolFadeChange=function(a){return 0===this.fadeDuration?1:(a-this.commitTime)/this.fadeDuration},Qb.prototype.hasTransitions=function(a){return this.stale||a-this.lastPlacementChangeTime<this.fadeDuration},Qb.prototype.stillRecent=function(a){return this.commitTime+this.fadeDuration>a},Qb.prototype.setStale=function(){this.stale=!0};var Rb=Math.pow(2,25),Sb=Math.pow(2,24),Tb=Math.pow(2,17),Ub=Math.pow(2,16),Vb=Math.pow(2,9),Wb=Math.pow(2,8),Xb=Math.pow(2,1),Yb=function(){this._currentTileIndex=0,this._seenCrossTileIDs={}};Yb.prototype.continuePlacement=function(a,b,c,d,e){for(;this._currentTileIndex<a.length;){var f=a[this._currentTileIndex];if(b.placeLayerTile(d,f,c,this._seenCrossTileIDs),this._currentTileIndex++,e())return!0}};var Zb=function(a,b,c,d,e,f){this.placement=new Qb(a,e,f),this._currentPlacementIndex=b.length-1,this._forceFullPlacement=c,this._showCollisionBoxes=d,this._done=!1};Zb.prototype.isDone=function(){return this._done},Zb.prototype.continuePlacement=function(b,c,d){for(var e=this,f=a.browser.now(),g=function(){var b=a.browser.now()-f;return!e._forceFullPlacement&&b>2};this._currentPlacementIndex>=0;){var h=c[b[this._currentPlacementIndex]],i=this.placement.collisionIndex.transform.zoom;if("symbol"===h.type&&(!h.minzoom||h.minzoom<=i)&&(!h.maxzoom||h.maxzoom>i)){if(this._inProgressLayer||(this._inProgressLayer=new Yb),this._inProgressLayer.continuePlacement(d[h.source],this.placement,this._showCollisionBoxes,h,g))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0},Zb.prototype.commit=function(a,b){return this.placement.commit(a,b),this.placement};var $b=512/a.EXTENT/2,_b=function(a,b,c){this.tileID=a,this.indexedSymbolInstances={},this.bucketInstanceId=c;for(var d=0;d<b.length;d++){var e=b.get(d),f=e.key;this.indexedSymbolInstances[f]||(this.indexedSymbolInstances[f]=[]),this.indexedSymbolInstances[f].push({crossTileID:e.crossTileID,coord:this.getScaledCoordinates(e,a)})}};_b.prototype.getScaledCoordinates=function(b,c){var d=c.canonical.z-this.tileID.canonical.z,e=$b/Math.pow(2,d);return{x:Math.floor((c.canonical.x*a.EXTENT+b.anchorX)*e),y:Math.floor((c.canonical.y*a.EXTENT+b.anchorY)*e)}},_b.prototype.findMatches=function(a,b,c){for(var d=this.tileID.canonical.z<b.canonical.z?1:Math.pow(2,this.tileID.canonical.z-b.canonical.z),e=0;e<a.length;e++){var f=a.get(e);if(!f.crossTileID){var g=this.indexedSymbolInstances[f.key];if(g)for(var h=this.getScaledCoordinates(f,b),i=0,j=g;i<j.length;i+=1){var k=j[i];if(Math.abs(k.coord.x-h.x)<=d&&Math.abs(k.coord.y-h.y)<=d&&!c[k.crossTileID]){c[k.crossTileID]=!0,f.crossTileID=k.crossTileID;break}}}}};var ac=function(){this.maxCrossTileID=0};ac.prototype.generate=function(){return++this.maxCrossTileID};var bc=function(){this.indexes={},this.usedCrossTileIDs={},this.lng=0};bc.prototype.handleWrapJump=function(a){var b=Math.round((a-this.lng)/360);if(0!==b)for(var c in this.indexes){var d=this.indexes[c],e={};for(var f in d){var g=d[f];g.tileID=g.tileID.unwrapTo(g.tileID.wrap+b),e[g.tileID.key]=g}this.indexes[c]=e}this.lng=a},bc.prototype.addBucket=function(a,b,c){if(this.indexes[a.overscaledZ]&&this.indexes[a.overscaledZ][a.key]){if(this.indexes[a.overscaledZ][a.key].bucketInstanceId===b.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(a.overscaledZ,this.indexes[a.overscaledZ][a.key])}for(var d=0;d<b.symbolInstances.length;d++)b.symbolInstances.get(d).crossTileID=0;this.usedCrossTileIDs[a.overscaledZ]||(this.usedCrossTileIDs[a.overscaledZ]={});var e=this.usedCrossTileIDs[a.overscaledZ];for(var f in this.indexes){var g=this.indexes[f];if(Number(f)>a.overscaledZ)for(var h in g){var i=g[h];i.tileID.isChildOf(a)&&i.findMatches(b.symbolInstances,a,e)}else{var j=g[a.scaledTo(Number(f)).key];j&&j.findMatches(b.symbolInstances,a,e)}}for(var k=0;k<b.symbolInstances.length;k++){var l=b.symbolInstances.get(k);l.crossTileID||(l.crossTileID=c.generate(),e[l.crossTileID]=!0)}return void 0===this.indexes[a.overscaledZ]&&(this.indexes[a.overscaledZ]={}),this.indexes[a.overscaledZ][a.key]=new _b(a,b.symbolInstances,b.bucketInstanceId),!0},bc.prototype.removeBucketCrossTileIDs=function(a,b){for(var c in b.indexedSymbolInstances)for(var d=0,e=b.indexedSymbolInstances[c];d<e.length;d+=1){var f=e[d];delete this.usedCrossTileIDs[a][f.crossTileID]}},bc.prototype.removeStaleBuckets=function(a){var b=!1;for(var c in this.indexes){var d=this.indexes[c];for(var e in d)a[d[e].bucketInstanceId]||(this.removeBucketCrossTileIDs(c,d[e]),delete d[e],b=!0)}return b};var cc=function(){this.layerIndexes={},this.crossTileIDs=new ac,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}};cc.prototype.addLayer=function(a,b,c){var d=this.layerIndexes[a.id];void 0===d&&(d=this.layerIndexes[a.id]=new bc);var e=!1,f={};d.handleWrapJump(c);for(var g=0,h=b;g<h.length;g+=1){var i=h[g],j=i.getBucket(a);j&&a.id===j.layerIds[0]&&(j.bucketInstanceId||(j.bucketInstanceId=++this.maxBucketInstanceId),d.addBucket(i.tileID,j,this.crossTileIDs)&&(e=!0),f[j.bucketInstanceId]=!0)}return d.removeStaleBuckets(f)&&(e=!0),e},cc.prototype.pruneUnusedLayers=function(a){var b={};for(var c in a.forEach(function(a){b[a]=!0}),this.layerIndexes)b[c]||delete this.layerIndexes[c]};var dc=function(b,c){return a.emitValidationErrors(b,c&&c.filter(function(a){return"source.canvas"!==a.identifier}))},ec=a.pick(Gb,["addLayer","removeLayer","setPaintProperty","setLayoutProperty","setFilter","addSource","removeSource","setLayerZoomRange","setLight","setTransition","setGeoJSONSourceData"]),fc=a.pick(Gb,["setCenter","setZoom","setBearing","setPitch"]),gc=function(b){function c(d,e){var f=this;void 0===e&&(e={}),b.call(this),this.map=d,this.dispatcher=new Ca((Eb||(Eb=new Db),Eb),this),this.imageManager=new ua,this.glyphManager=new xa(d._transformRequest,e.localIdeographFontFamily),this.lineAtlas=new Ba(256,512),this.crossTileSymbolIndex=new cc,this._layers={},this._order=[],this.sourceCaches={},this.zoomHistory=new a.ZoomHistory,this._loaded=!1,this._resetUpdates(),this.dispatcher.broadcast("setReferrer",a.getReferrer());var g=this;this._rtlTextPluginCallback=c.registerForPluginAvailability(function(a){for(var b in g.dispatcher.broadcast("loadRTLTextPlugin",a.pluginURL,a.completionCallback),g.sourceCaches)g.sourceCaches[b].reload()}),this.on("data",function(a){if("source"===a.dataType&&"metadata"===a.sourceDataType){var b=f.sourceCaches[a.sourceId];if(b){var c=b.getSource();if(c&&c.vectorLayerIds)for(var d in f._layers){var e=f._layers[d];e.source===c.id&&f._validateLayer(e)}}}})}return b&&(c.__proto__=b),c.prototype=Object.create(b&&b.prototype),c.prototype.constructor=c,c.prototype.loadURL=function(b,c){var d=this;void 0===c&&(c={}),this.fire(new a.Event("dataloading",{dataType:"style"}));var e="boolean"==typeof c.validate?c.validate:!a.isMapboxURL(b);b=a.normalizeStyleURL(b,c.accessToken);var f=this.map._transformRequest(b,a.ResourceType.Style);this._request=a.getJSON(f,function(b,c){d._request=null,b?d.fire(new a.ErrorEvent(b)):c&&d._load(c,e)})},c.prototype.loadJSON=function(b,c){var d=this;void 0===c&&(c={}),this.fire(new a.Event("dataloading",{dataType:"style"})),this._request=a.browser.frame(function(){d._request=null,d._load(b,!1!==c.validate)})},c.prototype._load=function(b,c){var d=this;if(!c||!dc(this,a.validateStyle(b))){for(var e in this._loaded=!0,this.stylesheet=b,b.sources)this.addSource(e,b.sources[e],{validate:!1});b.sprite?this._spriteRequest=function(b,c,d){function e(){if(h)d(h);else if(f&&g){var b=a.browser.getImageData(g),c={};for(var e in f){var i=f[e],j=i.width,k=i.height,l=i.x,m=i.y,n=i.sdf,o=i.pixelRatio,p=new a.RGBAImage({width:j,height:k});a.RGBAImage.copy(b,p,{x:l,y:m},{x:0,y:0},{width:j,height:k}),c[e]={data:p,pixelRatio:o,sdf:n}}d(null,c)}}var f,g,h,i=a.browser.devicePixelRatio>1?"@2x":"",j=a.getJSON(c(a.normalizeSpriteURL(b,i,".json"),a.ResourceType.SpriteJSON),function(a,b){j=null,h||(h=a,f=b,e())}),k=a.getImage(c(a.normalizeSpriteURL(b,i,".png"),a.ResourceType.SpriteImage),function(a,b){k=null,h||(h=a,g=b,e())});return{cancel:function(){j&&(j.cancel(),j=null),k&&(k.cancel(),k=null)}}}(b.sprite,this.map._transformRequest,function(b,c){if(d._spriteRequest=null,b)d.fire(new a.ErrorEvent(b));else if(c)for(var e in c)d.imageManager.addImage(e,c[e]);d.imageManager.setLoaded(!0),d.fire(new a.Event("data",{dataType:"style"}))}):this.imageManager.setLoaded(!0),this.glyphManager.setURL(b.glyphs);var f=n(this.stylesheet.layers);this._order=f.map(function(a){return a.id}),this._layers={};for(var g=0,h=f;g<h.length;g+=1){var i=h[g];(i=a.createStyleLayer(i)).setEventedParent(this,{layer:{id:i.id}}),this._layers[i.id]=i}this.dispatcher.broadcast("setLayers",this._serializeLayers(this._order)),this.light=new Aa(this.stylesheet.light),this.fire(new a.Event("data",{dataType:"style"})),this.fire(new a.Event("style.load"))}},c.prototype._validateLayer=function(b){var c=this.sourceCaches[b.source];if(c){var d=b.sourceLayer;if(d){var e=c.getSource();("geojson"===e.type||e.vectorLayerIds&&-1===e.vectorLayerIds.indexOf(d))&&this.fire(new a.ErrorEvent(new Error('Source layer "'+d+'" does not exist on source "'+e.id+'" as specified by style layer "'+b.id+'"')))}}},c.prototype.loaded=function(){if(!this._loaded)return!1;if(Object.keys(this._updatedSources).length)return!1;for(var a in this.sourceCaches)if(!this.sourceCaches[a].loaded())return!1;return!!this.imageManager.isLoaded()},c.prototype._serializeLayers=function(a){for(var b=[],c=0,d=a;c<d.length;c+=1){var e=d[c],f=this._layers[e];"custom"!==f.type&&b.push(f.serialize())}return b},c.prototype.hasTransitions=function(){if(this.light&&this.light.hasTransition())return!0;for(var a in this.sourceCaches)if(this.sourceCaches[a].hasTransition())return!0;for(var b in this._layers)if(this._layers[b].hasTransition())return!0;return!1},c.prototype._checkLoaded=function(){if(!this._loaded)throw new Error("Style is not done loading")},c.prototype.update=function(b){if(this._loaded){var c=this._changed;if(this._changed){var d=Object.keys(this._updatedLayers),e=Object.keys(this._removedLayers);for(var f in(d.length||e.length)&&this._updateWorkerLayers(d,e),this._updatedSources){var g=this._updatedSources[f];"reload"===g?this._reloadSource(f):"clear"===g&&this._clearSource(f)}for(var h in this._updatedPaintProps)this._layers[h].updateTransitions(b);this.light.updateTransitions(b),this._resetUpdates()}for(var i in this.sourceCaches)this.sourceCaches[i].used=!1;for(var j=0,k=this._order;j<k.length;j+=1){var l=k[j],m=this._layers[l];m.recalculate(b),!m.isHidden(b.zoom)&&m.source&&(this.sourceCaches[m.source].used=!0)}this.light.recalculate(b),this.z=b.zoom,c&&this.fire(new a.Event("data",{dataType:"style"}))}},c.prototype._updateWorkerLayers=function(a,b){this.dispatcher.broadcast("updateLayers",{layers:this._serializeLayers(a),removedIds:b})},c.prototype._resetUpdates=function(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={}},c.prototype.setState=function(b){var c=this;if(this._checkLoaded(),dc(this,a.validateStyle(b)))return!1;(b=a.clone(b)).layers=n(b.layers);var d=v(this.serialize(),b).filter(function(a){return!(a.command in fc)});if(0===d.length)return!1;var e=d.filter(function(a){return!(a.command in ec)});if(e.length>0)throw new Error("Unimplemented: "+e.map(function(a){return a.command}).join(", ")+".");return d.forEach(function(a){"setTransition"!==a.command&&c[a.command].apply(c,a.args)}),this.stylesheet=b,!0},c.prototype.addImage=function(b,c){if(this.getImage(b))return this.fire(new a.ErrorEvent(new Error("An image with this name already exists.")));this.imageManager.addImage(b,c),this.fire(new a.Event("data",{dataType:"style"}))},c.prototype.getImage=function(a){return this.imageManager.getImage(a)},c.prototype.removeImage=function(b){if(!this.getImage(b))return this.fire(new a.ErrorEvent(new Error("No image with this name exists.")));this.imageManager.removeImage(b),this.fire(new a.Event("data",{dataType:"style"}))},c.prototype.listImages=function(){return this._checkLoaded(),this.imageManager.listImages()},c.prototype.addSource=function(b,c,d){var e=this;if(void 0===d&&(d={}),this._checkLoaded(),void 0!==this.sourceCaches[b])throw new Error("There is already a source with this ID");if(!c.type)throw new Error("The type property must be defined, but the only the following properties were given: "+Object.keys(c).join(", ")+".");if(!(["vector","raster","geojson","video","image"].indexOf(c.type)>=0&&this._validate(a.validateStyle.source,"sources."+b,c,null,d))){this.map&&this.map._collectResourceTiming&&(c.collectResourceTiming=!0);var f=this.sourceCaches[b]=new Cb(b,c,this.dispatcher);f.style=this,f.setEventedParent(this,function(){return{isSourceLoaded:e.loaded(),source:f.serialize(),sourceId:b}}),f.onAdd(this.map),this._changed=!0}},c.prototype.removeSource=function(b){if(this._checkLoaded(),void 0===this.sourceCaches[b])throw new Error("There is no source with this ID");for(var c in this._layers)if(this._layers[c].source===b)return this.fire(new a.ErrorEvent(new Error('Source "'+b+'" cannot be removed while layer "'+c+'" is using it.')));var d=this.sourceCaches[b];delete this.sourceCaches[b],delete this._updatedSources[b],d.fire(new a.Event("data",{sourceDataType:"metadata",dataType:"source",sourceId:b})),d.setEventedParent(null),d.clearTiles(),d.onRemove&&d.onRemove(this.map),this._changed=!0},c.prototype.setGeoJSONSourceData=function(a,b){this._checkLoaded(),this.sourceCaches[a].getSource().setData(b),this._changed=!0},c.prototype.getSource=function(a){return this.sourceCaches[a]&&this.sourceCaches[a].getSource()},c.prototype.addLayer=function(b,c,d){void 0===d&&(d={}),this._checkLoaded();var e=b.id;if(this.getLayer(e))this.fire(new a.ErrorEvent(new Error('Layer with id "'+e+'" already exists on this map')));else{var f;if("custom"===b.type){if(dc(this,a.validateCustomStyleLayer(b)))return;f=a.createStyleLayer(b)}else{if("object"==typeof b.source&&(this.addSource(e,b.source),b=a.clone(b),b=a.extend(b,{source:e})),this._validate(a.validateStyle.layer,"layers."+e,b,{arrayIndex:-1},d))return;f=a.createStyleLayer(b),this._validateLayer(f),f.setEventedParent(this,{layer:{id:e}})}var g=c?this._order.indexOf(c):this._order.length;if(c&&-1===g)this.fire(new a.ErrorEvent(new Error('Layer with id "'+c+'" does not exist on this map.')));else{if(this._order.splice(g,0,e),this._layerOrderChanged=!0,this._layers[e]=f,this._removedLayers[e]&&f.source&&"custom"!==f.type){var h=this._removedLayers[e];delete this._removedLayers[e],h.type!==f.type?this._updatedSources[f.source]="clear":(this._updatedSources[f.source]="reload",this.sourceCaches[f.source].pause())}this._updateLayer(f),f.onAdd&&f.onAdd(this.map)}}},c.prototype.moveLayer=function(b,c){if(this._checkLoaded(),this._changed=!0,this._layers[b]){if(b!==c){var d=this._order.indexOf(b);this._order.splice(d,1);var e=c?this._order.indexOf(c):this._order.length;c&&-1===e?this.fire(new a.ErrorEvent(new Error('Layer with id "'+c+'" does not exist on this map.'))):(this._order.splice(e,0,b),this._layerOrderChanged=!0)}}else this.fire(new a.ErrorEvent(new Error("The layer '"+b+"' does not exist in the map's style and cannot be moved.")))},c.prototype.removeLayer=function(b){this._checkLoaded();var c=this._layers[b];if(c){c.setEventedParent(null);var d=this._order.indexOf(b);this._order.splice(d,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[b]=c,delete this._layers[b],delete this._updatedLayers[b],delete this._updatedPaintProps[b],c.onRemove&&c.onRemove(this.map)}else this.fire(new a.ErrorEvent(new Error("The layer '"+b+"' does not exist in the map's style and cannot be removed.")))},c.prototype.getLayer=function(a){return this._layers[a]},c.prototype.setLayerZoomRange=function(b,c,d){this._checkLoaded();var e=this.getLayer(b);e?e.minzoom===c&&e.maxzoom===d||(null!=c&&(e.minzoom=c),null!=d&&(e.maxzoom=d),this._updateLayer(e)):this.fire(new a.ErrorEvent(new Error("The layer '"+b+"' does not exist in the map's style and cannot have zoom extent.")))},c.prototype.setFilter=function(b,c,d){void 0===d&&(d={}),this._checkLoaded();var e=this.getLayer(b);if(e){if(!a.isEqual(e.filter,c))return null==c?(e.filter=void 0,void this._updateLayer(e)):void(this._validate(a.validateStyle.filter,"layers."+e.id+".filter",c,null,d)||(e.filter=a.clone(c),this._updateLayer(e)))}else this.fire(new a.ErrorEvent(new Error("The layer '"+b+"' does not exist in the map's style and cannot be filtered.")))},c.prototype.getFilter=function(b){return a.clone(this.getLayer(b).filter)},c.prototype.setLayoutProperty=function(b,c,d,e){void 0===e&&(e={}),this._checkLoaded();var f=this.getLayer(b);f?a.isEqual(f.getLayoutProperty(c),d)||(f.setLayoutProperty(c,d,e),this._updateLayer(f)):this.fire(new a.ErrorEvent(new Error("The layer '"+b+"' does not exist in the map's style and cannot be styled.")))},c.prototype.getLayoutProperty=function(b,c){var d=this.getLayer(b);if(d)return d.getLayoutProperty(c);this.fire(new a.ErrorEvent(new Error("The layer '"+b+"' does not exist in the map's style.")))},c.prototype.setPaintProperty=function(b,c,d,e){void 0===e&&(e={}),this._checkLoaded();var f=this.getLayer(b);f?a.isEqual(f.getPaintProperty(c),d)||(f.setPaintProperty(c,d,e)&&this._updateLayer(f),this._changed=!0,this._updatedPaintProps[b]=!0):this.fire(new a.ErrorEvent(new Error("The layer '"+b+"' does not exist in the map's style and cannot be styled.")))},c.prototype.getPaintProperty=function(a,b){return this.getLayer(a).getPaintProperty(b)},c.prototype.setFeatureState=function(b,c){this._checkLoaded();var d=b.source,e=b.sourceLayer,f=this.sourceCaches[d],g=parseInt(b.id,10);if(void 0!==f){var h=f.getSource().type;"geojson"===h&&e?this.fire(new a.ErrorEvent(new Error("GeoJSON sources cannot have a sourceLayer parameter."))):"vector"!==h||e?isNaN(g)||g<0?this.fire(new a.ErrorEvent(new Error("The feature id parameter must be provided and non-negative."))):f.setFeatureState(e,g,c):this.fire(new a.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new a.ErrorEvent(new Error("The source '"+d+"' does not exist in the map's style.")))},c.prototype.removeFeatureState=function(b,c){this._checkLoaded();var d=b.source,e=this.sourceCaches[d];if(void 0!==e){var f=e.getSource().type,g="vector"===f?b.sourceLayer:void 0,h=parseInt(b.id,10);"vector"!==f||g?b.id&&isNaN(h)||h<0?this.fire(new a.ErrorEvent(new Error("The feature id parameter must be non-negative."))):!c||b.id?e.removeFeatureState(g,h,c):this.fire(new a.ErrorEvent(new Error("A feature id is requred to remove its specific state property."))):this.fire(new a.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new a.ErrorEvent(new Error("The source '"+d+"' does not exist in the map's style.")))},c.prototype.getFeatureState=function(b){this._checkLoaded();var c=b.source,d=b.sourceLayer,e=this.sourceCaches[c],f=parseInt(b.id,10);if(void 0!==e)if("vector"!==e.getSource().type||d){if(!(isNaN(f)||f<0))return e.getFeatureState(d,f);this.fire(new a.ErrorEvent(new Error("The feature id parameter must be provided and non-negative.")))}else this.fire(new a.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")));else this.fire(new a.ErrorEvent(new Error("The source '"+c+"' does not exist in the map's style.")))},c.prototype.getTransition=function(){return a.extend({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)},c.prototype.serialize=function(){return a.filterObject({version:this.stylesheet.version,name:this.stylesheet.name,metadata:this.stylesheet.metadata,light:this.stylesheet.light,center:this.stylesheet.center,zoom:this.stylesheet.zoom,bearing:this.stylesheet.bearing,pitch:this.stylesheet.pitch,sprite:this.stylesheet.sprite,glyphs:this.stylesheet.glyphs,transition:this.stylesheet.transition,sources:a.mapObject(this.sourceCaches,function(a){return a.serialize()}),layers:this._serializeLayers(this._order)},function(a){return void 0!==a})},c.prototype._updateLayer=function(a){this._updatedLayers[a.id]=!0,a.source&&!this._updatedSources[a.source]&&(this._updatedSources[a.source]="reload",this.sourceCaches[a.source].pause()),this._changed=!0},c.prototype._flattenAndSortRenderedFeatures=function(a){for(var b=[],c=[],d=this._order.length-1;d>=0;d--)for(var e=this._order[d],f=0,g=a;f<g.length;f+=1){var h=g[f][e];if(h)if("fill-extrusion"===this._layers[e].type)for(var i=0,j=h;i<j.length;i+=1){var k=j[i];c.push(k)}else for(var l=0,m=h;l<m.length;l+=1){var n=m[l];b.push(n.feature)}}c.sort(function(a,b){return a.intersectionZ-b.intersectionZ});for(var o=0,p=c;o<p.length;o+=1){var q=p[o];b.push(q.feature)}return b},c.prototype.queryRenderedFeatures=function(b,c,d){c&&c.filter&&this._validate(a.validateStyle.filter,"queryRenderedFeatures.filter",c.filter);var e={};if(c&&c.layers){if(!Array.isArray(c.layers))return this.fire(new a.ErrorEvent(new Error("parameters.layers must be an Array."))),[];for(var f=0,g=c.layers;f<g.length;f+=1){var j=g[f],k=this._layers[j];if(!k)return this.fire(new a.ErrorEvent(new Error("The layer '"+j+"' does not exist in the map's style and cannot be queried for features."))),[];e[k.source]=!0}}var l=[];for(var m in this.sourceCaches)c.layers&&!e[m]||l.push(h(this.sourceCaches[m],this._layers,b,c,d));return this.placement&&l.push(function(a,b,c,d,e,f){for(var g={},h=e.queryRenderedSymbols(c),j=[],k=0,l=Object.keys(h).map(Number);k<l.length;k+=1){var m=l[k];j.push(f[m])}j.sort(i);for(var n=0,o=j;n<o.length;n+=1)!function(){var b=o[n],c=b.featureIndex.lookupSymbolFeatures(h[b.bucketInstanceId],b.bucketIndex,b.sourceLayerIndex,d.filter,d.layers,a);for(var e in c){var f=g[e]=g[e]||[],i=c[e];i.sort(function(a,c){var d=b.featureSortOrder;if(d){var e=d.indexOf(a.featureIndex);return d.indexOf(c.featureIndex)-e}return c.featureIndex-a.featureIndex});for(var j=0,k=i;j<k.length;j+=1){var l=k[j];f.push(l)}}}();for(var p in g)!function(c){g[c].forEach(function(d){var e=d.feature,f=a[c],g=b[f.source].getFeatureState(e.layer["source-layer"],e.id);e.source=e.layer.source,e.layer["source-layer"]&&(e.sourceLayer=e.layer["source-layer"]),e.state=g})}(p);return g}(this._layers,this.sourceCaches,b,c,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(l)},c.prototype.querySourceFeatures=function(b,c){c&&c.filter&&this._validate(a.validateStyle.filter,"querySourceFeatures.filter",c.filter);var d=this.sourceCaches[b];return d?function(a,b){for(var c=a.getRenderableIds().map(function(b){return a.getTileByID(b)}),d=[],e={},f=0;f<c.length;f++){var g=c[f],h=g.tileID.canonical.key;e[h]||(e[h]=!0,g.querySourceFeatures(d,b))}return d}(d,c):[]},c.prototype.addSourceType=function(a,b,d){return c.getSourceType(a)?d(new Error('A source type called "'+a+'" already exists.')):(c.setSourceType(a,b),b.workerSourceURL?void this.dispatcher.broadcast("loadWorkerSource",{name:a,url:b.workerSourceURL},d):d(null,null))},c.prototype.getLight=function(){return this.light.getLight()},c.prototype.setLight=function(b,c){void 0===c&&(c={}),this._checkLoaded();var d=this.light.getLight(),e=!1;for(var f in b)if(!a.isEqual(b[f],d[f])){e=!0;break}if(e){var g={now:a.browser.now(),transition:a.extend({duration:300,delay:0},this.stylesheet.transition)};this.light.setLight(b,c),this.light.updateTransitions(g)}},c.prototype._validate=function(b,c,d,e,f){return void 0===f&&(f={}),(!f||!1!==f.validate)&&dc(this,b.call(a.validateStyle,a.extend({key:c,style:this.serialize(),value:d,styleSpec:a.styleSpec},e)))},c.prototype._remove=function(){for(var b in this._request&&(this._request.cancel(),this._request=null),this._spriteRequest&&(this._spriteRequest.cancel(),this._spriteRequest=null),a.evented.off("pluginAvailable",this._rtlTextPluginCallback),this.sourceCaches)this.sourceCaches[b].clearTiles();this.dispatcher.remove()},c.prototype._clearSource=function(a){this.sourceCaches[a].clearTiles()},c.prototype._reloadSource=function(a){this.sourceCaches[a].resume(),this.sourceCaches[a].reload()},c.prototype._updateSources=function(a){for(var b in this.sourceCaches)this.sourceCaches[b].update(a)},c.prototype._generateCollisionBoxes=function(){for(var a in this.sourceCaches)this._reloadSource(a)},c.prototype._updatePlacement=function(b,c,d,e){for(var f=!1,g=!1,h={},i=0,j=this._order;i<j.length;i+=1){var k=j[i],l=this._layers[k];if("symbol"===l.type){if(!h[l.source]){var m=this.sourceCaches[l.source];h[l.source]=m.getRenderableIds(!0).map(function(a){return m.getTileByID(a)}).sort(function(a,b){return b.tileID.overscaledZ-a.tileID.overscaledZ||(a.tileID.isLessThan(b.tileID)?-1:1)})}var n=this.crossTileSymbolIndex.addLayer(l,h[l.source],b.center.lng);f=f||n}}this.crossTileSymbolIndex.pruneUnusedLayers(this._order);var o=this._layerOrderChanged||0===d;if((o||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(a.browser.now()))&&(this.pauseablePlacement=new Zb(b,this._order,o,c,d,e),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,h),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(this.placement,a.browser.now()),g=!0),f&&this.pauseablePlacement.placement.setStale()),g||f)for(var p=0,q=this._order;p<q.length;p+=1){var r=q[p],s=this._layers[r];"symbol"===s.type&&this.placement.updateLayerOpacities(s,h[s.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(a.browser.now())},c.prototype._releaseSymbolFadeTiles=function(){for(var a in this.sourceCaches)this.sourceCaches[a].releaseSymbolFadeTiles()},c.prototype.getImages=function(a,b,c){this.imageManager.getImages(b.icons,c)},c.prototype.getGlyphs=function(a,b,c){this.glyphManager.getGlyphs(b.stacks,c)},c.prototype.getResource=function(b,c,d){return a.makeRequest(c,d)},c}(a.Evented);gc.getSourceType=function(a){return Ja[a]},gc.setSourceType=function(a,b){Ja[a]=b},gc.registerForPluginAvailability=a.registerForPluginAvailability;var hc=a.createLayout([{name:"a_pos",type:"Int16",components:2
}]),ic=M("#ifdef GL_ES\nprecision mediump float;\n#else\n#if !defined(lowp)\n#define lowp\n#endif\n#if !defined(mediump)\n#define mediump\n#endif\n#if !defined(highp)\n#define highp\n#endif\n#endif","#ifdef GL_ES\nprecision highp float;\n#else\n#if !defined(lowp)\n#define lowp\n#endif\n#if !defined(mediump)\n#define mediump\n#endif\n#if !defined(highp)\n#define highp\n#endif\n#endif\nvec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0\n);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}"),jc=M("uniform vec4 u_color;uniform float u_opacity;void main() {gl_FragColor=u_color*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),kc=M("uniform vec2 u_pattern_tl_a;uniform vec2 u_pattern_br_a;uniform vec2 u_pattern_tl_b;uniform vec2 u_pattern_br_b;uniform vec2 u_texsize;uniform float u_mix;uniform float u_opacity;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(u_pattern_tl_a/u_texsize,u_pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(u_pattern_tl_b/u_texsize,u_pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_mix)*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_pattern_size_a;uniform vec2 u_pattern_size_b;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_scale_a;uniform float u_scale_b;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_a*u_pattern_size_a,u_tile_units_to_pixels,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_b*u_pattern_size_b,u_tile_units_to_pixels,a_pos);}"),lc=M("#pragma mapbox: define highp vec4 color\n#pragma mapbox: define mediump float radius\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define highp vec4 stroke_color\n#pragma mapbox: define mediump float stroke_width\n#pragma mapbox: define lowp float stroke_opacity\nvarying vec3 v_data;void main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize mediump float radius\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize highp vec4 stroke_color\n#pragma mapbox: initialize mediump float stroke_width\n#pragma mapbox: initialize lowp float stroke_opacity\nvec2 extrude=v_data.xy;float extrude_length=length(extrude);lowp float antialiasblur=v_data.z;float antialiased_blur=-max(blur,antialiasblur);float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width));gl_FragColor=opacity_t*mix(color*opacity,stroke_color*stroke_opacity,color_t);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform bool u_scale_with_map;uniform bool u_pitch_with_map;uniform vec2 u_extrude_scale;uniform highp float u_camera_to_center_distance;attribute vec2 a_pos;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define mediump float radius\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define highp vec4 stroke_color\n#pragma mapbox: define mediump float stroke_width\n#pragma mapbox: define lowp float stroke_opacity\nvarying vec3 v_data;void main(void) {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize mediump float radius\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize highp vec4 stroke_color\n#pragma mapbox: initialize mediump float stroke_width\n#pragma mapbox: initialize lowp float stroke_opacity\nvec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);if (u_pitch_with_map) {vec2 corner_position=circle_center;if (u_scale_with_map) {corner_position+=extrude*(radius+stroke_width)*u_extrude_scale;} else {vec4 projected_center=u_matrix*vec4(circle_center,0,1);corner_position+=extrude*(radius+stroke_width)*u_extrude_scale*(projected_center.w/u_camera_to_center_distance);}gl_Position=u_matrix*vec4(corner_position,0,1);} else {gl_Position=u_matrix*vec4(circle_center,0,1);if (u_scale_with_map) {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*u_camera_to_center_distance;} else {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*gl_Position.w;}}lowp float antialiasblur=1.0/DEVICE_PIXEL_RATIO/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);}"),mc=M("void main() {gl_FragColor=vec4(1.0);}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),nc=M("#pragma mapbox: define highp float weight\nuniform highp float u_intensity;varying vec2 v_extrude;\n#define GAUSS_COEF 0.3989422804014327\nvoid main() {\n#pragma mapbox: initialize highp float weight\nfloat d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);gl_FragColor=vec4(val,1.0,1.0,1.0);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","#pragma mapbox: define highp float weight\n#pragma mapbox: define mediump float radius\nuniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;attribute vec2 a_pos;varying vec2 v_extrude;const highp float ZERO=1.0/255.0/16.0;\n#define GAUSS_COEF 0.3989422804014327\nvoid main(void) {\n#pragma mapbox: initialize highp float weight\n#pragma mapbox: initialize mediump float radius\nvec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec4 pos=vec4(floor(a_pos*0.5)+extrude,0,1);gl_Position=u_matrix*pos;}"),oc=M("uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;varying vec2 v_pos;void main() {float t=texture2D(u_image,v_pos).r;vec4 color=texture2D(u_color_ramp,vec2(t,0.5));gl_FragColor=color*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(0.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_world;attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos*u_world,0,1);v_pos.x=a_pos.x;v_pos.y=1.0-a_pos.y;}"),pc=M("varying float v_placed;varying float v_notUsed;void main() {float alpha=0.5;gl_FragColor=vec4(1.0,0.0,0.0,1.0)*alpha;if (v_placed > 0.5) {gl_FragColor=vec4(0.0,0.0,1.0,0.5)*alpha;}if (v_notUsed > 0.5) {gl_FragColor*=.1;}}","attribute vec2 a_pos;attribute vec2 a_anchor_pos;attribute vec2 a_extrude;attribute vec2 a_placed;uniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform float u_camera_to_center_distance;varying float v_placed;varying float v_notUsed;void main() {vec4 projectedPoint=u_matrix*vec4(a_anchor_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);gl_Position=u_matrix*vec4(a_pos,0.0,1.0);gl_Position.xy+=a_extrude*u_extrude_scale*gl_Position.w*collision_perspective_ratio;v_placed=a_placed.x;v_notUsed=a_placed.y;}"),qc=M("uniform float u_overscale_factor;varying float v_placed;varying float v_notUsed;varying float v_radius;varying vec2 v_extrude;varying vec2 v_extrude_scale;void main() {float alpha=0.5;vec4 color=vec4(1.0,0.0,0.0,1.0)*alpha;if (v_placed > 0.5) {color=vec4(0.0,0.0,1.0,0.5)*alpha;}if (v_notUsed > 0.5) {color*=.2;}float extrude_scale_length=length(v_extrude_scale);float extrude_length=length(v_extrude)*extrude_scale_length;float stroke_width=15.0*extrude_scale_length/u_overscale_factor;float radius=v_radius*extrude_scale_length;float distance_to_edge=abs(extrude_length-radius);float opacity_t=smoothstep(-stroke_width,0.0,-distance_to_edge);gl_FragColor=opacity_t*color;}","attribute vec2 a_pos;attribute vec2 a_anchor_pos;attribute vec2 a_extrude;attribute vec2 a_placed;uniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform float u_camera_to_center_distance;varying float v_placed;varying float v_notUsed;varying float v_radius;varying vec2 v_extrude;varying vec2 v_extrude_scale;void main() {vec4 projectedPoint=u_matrix*vec4(a_anchor_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);gl_Position=u_matrix*vec4(a_pos,0.0,1.0);highp float padding_factor=1.2;gl_Position.xy+=a_extrude*u_extrude_scale*padding_factor*gl_Position.w*collision_perspective_ratio;v_placed=a_placed.x;v_notUsed=a_placed.y;v_radius=abs(a_extrude.y);v_extrude=a_extrude*padding_factor;v_extrude_scale=u_extrude_scale*u_camera_to_center_distance*collision_perspective_ratio;}"),rc=M("uniform highp vec4 u_color;void main() {gl_FragColor=u_color;}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),sc=M("#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float opacity\ngl_FragColor=color*opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec2 a_pos;uniform mat4 u_matrix;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float opacity\ngl_Position=u_matrix*vec4(a_pos,0,1);}"),tc=M("#pragma mapbox: define highp vec4 outline_color\n#pragma mapbox: define lowp float opacity\nvarying vec2 v_pos;void main() {\n#pragma mapbox: initialize highp vec4 outline_color\n#pragma mapbox: initialize lowp float opacity\nfloat dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=outline_color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec2 a_pos;uniform mat4 u_matrix;uniform vec2 u_world;varying vec2 v_pos;\n#pragma mapbox: define highp vec4 outline_color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 outline_color\n#pragma mapbox: initialize lowp float opacity\ngl_Position=u_matrix*vec4(a_pos,0,1);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}"),uc=M("uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_fade;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=mix(color1,color2,u_fade)*alpha*opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec4 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float pixelRatio=u_scale.x;float tileRatio=u_scale.y;float fromScale=u_scale.z;float toScale=u_scale.w;gl_Position=u_matrix*vec4(a_pos,0,1);vec2 display_size_a=vec2((pattern_br_a.x-pattern_tl_a.x)/pixelRatio,(pattern_br_a.y-pattern_tl_a.y)/pixelRatio);vec2 display_size_b=vec2((pattern_br_b.x-pattern_tl_b.x)/pixelRatio,(pattern_br_b.y-pattern_tl_b.y)/pixelRatio);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}"),vc=M("uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_fade)*opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec4 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float pixelRatio=u_scale.x;float tileZoomRatio=u_scale.y;float fromScale=u_scale.z;float toScale=u_scale.w;vec2 display_size_a=vec2((pattern_br_a.x-pattern_tl_a.x)/pixelRatio,(pattern_br_a.y-pattern_tl_a.y)/pixelRatio);vec2 display_size_b=vec2((pattern_br_b.x-pattern_tl_b.x)/pixelRatio,(pattern_br_b.y-pattern_tl_b.y)/pixelRatio);gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileZoomRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileZoomRatio,a_pos);}"),wc=M("varying vec4 v_color;void main() {gl_FragColor=v_color;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;attribute vec2 a_pos;attribute vec4 a_normal_ed;varying vec4 v_color;\n#pragma mapbox: define highp float base\n#pragma mapbox: define highp float height\n#pragma mapbox: define highp vec4 color\nvoid main() {\n#pragma mapbox: initialize highp float base\n#pragma mapbox: initialize highp float height\n#pragma mapbox: initialize highp vec4 color\nvec3 normal=a_normal_ed.xyz;base=max(0.0,base);height=max(0.0,height);float t=mod(normal.x,2.0);gl_Position=u_matrix*vec4(a_pos,t > 0.0 ? height : base,1);float colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;v_color=vec4(0.0,0.0,0.0,1.0);vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;float directional=clamp(dot(normal/16384.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_color.r+=clamp(color.r*directional*u_lightcolor.r,mix(0.0,0.3,1.0-u_lightcolor.r),1.0);v_color.g+=clamp(color.g*directional*u_lightcolor.g,mix(0.0,0.3,1.0-u_lightcolor.g),1.0);v_color.b+=clamp(color.b*directional*u_lightcolor.b,mix(0.0,0.3,1.0-u_lightcolor.b),1.0);}"),xc=M("uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;\n#pragma mapbox: define lowp float base\n#pragma mapbox: define lowp float height\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\nvoid main() {\n#pragma mapbox: initialize lowp float base\n#pragma mapbox: initialize lowp float height\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);vec4 mixedColor=mix(color1,color2,u_fade);gl_FragColor=mixedColor*v_lighting;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform vec4 u_scale;uniform float u_vertical_gradient;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;attribute vec2 a_pos;attribute vec4 a_normal_ed;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;\n#pragma mapbox: define lowp float base\n#pragma mapbox: define lowp float height\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\nvoid main() {\n#pragma mapbox: initialize lowp float base\n#pragma mapbox: initialize lowp float height\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float pixelRatio=u_scale.x;float tileRatio=u_scale.y;float fromScale=u_scale.z;float toScale=u_scale.w;vec3 normal=a_normal_ed.xyz;float edgedistance=a_normal_ed.w;vec2 display_size_a=vec2((pattern_br_a.x-pattern_tl_a.x)/pixelRatio,(pattern_br_a.y-pattern_tl_a.y)/pixelRatio);vec2 display_size_b=vec2((pattern_br_b.x-pattern_tl_b.x)/pixelRatio,(pattern_br_b.y-pattern_tl_b.y)/pixelRatio);base=max(0.0,base);height=max(0.0,height);float t=mod(normal.x,2.0);float z=t > 0.0 ? height : base;gl_Position=u_matrix*vec4(a_pos,z,1);vec2 pos=normal.x==1.0 && normal.y==0.0 && normal.z==16384.0\n? a_pos\n: vec2(edgedistance,z*u_height_factor);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float directional=clamp(dot(normal/16383.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_lighting.rgb+=clamp(directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));}"),yc=M("uniform sampler2D u_image;uniform float u_opacity;varying vec2 v_pos;void main() {gl_FragColor=texture2D(u_image,v_pos)*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(0.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_world;attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos*u_world,0,1);v_pos.x=a_pos.x;v_pos.y=1.0-a_pos.y;}"),zc=M("#ifdef GL_ES\nprecision highp float;\n#endif\nuniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform float u_maxzoom;float getElevation(vec2 coord,float bias) {vec4 data=texture2D(u_image,coord)*255.0;return (data.r+data.g*256.0+data.b*256.0*256.0)/4.0;}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y),0.0);float b=getElevation(v_pos+vec2(0,-epsilon.y),0.0);float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y),0.0);float d=getElevation(v_pos+vec2(-epsilon.x,0),0.0);float e=getElevation(v_pos,0.0);float f=getElevation(v_pos+vec2(epsilon.x,0),0.0);float g=getElevation(v_pos+vec2(-epsilon.x,epsilon.y),0.0);float h=getElevation(v_pos+vec2(0,epsilon.y),0.0);float i=getElevation(v_pos+vec2(epsilon.x,epsilon.y),0.0);float exaggeration=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;vec2 deriv=vec2((c+f+f+i)-(a+d+d+g),(g+h+h+i)-(a+b+b+c))/ pow(2.0,(u_zoom-u_maxzoom)*exaggeration+19.2562-u_zoom);gl_FragColor=clamp(vec4(deriv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_dimension;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),Ac=M("uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;\n#define PI 3.141592653589793\nvoid main() {vec4 pixel=texture2D(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);gl_FragColor=accent_color*(1.0-shade_color.a)+shade_color;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;}"),Bc=M("#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\nvarying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;void main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\nfloat dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/DEVICE_PIXEL_RATIO)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);gl_FragColor=color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","\n#define ANTIALIASING 1.0/DEVICE_PIXEL_RATIO/2.0\n#define scale 0.015873016\nattribute vec4 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform vec2 u_gl_units_to_pixels;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp float v_linesofar;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float width\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float width\nvec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;v_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*2.0;vec2 pos=a_pos_normal.xy;mediump vec2 normal=a_pos_normal.zw;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_gl_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_width2=vec2(outset,inset);}"),Cc=M("#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\nuniform sampler2D u_image;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;varying highp float v_lineprogress;void main() {\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\nfloat dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/DEVICE_PIXEL_RATIO)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);vec4 color=texture2D(u_image,vec2(v_lineprogress,0.5));gl_FragColor=color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","\n#define MAX_LINE_DISTANCE 32767.0\n#define ANTIALIASING 1.0/DEVICE_PIXEL_RATIO/2.0\n#define scale 0.015873016\nattribute vec4 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform vec2 u_gl_units_to_pixels;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp float v_lineprogress;\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float width\nvoid main() {\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float width\nvec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;v_lineprogress=(floor(a_data.z/4.0)+a_data.w*64.0)*2.0/MAX_LINE_DISTANCE;vec2 pos=a_pos_normal.xy;mediump vec2 normal=a_pos_normal.zw;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_gl_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_width2=vec2(outset,inset);}"),Dc=M("uniform vec2 u_texsize;uniform float u_fade;uniform mediump vec4 u_scale;uniform sampler2D u_image;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float pixelRatio=u_scale.x;float tileZoomRatio=u_scale.y;float fromScale=u_scale.z;float toScale=u_scale.w;vec2 display_size_a=vec2((pattern_br_a.x-pattern_tl_a.x)/pixelRatio,(pattern_br_a.y-pattern_tl_a.y)/pixelRatio);vec2 display_size_b=vec2((pattern_br_b.x-pattern_tl_b.x)/pixelRatio,(pattern_br_b.y-pattern_tl_b.y)/pixelRatio);vec2 pattern_size_a=vec2(display_size_a.x*fromScale/tileZoomRatio,display_size_a.y);vec2 pattern_size_b=vec2(display_size_b.x*toScale/tileZoomRatio,display_size_b.y);float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/DEVICE_PIXEL_RATIO)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x_a=mod(v_linesofar/pattern_size_a.x,1.0);float x_b=mod(v_linesofar/pattern_size_b.x,1.0);float y_a=0.5+(v_normal.y*clamp(v_width2.s,0.0,(pattern_size_a.y+2.0)/2.0)/pattern_size_a.y);float y_b=0.5+(v_normal.y*clamp(v_width2.s,0.0,(pattern_size_b.y+2.0)/2.0)/pattern_size_b.y);vec2 pos_a=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,vec2(x_a,y_a));vec2 pos_b=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,vec2(x_b,y_b));vec4 color=mix(texture2D(u_image,pos_a),texture2D(u_image,pos_b),u_fade);gl_FragColor=color*alpha*opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","\n#define scale 0.015873016\n#define LINE_DISTANCE_SCALE 2.0\n#define ANTIALIASING 1.0/DEVICE_PIXEL_RATIO/2.0\nattribute vec4 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform vec2 u_gl_units_to_pixels;uniform mediump float u_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define mediump float width\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\nvoid main() {\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize mediump float width\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\nvec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=a_pos_normal.xy;mediump vec2 normal=a_pos_normal.zw;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_gl_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_linesofar=a_linesofar;v_width2=vec2(outset,inset);}"),Ec=M("uniform sampler2D u_image;uniform float u_sdfgamma;uniform float u_mix;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float width\n#pragma mapbox: define lowp float floorwidth\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump float width\n#pragma mapbox: initialize lowp float floorwidth\nfloat dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/DEVICE_PIXEL_RATIO)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float sdfdist_a=texture2D(u_image,v_tex_a).a;float sdfdist_b=texture2D(u_image,v_tex_b).a;float sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);alpha*=smoothstep(0.5-u_sdfgamma/floorwidth,0.5+u_sdfgamma/floorwidth,sdfdist);gl_FragColor=color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","\n#define scale 0.015873016\n#define LINE_DISTANCE_SCALE 2.0\n#define ANTIALIASING 1.0/DEVICE_PIXEL_RATIO/2.0\nattribute vec4 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform vec2 u_patternscale_a;uniform float u_tex_y_a;uniform vec2 u_patternscale_b;uniform float u_tex_y_b;uniform vec2 u_gl_units_to_pixels;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float width\n#pragma mapbox: define lowp float floorwidth\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float width\n#pragma mapbox: initialize lowp float floorwidth\nvec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=a_pos_normal.xy;mediump vec2 normal=a_pos_normal.zw;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_gl_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_tex_a=vec2(a_linesofar*u_patternscale_a.x/floorwidth,normal.y*u_patternscale_a.y+u_tex_y_a);v_tex_b=vec2(a_linesofar*u_patternscale_b.x/floorwidth,normal.y*u_patternscale_b.y+u_tex_y_b);v_width2=vec2(outset,inset);}"),Fc=M("uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;varying vec2 v_pos0;varying vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture2D(u_image0,v_pos0);vec4 color1=texture2D(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);gl_FragColor=vec4(mix(u_high_vec,u_low_vec,rgb)*color.a,color.a);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_buffer_scale;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos0;varying vec2 v_pos1;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos0=(((a_texture_pos/8192.0)-0.5)/u_buffer_scale )+0.5;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}"),Gc=M("uniform sampler2D u_texture;\n#pragma mapbox: define lowp float opacity\nvarying vec2 v_tex;varying float v_fade_opacity;void main() {\n#pragma mapbox: initialize lowp float opacity\nlowp float alpha=opacity*v_fade_opacity;gl_FragColor=texture2D(u_texture,v_tex)*alpha;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;\n#pragma mapbox: define lowp float opacity\nuniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_gl_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;varying vec2 v_tex;varying float v_fade_opacity;void main() {\n#pragma mapbox: initialize lowp float opacity\nvec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size[0],a_size[1],u_size_t)/256.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size[0]/256.0;} else if (!u_is_size_zoom_constant && u_is_size_feature_constant) {size=u_size;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?\ncamera_to_anchor_distance/u_camera_to_center_distance :\nu_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,0.0,1.0);gl_Position=u_gl_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale),0.0,1.0);v_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;v_fade_opacity=max(0.0,min(1.0,fade_opacity[0]+fade_change));}"),Hc=M("#define SDF_PX 8.0\n#define EDGE_GAMMA 0.105/DEVICE_PIXEL_RATIO\nuniform bool u_is_halo;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nuniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform bool u_is_text;varying vec2 v_data0;varying vec3 v_data1;void main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nvec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nuniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_gl_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;varying vec2 v_data0;varying vec3 v_data1;void main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nvec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size[0],a_size[1],u_size_t)/256.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size[0]/256.0;} else if (!u_is_size_zoom_constant && u_is_size_feature_constant) {size=u_size;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?\ncamera_to_anchor_distance/u_camera_to_center_distance :\nu_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,0.0,1.0);gl_Position=u_gl_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale),0.0,1.0);float gamma_scale=gl_Position.w;vec2 tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(1.0,fade_opacity[0]+fade_change));v_data0=vec2(tex.x,tex.y);v_data1=vec3(gamma_scale,size,interpolated_fade_opacity);}"),Ic=Object.freeze({
prelude:ic,background:jc,backgroundPattern:kc,circle:lc,clippingMask:mc,heatmap:nc,heatmapTexture:oc,collisionBox:pc,collisionCircle:qc,debug:rc,fill:sc,fillOutline:tc,fillOutlinePattern:uc,fillPattern:vc,fillExtrusion:wc,fillExtrusionPattern:xc,extrusionTexture:yc,hillshadePrepare:zc,hillshade:Ac,line:Bc,lineGradient:Cc,linePattern:Dc,lineSDF:Ec,raster:Fc,symbolIcon:Gc,symbolSDF:Hc}),Jc=function(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffer=null,this.vao=null};Jc.prototype.bind=function(a,b,c,d,e,f,g,h){this.context=a;for(var i=this.boundPaintVertexBuffers.length!==d.length,j=0;!i&&j<d.length;j++)this.boundPaintVertexBuffers[j]!==d[j]&&(i=!0);var k=!this.vao||this.boundProgram!==b||this.boundLayoutVertexBuffer!==c||i||this.boundIndexBuffer!==e||this.boundVertexOffset!==f||this.boundDynamicVertexBuffer!==g||this.boundDynamicVertexBuffer2!==h;!a.extVertexArrayObject||k?this.freshBind(b,c,d,e,f,g,h):(a.bindVertexArrayOES.set(this.vao),g&&g.bind(),e&&e.dynamicDraw&&e.bind(),h&&h.bind())},Jc.prototype.freshBind=function(a,b,c,d,e,f,g){var h,i=a.numAttributes,j=this.context,k=j.gl;if(j.extVertexArrayObject)this.vao&&this.destroy(),this.vao=j.extVertexArrayObject.createVertexArrayOES(),j.bindVertexArrayOES.set(this.vao),h=0,this.boundProgram=a,this.boundLayoutVertexBuffer=b,this.boundPaintVertexBuffers=c,this.boundIndexBuffer=d,this.boundVertexOffset=e,this.boundDynamicVertexBuffer=f,this.boundDynamicVertexBuffer2=g;else{h=j.currentNumAttributes||0;for(var l=i;l<h;l++)k.disableVertexAttribArray(l)}b.enableAttributes(k,a);for(var m=0,n=c;m<n.length;m+=1)n[m].enableAttributes(k,a);f&&f.enableAttributes(k,a),g&&g.enableAttributes(k,a),b.bind(),b.setVertexAttribPointers(k,a,e);for(var o=0,p=c;o<p.length;o+=1){var q=p[o];q.bind(),q.setVertexAttribPointers(k,a,e)}f&&(f.bind(),f.setVertexAttribPointers(k,a,e)),d&&d.bind(),g&&(g.bind(),g.setVertexAttribPointers(k,a,e)),j.currentNumAttributes=i},Jc.prototype.destroy=function(){this.vao&&(this.context.extVertexArrayObject.deleteVertexArrayOES(this.vao),this.vao=null)};var Kc=function(b,c,d,e,f){var g=b.gl;this.program=g.createProgram();var h=d.defines().concat("#define DEVICE_PIXEL_RATIO "+a.browser.devicePixelRatio.toFixed(1));f&&h.push("#define OVERDRAW_INSPECTOR;");var i=h.concat(ic.fragmentSource,c.fragmentSource).join("\n"),j=h.concat(ic.vertexSource,c.vertexSource).join("\n"),k=g.createShader(g.FRAGMENT_SHADER);g.shaderSource(k,i),g.compileShader(k),g.attachShader(this.program,k);var l=g.createShader(g.VERTEX_SHADER);g.shaderSource(l,j),g.compileShader(l),g.attachShader(this.program,l);for(var m=d.layoutAttributes||[],n=0;n<m.length;n++)g.bindAttribLocation(this.program,n,m[n].name);g.linkProgram(this.program),this.numAttributes=g.getProgramParameter(this.program,g.ACTIVE_ATTRIBUTES),this.attributes={};for(var o={},p=0;p<this.numAttributes;p++){var q=g.getActiveAttrib(this.program,p);q&&(this.attributes[q.name]=g.getAttribLocation(this.program,q.name))}for(var r=g.getProgramParameter(this.program,g.ACTIVE_UNIFORMS),s=0;s<r;s++){var t=g.getActiveUniform(this.program,s);t&&(o[t.name]=g.getUniformLocation(this.program,t.name))}this.fixedUniforms=e(b,o),this.binderUniforms=d.getUniforms(b,o)};Kc.prototype.draw=function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p){var q,r=a.gl;for(var s in a.program.set(this.program),a.setDepthMode(c),a.setStencilMode(d),a.setColorMode(e),a.setCullFace(f),this.fixedUniforms)this.fixedUniforms[s].set(g[s]);n&&n.setUniforms(a,this.binderUniforms,l,{zoom:m});for(var t=(q={},q[r.LINES]=2,q[r.TRIANGLES]=3,q[r.LINE_STRIP]=1,q)[b],u=0,v=k.get();u<v.length;u+=1){var w=v[u],x=w.vaos||(w.vaos={});(x[h]||(x[h]=new Jc)).bind(a,this,i,n?n.getPaintVertexBuffers():[],j,w.vertexOffset,o,p),r.drawElements(b,w.primitiveLength*t,r.UNSIGNED_SHORT,w.primitiveOffset*t*2)}};var Lc=function(b,c,d){var e=c.style.light,f=e.properties.get("position"),g=[f.x,f.y,f.z],h=a.create();"viewport"===e.properties.get("anchor")&&a.fromRotation(h,-c.transform.angle),a.transformMat3(g,g,h);var i=e.properties.get("color");return{u_matrix:b,u_lightpos:g,u_lightintensity:e.properties.get("intensity"),u_lightcolor:[i.r,i.g,i.b],u_vertical_gradient:+d}},Mc=function(b,c,d,e,f,g){return a.extend(Lc(b,c,d),N(f,c,g),{u_height_factor:-Math.pow(2,e.overscaledZ)/g.tileSize/8})},Nc=function(b,c,d){var e=a.create$1();a.ortho(e,0,b.width,b.height,0,0,1);var f=b.context.gl;return{u_matrix:e,u_world:[f.drawingBufferWidth,f.drawingBufferHeight],u_image:d,u_opacity:c}},Oc=function(a){return{u_matrix:a}},Pc=function(b,c,d,e){return a.extend(Oc(b),N(d,c,e))},Qc=function(a,b){return{u_matrix:a,u_world:b}},Rc=function(b,c,d,e,f){return a.extend(Pc(b,c,d,e),{u_world:f})},Sc=function(a,b,c,d){var e,f,g=a.transform;if("map"===d.paint.get("circle-pitch-alignment")){var h=J(c,1,g.zoom);e=!0,f=[h,h]}else e=!1,f=g.pixelsToGLUnits;return{u_camera_to_center_distance:g.cameraToCenterDistance,u_scale_with_map:+("map"===d.paint.get("circle-pitch-scale")),u_matrix:a.translatePosMatrix(b.posMatrix,c,d.paint.get("circle-translate"),d.paint.get("circle-translate-anchor")),u_pitch_with_map:+e,u_extrude_scale:f}},Tc=function(b,c){return{u_matrix:new a.UniformMatrix4f(b,c.u_matrix),u_camera_to_center_distance:new a.Uniform1f(b,c.u_camera_to_center_distance),u_pixels_to_tile_units:new a.Uniform1f(b,c.u_pixels_to_tile_units),u_extrude_scale:new a.Uniform2f(b,c.u_extrude_scale),u_overscale_factor:new a.Uniform1f(b,c.u_overscale_factor)}},Uc=function(a,b,c){var d=J(c,1,b.zoom),e=Math.pow(2,b.zoom-c.tileID.overscaledZ),f=c.tileID.overscaleFactor();return{u_matrix:a,u_camera_to_center_distance:b.cameraToCenterDistance,u_pixels_to_tile_units:d,u_extrude_scale:[b.pixelsToGLUnits[0]/(d*e),b.pixelsToGLUnits[1]/(d*e)],u_overscale_factor:f}},Vc=function(a,b){return{u_matrix:a,u_color:b}},Wc=function(a){return{u_matrix:a}},Xc=function(a,b,c,d){return{u_matrix:a,u_extrude_scale:J(b,1,c),u_intensity:d}},Yc=function(b,c,d,e){var f=a.create$1();a.ortho(f,0,b.width,b.height,0,0,1);var g=b.context.gl;return{u_matrix:f,u_world:[g.drawingBufferWidth,g.drawingBufferHeight],u_image:d,u_color_ramp:e,u_opacity:c.paint.get("heatmap-opacity")}},Zc=function(a,b,c){var d=c.paint.get("hillshade-shadow-color"),e=c.paint.get("hillshade-highlight-color"),f=c.paint.get("hillshade-accent-color"),g=c.paint.get("hillshade-illumination-direction")*(Math.PI/180);"viewport"===c.paint.get("hillshade-illumination-anchor")&&(g-=a.transform.angle);var h=!a.options.moving;return{u_matrix:a.transform.calculatePosMatrix(b.tileID.toUnwrapped(),h),u_image:0,u_latrange:O(a,b.tileID),u_light:[c.paint.get("hillshade-exaggeration"),g],u_shadow:d,u_highlight:e,u_accent:f}},$c=function(b,c){var d=b.dem.stride,e=a.create$1();return a.ortho(e,0,a.EXTENT,-a.EXTENT,0,0,1),a.translate(e,e,[0,-a.EXTENT,0]),{u_matrix:e,u_image:1,u_dimension:[d,d],u_zoom:b.tileID.overscaledZ,u_maxzoom:c}},_c=function(a,b,c){var d=a.transform;return{u_matrix:Q(a,b,c),u_ratio:1/J(b,1,d.zoom),u_gl_units_to_pixels:[1/d.pixelsToGLUnits[0],1/d.pixelsToGLUnits[1]]}},ad=function(b,c,d){return a.extend(_c(b,c,d),{u_image:0})},bd=function(b,c,d,e){var f=b.transform,g=P(c,f);return{u_matrix:Q(b,c,d),u_texsize:c.imageAtlasTexture.size,u_ratio:1/J(c,1,f.zoom),u_image:0,u_scale:[a.browser.devicePixelRatio,g,e.fromScale,e.toScale],u_fade:e.t,u_gl_units_to_pixels:[1/f.pixelsToGLUnits[0],1/f.pixelsToGLUnits[1]]}},cd=function(b,c,d,e,f){var g=b.transform,h=b.lineAtlas,i=P(c,g),j="round"===d.layout.get("line-cap"),k=h.getDash(e.from,j),l=h.getDash(e.to,j),m=k.width*f.fromScale,n=l.width*f.toScale;return a.extend(_c(b,c,d),{u_patternscale_a:[i/m,-k.height/2],u_patternscale_b:[i/n,-l.height/2],u_sdfgamma:h.width/(256*Math.min(m,n)*a.browser.devicePixelRatio)/2,u_image:0,u_tex_y_a:k.y,u_tex_y_b:l.y,u_mix:f.t})},dd=function(a,b,c,d,e){return{u_matrix:a,u_tl_parent:b,u_scale_parent:c,u_buffer_scale:1,u_fade_t:d.mix,u_opacity:d.opacity*e.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:e.paint.get("raster-brightness-min"),u_brightness_high:e.paint.get("raster-brightness-max"),u_saturation_factor:(g=e.paint.get("raster-saturation"),g>0?1-1/(1.001-g):-g),u_contrast_factor:(f=e.paint.get("raster-contrast"),f>0?1/(1-f):1+f),u_spin_weights:R(e.paint.get("raster-hue-rotate"))};var f,g},ed=function(a,b,c,d,e,f,g,h,i,j){var k=e.transform;return{u_is_size_zoom_constant:+("constant"===a||"source"===a),u_is_size_feature_constant:+("constant"===a||"camera"===a),u_size_t:b?b.uSizeT:0,u_size:b?b.uSize:0,u_camera_to_center_distance:k.cameraToCenterDistance,u_pitch:k.pitch/360*2*Math.PI,u_rotate_symbol:+c,u_aspect_ratio:k.width/k.height,u_fade_change:e.options.fadeDuration?e.symbolFadeChange:1,u_matrix:f,u_label_plane_matrix:g,u_gl_coord_matrix:h,u_is_text:+i,u_pitch_with_map:+d,u_texsize:j,u_texture:0}},fd=function(b,c,d,e,f,g,h,i,j,k,l){var m=f.transform;return a.extend(ed(b,c,d,e,f,g,h,i,j,k),{u_gamma_scale:e?Math.cos(m._pitch)*m.cameraToCenterDistance:1,u_is_halo:+l})},gd=function(a,b,c){return{u_matrix:a,u_opacity:b,u_color:c}},hd=function(b,c,d,e,f,g){return a.extend(function(a,b,c,d){var e=c.imageManager.getPattern(a.from),f=c.imageManager.getPattern(a.to),g=c.imageManager.getPixelSize(),h=g.width,i=g.height,j=Math.pow(2,d.tileID.overscaledZ),k=d.tileSize*Math.pow(2,c.transform.tileZoom)/j,l=k*(d.tileID.canonical.x+d.tileID.wrap*j),m=k*d.tileID.canonical.y;return{u_image:0,u_pattern_tl_a:e.tl,u_pattern_br_a:e.br,u_pattern_tl_b:f.tl,u_pattern_br_b:f.br,u_texsize:[h,i],u_mix:b.t,u_pattern_size_a:e.displaySize,u_pattern_size_b:f.displaySize,u_scale_a:b.fromScale,u_scale_b:b.toScale,u_tile_units_to_pixels:1/J(d,1,c.transform.tileZoom),u_pixel_coord_upper:[l>>16,m>>16],u_pixel_coord_lower:[65535&l,65535&m]}}(e,g,d,f),{u_matrix:b,u_opacity:c})},id={fillExtrusion:function(b,c){return{u_matrix:new a.UniformMatrix4f(b,c.u_matrix),u_lightpos:new a.Uniform3f(b,c.u_lightpos),u_lightintensity:new a.Uniform1f(b,c.u_lightintensity),u_lightcolor:new a.Uniform3f(b,c.u_lightcolor),u_vertical_gradient:new a.Uniform1f(b,c.u_vertical_gradient)}},fillExtrusionPattern:function(b,c){return{u_matrix:new a.UniformMatrix4f(b,c.u_matrix),u_lightpos:new a.Uniform3f(b,c.u_lightpos),u_lightintensity:new a.Uniform1f(b,c.u_lightintensity),u_lightcolor:new a.Uniform3f(b,c.u_lightcolor),u_vertical_gradient:new a.Uniform1f(b,c.u_vertical_gradient),u_height_factor:new a.Uniform1f(b,c.u_height_factor),u_image:new a.Uniform1i(b,c.u_image),u_texsize:new a.Uniform2f(b,c.u_texsize),u_pixel_coord_upper:new a.Uniform2f(b,c.u_pixel_coord_upper),u_pixel_coord_lower:new a.Uniform2f(b,c.u_pixel_coord_lower),u_scale:new a.Uniform4f(b,c.u_scale),u_fade:new a.Uniform1f(b,c.u_fade)}},extrusionTexture:function(b,c){return{u_matrix:new a.UniformMatrix4f(b,c.u_matrix),u_world:new a.Uniform2f(b,c.u_world),u_image:new a.Uniform1i(b,c.u_image),u_opacity:new a.Uniform1f(b,c.u_opacity)}},fill:function(b,c){return{u_matrix:new a.UniformMatrix4f(b,c.u_matrix)}},fillPattern:function(b,c){return{u_matrix:new a.UniformMatrix4f(b,c.u_matrix),u_image:new a.Uniform1i(b,c.u_image),u_texsize:new a.Uniform2f(b,c.u_texsize),u_pixel_coord_upper:new a.Uniform2f(b,c.u_pixel_coord_upper),u_pixel_coord_lower:new a.Uniform2f(b,c.u_pixel_coord_lower),u_scale:new a.Uniform4f(b,c.u_scale),u_fade:new a.Uniform1f(b,c.u_fade)}},fillOutline:function(b,c){return{u_matrix:new a.UniformMatrix4f(b,c.u_matrix),u_world:new a.Uniform2f(b,c.u_world)}},fillOutlinePattern:function(b,c){return{u_matrix:new a.UniformMatrix4f(b,c.u_matrix),u_world:new a.Uniform2f(b,c.u_world),u_image:new a.Uniform1i(b,c.u_image),u_texsize:new a.Uniform2f(b,c.u_texsize),u_pixel_coord_upper:new a.Uniform2f(b,c.u_pixel_coord_upper),u_pixel_coord_lower:new a.Uniform2f(b,c.u_pixel_coord_lower),u_scale:new a.Uniform4f(b,c.u_scale),u_fade:new a.Uniform1f(b,c.u_fade)}},circle:function(b,c){return{u_camera_to_center_distance:new a.Uniform1f(b,c.u_camera_to_center_distance),u_scale_with_map:new a.Uniform1i(b,c.u_scale_with_map),u_pitch_with_map:new a.Uniform1i(b,c.u_pitch_with_map),u_extrude_scale:new a.Uniform2f(b,c.u_extrude_scale),u_matrix:new a.UniformMatrix4f(b,c.u_matrix)}},collisionBox:Tc,collisionCircle:Tc,debug:function(b,c){return{u_color:new a.UniformColor(b,c.u_color),u_matrix:new a.UniformMatrix4f(b,c.u_matrix)}},clippingMask:function(b,c){return{u_matrix:new a.UniformMatrix4f(b,c.u_matrix)}},heatmap:function(b,c){return{u_extrude_scale:new a.Uniform1f(b,c.u_extrude_scale),u_intensity:new a.Uniform1f(b,c.u_intensity),u_matrix:new a.UniformMatrix4f(b,c.u_matrix)}},heatmapTexture:function(b,c){return{u_matrix:new a.UniformMatrix4f(b,c.u_matrix),u_world:new a.Uniform2f(b,c.u_world),u_image:new a.Uniform1i(b,c.u_image),u_color_ramp:new a.Uniform1i(b,c.u_color_ramp),u_opacity:new a.Uniform1f(b,c.u_opacity)}},hillshade:function(b,c){return{u_matrix:new a.UniformMatrix4f(b,c.u_matrix),u_image:new a.Uniform1i(b,c.u_image),u_latrange:new a.Uniform2f(b,c.u_latrange),u_light:new a.Uniform2f(b,c.u_light),u_shadow:new a.UniformColor(b,c.u_shadow),u_highlight:new a.UniformColor(b,c.u_highlight),u_accent:new a.UniformColor(b,c.u_accent)}},hillshadePrepare:function(b,c){return{u_matrix:new a.UniformMatrix4f(b,c.u_matrix),u_image:new a.Uniform1i(b,c.u_image),u_dimension:new a.Uniform2f(b,c.u_dimension),u_zoom:new a.Uniform1f(b,c.u_zoom),u_maxzoom:new a.Uniform1f(b,c.u_maxzoom)}},line:function(b,c){return{u_matrix:new a.UniformMatrix4f(b,c.u_matrix),u_ratio:new a.Uniform1f(b,c.u_ratio),u_gl_units_to_pixels:new a.Uniform2f(b,c.u_gl_units_to_pixels)}},lineGradient:function(b,c){return{u_matrix:new a.UniformMatrix4f(b,c.u_matrix),u_ratio:new a.Uniform1f(b,c.u_ratio),u_gl_units_to_pixels:new a.Uniform2f(b,c.u_gl_units_to_pixels),u_image:new a.Uniform1i(b,c.u_image)}},linePattern:function(b,c){return{u_matrix:new a.UniformMatrix4f(b,c.u_matrix),u_texsize:new a.Uniform2f(b,c.u_texsize),u_ratio:new a.Uniform1f(b,c.u_ratio),u_image:new a.Uniform1i(b,c.u_image),u_gl_units_to_pixels:new a.Uniform2f(b,c.u_gl_units_to_pixels),u_scale:new a.Uniform4f(b,c.u_scale),u_fade:new a.Uniform1f(b,c.u_fade)}},lineSDF:function(b,c){return{u_matrix:new a.UniformMatrix4f(b,c.u_matrix),u_ratio:new a.Uniform1f(b,c.u_ratio),u_gl_units_to_pixels:new a.Uniform2f(b,c.u_gl_units_to_pixels),u_patternscale_a:new a.Uniform2f(b,c.u_patternscale_a),u_patternscale_b:new a.Uniform2f(b,c.u_patternscale_b),u_sdfgamma:new a.Uniform1f(b,c.u_sdfgamma),u_image:new a.Uniform1i(b,c.u_image),u_tex_y_a:new a.Uniform1f(b,c.u_tex_y_a),u_tex_y_b:new a.Uniform1f(b,c.u_tex_y_b),u_mix:new a.Uniform1f(b,c.u_mix)}},raster:function(b,c){return{u_matrix:new a.UniformMatrix4f(b,c.u_matrix),u_tl_parent:new a.Uniform2f(b,c.u_tl_parent),u_scale_parent:new a.Uniform1f(b,c.u_scale_parent),u_buffer_scale:new a.Uniform1f(b,c.u_buffer_scale),u_fade_t:new a.Uniform1f(b,c.u_fade_t),u_opacity:new a.Uniform1f(b,c.u_opacity),u_image0:new a.Uniform1i(b,c.u_image0),u_image1:new a.Uniform1i(b,c.u_image1),u_brightness_low:new a.Uniform1f(b,c.u_brightness_low),u_brightness_high:new a.Uniform1f(b,c.u_brightness_high),u_saturation_factor:new a.Uniform1f(b,c.u_saturation_factor),u_contrast_factor:new a.Uniform1f(b,c.u_contrast_factor),u_spin_weights:new a.Uniform3f(b,c.u_spin_weights)}},symbolIcon:function(b,c){return{u_is_size_zoom_constant:new a.Uniform1i(b,c.u_is_size_zoom_constant),u_is_size_feature_constant:new a.Uniform1i(b,c.u_is_size_feature_constant),u_size_t:new a.Uniform1f(b,c.u_size_t),u_size:new a.Uniform1f(b,c.u_size),u_camera_to_center_distance:new a.Uniform1f(b,c.u_camera_to_center_distance),u_pitch:new a.Uniform1f(b,c.u_pitch),u_rotate_symbol:new a.Uniform1i(b,c.u_rotate_symbol),u_aspect_ratio:new a.Uniform1f(b,c.u_aspect_ratio),u_fade_change:new a.Uniform1f(b,c.u_fade_change),u_matrix:new a.UniformMatrix4f(b,c.u_matrix),u_label_plane_matrix:new a.UniformMatrix4f(b,c.u_label_plane_matrix),u_gl_coord_matrix:new a.UniformMatrix4f(b,c.u_gl_coord_matrix),u_is_text:new a.Uniform1f(b,c.u_is_text),u_pitch_with_map:new a.Uniform1i(b,c.u_pitch_with_map),u_texsize:new a.Uniform2f(b,c.u_texsize),u_texture:new a.Uniform1i(b,c.u_texture)}},symbolSDF:function(b,c){return{u_is_size_zoom_constant:new a.Uniform1i(b,c.u_is_size_zoom_constant),u_is_size_feature_constant:new a.Uniform1i(b,c.u_is_size_feature_constant),u_size_t:new a.Uniform1f(b,c.u_size_t),u_size:new a.Uniform1f(b,c.u_size),u_camera_to_center_distance:new a.Uniform1f(b,c.u_camera_to_center_distance),u_pitch:new a.Uniform1f(b,c.u_pitch),u_rotate_symbol:new a.Uniform1i(b,c.u_rotate_symbol),u_aspect_ratio:new a.Uniform1f(b,c.u_aspect_ratio),u_fade_change:new a.Uniform1f(b,c.u_fade_change),u_matrix:new a.UniformMatrix4f(b,c.u_matrix),u_label_plane_matrix:new a.UniformMatrix4f(b,c.u_label_plane_matrix),u_gl_coord_matrix:new a.UniformMatrix4f(b,c.u_gl_coord_matrix),u_is_text:new a.Uniform1f(b,c.u_is_text),u_pitch_with_map:new a.Uniform1i(b,c.u_pitch_with_map),u_texsize:new a.Uniform2f(b,c.u_texsize),u_texture:new a.Uniform1i(b,c.u_texture),u_gamma_scale:new a.Uniform1f(b,c.u_gamma_scale),u_is_halo:new a.Uniform1f(b,c.u_is_halo)}},background:function(b,c){return{u_matrix:new a.UniformMatrix4f(b,c.u_matrix),u_opacity:new a.Uniform1f(b,c.u_opacity),u_color:new a.UniformColor(b,c.u_color)}},backgroundPattern:function(b,c){return{u_matrix:new a.UniformMatrix4f(b,c.u_matrix),u_opacity:new a.Uniform1f(b,c.u_opacity),u_image:new a.Uniform1i(b,c.u_image),u_pattern_tl_a:new a.Uniform2f(b,c.u_pattern_tl_a),u_pattern_br_a:new a.Uniform2f(b,c.u_pattern_br_a),u_pattern_tl_b:new a.Uniform2f(b,c.u_pattern_tl_b),u_pattern_br_b:new a.Uniform2f(b,c.u_pattern_br_b),u_texsize:new a.Uniform2f(b,c.u_texsize),u_mix:new a.Uniform1f(b,c.u_mix),u_pattern_size_a:new a.Uniform2f(b,c.u_pattern_size_a),u_pattern_size_b:new a.Uniform2f(b,c.u_pattern_size_b),u_scale_a:new a.Uniform1f(b,c.u_scale_a),u_scale_b:new a.Uniform1f(b,c.u_scale_b),u_pixel_coord_upper:new a.Uniform2f(b,c.u_pixel_coord_upper),u_pixel_coord_lower:new a.Uniform2f(b,c.u_pixel_coord_lower),u_tile_units_to_pixels:new a.Uniform1f(b,c.u_tile_units_to_pixels)}}},jd=a.identity(new Float32Array(16)),kd=a.properties.layout,ld={" ":[16,[]],"!":[10,[5,21,5,7,-1,-1,5,2,4,1,5,0,6,1,5,2]],'"':[16,[4,21,4,14,-1,-1,12,21,12,14]],"#":[21,[11,25,4,-7,-1,-1,17,25,10,-7,-1,-1,4,12,18,12,-1,-1,3,6,17,6]],$:[20,[8,25,8,-4,-1,-1,12,25,12,-4,-1,-1,17,18,15,20,12,21,8,21,5,20,3,18,3,16,4,14,5,13,7,12,13,10,15,9,16,8,17,6,17,3,15,1,12,0,8,0,5,1,3,3]],"%":[24,[21,21,3,0,-1,-1,8,21,10,19,10,17,9,15,7,14,5,14,3,16,3,18,4,20,6,21,8,21,10,20,13,19,16,19,19,20,21,21,-1,-1,17,7,15,6,14,4,14,2,16,0,18,0,20,1,21,3,21,5,19,7,17,7]],"&":[26,[23,12,23,13,22,14,21,14,20,13,19,11,17,6,15,3,13,1,11,0,7,0,5,1,4,2,3,4,3,6,4,8,5,9,12,13,13,14,14,16,14,18,13,20,11,21,9,20,8,18,8,16,9,13,11,10,16,3,18,1,20,0,22,0,23,1,23,2]],"'":[10,[5,19,4,20,5,21,6,20,6,18,5,16,4,15]],"(":[14,[11,25,9,23,7,20,5,16,4,11,4,7,5,2,7,-2,9,-5,11,-7]],")":[14,[3,25,5,23,7,20,9,16,10,11,10,7,9,2,7,-2,5,-5,3,-7]],"*":[16,[8,21,8,9,-1,-1,3,18,13,12,-1,-1,13,18,3,12]],"+":[26,[13,18,13,0,-1,-1,4,9,22,9]],",":[10,[6,1,5,0,4,1,5,2,6,1,6,-1,5,-3,4,-4]],"-":[26,[4,9,22,9]],".":[10,[5,2,4,1,5,0,6,1,5,2]],"/":[22,[20,25,2,-7]],0:[20,[9,21,6,20,4,17,3,12,3,9,4,4,6,1,9,0,11,0,14,1,16,4,17,9,17,12,16,17,14,20,11,21,9,21]],1:[20,[6,17,8,18,11,21,11,0]],2:[20,[4,16,4,17,5,19,6,20,8,21,12,21,14,20,15,19,16,17,16,15,15,13,13,10,3,0,17,0]],3:[20,[5,21,16,21,10,13,13,13,15,12,16,11,17,8,17,6,16,3,14,1,11,0,8,0,5,1,4,2,3,4]],4:[20,[13,21,3,7,18,7,-1,-1,13,21,13,0]],5:[20,[15,21,5,21,4,12,5,13,8,14,11,14,14,13,16,11,17,8,17,6,16,3,14,1,11,0,8,0,5,1,4,2,3,4]],6:[20,[16,18,15,20,12,21,10,21,7,20,5,17,4,12,4,7,5,3,7,1,10,0,11,0,14,1,16,3,17,6,17,7,16,10,14,12,11,13,10,13,7,12,5,10,4,7]],7:[20,[17,21,7,0,-1,-1,3,21,17,21]],8:[20,[8,21,5,20,4,18,4,16,5,14,7,13,11,12,14,11,16,9,17,7,17,4,16,2,15,1,12,0,8,0,5,1,4,2,3,4,3,7,4,9,6,11,9,12,13,13,15,14,16,16,16,18,15,20,12,21,8,21]],9:[20,[16,14,15,11,13,9,10,8,9,8,6,9,4,11,3,14,3,15,4,18,6,20,9,21,10,21,13,20,15,18,16,14,16,9,15,4,13,1,10,0,8,0,5,1,4,3]],":":[10,[5,14,4,13,5,12,6,13,5,14,-1,-1,5,2,4,1,5,0,6,1,5,2]],";":[10,[5,14,4,13,5,12,6,13,5,14,-1,-1,6,1,5,0,4,1,5,2,6,1,6,-1,5,-3,4,-4]],"<":[24,[20,18,4,9,20,0]],"=":[26,[4,12,22,12,-1,-1,4,6,22,6]],">":[24,[4,18,20,9,4,0]],"?":[18,[3,16,3,17,4,19,5,20,7,21,11,21,13,20,14,19,15,17,15,15,14,13,13,12,9,10,9,7,-1,-1,9,2,8,1,9,0,10,1,9,2]],"@":[27,[18,13,17,15,15,16,12,16,10,15,9,14,8,11,8,8,9,6,11,5,14,5,16,6,17,8,-1,-1,12,16,10,14,9,11,9,8,10,6,11,5,-1,-1,18,16,17,8,17,6,19,5,21,5,23,7,24,10,24,12,23,15,22,17,20,19,18,20,15,21,12,21,9,20,7,19,5,17,4,15,3,12,3,9,4,6,5,4,7,2,9,1,12,0,15,0,18,1,20,2,21,3,-1,-1,19,16,18,8,18,6,19,5]],A:[18,[9,21,1,0,-1,-1,9,21,17,0,-1,-1,4,7,14,7]],B:[21,[4,21,4,0,-1,-1,4,21,13,21,16,20,17,19,18,17,18,15,17,13,16,12,13,11,-1,-1,4,11,13,11,16,10,17,9,18,7,18,4,17,2,16,1,13,0,4,0]],C:[21,[18,16,17,18,15,20,13,21,9,21,7,20,5,18,4,16,3,13,3,8,4,5,5,3,7,1,9,0,13,0,15,1,17,3,18,5]],D:[21,[4,21,4,0,-1,-1,4,21,11,21,14,20,16,18,17,16,18,13,18,8,17,5,16,3,14,1,11,0,4,0]],E:[19,[4,21,4,0,-1,-1,4,21,17,21,-1,-1,4,11,12,11,-1,-1,4,0,17,0]],F:[18,[4,21,4,0,-1,-1,4,21,17,21,-1,-1,4,11,12,11]],G:[21,[18,16,17,18,15,20,13,21,9,21,7,20,5,18,4,16,3,13,3,8,4,5,5,3,7,1,9,0,13,0,15,1,17,3,18,5,18,8,-1,-1,13,8,18,8]],H:[22,[4,21,4,0,-1,-1,18,21,18,0,-1,-1,4,11,18,11]],I:[8,[4,21,4,0]],J:[16,[12,21,12,5,11,2,10,1,8,0,6,0,4,1,3,2,2,5,2,7]],K:[21,[4,21,4,0,-1,-1,18,21,4,7,-1,-1,9,12,18,0]],L:[17,[4,21,4,0,-1,-1,4,0,16,0]],M:[24,[4,21,4,0,-1,-1,4,21,12,0,-1,-1,20,21,12,0,-1,-1,20,21,20,0]],N:[22,[4,21,4,0,-1,-1,4,21,18,0,-1,-1,18,21,18,0]],O:[22,[9,21,7,20,5,18,4,16,3,13,3,8,4,5,5,3,7,1,9,0,13,0,15,1,17,3,18,5,19,8,19,13,18,16,17,18,15,20,13,21,9,21]],P:[21,[4,21,4,0,-1,-1,4,21,13,21,16,20,17,19,18,17,18,14,17,12,16,11,13,10,4,10]],Q:[22,[9,21,7,20,5,18,4,16,3,13,3,8,4,5,5,3,7,1,9,0,13,0,15,1,17,3,18,5,19,8,19,13,18,16,17,18,15,20,13,21,9,21,-1,-1,12,4,18,-2]],R:[21,[4,21,4,0,-1,-1,4,21,13,21,16,20,17,19,18,17,18,15,17,13,16,12,13,11,4,11,-1,-1,11,11,18,0]],S:[20,[17,18,15,20,12,21,8,21,5,20,3,18,3,16,4,14,5,13,7,12,13,10,15,9,16,8,17,6,17,3,15,1,12,0,8,0,5,1,3,3]],T:[16,[8,21,8,0,-1,-1,1,21,15,21]],U:[22,[4,21,4,6,5,3,7,1,10,0,12,0,15,1,17,3,18,6,18,21]],V:[18,[1,21,9,0,-1,-1,17,21,9,0]],W:[24,[2,21,7,0,-1,-1,12,21,7,0,-1,-1,12,21,17,0,-1,-1,22,21,17,0]],X:[20,[3,21,17,0,-1,-1,17,21,3,0]],Y:[18,[1,21,9,11,9,0,-1,-1,17,21,9,11]],Z:[20,[17,21,3,0,-1,-1,3,21,17,21,-1,-1,3,0,17,0]],"[":[14,[4,25,4,-7,-1,-1,5,25,5,-7,-1,-1,4,25,11,25,-1,-1,4,-7,11,-7]],"\\":[14,[0,21,14,-3]],"]":[14,[9,25,9,-7,-1,-1,10,25,10,-7,-1,-1,3,25,10,25,-1,-1,3,-7,10,-7]],"^":[16,[6,15,8,18,10,15,-1,-1,3,12,8,17,13,12,-1,-1,8,17,8,0]],_:[16,[0,-2,16,-2]],"`":[10,[6,21,5,20,4,18,4,16,5,15,6,16,5,17]],a:[19,[15,14,15,0,-1,-1,15,11,13,13,11,14,8,14,6,13,4,11,3,8,3,6,4,3,6,1,8,0,11,0,13,1,15,3]],b:[19,[4,21,4,0,-1,-1,4,11,6,13,8,14,11,14,13,13,15,11,16,8,16,6,15,3,13,1,11,0,8,0,6,1,4,3]],c:[18,[15,11,13,13,11,14,8,14,6,13,4,11,3,8,3,6,4,3,6,1,8,0,11,0,13,1,15,3]],d:[19,[15,21,15,0,-1,-1,15,11,13,13,11,14,8,14,6,13,4,11,3,8,3,6,4,3,6,1,8,0,11,0,13,1,15,3]],e:[18,[3,8,15,8,15,10,14,12,13,13,11,14,8,14,6,13,4,11,3,8,3,6,4,3,6,1,8,0,11,0,13,1,15,3]],f:[12,[10,21,8,21,6,20,5,17,5,0,-1,-1,2,14,9,14]],g:[19,[15,14,15,-2,14,-5,13,-6,11,-7,8,-7,6,-6,-1,-1,15,11,13,13,11,14,8,14,6,13,4,11,3,8,3,6,4,3,6,1,8,0,11,0,13,1,15,3]],h:[19,[4,21,4,0,-1,-1,4,10,7,13,9,14,12,14,14,13,15,10,15,0]],i:[8,[3,21,4,20,5,21,4,22,3,21,-1,-1,4,14,4,0]],j:[10,[5,21,6,20,7,21,6,22,5,21,-1,-1,6,14,6,-3,5,-6,3,-7,1,-7]],k:[17,[4,21,4,0,-1,-1,14,14,4,4,-1,-1,8,8,15,0]],l:[8,[4,21,4,0]],m:[30,[4,14,4,0,-1,-1,4,10,7,13,9,14,12,14,14,13,15,10,15,0,-1,-1,15,10,18,13,20,14,23,14,25,13,26,10,26,0]],n:[19,[4,14,4,0,-1,-1,4,10,7,13,9,14,12,14,14,13,15,10,15,0]],o:[19,[8,14,6,13,4,11,3,8,3,6,4,3,6,1,8,0,11,0,13,1,15,3,16,6,16,8,15,11,13,13,11,14,8,14]],p:[19,[4,14,4,-7,-1,-1,4,11,6,13,8,14,11,14,13,13,15,11,16,8,16,6,15,3,13,1,11,0,8,0,6,1,4,3]],q:[19,[15,14,15,-7,-1,-1,15,11,13,13,11,14,8,14,6,13,4,11,3,8,3,6,4,3,6,1,8,0,11,0,13,1,15,3]],r:[13,[4,14,4,0,-1,-1,4,8,5,11,7,13,9,14,12,14]],s:[17,[14,11,13,13,10,14,7,14,4,13,3,11,4,9,6,8,11,7,13,6,14,4,14,3,13,1,10,0,7,0,4,1,3,3]],t:[12,[5,21,5,4,6,1,8,0,10,0,-1,-1,2,14,9,14]],u:[19,[4,14,4,4,5,1,7,0,10,0,12,1,15,4,-1,-1,15,14,15,0]],v:[16,[2,14,8,0,-1,-1,14,14,8,0]],w:[22,[3,14,7,0,-1,-1,11,14,7,0,-1,-1,11,14,15,0,-1,-1,19,14,15,0]],x:[17,[3,14,14,0,-1,-1,14,14,3,0]],y:[16,[2,14,8,0,-1,-1,14,14,8,0,6,-4,4,-6,2,-7,1,-7]],z:[17,[14,14,3,0,-1,-1,3,14,14,14,-1,-1,3,0,14,0]],"{":[14,[9,25,7,24,6,23,5,21,5,19,6,17,7,16,8,14,8,12,6,10,-1,-1,7,24,6,22,6,20,7,18,8,17,9,15,9,13,8,11,4,9,8,7,9,5,9,3,8,1,7,0,6,-2,6,-4,7,-6,-1,-1,6,8,8,6,8,4,7,2,6,1,5,-1,5,-3,6,-5,7,-6,9,-7]],"|":[8,[4,25,4,-7]],"}":[14,[5,25,7,24,8,23,9,21,9,19,8,17,7,16,6,14,6,12,8,10,-1,-1,7,24,8,22,8,20,7,18,6,17,5,15,5,13,6,11,10,9,6,7,5,5,5,3,6,1,7,0,8,-2,8,-4,7,-6,-1,-1,8,8,6,6,6,4,7,2,8,1,9,-1,9,-3,8,-5,7,-6,5,-7]],"~":[24,[3,6,3,8,4,11,6,12,8,12,10,11,14,8,16,7,18,7,20,8,21,10,-1,-1,3,8,4,10,6,11,8,11,10,10,14,7,16,6,18,6,20,7,21,10,21,12]]},md={symbol:function(a,b,c,d){if("translucent"===a.renderPass){var e=yb.disabled,f=a.colorModeForRenderPass();0!==c.paint.get("icon-opacity").constantOr(1)&&V(a,b,c,d,!1,c.paint.get("icon-translate"),c.paint.get("icon-translate-anchor"),c.layout.get("icon-rotation-alignment"),c.layout.get("icon-pitch-alignment"),c.layout.get("icon-keep-upright"),e,f),0!==c.paint.get("text-opacity").constantOr(1)&&V(a,b,c,d,!0,c.paint.get("text-translate"),c.paint.get("text-translate-anchor"),c.layout.get("text-rotation-alignment"),c.layout.get("text-pitch-alignment"),c.layout.get("text-keep-upright"),e,f),b.map.showCollisionBoxes&&function(a,b,c,d){U(a,b,c,d,!1),U(a,b,c,d,!0)}(a,b,c,d)}},circle:function(a,b,c,d){if("translucent"===a.renderPass){var e=c.paint.get("circle-opacity"),f=c.paint.get("circle-stroke-width"),g=c.paint.get("circle-stroke-opacity");if(0!==e.constantOr(1)||0!==f.constantOr(1)&&0!==g.constantOr(1))for(var h=a.context,i=h.gl,j=a.depthModeForSublayer(0,xb.ReadOnly),k=yb.disabled,l=a.colorModeForRenderPass(),m=0;m<d.length;m++){var n=d[m],o=b.getTile(n),p=o.getBucket(c);if(p){var q=p.programConfigurations.get(c.id);a.useProgram("circle",q).draw(h,i.TRIANGLES,j,k,l,Ab.disabled,Sc(a,n,o,c),c.id,p.layoutVertexBuffer,p.indexBuffer,p.segments,c.paint,a.transform.zoom,q)}}}},heatmap:function(b,c,d,e){if(0!==d.paint.get("heatmap-opacity"))if("offscreen"===b.renderPass){var f=b.context,g=f.gl,h=b.depthModeForSublayer(0,xb.ReadOnly),i=yb.disabled,j=new zb([g.ONE,g.ONE],a.Color.transparent,[!0,!0,!0,!0]);!function(a,b,c){var d=a.gl;a.activeTexture.set(d.TEXTURE1),a.viewport.set([0,0,b.width/4,b.height/4]);var e=c.heatmapFbo;if(e)d.bindTexture(d.TEXTURE_2D,e.colorAttachment.get()),a.bindFramebuffer.set(e.framebuffer);else{var f=d.createTexture();d.bindTexture(d.TEXTURE_2D,f),d.texParameteri(d.TEXTURE_2D,d.TEXTURE_WRAP_S,d.CLAMP_TO_EDGE),d.texParameteri(d.TEXTURE_2D,d.TEXTURE_WRAP_T,d.CLAMP_TO_EDGE),d.texParameteri(d.TEXTURE_2D,d.TEXTURE_MIN_FILTER,d.LINEAR),d.texParameteri(d.TEXTURE_2D,d.TEXTURE_MAG_FILTER,d.LINEAR),e=c.heatmapFbo=a.createFramebuffer(b.width/4,b.height/4),function a(b,c,d,e){var f=b.gl;f.texImage2D(f.TEXTURE_2D,0,f.RGBA,c.width/4,c.height/4,0,f.RGBA,b.extTextureHalfFloat?b.extTextureHalfFloat.HALF_FLOAT_OES:f.UNSIGNED_BYTE,null),e.colorAttachment.set(d),b.extTextureHalfFloat&&f.checkFramebufferStatus(f.FRAMEBUFFER)!==f.FRAMEBUFFER_COMPLETE&&(b.extTextureHalfFloat=null,e.colorAttachment.setDirty(),a(b,c,d,e))}(a,b,f,e)}}(f,b,d),f.clear({color:a.Color.transparent});for(var k=0;k<e.length;k++){var l=e[k];if(!c.hasRenderableParent(l)){var m=c.getTile(l),n=m.getBucket(d);if(n){var o=n.programConfigurations.get(d.id),p=b.useProgram("heatmap",o),q=b.transform.zoom;p.draw(f,g.TRIANGLES,h,i,j,Ab.disabled,Xc(l.posMatrix,m,q,d.paint.get("heatmap-intensity")),d.id,n.layoutVertexBuffer,n.indexBuffer,n.segments,d.paint,b.transform.zoom,o)}}}f.viewport.set([0,0,b.width,b.height])}else"translucent"===b.renderPass&&(b.context.setColorMode(b.colorModeForRenderPass()),function(b,c){var d=b.context,e=d.gl,f=c.heatmapFbo;if(f){d.activeTexture.set(e.TEXTURE0),e.bindTexture(e.TEXTURE_2D,f.colorAttachment.get()),d.activeTexture.set(e.TEXTURE1);var g=c.colorRampTexture;g||(g=c.colorRampTexture=new a.Texture(d,c.colorRamp,e.RGBA)),g.bind(e.LINEAR,e.CLAMP_TO_EDGE),b.useProgram("heatmapTexture").draw(d,e.TRIANGLES,xb.disabled,yb.disabled,b.colorModeForRenderPass(),Ab.disabled,Yc(b,c,0,1),c.id,b.viewportBuffer,b.quadTriangleIndexBuffer,b.viewportSegments,c.paint,b.transform.zoom)}}(b,d))},line:function(b,c,d,e){if("translucent"===b.renderPass){var f=d.paint.get("line-opacity"),g=d.paint.get("line-width");if(0!==f.constantOr(1)&&0!==g.constantOr(1)){var h=b.depthModeForSublayer(0,xb.ReadOnly),i=b.colorModeForRenderPass(),j=d.paint.get("line-dasharray"),k=d.paint.get("line-pattern"),l=k.constantOr(1),m=d.paint.get("line-gradient"),n=d.getCrossfadeParameters(),o=j?"lineSDF":l?"linePattern":m?"lineGradient":"line",p=b.context,q=p.gl,r=!0;if(m){p.activeTexture.set(q.TEXTURE0);var s=d.gradientTexture;if(!d.gradient)return;s||(s=d.gradientTexture=new a.Texture(p,d.gradient,q.RGBA)),s.bind(q.LINEAR,q.CLAMP_TO_EDGE)}for(var t=0,u=e;t<u.length;t+=1){var v=u[t],w=c.getTile(v);if(!l||w.patternsLoaded()){var x=w.getBucket(d);if(x){var y=x.programConfigurations.get(d.id),z=b.context.program.get(),A=b.useProgram(o,y),B=r||A.program!==z,C=k.constantOr(null);if(C&&w.imageAtlas){var D=w.imageAtlas.patternPositions[C.to],E=w.imageAtlas.patternPositions[C.from];D&&E&&y.setConstantPatternPositions(D,E)}var F=j?cd(b,w,d,j,n):l?bd(b,w,d,n):m?ad(b,w,d):_c(b,w,d);j&&(B||b.lineAtlas.dirty)?(p.activeTexture.set(q.TEXTURE0),b.lineAtlas.bind(p)):l&&(p.activeTexture.set(q.TEXTURE0),w.imageAtlasTexture.bind(q.LINEAR,q.CLAMP_TO_EDGE),y.updatePatternPaintBuffers(n)),A.draw(p,q.TRIANGLES,h,b.stencilModeForClipping(v),i,Ab.disabled,F,d.id,x.layoutVertexBuffer,x.indexBuffer,x.segments,d.paint,b.transform.zoom,y),r=!1}}}}}},fill:function(b,c,d,e){var f=d.paint.get("fill-color"),g=d.paint.get("fill-opacity");if(0!==g.constantOr(1)){var h=b.colorModeForRenderPass(),i=d.paint.get("fill-pattern").constantOr(1)||1!==f.constantOr(a.Color.transparent).a||1!==g.constantOr(0)?"translucent":"opaque";if(b.renderPass===i){X(b,c,d,e,b.depthModeForSublayer(1,"opaque"===b.renderPass?xb.ReadWrite:xb.ReadOnly),h,!1)}if("translucent"===b.renderPass&&d.paint.get("fill-antialias")){X(b,c,d,e,b.depthModeForSublayer(d.getPaintProperty("fill-outline-color")?2:0,xb.ReadOnly),h,!0)}}},"fill-extrusion":function(a,b,c,d){if(0!==c.paint.get("fill-extrusion-opacity"))if("offscreen"===a.renderPass){Y(a,c);var e=new xb(a.context.gl.LEQUAL,xb.ReadWrite,[0,1]),f=yb.disabled,g=a.colorModeForRenderPass();!function(a,b,c,d,e,f,g){for(var h=a.context,i=h.gl,j=c.paint.get("fill-extrusion-pattern"),k=j.constantOr(1),l=c.getCrossfadeParameters(),m=0,n=d;m<n.length;m+=1){var o=n[m],p=b.getTile(o),q=p.getBucket(c);if(q){var r=q.programConfigurations.get(c.id),s=a.useProgram(k?"fillExtrusionPattern":"fillExtrusion",r);k&&(a.context.activeTexture.set(i.TEXTURE0),p.imageAtlasTexture.bind(i.LINEAR,i.CLAMP_TO_EDGE),r.updatePatternPaintBuffers(l));var t=j.constantOr(null);if(t&&p.imageAtlas){var u=p.imageAtlas.patternPositions[t.to],v=p.imageAtlas.patternPositions[t.from];u&&v&&r.setConstantPatternPositions(u,v)}var w=a.translatePosMatrix(o.posMatrix,p,c.paint.get("fill-extrusion-translate"),c.paint.get("fill-extrusion-translate-anchor")),x=c.paint.get("fill-extrusion-vertical-gradient"),y=k?Mc(w,a,x,o,l,p):Lc(w,a,x);s.draw(h,h.gl.TRIANGLES,e,f,g,Ab.backCCW,y,c.id,q.layoutVertexBuffer,q.indexBuffer,q.segments,c.paint,a.transform.zoom,r)}}}(a,b,c,d,e,f,g)}else"translucent"===a.renderPass&&Z(a,c,c.paint.get("fill-extrusion-opacity"))},hillshade:function(a,b,c,d){
if("offscreen"===a.renderPass||"translucent"===a.renderPass){for(var e=a.context,f=b.getSource().maxzoom,g=a.depthModeForSublayer(0,xb.ReadOnly),h=yb.disabled,i=a.colorModeForRenderPass(),j=0,k=d;j<k.length;j+=1){var l=k[j],m=b.getTile(l);m.needsHillshadePrepare&&"offscreen"===a.renderPass?_(a,m,c,f,g,h,i):"translucent"===a.renderPass&&$(a,m,c,g,h,i)}e.viewport.set([0,0,a.width,a.height])}},raster:function(a,b,c,d){if("translucent"===a.renderPass&&0!==c.paint.get("raster-opacity"))for(var e=a.context,f=e.gl,g=b.getSource(),h=a.useProgram("raster"),i=yb.disabled,j=a.colorModeForRenderPass(),k=d.length&&d[0].overscaledZ,l=!a.options.moving,m=0,n=d;m<n.length;m+=1){var o=n[m],p=a.depthModeForSublayer(o.overscaledZ-k,1===c.paint.get("raster-opacity")?xb.ReadWrite:xb.ReadOnly,f.LESS),q=b.getTile(o),r=a.transform.calculatePosMatrix(o.toUnwrapped(),l);q.registerFadeDuration(c.paint.get("raster-fade-duration"));var s=b.findLoadedParent(o,0),t=aa(q,s,b,c,a.transform),u=void 0,v=void 0,w="nearest"===c.paint.get("raster-resampling")?f.NEAREST:f.LINEAR;e.activeTexture.set(f.TEXTURE0),q.texture.bind(w,f.CLAMP_TO_EDGE,f.LINEAR_MIPMAP_NEAREST),e.activeTexture.set(f.TEXTURE1),s?(s.texture.bind(w,f.CLAMP_TO_EDGE,f.LINEAR_MIPMAP_NEAREST),u=Math.pow(2,s.tileID.overscaledZ-q.tileID.overscaledZ),v=[q.tileID.canonical.x*u%1,q.tileID.canonical.y*u%1]):q.texture.bind(w,f.CLAMP_TO_EDGE,f.LINEAR_MIPMAP_NEAREST);var x=dd(r,v||[0,0],u||1,t,c);g instanceof Ia?h.draw(e,f.TRIANGLES,p,i,j,Ab.disabled,x,c.id,g.boundsBuffer,a.quadTriangleIndexBuffer,g.boundsSegments):q.maskedBoundsBuffer&&q.maskedIndexBuffer&&q.segments?h.draw(e,f.TRIANGLES,p,i,j,Ab.disabled,x,c.id,q.maskedBoundsBuffer,q.maskedIndexBuffer,q.segments,c.paint,a.transform.zoom):h.draw(e,f.TRIANGLES,p,i,j,Ab.disabled,x,c.id,a.rasterBoundsBuffer,a.quadTriangleIndexBuffer,a.rasterBoundsSegments)}},background:function(a,b,c){var d=c.paint.get("background-color"),e=c.paint.get("background-opacity");if(0!==e){var f=a.context,g=f.gl,h=a.transform,i=h.tileSize,j=c.paint.get("background-pattern");if(!a.isPatternMissing(j)){var k=j||1!==d.a||1!==e?"translucent":"opaque";if(a.renderPass===k){var l=yb.disabled,m=a.depthModeForSublayer(0,"opaque"===k?xb.ReadWrite:xb.ReadOnly),n=a.colorModeForRenderPass(),o=a.useProgram(j?"backgroundPattern":"background"),p=h.coveringTiles({tileSize:i});j&&(f.activeTexture.set(g.TEXTURE0),a.imageManager.bind(a.context));for(var q=c.getCrossfadeParameters(),r=0,s=p;r<s.length;r+=1){var t=s[r],u=a.transform.calculatePosMatrix(t.toUnwrapped()),v=j?hd(u,e,a,j,{tileID:t,tileSize:i},q):gd(u,e,d);o.draw(f,g.TRIANGLES,m,l,n,Ab.disabled,v,c.id,a.tileExtentBuffer,a.quadTriangleIndexBuffer,a.tileExtentSegments)}}}}},debug:function(a,b,c){for(var d=0;d<c.length;d++)ba(a,b,c[d])},custom:function(a,b,c){var d=a.context,e=c.implementation;if("offscreen"===a.renderPass){var f=e.prerender;f&&(a.setCustomLayerDefaults(),f.call(e,d.gl,a.transform.customLayerMatrix()),d.setDirty(),a.setBaseState()),"3d"===e.renderingMode&&(a.setCustomLayerDefaults(),Y(a,c),e.render(d.gl,a.transform.customLayerMatrix()),d.setDirty(),a.setBaseState())}else if("translucent"===a.renderPass)if("3d"===e.renderingMode)Z(a,c,1);else{a.setCustomLayerDefaults(),d.setColorMode(a.colorModeForRenderPass()),d.setStencilMode(yb.disabled);var g=a.depthModeForSublayer(0,xb.ReadOnly);d.setDepthMode(g),e.render(d.gl,a.transform.customLayerMatrix()),d.setDirty(),a.setBaseState(),d.bindFramebuffer.set(null)}}},nd=function(b,c){this.context=new Bb(b),this.transform=c,this._tileTextures={},this.setup(),this.numSublayers=Cb.maxUnderzooming+Cb.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.depthRboNeedsClear=!0,this.emptyProgramConfiguration=new a.ProgramConfiguration,this.crossTileSymbolIndex=new cc};nd.prototype.resize=function(b,c){var d=this.context.gl;if(this.width=b*a.browser.devicePixelRatio,this.height=c*a.browser.devicePixelRatio,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(var e=0,f=this.style._order;e<f.length;e+=1){var g=f[e];this.style._layers[g].resize()}this.depthRbo&&(d.deleteRenderbuffer(this.depthRbo),this.depthRbo=null)},nd.prototype.setup=function(){var b=this.context,c=new a.StructArrayLayout2i4;c.emplaceBack(0,0),c.emplaceBack(a.EXTENT,0),c.emplaceBack(0,a.EXTENT),c.emplaceBack(a.EXTENT,a.EXTENT),this.tileExtentBuffer=b.createVertexBuffer(c,hc.members),this.tileExtentSegments=a.SegmentVector.simpleSegment(0,0,4,2);var d=new a.StructArrayLayout2i4;d.emplaceBack(0,0),d.emplaceBack(a.EXTENT,0),d.emplaceBack(0,a.EXTENT),d.emplaceBack(a.EXTENT,a.EXTENT),this.debugBuffer=b.createVertexBuffer(d,hc.members),this.debugSegments=a.SegmentVector.simpleSegment(0,0,4,5);var e=new a.StructArrayLayout4i8;e.emplaceBack(0,0,0,0),e.emplaceBack(a.EXTENT,0,a.EXTENT,0),e.emplaceBack(0,a.EXTENT,0,a.EXTENT),e.emplaceBack(a.EXTENT,a.EXTENT,a.EXTENT,a.EXTENT),this.rasterBoundsBuffer=b.createVertexBuffer(e,a.rasterBoundsAttributes.members),this.rasterBoundsSegments=a.SegmentVector.simpleSegment(0,0,4,2);var f=new a.StructArrayLayout2i4;f.emplaceBack(0,0),f.emplaceBack(1,0),f.emplaceBack(0,1),f.emplaceBack(1,1),this.viewportBuffer=b.createVertexBuffer(f,hc.members),this.viewportSegments=a.SegmentVector.simpleSegment(0,0,4,2);var g=new a.StructArrayLayout1ui2;g.emplaceBack(0),g.emplaceBack(1),g.emplaceBack(3),g.emplaceBack(2),g.emplaceBack(0),this.tileBorderIndexBuffer=b.createIndexBuffer(g);var h=new a.StructArrayLayout3ui6;h.emplaceBack(0,1,2),h.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=b.createIndexBuffer(h);var i=this.context.gl;this.stencilClearMode=new yb({func:i.ALWAYS,mask:0},0,255,i.ZERO,i.ZERO,i.ZERO)},nd.prototype.clearStencil=function(){var b=this.context,c=b.gl,d=a.create$1();a.ortho(d,0,this.width,this.height,0,0,1),a.scale(d,d,[c.drawingBufferWidth,c.drawingBufferHeight,0]),this.useProgram("clippingMask").draw(b,c.TRIANGLES,xb.disabled,this.stencilClearMode,zb.disabled,Ab.disabled,Wc(d),"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)},nd.prototype._renderTileClippingMasks=function(a){var b=this.context,c=b.gl;b.setColorMode(zb.disabled),b.setDepthMode(xb.disabled);var d=this.useProgram("clippingMask"),e=1;this._tileClippingMaskIDs={};for(var f=0,g=a;f<g.length;f+=1){var h=g[f],i=this._tileClippingMaskIDs[h.key]=e++;d.draw(b,c.TRIANGLES,xb.disabled,new yb({func:c.ALWAYS,mask:0},i,255,c.KEEP,c.KEEP,c.REPLACE),zb.disabled,Ab.disabled,Wc(h.posMatrix),"$clipping",this.tileExtentBuffer,this.quadTriangleIndexBuffer,this.tileExtentSegments)}},nd.prototype.stencilModeForClipping=function(a){var b=this.context.gl;return new yb({func:b.EQUAL,mask:255},this._tileClippingMaskIDs[a.key],0,b.KEEP,b.KEEP,b.REPLACE)},nd.prototype.colorModeForRenderPass=function(){var b=this.context.gl;return this._showOverdrawInspector?new zb([b.CONSTANT_COLOR,b.ONE],new a.Color(1/8,1/8,1/8,0),[!0,!0,!0,!0]):"opaque"===this.renderPass?zb.unblended:zb.alphaBlended},nd.prototype.depthModeForSublayer=function(a,b,c){var d=1-((1+this.currentLayer)*this.numSublayers+a)*this.depthEpsilon;return new xb(c||this.context.gl.LEQUAL,b,[d,d])},nd.prototype.render=function(b,c){this.style=b,this.options=c,this.lineAtlas=b.lineAtlas,this.imageManager=b.imageManager,this.glyphManager=b.glyphManager,this.symbolFadeChange=b.placement.symbolFadeChange(a.browser.now());var d=this.style._order,e=this.style.sourceCaches;for(var f in e){var g=e[f];g.used&&g.prepare(this.context)}var h,i={},j={},k={};for(var l in e){var m=e[l];i[l]=m.getVisibleCoordinates(),j[l]=i[l].slice().reverse(),k[l]=m.getVisibleCoordinates(!0).reverse()}for(var n in e){var o=e[n],p=o.getSource();if("raster"===p.type||"raster-dem"===p.type){for(var q=[],r=0,s=i[n];r<s.length;r+=1){var t=s[r];q.push(o.getTile(t))}S(q,this.context)}}this.renderPass="offscreen",this.depthRboNeedsClear=!0;for(var u=0,v=d;u<v.length;u+=1){var w=v[u],x=this.style._layers[w];if(x.hasOffscreenPass()&&!x.isHidden(this.transform.zoom)){var y=j[x.source];("custom"===x.type||y.length)&&this.renderLayer(this,e[x.source],x,y)}}for(this.context.bindFramebuffer.set(null),this.context.clear({color:c.showOverdrawInspector?a.Color.black:a.Color.transparent,depth:1}),this._showOverdrawInspector=c.showOverdrawInspector,this.depthRange=(b._order.length+2)*this.numSublayers*this.depthEpsilon,this.renderPass="opaque",this.currentLayer=d.length-1;this.currentLayer>=0;this.currentLayer--){var z=this.style._layers[d[this.currentLayer]],A=e[z.source],B=i[z.source];z.source!==h&&A&&(this.clearStencil(),A.getSource().isTileClipped&&this._renderTileClippingMasks(B)),this.renderLayer(this,A,z,B),h=z.source}for(this.renderPass="translucent",this.currentLayer=0,h=null;this.currentLayer<d.length;this.currentLayer++){var C=this.style._layers[d[this.currentLayer]],D=e[C.source],E=("symbol"===C.type?k:j)[C.source];C.source!==h&&D&&(this.clearStencil(),D.getSource().isTileClipped&&this._renderTileClippingMasks(i[C.source])),this.renderLayer(this,D,C,E),h=C.source}if(this.options.showTileBoundaries)for(var F in e){md.debug(this,e[F],i[F]);break}this.setCustomLayerDefaults()},nd.prototype.setupOffscreenDepthRenderbuffer=function(){var a=this.context;this.depthRbo||(this.depthRbo=a.createRenderbuffer(a.gl.DEPTH_COMPONENT16,this.width,this.height))},nd.prototype.renderLayer=function(a,b,c,d){c.isHidden(this.transform.zoom)||("background"===c.type||"custom"===c.type||d.length)&&(this.id=c.id,md[c.type](a,b,c,d))},nd.prototype.translatePosMatrix=function(b,c,d,e,f){if(!d[0]&&!d[1])return b;var g=f?"map"===e?this.transform.angle:0:"viewport"===e?-this.transform.angle:0;if(g){var h=Math.sin(g),i=Math.cos(g);d=[d[0]*i-d[1]*h,d[0]*h+d[1]*i]}var j=[f?d[0]:J(c,d[0],this.transform.zoom),f?d[1]:J(c,d[1],this.transform.zoom),0],k=new Float32Array(16);return a.translate(k,b,j),k},nd.prototype.saveTileTexture=function(a){var b=this._tileTextures[a.size[0]];b?b.push(a):this._tileTextures[a.size[0]]=[a]},nd.prototype.getTileTexture=function(a){var b=this._tileTextures[a];return b&&b.length>0?b.pop():null},nd.prototype.isPatternMissing=function(a){if(!a)return!1;var b=this.imageManager.getPattern(a.from),c=this.imageManager.getPattern(a.to);return!b||!c},nd.prototype.useProgram=function(a,b){void 0===b&&(b=this.emptyProgramConfiguration),this.cache=this.cache||{};var c=""+a+(b.cacheKey||"")+(this._showOverdrawInspector?"/overdraw":"");return this.cache[c]||(this.cache[c]=new Kc(this.context,Ic[a],b,id[a],this._showOverdrawInspector)),this.cache[c]},nd.prototype.setCustomLayerDefaults=function(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()},nd.prototype.setBaseState=function(){var a=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(a.FUNC_ADD)};var od=function(b,c,d){this.tileSize=512,this.maxValidLatitude=85.051129,this._renderWorldCopies=void 0===d||d,this._minZoom=b||0,this._maxZoom=c||22,this.setMaxBounds(),this.width=0,this.height=0,this._center=new a.LngLat(0,0),this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._unmodified=!0,this._posMatrixCache={},this._alignedPosMatrixCache={}},pd={minZoom:{configurable:!0},maxZoom:{configurable:!0},renderWorldCopies:{configurable:!0},worldSize:{configurable:!0},centerPoint:{configurable:!0},size:{configurable:!0},bearing:{configurable:!0},pitch:{configurable:!0},fov:{configurable:!0},zoom:{configurable:!0},center:{configurable:!0},unmodified:{configurable:!0},point:{configurable:!0}};od.prototype.clone=function(){var a=new od(this._minZoom,this._maxZoom,this._renderWorldCopies);return a.tileSize=this.tileSize,a.latRange=this.latRange,a.width=this.width,a.height=this.height,a._center=this._center,a.zoom=this.zoom,a.angle=this.angle,a._fov=this._fov,a._pitch=this._pitch,a._unmodified=this._unmodified,a._calcMatrices(),a},pd.minZoom.get=function(){return this._minZoom},pd.minZoom.set=function(a){this._minZoom!==a&&(this._minZoom=a,this.zoom=Math.max(this.zoom,a))},pd.maxZoom.get=function(){return this._maxZoom},pd.maxZoom.set=function(a){this._maxZoom!==a&&(this._maxZoom=a,this.zoom=Math.min(this.zoom,a))},pd.renderWorldCopies.get=function(){return this._renderWorldCopies},pd.renderWorldCopies.set=function(a){void 0===a?a=!0:null===a&&(a=!1),this._renderWorldCopies=a},pd.worldSize.get=function(){return this.tileSize*this.scale},pd.centerPoint.get=function(){return this.size._div(2)},pd.size.get=function(){return new a.Point(this.width,this.height)},pd.bearing.get=function(){return-this.angle/Math.PI*180},pd.bearing.set=function(b){var c=-a.wrap(b,-180,180)*Math.PI/180;this.angle!==c&&(this._unmodified=!1,this.angle=c,this._calcMatrices(),this.rotationMatrix=a.create$2(),a.rotate(this.rotationMatrix,this.rotationMatrix,this.angle))},pd.pitch.get=function(){return this._pitch/Math.PI*180},pd.pitch.set=function(b){var c=a.clamp(b,0,60)/180*Math.PI;this._pitch!==c&&(this._unmodified=!1,this._pitch=c,this._calcMatrices())},pd.fov.get=function(){return this._fov/Math.PI*180},pd.fov.set=function(a){a=Math.max(.01,Math.min(60,a)),this._fov!==a&&(this._unmodified=!1,this._fov=a/180*Math.PI,this._calcMatrices())},pd.zoom.get=function(){return this._zoom},pd.zoom.set=function(a){var b=Math.min(Math.max(a,this.minZoom),this.maxZoom);this._zoom!==b&&(this._unmodified=!1,this._zoom=b,this.scale=this.zoomScale(b),this.tileZoom=Math.floor(b),this.zoomFraction=b-this.tileZoom,this._constrain(),this._calcMatrices())},pd.center.get=function(){return this._center},pd.center.set=function(a){a.lat===this._center.lat&&a.lng===this._center.lng||(this._unmodified=!1,this._center=a,this._constrain(),this._calcMatrices())},od.prototype.coveringZoomLevel=function(a){return(a.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/a.tileSize))},od.prototype.getVisibleUnwrappedCoordinates=function(b){var c=[new a.UnwrappedTileID(0,b)];if(this._renderWorldCopies)for(var d=this.pointCoordinate(new a.Point(0,0)),e=this.pointCoordinate(new a.Point(this.width,0)),f=this.pointCoordinate(new a.Point(this.width,this.height)),g=this.pointCoordinate(new a.Point(0,this.height)),h=Math.floor(Math.min(d.x,e.x,f.x,g.x)),i=Math.floor(Math.max(d.x,e.x,f.x,g.x)),j=h-1;j<=i+1;j++)0!==j&&c.push(new a.UnwrappedTileID(j,b));return c},od.prototype.coveringTiles=function(b){var c=this.coveringZoomLevel(b),d=c;if(void 0!==b.minzoom&&c<b.minzoom)return[];void 0!==b.maxzoom&&c>b.maxzoom&&(c=b.maxzoom);var e=a.MercatorCoordinate.fromLngLat(this.center),f=Math.pow(2,c),g=new a.Point(f*e.x-.5,f*e.y-.5);return function(b,c,d,e){function f(c,f,i){var j,k,l,m;if(i>=0&&i<=g)for(j=c;j<f;j++)k=Math.floor(j/g),l=(j%g+g)%g,0!==k&&!0!==e||(m=new a.OverscaledTileID(d,k,b,l,i),h[m.key]=m)}void 0===e&&(e=!0);var g=1<<b,h={},i=c.map(function(b){return new a.Point(b.x,b.y)._mult(g)});return ea(i[0],i[1],i[2],0,g,f),ea(i[2],i[3],i[0],0,g,f),Object.keys(h).map(function(a){return h[a]})}(c,[this.pointCoordinate(new a.Point(0,0)),this.pointCoordinate(new a.Point(this.width,0)),this.pointCoordinate(new a.Point(this.width,this.height)),this.pointCoordinate(new a.Point(0,this.height))],b.reparseOverscaled?d:c,this._renderWorldCopies).sort(function(a,b){return g.dist(a.canonical)-g.dist(b.canonical)})},od.prototype.resize=function(a,b){this.width=a,this.height=b,this.pixelsToGLUnits=[2/a,-2/b],this._constrain(),this._calcMatrices()},pd.unmodified.get=function(){return this._unmodified},od.prototype.zoomScale=function(a){return Math.pow(2,a)},od.prototype.scaleZoom=function(a){return Math.log(a)/Math.LN2},od.prototype.project=function(b){var c=a.clamp(b.lat,-this.maxValidLatitude,this.maxValidLatitude);return new a.Point(a.mercatorXfromLng(b.lng)*this.worldSize,a.mercatorYfromLat(c)*this.worldSize)},od.prototype.unproject=function(b){return new a.MercatorCoordinate(b.x/this.worldSize,b.y/this.worldSize).toLngLat()},pd.point.get=function(){return this.project(this.center)},od.prototype.setLocationAtPoint=function(b,c){var d=this.pointCoordinate(c),e=this.pointCoordinate(this.centerPoint),f=this.locationCoordinate(b),g=new a.MercatorCoordinate(f.x-(d.x-e.x),f.y-(d.y-e.y));this.center=this.coordinateLocation(g),this._renderWorldCopies&&(this.center=this.center.wrap())},od.prototype.locationPoint=function(a){return this.coordinatePoint(this.locationCoordinate(a))},od.prototype.pointLocation=function(a){return this.coordinateLocation(this.pointCoordinate(a))},od.prototype.locationCoordinate=function(b){return a.MercatorCoordinate.fromLngLat(b)},od.prototype.coordinateLocation=function(a){return a.toLngLat()},od.prototype.pointCoordinate=function(b){var c=[b.x,b.y,0,1],d=[b.x,b.y,1,1];a.transformMat4(c,c,this.pixelMatrixInverse),a.transformMat4(d,d,this.pixelMatrixInverse);var e=c[3],f=d[3],g=c[0]/e,h=d[0]/f,i=c[1]/e,j=d[1]/f,k=c[2]/e,l=d[2]/f,m=k===l?0:(0-k)/(l-k);return new a.MercatorCoordinate(a.number(g,h,m)/this.worldSize,a.number(i,j,m)/this.worldSize)},od.prototype.coordinatePoint=function(b){var c=[b.x*this.worldSize,b.y*this.worldSize,0,1];return a.transformMat4(c,c,this.pixelMatrix),new a.Point(c[0]/c[3],c[1]/c[3])},od.prototype.getBounds=function(){return(new a.LngLatBounds).extend(this.pointLocation(new a.Point(0,0))).extend(this.pointLocation(new a.Point(this.width,0))).extend(this.pointLocation(new a.Point(this.width,this.height))).extend(this.pointLocation(new a.Point(0,this.height)))},od.prototype.getMaxBounds=function(){return this.latRange&&2===this.latRange.length&&this.lngRange&&2===this.lngRange.length?new a.LngLatBounds([this.lngRange[0],this.latRange[0]],[this.lngRange[1],this.latRange[1]]):null},od.prototype.setMaxBounds=function(a){a?(this.lngRange=[a.getWest(),a.getEast()],this.latRange=[a.getSouth(),a.getNorth()],this._constrain()):(this.lngRange=null,this.latRange=[-this.maxValidLatitude,this.maxValidLatitude])},od.prototype.calculatePosMatrix=function(b,c){void 0===c&&(c=!1);var d=b.key,e=c?this._alignedPosMatrixCache:this._posMatrixCache;if(e[d])return e[d];var f=b.canonical,g=this.worldSize/this.zoomScale(f.z),h=f.x+Math.pow(2,f.z)*b.wrap,i=a.identity(new Float64Array(16));return a.translate(i,i,[h*g,f.y*g,0]),a.scale(i,i,[g/a.EXTENT,g/a.EXTENT,1]),a.multiply(i,c?this.alignedProjMatrix:this.projMatrix,i),e[d]=new Float32Array(i),e[d]},od.prototype.customLayerMatrix=function(){return this.mercatorMatrix.slice()},od.prototype._constrain=function(){if(this.center&&this.width&&this.height&&!this._constraining){this._constraining=!0;var b,c,d,e,f=-90,g=90,h=-180,i=180,j=this.size,k=this._unmodified;if(this.latRange){var l=this.latRange;f=a.mercatorYfromLat(l[1])*this.worldSize,b=(g=a.mercatorYfromLat(l[0])*this.worldSize)-f<j.y?j.y/(g-f):0}if(this.lngRange){var m=this.lngRange;h=a.mercatorXfromLng(m[0])*this.worldSize,c=(i=a.mercatorXfromLng(m[1])*this.worldSize)-h<j.x?j.x/(i-h):0}var n=this.point,o=Math.max(c||0,b||0);if(o)return this.center=this.unproject(new a.Point(c?(i+h)/2:n.x,b?(g+f)/2:n.y)),this.zoom+=this.scaleZoom(o),this._unmodified=k,void(this._constraining=!1);if(this.latRange){var p=n.y,q=j.y/2;p-q<f&&(e=f+q),p+q>g&&(e=g-q)}if(this.lngRange){var r=n.x,s=j.x/2;r-s<h&&(d=h+s),r+s>i&&(d=i-s)}void 0===d&&void 0===e||(this.center=this.unproject(new a.Point(void 0!==d?d:n.x,void 0!==e?e:n.y))),this._unmodified=k,this._constraining=!1}},od.prototype._calcMatrices=function(){if(this.height){this.cameraToCenterDistance=.5/Math.tan(this._fov/2)*this.height;var b=this._fov/2,c=Math.PI/2+this._pitch,d=Math.sin(b)*this.cameraToCenterDistance/Math.sin(Math.PI-c-b),e=this.point,f=e.x,g=e.y,h=1.01*(Math.cos(Math.PI/2-this._pitch)*d+this.cameraToCenterDistance),i=new Float64Array(16);a.perspective(i,this._fov,this.width/this.height,1,h),a.scale(i,i,[1,-1,1]),a.translate(i,i,[0,0,-this.cameraToCenterDistance]),a.rotateX(i,i,this._pitch),a.rotateZ(i,i,this.angle),a.translate(i,i,[-f,-g,0]),this.mercatorMatrix=a.scale([],i,[this.worldSize,this.worldSize,this.worldSize]),a.scale(i,i,[1,1,a.mercatorZfromAltitude(1,this.center.lat)*this.worldSize,1]),this.projMatrix=i;var j=this.width%2/2,k=this.height%2/2,l=Math.cos(this.angle),m=Math.sin(this.angle),n=f-Math.round(f)+l*j+m*k,o=g-Math.round(g)+l*k+m*j,p=new Float64Array(i);if(a.translate(p,p,[n>.5?n-1:n,o>.5?o-1:o,0]),this.alignedProjMatrix=p,i=a.create$1(),a.scale(i,i,[this.width/2,-this.height/2,1]),a.translate(i,i,[1,-1,0]),this.pixelMatrix=a.multiply(new Float64Array(16),i,this.projMatrix),!(i=a.invert(new Float64Array(16),this.pixelMatrix)))throw new Error("failed to invert matrix");this.pixelMatrixInverse=i,this._posMatrixCache={},this._alignedPosMatrixCache={}}},od.prototype.maxPitchScaleFactor=function(){if(!this.pixelMatrixInverse)return 1;var b=this.pointCoordinate(new a.Point(0,0)),c=[b.x*this.worldSize,b.y*this.worldSize,0,1];return a.transformMat4(c,c,this.pixelMatrix)[3]/this.cameraToCenterDistance},od.prototype.getCameraPoint=function(){var b=this._pitch,c=Math.tan(b)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new a.Point(0,c))},od.prototype.getCameraQueryGeometry=function(b){var c=this.getCameraPoint();if(1===b.length)return[b[0],c];for(var d=c.x,e=c.y,f=c.x,g=c.y,h=0,i=b;h<i.length;h+=1){var j=i[h];d=Math.min(d,j.x),e=Math.min(e,j.y),f=Math.max(f,j.x),g=Math.max(g,j.y)}return[new a.Point(d,e),new a.Point(f,e),new a.Point(f,g),new a.Point(d,g),new a.Point(d,e)]},Object.defineProperties(od.prototype,pd);var qd=function(){var b,c,d,e,f;a.bindAll(["_onHashChange","_updateHash"],this),this._updateHash=(b=this._updateHashUnthrottled.bind(this),c=300,d=!1,e=0,f=function(){e=0,d&&(b(),e=setTimeout(f,c),d=!1)},function(){return d=!0,e||f(),e})};qd.prototype.addTo=function(b){return this._map=b,a.window.addEventListener("hashchange",this._onHashChange,!1),this._map.on("moveend",this._updateHash),this},qd.prototype.remove=function(){return a.window.removeEventListener("hashchange",this._onHashChange,!1),this._map.off("moveend",this._updateHash),clearTimeout(this._updateHash()),delete this._map,this},qd.prototype.getHashString=function(a){var b=this._map.getCenter(),c=Math.round(100*this._map.getZoom())/100,d=Math.ceil((c*Math.LN2+Math.log(512/360/.5))/Math.LN10),e=Math.pow(10,d),f=Math.round(b.lng*e)/e,g=Math.round(b.lat*e)/e,h=this._map.getBearing(),i=this._map.getPitch(),j="";return j+=a?"#/"+f+"/"+g+"/"+c:"#"+c+"/"+g+"/"+f,(h||i)&&(j+="/"+Math.round(10*h)/10),i&&(j+="/"+Math.round(i)),j},qd.prototype._onHashChange=function(){var b=a.window.location.hash.replace("#","").split("/");return b.length>=3&&(this._map.jumpTo({center:[+b[2],+b[1]],zoom:+b[0],bearing:+(b[3]||0),pitch:+(b[4]||0)}),!0)},qd.prototype._updateHashUnthrottled=function(){var b=this.getHashString();try{a.window.history.replaceState(a.window.history.state,"",b)}catch(a){}};var rd=function(b){function c(c,d,e,f){void 0===f&&(f={});var g=na.mousePos(d.getCanvasContainer(),e),h=d.unproject(g);b.call(this,c,a.extend({point:g,lngLat:h,originalEvent:e},f)),this._defaultPrevented=!1,this.target=d}b&&(c.__proto__=b),c.prototype=Object.create(b&&b.prototype),c.prototype.constructor=c;var d={defaultPrevented:{configurable:!0}};return c.prototype.preventDefault=function(){this._defaultPrevented=!0},d.defaultPrevented.get=function(){return this._defaultPrevented},Object.defineProperties(c.prototype,d),c}(a.Event),sd=function(b){function c(c,d,e){var f=na.touchPos(d.getCanvasContainer(),e),g=f.map(function(a){return d.unproject(a)}),h=f.reduce(function(a,b,c,d){return a.add(b.div(d.length))},new a.Point(0,0)),i=d.unproject(h);b.call(this,c,{points:f,point:h,lngLats:g,lngLat:i,originalEvent:e}),this._defaultPrevented=!1}b&&(c.__proto__=b),c.prototype=Object.create(b&&b.prototype),c.prototype.constructor=c;var d={defaultPrevented:{configurable:!0}};return c.prototype.preventDefault=function(){this._defaultPrevented=!0},d.defaultPrevented.get=function(){return this._defaultPrevented},Object.defineProperties(c.prototype,d),c}(a.Event),td=function(a){function b(b,c,d){a.call(this,b,{originalEvent:d}),this._defaultPrevented=!1}a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b;var c={defaultPrevented:{configurable:!0}};return b.prototype.preventDefault=function(){this._defaultPrevented=!0},c.defaultPrevented.get=function(){return this._defaultPrevented},Object.defineProperties(b.prototype,c),b}(a.Event),ud=function(b){this._map=b,this._el=b.getCanvasContainer(),this._delta=0,a.bindAll(["_onWheel","_onTimeout","_onScrollFrame","_onScrollFinished"],this)};ud.prototype.isEnabled=function(){return!!this._enabled},ud.prototype.isActive=function(){return!!this._active},ud.prototype.isZooming=function(){return!!this._zooming},ud.prototype.enable=function(a){this.isEnabled()||(this._enabled=!0,this._aroundCenter=a&&"center"===a.around)},ud.prototype.disable=function(){this.isEnabled()&&(this._enabled=!1)},ud.prototype.onWheel=function(b){if(this.isEnabled()){var c=b.deltaMode===a.window.WheelEvent.DOM_DELTA_LINE?40*b.deltaY:b.deltaY,d=a.browser.now(),e=d-(this._lastWheelEventTime||0);this._lastWheelEventTime=d,0!==c&&c%4.000244140625==0?this._type="wheel":0!==c&&Math.abs(c)<4?this._type="trackpad":e>400?(this._type=null,this._lastValue=c,this._timeout=setTimeout(this._onTimeout,40,b)):this._type||(this._type=Math.abs(e*c)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,c+=this._lastValue)),b.shiftKey&&c&&(c/=4),this._type&&(this._lastWheelEvent=b,this._delta-=c,this.isActive()||this._start(b)),b.preventDefault()}},ud.prototype._onTimeout=function(a){this._type="wheel",this._delta-=this._lastValue,this.isActive()||this._start(a)},ud.prototype._start=function(b){if(this._delta){this._frameId&&(this._map._cancelRenderFrame(this._frameId),this._frameId=null),this._active=!0,this._zooming=!0,this._map.fire(new a.Event("movestart",{originalEvent:b})),this._map.fire(new a.Event("zoomstart",{originalEvent:b})),this._finishTimeout&&clearTimeout(this._finishTimeout);var c=na.mousePos(this._el,b);this._around=a.LngLat.convert(this._aroundCenter?this._map.getCenter():this._map.unproject(c)),this._aroundPoint=this._map.transform.locationPoint(this._around),this._frameId||(this._frameId=this._map._requestRenderFrame(this._onScrollFrame))}},ud.prototype._onScrollFrame=function(){var b=this;if(this._frameId=null,this.isActive()){var c=this._map.transform;if(0!==this._delta){var d="wheel"===this._type&&Math.abs(this._delta)>4.000244140625?1/450:.01,e=2/(1+Math.exp(-Math.abs(this._delta*d)));this._delta<0&&0!==e&&(e=1/e);var f="number"==typeof this._targetZoom?c.zoomScale(this._targetZoom):c.scale;this._targetZoom=Math.min(c.maxZoom,Math.max(c.minZoom,c.scaleZoom(f*e))),"wheel"===this._type&&(this._startZoom=c.zoom,this._easing=this._smoothOutEasing(200)),this._delta=0}var g="number"==typeof this._targetZoom?this._targetZoom:c.zoom,h=this._startZoom,i=this._easing,j=!1;if("wheel"===this._type&&h&&i){var k=Math.min((a.browser.now()-this._lastWheelEventTime)/200,1),l=i(k);c.zoom=a.number(h,g,l),k<1?this._frameId||(this._frameId=this._map._requestRenderFrame(this._onScrollFrame)):j=!0}else c.zoom=g,j=!0;c.setLocationAtPoint(this._around,this._aroundPoint),this._map.fire(new a.Event("move",{originalEvent:this._lastWheelEvent})),this._map.fire(new a.Event("zoom",{originalEvent:this._lastWheelEvent})),j&&(this._active=!1,this._finishTimeout=setTimeout(function(){b._zooming=!1,b._map.fire(new a.Event("zoomend",{originalEvent:b._lastWheelEvent})),b._map.fire(new a.Event("moveend",{originalEvent:b._lastWheelEvent})),delete b._targetZoom},200))}},ud.prototype._smoothOutEasing=function(b){var c=a.ease;if(this._prevEase){var d=this._prevEase,e=(a.browser.now()-d.start)/d.duration,f=d.easing(e+.01)-d.easing(e),g=.27/Math.sqrt(f*f+1e-4)*.01,h=Math.sqrt(.0729-g*g);c=a.bezier(g,h,.25,1)}return this._prevEase={start:a.browser.now(),duration:b,easing:c},c};var vd=function(b,c){this._map=b,this._el=b.getCanvasContainer(),this._container=b.getContainer(),this._clickTolerance=c.clickTolerance||1,a.bindAll(["_onMouseMove","_onMouseUp","_onKeyDown"],this)};vd.prototype.isEnabled=function(){return!!this._enabled},vd.prototype.isActive=function(){return!!this._active},vd.prototype.enable=function(){this.isEnabled()||(this._enabled=!0)},vd.prototype.disable=function(){this.isEnabled()&&(this._enabled=!1)},vd.prototype.onMouseDown=function(b){this.isEnabled()&&b.shiftKey&&0===b.button&&(a.window.document.addEventListener("mousemove",this._onMouseMove,!1),a.window.document.addEventListener("keydown",this._onKeyDown,!1),a.window.document.addEventListener("mouseup",this._onMouseUp,!1),na.disableDrag(),this._startPos=this._lastPos=na.mousePos(this._el,b),this._active=!0)},vd.prototype._onMouseMove=function(a){var b=na.mousePos(this._el,a);if(!(this._lastPos.equals(b)||!this._box&&b.dist(this._startPos)<this._clickTolerance)){var c=this._startPos;this._lastPos=b,this._box||(this._box=na.create("div","mapboxgl-boxzoom",this._container),this._container.classList.add("mapboxgl-crosshair"),this._fireEvent("boxzoomstart",a));var d=Math.min(c.x,b.x),e=Math.max(c.x,b.x),f=Math.min(c.y,b.y),g=Math.max(c.y,b.y);na.setTransform(this._box,"translate("+d+"px,"+f+"px)"),this._box.style.width=e-d+"px",this._box.style.height=g-f+"px"}},vd.prototype._onMouseUp=function(b){if(0===b.button){var c=this._startPos,d=na.mousePos(this._el,b);this._finish(),na.suppressClick(),c.x===d.x&&c.y===d.y?this._fireEvent("boxzoomcancel",b):this._map.fitScreenCoordinates(c,d,this._map.getBearing(),{linear:!0}).fire(new a.Event("boxzoomend",{originalEvent:b}))}},vd.prototype._onKeyDown=function(a){27===a.keyCode&&(this._finish(),this._fireEvent("boxzoomcancel",a))},vd.prototype._finish=function(){this._active=!1,a.window.document.removeEventListener("mousemove",this._onMouseMove,!1),a.window.document.removeEventListener("keydown",this._onKeyDown,!1),a.window.document.removeEventListener("mouseup",this._onMouseUp,!1),this._container.classList.remove("mapboxgl-crosshair"),this._box&&(na.remove(this._box),this._box=null),na.enableDrag(),delete this._startPos,delete this._lastPos},vd.prototype._fireEvent=function(b,c){return this._map.fire(new a.Event(b,{originalEvent:c}))};var wd=a.bezier(0,0,.25,1),xd=function(b,c){this._map=b,this._el=c.element||b.getCanvasContainer(),this._state="disabled",this._button=c.button||"right",this._bearingSnap=c.bearingSnap||0,this._pitchWithRotate=!1!==c.pitchWithRotate,a.bindAll(["onMouseDown","_onMouseMove","_onMouseUp","_onBlur","_onDragFrame"],this)};xd.prototype.isEnabled=function(){return"disabled"!==this._state},xd.prototype.isActive=function(){return"active"===this._state},xd.prototype.enable=function(){this.isEnabled()||(this._state="enabled")},xd.prototype.disable=function(){if(this.isEnabled())switch(this._state){case"active":this._state="disabled",this._unbind(),this._deactivate(),this._fireEvent("rotateend"),this._pitchWithRotate&&this._fireEvent("pitchend"),this._fireEvent("moveend");break;case"pending":this._state="disabled",this._unbind();break;default:this._state="disabled"}},xd.prototype.onMouseDown=function(b){if("enabled"===this._state){if("right"===this._button){if(this._eventButton=na.mouseButton(b),this._eventButton!==(b.ctrlKey?0:2))return}else{if(b.ctrlKey||0!==na.mouseButton(b))return;this._eventButton=0}na.disableDrag(),a.window.document.addEventListener("mousemove",this._onMouseMove,{capture:!0}),a.window.document.addEventListener("mouseup",this._onMouseUp),a.window.addEventListener("blur",this._onBlur),this._state="pending",this._inertia=[[a.browser.now(),this._map.getBearing()]],this._startPos=this._lastPos=na.mousePos(this._el,b),this._center=this._map.transform.centerPoint,b.preventDefault()}},xd.prototype._onMouseMove=function(a){var b=na.mousePos(this._el,a);this._lastPos.equals(b)||(this._lastMoveEvent=a,this._lastPos=b,"pending"===this._state&&(this._state="active",this._fireEvent("rotatestart",a),
this._fireEvent("movestart",a),this._pitchWithRotate&&this._fireEvent("pitchstart",a)),this._frameId||(this._frameId=this._map._requestRenderFrame(this._onDragFrame)))},xd.prototype._onDragFrame=function(){this._frameId=null;var b=this._lastMoveEvent;if(b){var c=this._map.transform,d=this._startPos,e=this._lastPos,f=.8*(d.x-e.x),g=-.5*(d.y-e.y),h=c.bearing-f,i=c.pitch-g,j=this._inertia,k=j[j.length-1];this._drainInertiaBuffer(),j.push([a.browser.now(),this._map._normalizeBearing(h,k[1])]),c.bearing=h,this._pitchWithRotate&&(this._fireEvent("pitch",b),c.pitch=i),this._fireEvent("rotate",b),this._fireEvent("move",b),delete this._lastMoveEvent,this._startPos=this._lastPos}},xd.prototype._onMouseUp=function(a){if(na.mouseButton(a)===this._eventButton)switch(this._state){case"active":this._state="enabled",na.suppressClick(),this._unbind(),this._deactivate(),this._inertialRotate(a);break;case"pending":this._state="enabled",this._unbind()}},xd.prototype._onBlur=function(a){switch(this._state){case"active":this._state="enabled",this._unbind(),this._deactivate(),this._fireEvent("rotateend",a),this._pitchWithRotate&&this._fireEvent("pitchend",a),this._fireEvent("moveend",a);break;case"pending":this._state="enabled",this._unbind()}},xd.prototype._unbind=function(){a.window.document.removeEventListener("mousemove",this._onMouseMove,{capture:!0}),a.window.document.removeEventListener("mouseup",this._onMouseUp),a.window.removeEventListener("blur",this._onBlur),na.enableDrag()},xd.prototype._deactivate=function(){this._frameId&&(this._map._cancelRenderFrame(this._frameId),this._frameId=null),delete this._lastMoveEvent,delete this._startPos,delete this._lastPos},xd.prototype._inertialRotate=function(a){var b=this;this._fireEvent("rotateend",a),this._drainInertiaBuffer();var c=this._map,d=c.getBearing(),e=this._inertia,f=function(){Math.abs(d)<b._bearingSnap?c.resetNorth({noMoveStart:!0},{originalEvent:a}):b._fireEvent("moveend",a),b._pitchWithRotate&&b._fireEvent("pitchend",a)};if(e.length<2)f();else{var g=e[0],h=e[e.length-1],i=e[e.length-2],j=c._normalizeBearing(d,i[1]),k=h[1]-g[1],l=k<0?-1:1,m=(h[0]-g[0])/1e3;if(0!==k&&0!==m){var n=Math.abs(k*(.25/m));n>180&&(n=180);var o=n/180;j+=l*n*(o/2),Math.abs(c._normalizeBearing(j,0))<this._bearingSnap&&(j=c._normalizeBearing(0,j)),c.rotateTo(j,{duration:1e3*o,easing:wd,noMoveStart:!0},{originalEvent:a})}else f()}},xd.prototype._fireEvent=function(b,c){return this._map.fire(new a.Event(b,c?{originalEvent:c}:{}))},xd.prototype._drainInertiaBuffer=function(){for(var b=this._inertia,c=a.browser.now();b.length>0&&c-b[0][0]>160;)b.shift()};var yd=a.bezier(0,0,.3,1),zd=function(b,c){this._map=b,this._el=b.getCanvasContainer(),this._state="disabled",this._clickTolerance=c.clickTolerance||1,a.bindAll(["_onMove","_onMouseUp","_onTouchEnd","_onBlur","_onDragFrame"],this)};zd.prototype.isEnabled=function(){return"disabled"!==this._state},zd.prototype.isActive=function(){return"active"===this._state},zd.prototype.enable=function(){this.isEnabled()||(this._el.classList.add("mapboxgl-touch-drag-pan"),this._state="enabled")},zd.prototype.disable=function(){if(this.isEnabled())switch(this._el.classList.remove("mapboxgl-touch-drag-pan"),this._state){case"active":this._state="disabled",this._unbind(),this._deactivate(),this._fireEvent("dragend"),this._fireEvent("moveend");break;case"pending":this._state="disabled",this._unbind();break;default:this._state="disabled"}},zd.prototype.onMouseDown=function(b){"enabled"===this._state&&(b.ctrlKey||0!==na.mouseButton(b)||(na.addEventListener(a.window.document,"mousemove",this._onMove,{capture:!0}),na.addEventListener(a.window.document,"mouseup",this._onMouseUp),this._start(b)))},zd.prototype.onTouchStart=function(b){"enabled"===this._state&&(b.touches.length>1||(na.addEventListener(a.window.document,"touchmove",this._onMove,{capture:!0,passive:!1}),na.addEventListener(a.window.document,"touchend",this._onTouchEnd),this._start(b)))},zd.prototype._start=function(b){a.window.addEventListener("blur",this._onBlur),this._state="pending",this._startPos=this._mouseDownPos=this._lastPos=na.mousePos(this._el,b),this._inertia=[[a.browser.now(),this._startPos]]},zd.prototype._onMove=function(b){b.preventDefault();var c=na.mousePos(this._el,b);this._lastPos.equals(c)||"pending"===this._state&&c.dist(this._mouseDownPos)<this._clickTolerance||(this._lastMoveEvent=b,this._lastPos=c,this._drainInertiaBuffer(),this._inertia.push([a.browser.now(),this._lastPos]),"pending"===this._state&&(this._state="active",this._fireEvent("dragstart",b),this._fireEvent("movestart",b)),this._frameId||(this._frameId=this._map._requestRenderFrame(this._onDragFrame)))},zd.prototype._onDragFrame=function(){this._frameId=null;var a=this._lastMoveEvent;if(a){var b=this._map.transform;b.setLocationAtPoint(b.pointLocation(this._startPos),this._lastPos),this._fireEvent("drag",a),this._fireEvent("move",a),this._startPos=this._lastPos,delete this._lastMoveEvent}},zd.prototype._onMouseUp=function(a){if(0===na.mouseButton(a))switch(this._state){case"active":this._state="enabled",na.suppressClick(),this._unbind(),this._deactivate(),this._inertialPan(a);break;case"pending":this._state="enabled",this._unbind()}},zd.prototype._onTouchEnd=function(a){switch(this._state){case"active":this._state="enabled",this._unbind(),this._deactivate(),this._inertialPan(a);break;case"pending":this._state="enabled",this._unbind()}},zd.prototype._onBlur=function(a){switch(this._state){case"active":this._state="enabled",this._unbind(),this._deactivate(),this._fireEvent("dragend",a),this._fireEvent("moveend",a);break;case"pending":this._state="enabled",this._unbind()}},zd.prototype._unbind=function(){na.removeEventListener(a.window.document,"touchmove",this._onMove,{capture:!0,passive:!1}),na.removeEventListener(a.window.document,"touchend",this._onTouchEnd),na.removeEventListener(a.window.document,"mousemove",this._onMove,{capture:!0}),na.removeEventListener(a.window.document,"mouseup",this._onMouseUp),na.removeEventListener(a.window,"blur",this._onBlur)},zd.prototype._deactivate=function(){this._frameId&&(this._map._cancelRenderFrame(this._frameId),this._frameId=null),delete this._lastMoveEvent,delete this._startPos,delete this._mouseDownPos,delete this._lastPos},zd.prototype._inertialPan=function(a){this._fireEvent("dragend",a),this._drainInertiaBuffer();var b=this._inertia;if(b.length<2)this._fireEvent("moveend",a);else{var c=b[b.length-1],d=b[0],e=c[1].sub(d[1]),f=(c[0]-d[0])/1e3;if(0===f||c[1].equals(d[1]))this._fireEvent("moveend",a);else{var g=e.mult(.3/f),h=g.mag();h>1400&&(h=1400,g._unit()._mult(h));var i=h/750,j=g.mult(-i/2);this._map.panBy(j,{duration:1e3*i,easing:yd,noMoveStart:!0},{originalEvent:a})}}},zd.prototype._fireEvent=function(b,c){return this._map.fire(new a.Event(b,c?{originalEvent:c}:{}))},zd.prototype._drainInertiaBuffer=function(){for(var b=this._inertia,c=a.browser.now();b.length>0&&c-b[0][0]>160;)b.shift()};var Ad=function(b){this._map=b,this._el=b.getCanvasContainer(),a.bindAll(["_onKeyDown"],this)};Ad.prototype.isEnabled=function(){return!!this._enabled},Ad.prototype.enable=function(){this.isEnabled()||(this._el.addEventListener("keydown",this._onKeyDown,!1),this._enabled=!0)},Ad.prototype.disable=function(){this.isEnabled()&&(this._el.removeEventListener("keydown",this._onKeyDown),this._enabled=!1)},Ad.prototype._onKeyDown=function(a){if(!(a.altKey||a.ctrlKey||a.metaKey)){var b=0,c=0,d=0,e=0,f=0;switch(a.keyCode){case 61:case 107:case 171:case 187:b=1;break;case 189:case 109:case 173:b=-1;break;case 37:a.shiftKey?c=-1:(a.preventDefault(),e=-1);break;case 39:a.shiftKey?c=1:(a.preventDefault(),e=1);break;case 38:a.shiftKey?d=1:(a.preventDefault(),f=-1);break;case 40:a.shiftKey?d=-1:(f=1,a.preventDefault());break;default:return}var g=this._map,h=g.getZoom(),i={duration:300,delayEndEvents:500,easing:fa,zoom:b?Math.round(h)+b*(a.shiftKey?2:1):h,bearing:g.getBearing()+15*c,pitch:g.getPitch()+10*d,offset:[100*-e,100*-f],center:g.getCenter()};g.easeTo(i,{originalEvent:a})}};var Bd=function(b){this._map=b,a.bindAll(["_onDblClick","_onZoomEnd"],this)};Bd.prototype.isEnabled=function(){return!!this._enabled},Bd.prototype.isActive=function(){return!!this._active},Bd.prototype.enable=function(){this.isEnabled()||(this._enabled=!0)},Bd.prototype.disable=function(){this.isEnabled()&&(this._enabled=!1)},Bd.prototype.onTouchStart=function(a){var b=this;this.isEnabled()&&(a.points.length>1||(this._tapped?(clearTimeout(this._tapped),this._tapped=null,this._zoom(a)):this._tapped=setTimeout(function(){b._tapped=null},300)))},Bd.prototype.onDblClick=function(a){this.isEnabled()&&(a.originalEvent.preventDefault(),this._zoom(a))},Bd.prototype._zoom=function(a){this._active=!0,this._map.on("zoomend",this._onZoomEnd),this._map.zoomTo(this._map.getZoom()+(a.originalEvent.shiftKey?-1:1),{around:a.lngLat},a)},Bd.prototype._onZoomEnd=function(){this._active=!1,this._map.off("zoomend",this._onZoomEnd)};var Cd=a.bezier(0,0,.15,1),Dd=function(b){this._map=b,this._el=b.getCanvasContainer(),a.bindAll(["_onMove","_onEnd","_onTouchFrame"],this)};Dd.prototype.isEnabled=function(){return!!this._enabled},Dd.prototype.enable=function(a){this.isEnabled()||(this._el.classList.add("mapboxgl-touch-zoom-rotate"),this._enabled=!0,this._aroundCenter=!!a&&"center"===a.around)},Dd.prototype.disable=function(){this.isEnabled()&&(this._el.classList.remove("mapboxgl-touch-zoom-rotate"),this._enabled=!1)},Dd.prototype.disableRotation=function(){this._rotationDisabled=!0},Dd.prototype.enableRotation=function(){this._rotationDisabled=!1},Dd.prototype.onStart=function(b){if(this.isEnabled()&&2===b.touches.length){var c=na.mousePos(this._el,b.touches[0]),d=na.mousePos(this._el,b.touches[1]),e=c.add(d).div(2);this._startVec=c.sub(d),this._startAround=this._map.transform.pointLocation(e),this._gestureIntent=void 0,this._inertia=[],na.addEventListener(a.window.document,"touchmove",this._onMove,{passive:!1}),na.addEventListener(a.window.document,"touchend",this._onEnd)}},Dd.prototype._getTouchEventData=function(a){var b=na.mousePos(this._el,a.touches[0]),c=na.mousePos(this._el,a.touches[1]),d=b.sub(c);return{vec:d,center:b.add(c).div(2),scale:d.mag()/this._startVec.mag(),bearing:this._rotationDisabled?0:180*d.angleWith(this._startVec)/Math.PI}},Dd.prototype._onMove=function(b){if(2===b.touches.length){var c=this._getTouchEventData(b),d=c.vec,e=c.scale,f=c.bearing;if(!this._gestureIntent){var g=this._rotationDisabled&&1!==e||Math.abs(1-e)>.15;Math.abs(f)>10?this._gestureIntent="rotate":g&&(this._gestureIntent="zoom"),this._gestureIntent&&(this._map.fire(new a.Event(this._gestureIntent+"start",{originalEvent:b})),this._map.fire(new a.Event("movestart",{originalEvent:b})),this._startVec=d)}this._lastTouchEvent=b,this._frameId||(this._frameId=this._map._requestRenderFrame(this._onTouchFrame)),b.preventDefault()}},Dd.prototype._onTouchFrame=function(){this._frameId=null;var b=this._gestureIntent;if(b){var c=this._map.transform;this._startScale||(this._startScale=c.scale,this._startBearing=c.bearing);var d=this._getTouchEventData(this._lastTouchEvent),e=d.center,f=d.bearing,g=d.scale,h=c.pointLocation(e),i=c.locationPoint(h);"rotate"===b&&(c.bearing=this._startBearing+f),c.zoom=c.scaleZoom(this._startScale*g),c.setLocationAtPoint(this._startAround,i),this._map.fire(new a.Event(b,{originalEvent:this._lastTouchEvent})),this._map.fire(new a.Event("move",{originalEvent:this._lastTouchEvent})),this._drainInertiaBuffer(),this._inertia.push([a.browser.now(),g,e])}},Dd.prototype._onEnd=function(b){na.removeEventListener(a.window.document,"touchmove",this._onMove,{passive:!1}),na.removeEventListener(a.window.document,"touchend",this._onEnd);var c=this._gestureIntent,d=this._startScale;if(this._frameId&&(this._map._cancelRenderFrame(this._frameId),this._frameId=null),delete this._gestureIntent,delete this._startScale,delete this._startBearing,delete this._lastTouchEvent,c){this._map.fire(new a.Event(c+"end",{originalEvent:b})),this._drainInertiaBuffer();var e=this._inertia,f=this._map;if(e.length<2)f.snapToNorth({},{originalEvent:b});else{var g=e[e.length-1],h=e[0],i=f.transform.scaleZoom(d*g[1]),j=f.transform.scaleZoom(d*h[1]),k=i-j,l=(g[0]-h[0])/1e3,m=g[2];if(0!==l&&i!==j){var n=.15*k/l;Math.abs(n)>2.5&&(n=n>0?2.5:-2.5);var o=1e3*Math.abs(n/(12*.15)),p=i+n*o/2e3;p<0&&(p=0),f.easeTo({zoom:p,duration:o,easing:Cd,around:this._aroundCenter?f.getCenter():f.unproject(m),noMoveStart:!0},{originalEvent:b})}else f.snapToNorth({},{originalEvent:b})}}},Dd.prototype._drainInertiaBuffer=function(){for(var b=this._inertia,c=a.browser.now();b.length>2&&c-b[0][0]>160;)b.shift()};var Ed={scrollZoom:ud,boxZoom:vd,dragRotate:xd,dragPan:zd,keyboard:Ad,doubleClickZoom:Bd,touchZoomRotate:Dd},Fd=function(b){function c(c,d){b.call(this),this._moving=!1,this._zooming=!1,this.transform=c,this._bearingSnap=d.bearingSnap,a.bindAll(["_renderFrameCallback"],this)}return b&&(c.__proto__=b),c.prototype=Object.create(b&&b.prototype),c.prototype.constructor=c,c.prototype.getCenter=function(){return this.transform.center},c.prototype.setCenter=function(a,b){return this.jumpTo({center:a},b)},c.prototype.panBy=function(b,c,d){return b=a.Point.convert(b).mult(-1),this.panTo(this.transform.center,a.extend({offset:b},c),d)},c.prototype.panTo=function(b,c,d){return this.easeTo(a.extend({center:b},c),d)},c.prototype.getZoom=function(){return this.transform.zoom},c.prototype.setZoom=function(a,b){return this.jumpTo({zoom:a},b),this},c.prototype.zoomTo=function(b,c,d){return this.easeTo(a.extend({zoom:b},c),d)},c.prototype.zoomIn=function(a,b){return this.zoomTo(this.getZoom()+1,a,b),this},c.prototype.zoomOut=function(a,b){return this.zoomTo(this.getZoom()-1,a,b),this},c.prototype.getBearing=function(){return this.transform.bearing},c.prototype.setBearing=function(a,b){return this.jumpTo({bearing:a},b),this},c.prototype.rotateTo=function(b,c,d){return this.easeTo(a.extend({bearing:b},c),d)},c.prototype.resetNorth=function(b,c){return this.rotateTo(0,a.extend({duration:1e3},b),c),this},c.prototype.snapToNorth=function(a,b){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(a,b):this},c.prototype.getPitch=function(){return this.transform.pitch},c.prototype.setPitch=function(a,b){return this.jumpTo({pitch:a},b),this},c.prototype.cameraForBounds=function(b,c){return b=a.LngLatBounds.convert(b),this._cameraForBoxAndBearing(b.getNorthWest(),b.getSouthEast(),0,c)},c.prototype._cameraForBoxAndBearing=function(b,c,d,e){if("number"==typeof(e=a.extend({padding:{top:0,bottom:0,right:0,left:0},offset:[0,0],maxZoom:this.transform.maxZoom},e)).padding){var f=e.padding;e.padding={top:f,bottom:f,right:f,left:f}}if(a.isEqual(Object.keys(e.padding).sort(function(a,b){return a<b?-1:a>b?1:0}),["bottom","left","right","top"])){var g=this.transform,h=g.project(a.LngLat.convert(b)),i=g.project(a.LngLat.convert(c)),j=h.rotate(-d*Math.PI/180),k=i.rotate(-d*Math.PI/180),l=new a.Point(Math.max(j.x,k.x),Math.max(j.y,k.y)),m=new a.Point(Math.min(j.x,k.x),Math.min(j.y,k.y)),n=l.sub(m),o=(g.width-e.padding.left-e.padding.right)/n.x,p=(g.height-e.padding.top-e.padding.bottom)/n.y;if(!(p<0||o<0)){var q=Math.min(g.scaleZoom(g.scale*Math.min(o,p)),e.maxZoom),r=a.Point.convert(e.offset),s=(e.padding.left-e.padding.right)/2,t=(e.padding.top-e.padding.bottom)/2,u=new a.Point(r.x+s,r.y+t).mult(g.scale/g.zoomScale(q));return{center:g.unproject(h.add(i).div(2).sub(u)),zoom:q,bearing:d}}a.warnOnce("Map cannot fit within canvas with the given bounds, padding, and/or offset.")}else a.warnOnce("options.padding must be a positive number, or an Object with keys 'bottom', 'left', 'right', 'top'")},c.prototype.fitBounds=function(a,b,c){return this._fitInternal(this.cameraForBounds(a,b),b,c)},c.prototype.fitScreenCoordinates=function(b,c,d,e,f){return this._fitInternal(this._cameraForBoxAndBearing(this.transform.pointLocation(a.Point.convert(b)),this.transform.pointLocation(a.Point.convert(c)),d,e),e,f)},c.prototype._fitInternal=function(b,c,d){return b?(c=a.extend(b,c)).linear?this.easeTo(c,d):this.flyTo(c,d):this},c.prototype.jumpTo=function(b,c){this.stop();var d=this.transform,e=!1,f=!1,g=!1;return"zoom"in b&&d.zoom!==+b.zoom&&(e=!0,d.zoom=+b.zoom),void 0!==b.center&&(d.center=a.LngLat.convert(b.center)),"bearing"in b&&d.bearing!==+b.bearing&&(f=!0,d.bearing=+b.bearing),"pitch"in b&&d.pitch!==+b.pitch&&(g=!0,d.pitch=+b.pitch),this.fire(new a.Event("movestart",c)).fire(new a.Event("move",c)),e&&this.fire(new a.Event("zoomstart",c)).fire(new a.Event("zoom",c)).fire(new a.Event("zoomend",c)),f&&this.fire(new a.Event("rotatestart",c)).fire(new a.Event("rotate",c)).fire(new a.Event("rotateend",c)),g&&this.fire(new a.Event("pitchstart",c)).fire(new a.Event("pitch",c)).fire(new a.Event("pitchend",c)),this.fire(new a.Event("moveend",c))},c.prototype.easeTo=function(b,c){var d=this;this.stop(),!1===(b=a.extend({offset:[0,0],duration:500,easing:a.ease},b)).animate&&(b.duration=0);var e=this.transform,f=this.getZoom(),g=this.getBearing(),h=this.getPitch(),i="zoom"in b?+b.zoom:f,j="bearing"in b?this._normalizeBearing(b.bearing,g):g,k="pitch"in b?+b.pitch:h,l=e.centerPoint.add(a.Point.convert(b.offset)),m=e.pointLocation(l),n=a.LngLat.convert(b.center||m);this._normalizeCenter(n);var o,p,q=e.project(m),r=e.project(n).sub(q),s=e.zoomScale(i-f);return b.around&&(o=a.LngLat.convert(b.around),p=e.locationPoint(o)),this._zooming=i!==f,this._rotating=g!==j,this._pitching=k!==h,this._prepareEase(c,b.noMoveStart),clearTimeout(this._easeEndTimeoutID),this._ease(function(b){if(d._zooming&&(e.zoom=a.number(f,i,b)),d._rotating&&(e.bearing=a.number(g,j,b)),d._pitching&&(e.pitch=a.number(h,k,b)),o)e.setLocationAtPoint(o,p);else{var m=e.zoomScale(e.zoom-f),n=i>f?Math.min(2,s):Math.max(.5,s),t=Math.pow(n,1-b),u=e.unproject(q.add(r.mult(b*t)).mult(m));e.setLocationAtPoint(e.renderWorldCopies?u.wrap():u,l)}d._fireMoveEvents(c)},function(){b.delayEndEvents?d._easeEndTimeoutID=setTimeout(function(){return d._afterEase(c)},b.delayEndEvents):d._afterEase(c)},b),this},c.prototype._prepareEase=function(b,c){this._moving=!0,c||this.fire(new a.Event("movestart",b)),this._zooming&&this.fire(new a.Event("zoomstart",b)),this._rotating&&this.fire(new a.Event("rotatestart",b)),this._pitching&&this.fire(new a.Event("pitchstart",b))},c.prototype._fireMoveEvents=function(b){this.fire(new a.Event("move",b)),this._zooming&&this.fire(new a.Event("zoom",b)),this._rotating&&this.fire(new a.Event("rotate",b)),this._pitching&&this.fire(new a.Event("pitch",b))},c.prototype._afterEase=function(b){var c=this._zooming,d=this._rotating,e=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,c&&this.fire(new a.Event("zoomend",b)),d&&this.fire(new a.Event("rotateend",b)),e&&this.fire(new a.Event("pitchend",b)),this.fire(new a.Event("moveend",b))},c.prototype.flyTo=function(b,c){function d(a){var b=(w*w-v*v+(a?-1:1)*A*A*x*x)/(2*(a?w:v)*A*x);return Math.log(Math.sqrt(b*b+1)-b)}function e(a){return(Math.exp(a)-Math.exp(-a))/2}function f(a){return(Math.exp(a)+Math.exp(-a))/2}var g=this;this.stop(),b=a.extend({offset:[0,0],speed:1.2,curve:1.42,easing:a.ease},b);var h=this.transform,i=this.getZoom(),j=this.getBearing(),k=this.getPitch(),l="zoom"in b?a.clamp(+b.zoom,h.minZoom,h.maxZoom):i,m="bearing"in b?this._normalizeBearing(b.bearing,j):j,n="pitch"in b?+b.pitch:k,o=h.zoomScale(l-i),p=h.centerPoint.add(a.Point.convert(b.offset)),q=h.pointLocation(p),r=a.LngLat.convert(b.center||q);this._normalizeCenter(r);var s=h.project(q),t=h.project(r).sub(s),u=b.curve,v=Math.max(h.width,h.height),w=v/o,x=t.mag();if("minZoom"in b){var y=a.clamp(Math.min(b.minZoom,i,l),h.minZoom,h.maxZoom),z=v/h.zoomScale(y-i);u=Math.sqrt(z/x*2)}var A=u*u,B=d(0),C=function(a){return f(B)/f(B+u*a)},D=function(a){return v*((f(B)*(e(b=B+u*a)/f(b))-e(B))/A)/x;var b},E=(d(1)-B)/u;if(Math.abs(x)<1e-6||!isFinite(E)){if(Math.abs(v-w)<1e-6)return this.easeTo(b,c);var F=w<v?-1:1;E=Math.abs(Math.log(w/v))/u,D=function(){return 0},C=function(a){return Math.exp(F*u*a)}}if("duration"in b)b.duration=+b.duration;else{var G="screenSpeed"in b?+b.screenSpeed/u:+b.speed;b.duration=1e3*E/G}return b.maxDuration&&b.duration>b.maxDuration&&(b.duration=0),this._zooming=!0,this._rotating=j!==m,this._pitching=n!==k,this._prepareEase(c,!1),this._ease(function(b){var d=b*E,e=1/C(d);h.zoom=1===b?l:i+h.scaleZoom(e),g._rotating&&(h.bearing=a.number(j,m,b)),g._pitching&&(h.pitch=a.number(k,n,b));var f=1===b?r:h.unproject(s.add(t.mult(D(d))).mult(e));h.setLocationAtPoint(h.renderWorldCopies?f.wrap():f,p),g._fireMoveEvents(c)},function(){return g._afterEase(c)},b),this},c.prototype.isEasing=function(){return!!this._easeFrameId},c.prototype.stop=function(){if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),delete this._easeFrameId,delete this._onEaseFrame),this._onEaseEnd){var a=this._onEaseEnd;delete this._onEaseEnd,a.call(this)}return this},c.prototype._ease=function(b,c,d){!1===d.animate||0===d.duration?(b(1),c()):(this._easeStart=a.browser.now(),this._easeOptions=d,this._onEaseFrame=b,this._onEaseEnd=c,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))},c.prototype._renderFrameCallback=function(){var b=Math.min((a.browser.now()-this._easeStart)/this._easeOptions.duration,1);this._onEaseFrame(this._easeOptions.easing(b)),b<1?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()},c.prototype._normalizeBearing=function(b,c){b=a.wrap(b,-180,180);var d=Math.abs(b-c);return Math.abs(b-360-c)<d&&(b-=360),Math.abs(b+360-c)<d&&(b+=360),b},c.prototype._normalizeCenter=function(a){var b=this.transform;if(b.renderWorldCopies&&!b.lngRange){var c=a.lng-b.center.lng;a.lng+=c>180?-360:c<-180?360:0}},c}(a.Evented),Gd=function(b){void 0===b&&(b={}),this.options=b,a.bindAll(["_updateEditLink","_updateData","_updateCompact"],this)};Gd.prototype.getDefaultPosition=function(){return"bottom-right"},Gd.prototype.onAdd=function(a){var b=this.options&&this.options.compact;return this._map=a,this._container=na.create("div","mapboxgl-ctrl mapboxgl-ctrl-attrib"),this._innerContainer=na.create("div","mapboxgl-ctrl-attrib-inner",this._container),b&&this._container.classList.add("mapboxgl-compact"),this._updateAttributions(),this._updateEditLink(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("moveend",this._updateEditLink),void 0===b&&(this._map.on("resize",this._updateCompact),this._updateCompact()),this._container},Gd.prototype.onRemove=function(){na.remove(this._container),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("moveend",this._updateEditLink),this._map.off("resize",this._updateCompact),this._map=void 0},Gd.prototype._updateEditLink=function(){var b=this._editLink;b||(b=this._editLink=this._container.querySelector(".mapbox-improve-map"));var c=[{key:"owner",value:this.styleOwner},{key:"id",value:this.styleId},{key:"access_token",value:a.config.ACCESS_TOKEN}];if(b){var d=c.reduce(function(a,b,d){return b.value&&(a+=b.key+"="+b.value+(d<c.length-1?"&":"")),a},"?");b.href=a.config.FEEDBACK_URL+"/"+d+(this._map._hash?this._map._hash.getHashString(!0):"")}},Gd.prototype._updateData=function(a){!a||"metadata"!==a.sourceDataType&&"style"!==a.dataType||(this._updateAttributions(),this._updateEditLink())},Gd.prototype._updateAttributions=function(){if(this._map.style){var a=[];if(this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?a=a.concat(this.options.customAttribution.map(function(a){return"string"!=typeof a?"":a})):"string"==typeof this.options.customAttribution&&a.push(this.options.customAttribution)),this._map.style.stylesheet){var b=this._map.style.stylesheet;this.styleOwner=b.owner,this.styleId=b.id}var c=this._map.style.sourceCaches;for(var d in c){var e=c[d];if(e.used){var f=e.getSource();f.attribution&&a.indexOf(f.attribution)<0&&a.push(f.attribution)}}a.sort(function(a,b){return a.length-b.length}),(a=a.filter(function(b,c){for(var d=c+1;d<a.length;d++)if(a[d].indexOf(b)>=0)return!1;return!0})).length?(this._innerContainer.innerHTML=a.join(" | "),this._container.classList.remove("mapboxgl-attrib-empty")):this._container.classList.add("mapboxgl-attrib-empty"),this._editLink=null}},Gd.prototype._updateCompact=function(){this._map.getCanvasContainer().offsetWidth<=640?this._container.classList.add("mapboxgl-compact"):this._container.classList.remove("mapboxgl-compact")};var Hd=function(){a.bindAll(["_updateLogo"],this),a.bindAll(["_updateCompact"],this)};Hd.prototype.onAdd=function(a){this._map=a,this._container=na.create("div","mapboxgl-ctrl");var b=na.create("a","mapboxgl-ctrl-logo");return b.target="_blank",b.href="https://www.mapbox.com/",b.setAttribute("aria-label","Mapbox logo"),b.setAttribute("rel","noopener"),this._container.appendChild(b),this._container.style.display="none",this._map.on("sourcedata",this._updateLogo),this._updateLogo(),this._map.on("resize",this._updateCompact),this._updateCompact(),this._container},Hd.prototype.onRemove=function(){na.remove(this._container),this._map.off("sourcedata",this._updateLogo),this._map.off("resize",this._updateCompact)},Hd.prototype.getDefaultPosition=function(){return"bottom-left"},Hd.prototype._updateLogo=function(a){a&&"metadata"!==a.sourceDataType||(this._container.style.display=this._logoRequired()?"block":"none")},Hd.prototype._logoRequired=function(){if(this._map.style){var a=this._map.style.sourceCaches;for(var b in a)if(a[b].getSource().mapbox_logo)return!0;return!1}},Hd.prototype._updateCompact=function(){var a=this._container.children;if(a.length){var b=a[0];this._map.getCanvasContainer().offsetWidth<250?b.classList.add("mapboxgl-compact"):b.classList.remove("mapboxgl-compact")}};var Id=function(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1};Id.prototype.add=function(a){var b=++this._id;return this._queue.push({callback:a,id:b,cancelled:!1}),b},Id.prototype.remove=function(a){for(var b=this._currentlyRunning,c=0,d=b?this._queue.concat(b):this._queue;c<d.length;c+=1){var e=d[c];if(e.id===a)return void(e.cancelled=!0)}},Id.prototype.run=function(){var a=this._currentlyRunning=this._queue;this._queue=[];for(var b=0,c=a;b<c.length;b+=1){var d=c[b];if(!d.cancelled&&(d.callback(),this._cleared))break}this._cleared=!1,this._currentlyRunning=!1},Id.prototype.clear=function(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]};var Jd=a.window.HTMLImageElement,Kd=a.window.HTMLElement,Ld={center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:0,maxZoom:22,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,bearingSnap:7,clickTolerance:3,hash:!1,attributionControl:!0,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,trackResize:!0,renderWorldCopies:!0,refreshExpiredTiles:!0,maxTileCacheSize:null,transformRequest:null,fadeDuration:300,crossSourceCollisions:!0},Md=function(b){function c(c){var d=this;if(null!=(c=a.extend({},Ld,c)).minZoom&&null!=c.maxZoom&&c.minZoom>c.maxZoom)throw new Error("maxZoom must be greater than minZoom");var e=new od(c.minZoom,c.maxZoom,c.renderWorldCopies);b.call(this,e,c),this._interactive=c.interactive,this._maxTileCacheSize=c.maxTileCacheSize,this._failIfMajorPerformanceCaveat=c.failIfMajorPerformanceCaveat,this._preserveDrawingBuffer=c.preserveDrawingBuffer,this._trackResize=c.trackResize,this._bearingSnap=c.bearingSnap,this._refreshExpiredTiles=c.refreshExpiredTiles,this._fadeDuration=c.fadeDuration,this._crossSourceCollisions=c.crossSourceCollisions,this._crossFadingFactor=1,this._collectResourceTiming=c.collectResourceTiming,this._renderTaskQueue=new Id,this._controls=[],this._mapId=a.uniqueId();var f=c.transformRequest;if(this._transformRequest=f?function(a,b){return f(a,b)||{url:a}}:function(a){return{url:a}},"string"==typeof c.container){if(this._container=a.window.document.getElementById(c.container),!this._container)throw new Error("Container '"+c.container+"' not found.")}else{if(!(c.container instanceof Kd))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=c.container}if(c.maxBounds&&this.setMaxBounds(c.maxBounds),a.bindAll(["_onWindowOnline","_onWindowResize","_contextLost","_contextRestored"],this),this._setupContainer(),this._setupPainter(),void 0===this.painter)throw new Error("Failed to initialize WebGL.");this.on("move",function(){return d._update(!1)}),this.on("moveend",function(){return d._update(!1)}),this.on("zoom",function(){return d._update(!0)}),void 0!==a.window&&(a.window.addEventListener("online",this._onWindowOnline,!1),a.window.addEventListener("resize",this._onWindowResize,!1)),function(a,b){var c=a.getCanvasContainer(),d=null,e=!1,f=null;for(var g in Ed)a[g]=new Ed[g](a,b),b.interactive&&b[g]&&a[g].enable(b[g]);na.addEventListener(c,"mouseout",function(b){a.fire(new rd("mouseout",a,b))}),na.addEventListener(c,"mousedown",function(d){e=!0,f=na.mousePos(c,d);var g=new rd("mousedown",a,d);a.fire(g),g.defaultPrevented||(b.interactive&&!a.doubleClickZoom.isActive()&&a.stop(),a.boxZoom.onMouseDown(d),a.boxZoom.isActive()||a.dragPan.isActive()||a.dragRotate.onMouseDown(d),a.boxZoom.isActive()||a.dragRotate.isActive()||a.dragPan.onMouseDown(d))}),na.addEventListener(c,"mouseup",function(b){var c=a.dragRotate.isActive();d&&!c&&a.fire(new rd("contextmenu",a,d)),d=null,e=!1,a.fire(new rd("mouseup",a,b))}),na.addEventListener(c,"mousemove",function(b){if(!a.dragPan.isActive()&&!a.dragRotate.isActive()){for(var d=b.target;d&&d!==c;)d=d.parentNode;d===c&&a.fire(new rd("mousemove",a,b))}}),na.addEventListener(c,"mouseover",function(b){for(var d=b.target;d&&d!==c;)d=d.parentNode;d===c&&a.fire(new rd("mouseover",a,b))}),na.addEventListener(c,"touchstart",function(c){var d=new sd("touchstart",a,c);a.fire(d),d.defaultPrevented||(b.interactive&&a.stop(),a.boxZoom.isActive()||a.dragRotate.isActive()||a.dragPan.onTouchStart(c),a.touchZoomRotate.onStart(c),a.doubleClickZoom.onTouchStart(d))},{passive:!1}),na.addEventListener(c,"touchmove",function(b){a.fire(new sd("touchmove",a,b))},{passive:!1}),na.addEventListener(c,"touchend",function(b){a.fire(new sd("touchend",a,b))}),na.addEventListener(c,"touchcancel",function(b){a.fire(new sd("touchcancel",a,b))}),na.addEventListener(c,"click",function(d){var e=na.mousePos(c,d);(e.equals(f)||e.dist(f)<b.clickTolerance)&&a.fire(new rd("click",a,d))}),na.addEventListener(c,"dblclick",function(b){var c=new rd("dblclick",a,b);a.fire(c),c.defaultPrevented||a.doubleClickZoom.onDblClick(c)}),na.addEventListener(c,"contextmenu",function(b){var c=a.dragRotate.isActive();e||c?e&&(d=b):a.fire(new rd("contextmenu",a,b)),(a.dragRotate.isEnabled()||a.listens("contextmenu"))&&b.preventDefault()}),na.addEventListener(c,"wheel",function(c){b.interactive&&a.stop();var d=new td("wheel",a,c);a.fire(d),d.defaultPrevented||a.scrollZoom.onWheel(c)},{passive:!1})}(this,c),this._hash=c.hash&&(new qd).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:c.center,zoom:c.zoom,bearing:c.bearing,pitch:c.pitch}),c.bounds&&(this.resize(),this.fitBounds(c.bounds,a.extend({},c.fitBoundsOptions,{duration:0})))),this.resize(),c.style&&this.setStyle(c.style,{localIdeographFontFamily:c.localIdeographFontFamily}),c.attributionControl&&this.addControl(new Gd({customAttribution:c.customAttribution})),this.addControl(new Hd,c.logoPosition),this.on("style.load",function(){d.transform.unmodified&&d.jumpTo(d.style.stylesheet)}),this.on("data",function(b){d._update("style"===b.dataType),d.fire(new a.Event(b.dataType+"data",b))}),this.on("dataloading",function(b){d.fire(new a.Event(b.dataType+"dataloading",b))})}b&&(c.__proto__=b),c.prototype=Object.create(b&&b.prototype),c.prototype.constructor=c;var d={showTileBoundaries:{configurable:!0},showCollisionBoxes:{configurable:!0},showOverdrawInspector:{configurable:!0},repaint:{configurable:!0},vertices:{configurable:!0}}
;return c.prototype._getMapId=function(){return this._mapId},c.prototype.addControl=function(b,c){if(void 0===c&&b.getDefaultPosition&&(c=b.getDefaultPosition()),void 0===c&&(c="top-right"),!b||!b.onAdd)return this.fire(new a.ErrorEvent(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));var d=b.onAdd(this);this._controls.push(b);var e=this._controlPositions[c];return-1!==c.indexOf("bottom")?e.insertBefore(d,e.firstChild):e.appendChild(d),this},c.prototype.removeControl=function(b){if(!b||!b.onRemove)return this.fire(new a.ErrorEvent(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));var c=this._controls.indexOf(b);return c>-1&&this._controls.splice(c,1),b.onRemove(this),this},c.prototype.resize=function(b){var c=this._containerDimensions(),d=c[0],e=c[1];return this._resizeCanvas(d,e),this.transform.resize(d,e),this.painter.resize(d,e),this.fire(new a.Event("movestart",b)).fire(new a.Event("move",b)).fire(new a.Event("resize",b)).fire(new a.Event("moveend",b)),this},c.prototype.getBounds=function(){return this.transform.getBounds()},c.prototype.getMaxBounds=function(){return this.transform.getMaxBounds()},c.prototype.setMaxBounds=function(b){return this.transform.setMaxBounds(a.LngLatBounds.convert(b)),this._update()},c.prototype.setMinZoom=function(a){if((a=null==a?0:a)>=0&&a<=this.transform.maxZoom)return this.transform.minZoom=a,this._update(),this.getZoom()<a&&this.setZoom(a),this;throw new Error("minZoom must be between 0 and the current maxZoom, inclusive")},c.prototype.getMinZoom=function(){return this.transform.minZoom},c.prototype.setMaxZoom=function(a){if((a=null==a?22:a)>=this.transform.minZoom)return this.transform.maxZoom=a,this._update(),this.getZoom()>a&&this.setZoom(a),this;throw new Error("maxZoom must be greater than the current minZoom")},c.prototype.getRenderWorldCopies=function(){return this.transform.renderWorldCopies},c.prototype.setRenderWorldCopies=function(a){return this.transform.renderWorldCopies=a,this._update()},c.prototype.getMaxZoom=function(){return this.transform.maxZoom},c.prototype.project=function(b){return this.transform.locationPoint(a.LngLat.convert(b))},c.prototype.unproject=function(b){return this.transform.pointLocation(a.Point.convert(b))},c.prototype.isMoving=function(){return this._moving||this.dragPan.isActive()||this.dragRotate.isActive()||this.scrollZoom.isActive()},c.prototype.isZooming=function(){return this._zooming||this.scrollZoom.isZooming()},c.prototype.isRotating=function(){return this._rotating||this.dragRotate.isActive()},c.prototype.on=function(a,c,d){var e=this;if(void 0===d)return b.prototype.on.call(this,a,c);var f=function(){var b;if("mouseenter"===a||"mouseover"===a){var f=!1;return{layer:c,listener:d,delegates:{mousemove:function(b){var g=e.getLayer(c)?e.queryRenderedFeatures(b.point,{layers:[c]}):[];g.length?f||(f=!0,d.call(e,new rd(a,e,b.originalEvent,{features:g}))):f=!1},mouseout:function(){f=!1}}}}if("mouseleave"===a||"mouseout"===a){var g=!1;return{layer:c,listener:d,delegates:{mousemove:function(b){(e.getLayer(c)?e.queryRenderedFeatures(b.point,{layers:[c]}):[]).length?g=!0:g&&(g=!1,d.call(e,new rd(a,e,b.originalEvent)))},mouseout:function(b){g&&(g=!1,d.call(e,new rd(a,e,b.originalEvent)))}}}}return{layer:c,listener:d,delegates:(b={},b[a]=function(a){var b=e.getLayer(c)?e.queryRenderedFeatures(a.point,{layers:[c]}):[];b.length&&(a.features=b,d.call(e,a),delete a.features)},b)}}();for(var g in this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[a]=this._delegatedListeners[a]||[],this._delegatedListeners[a].push(f),f.delegates)this.on(g,f.delegates[g]);return this},c.prototype.off=function(a,c,d){if(void 0===d)return b.prototype.off.call(this,a,c);if(this._delegatedListeners&&this._delegatedListeners[a])for(var e=this._delegatedListeners[a],f=0;f<e.length;f++){var g=e[f];if(g.layer===c&&g.listener===d){for(var h in g.delegates)this.off(h,g.delegates[h]);return e.splice(f,1),this}}return this},c.prototype.queryRenderedFeatures=function(b,c){if(!this.style)return[];var d;if(void 0!==c||void 0===b||b instanceof a.Point||Array.isArray(b)||(c=b,b=void 0),c=c||{},(b=b||[[0,0],[this.transform.width,this.transform.height]])instanceof a.Point||"number"==typeof b[0])d=[a.Point.convert(b)];else{var e=a.Point.convert(b[0]),f=a.Point.convert(b[1]);d=[e,new a.Point(f.x,e.y),f,new a.Point(e.x,f.y),e]}return this.style.queryRenderedFeatures(d,c,this.transform)},c.prototype.querySourceFeatures=function(a,b){return this.style.querySourceFeatures(a,b)},c.prototype.setStyle=function(a,b){return(!b||!1!==b.diff&&!b.localIdeographFontFamily)&&this.style&&a?(this._diffStyle(a,b),this):this._updateStyle(a,b)},c.prototype._updateStyle=function(a,b){return this.style&&(this.style.setEventedParent(null),this.style._remove()),a?(this.style=new gc(this,b||{}),this.style.setEventedParent(this,{style:this.style}),"string"==typeof a?this.style.loadURL(a):this.style.loadJSON(a),this):(delete this.style,this)},c.prototype._diffStyle=function(b,c){var d=this;if("string"==typeof b){var e=a.normalizeStyleURL(b),f=this._transformRequest(e,a.ResourceType.Style);a.getJSON(f,function(b,e){b?d.fire(new a.ErrorEvent(b)):e&&d._updateDiff(e,c)})}else"object"==typeof b&&this._updateDiff(b,c)},c.prototype._updateDiff=function(b,c){try{this.style.setState(b)&&this._update(!0)}catch(d){a.warnOnce("Unable to perform style diff: "+(d.message||d.error||d)+".  Rebuilding the style from scratch."),this._updateStyle(b,c)}},c.prototype.getStyle=function(){if(this.style)return this.style.serialize()},c.prototype.isStyleLoaded=function(){return this.style?this.style.loaded():a.warnOnce("There is no style added to the map.")},c.prototype.addSource=function(a,b){return this.style.addSource(a,b),this._update(!0)},c.prototype.isSourceLoaded=function(b){var c=this.style&&this.style.sourceCaches[b];if(void 0!==c)return c.loaded();this.fire(new a.ErrorEvent(new Error("There is no source with ID '"+b+"'")))},c.prototype.areTilesLoaded=function(){var a=this.style&&this.style.sourceCaches;for(var b in a){var c=a[b]._tiles;for(var d in c){var e=c[d];if("loaded"!==e.state&&"errored"!==e.state)return!1}}return!0},c.prototype.addSourceType=function(a,b,c){return this.style.addSourceType(a,b,c)},c.prototype.removeSource=function(a){return this.style.removeSource(a),this._update(!0)},c.prototype.getSource=function(a){return this.style.getSource(a)},c.prototype.addImage=function(b,c,d){void 0===d&&(d={});var e=d.pixelRatio;void 0===e&&(e=1);var f=d.sdf;if(void 0===f&&(f=!1),c instanceof Jd){var g=a.browser.getImageData(c),h=g.width,i=g.height,j=g.data;this.style.addImage(b,{data:new a.RGBAImage({width:h,height:i},j),pixelRatio:e,sdf:f})}else{if(void 0===c.width||void 0===c.height)return this.fire(new a.ErrorEvent(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));var k=c.width,l=c.height,m=c.data;this.style.addImage(b,{data:new a.RGBAImage({width:k,height:l},new Uint8Array(m)),pixelRatio:e,sdf:f})}},c.prototype.hasImage=function(b){return b?!!this.style.getImage(b):(this.fire(new a.ErrorEvent(new Error("Missing required image id"))),!1)},c.prototype.removeImage=function(a){this.style.removeImage(a)},c.prototype.loadImage=function(b,c){a.getImage(this._transformRequest(b,a.ResourceType.Image),c)},c.prototype.listImages=function(){return this.style.listImages()},c.prototype.addLayer=function(a,b){return this.style.addLayer(a,b),this._update(!0)},c.prototype.moveLayer=function(a,b){return this.style.moveLayer(a,b),this._update(!0)},c.prototype.removeLayer=function(a){return this.style.removeLayer(a),this._update(!0)},c.prototype.getLayer=function(a){return this.style.getLayer(a)},c.prototype.setFilter=function(a,b,c){return void 0===c&&(c={}),this.style.setFilter(a,b,c),this._update(!0)},c.prototype.setLayerZoomRange=function(a,b,c){return this.style.setLayerZoomRange(a,b,c),this._update(!0)},c.prototype.getFilter=function(a){return this.style.getFilter(a)},c.prototype.setPaintProperty=function(a,b,c,d){return void 0===d&&(d={}),this.style.setPaintProperty(a,b,c,d),this._update(!0)},c.prototype.getPaintProperty=function(a,b){return this.style.getPaintProperty(a,b)},c.prototype.setLayoutProperty=function(a,b,c,d){return void 0===d&&(d={}),this.style.setLayoutProperty(a,b,c,d),this._update(!0)},c.prototype.getLayoutProperty=function(a,b){return this.style.getLayoutProperty(a,b)},c.prototype.setLight=function(a,b){return void 0===b&&(b={}),this.style.setLight(a,b),this._update(!0)},c.prototype.getLight=function(){return this.style.getLight()},c.prototype.setFeatureState=function(a,b){return this.style.setFeatureState(a,b),this._update()},c.prototype.removeFeatureState=function(a,b){return this.style.removeFeatureState(a,b),this._update()},c.prototype.getFeatureState=function(a){return this.style.getFeatureState(a)},c.prototype.getContainer=function(){return this._container},c.prototype.getCanvasContainer=function(){return this._canvasContainer},c.prototype.getCanvas=function(){return this._canvas},c.prototype._containerDimensions=function(){var a=0,b=0;return this._container&&(a=this._container.clientWidth||400,b=this._container.clientHeight||300),[a,b]},c.prototype._detectMissingCSS=function(){"rgb(250, 128, 114)"!==a.window.getComputedStyle(this._missingCSSCanary).getPropertyValue("background-color")&&a.warnOnce("This page appears to be missing CSS declarations for Mapbox GL JS, which may cause the map to display incorrectly. Please ensure your page includes mapbox-gl.css, as described in https://www.mapbox.com/mapbox-gl-js/api/.")},c.prototype._setupContainer=function(){var a=this._container;a.classList.add("mapboxgl-map"),(this._missingCSSCanary=na.create("div","mapboxgl-canary",a)).style.visibility="hidden",this._detectMissingCSS();var b=this._canvasContainer=na.create("div","mapboxgl-canvas-container",a);this._interactive&&b.classList.add("mapboxgl-interactive"),this._canvas=na.create("canvas","mapboxgl-canvas",b),this._canvas.style.position="absolute",this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex","0"),this._canvas.setAttribute("aria-label","Map");var c=this._containerDimensions();this._resizeCanvas(c[0],c[1]);var d=this._controlContainer=na.create("div","mapboxgl-control-container",a),e=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach(function(a){e[a]=na.create("div","mapboxgl-ctrl-"+a,d)})},c.prototype._resizeCanvas=function(b,c){var d=a.window.devicePixelRatio||1;this._canvas.width=d*b,this._canvas.height=d*c,this._canvas.style.width=b+"px",this._canvas.style.height=c+"px"},c.prototype._setupPainter=function(){var b=a.extend({failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer},ma.webGLContextAttributes),c=this._canvas.getContext("webgl",b)||this._canvas.getContext("experimental-webgl",b);c?(this.painter=new nd(c,this.transform),a.webpSupported.testSupport(c)):this.fire(new a.ErrorEvent(new Error("Failed to initialize WebGL")))},c.prototype._contextLost=function(b){b.preventDefault(),this._frame&&(this._frame.cancel(),this._frame=null),this.fire(new a.Event("webglcontextlost",{originalEvent:b}))},c.prototype._contextRestored=function(b){this._setupPainter(),this.resize(),this._update(),this.fire(new a.Event("webglcontextrestored",{originalEvent:b}))},c.prototype.loaded=function(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()},c.prototype._update=function(a){return this.style?(this._styleDirty=this._styleDirty||a,this._sourcesDirty=!0,this.triggerRepaint(),this):this},c.prototype._requestRenderFrame=function(a){return this._update(),this._renderTaskQueue.add(a)},c.prototype._cancelRenderFrame=function(a){this._renderTaskQueue.remove(a)},c.prototype._render=function(){this.painter.context.setDirty(),this.painter.setBaseState(),this._renderTaskQueue.run();var b=!1;if(this.style&&this._styleDirty){this._styleDirty=!1;var c=this.transform.zoom,d=a.browser.now();this.style.zoomHistory.update(c,d);var e=new a.EvaluationParameters(c,{now:d,fadeDuration:this._fadeDuration,zoomHistory:this.style.zoomHistory,transition:this.style.getTransition()}),f=e.crossFadingFactor();1===f&&f===this._crossFadingFactor||(b=!0,this._crossFadingFactor=f),this.style.update(e)}return this.style&&this._sourcesDirty&&(this._sourcesDirty=!1,this.style._updateSources(this.transform)),this._placementDirty=this.style&&this.style._updatePlacement(this.painter.transform,this.showCollisionBoxes,this._fadeDuration,this._crossSourceCollisions),this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showOverdrawInspector:this._showOverdrawInspector,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:this._fadeDuration}),this.fire(new a.Event("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,this.fire(new a.Event("load"))),this.style&&(this.style.hasTransitions()||b)&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles(),this._sourcesDirty||this._repaint||this._styleDirty||this._placementDirty?this.triggerRepaint():!this.isMoving()&&this.loaded()&&this.fire(new a.Event("idle")),this},c.prototype.remove=function(){this._hash&&this._hash.remove();for(var b=0,c=this._controls;b<c.length;b+=1)c[b].onRemove(this);this._controls=[],this._frame&&(this._frame.cancel(),this._frame=null),this._renderTaskQueue.clear(),this.setStyle(null),void 0!==a.window&&(a.window.removeEventListener("resize",this._onWindowResize,!1),a.window.removeEventListener("online",this._onWindowOnline,!1));var d=this.painter.context.gl.getExtension("WEBGL_lose_context");d&&d.loseContext(),ga(this._canvasContainer),ga(this._controlContainer),ga(this._missingCSSCanary),this._container.classList.remove("mapboxgl-map"),this.fire(new a.Event("remove"))},c.prototype.triggerRepaint=function(){var b=this;this.style&&!this._frame&&(this._frame=a.browser.frame(function(){b._frame=null,b._render()}))},c.prototype._onWindowOnline=function(){this._update()},c.prototype._onWindowResize=function(){this._trackResize&&this.resize()._update()},d.showTileBoundaries.get=function(){return!!this._showTileBoundaries},d.showTileBoundaries.set=function(a){this._showTileBoundaries!==a&&(this._showTileBoundaries=a,this._update())},d.showCollisionBoxes.get=function(){return!!this._showCollisionBoxes},d.showCollisionBoxes.set=function(a){this._showCollisionBoxes!==a&&(this._showCollisionBoxes=a,a?this.style._generateCollisionBoxes():this._update())},d.showOverdrawInspector.get=function(){return!!this._showOverdrawInspector},d.showOverdrawInspector.set=function(a){this._showOverdrawInspector!==a&&(this._showOverdrawInspector=a,this._update())},d.repaint.get=function(){return!!this._repaint},d.repaint.set=function(a){this._repaint!==a&&(this._repaint=a,this.triggerRepaint())},d.vertices.get=function(){return!!this._vertices},d.vertices.set=function(a){this._vertices=a,this._update()},Object.defineProperties(c.prototype,d),c}(Fd),Nd={showCompass:!0,showZoom:!0},Od=function(b){var c=this;this.options=a.extend({},Nd,b),this._container=na.create("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._container.addEventListener("contextmenu",function(a){return a.preventDefault()}),this.options.showZoom&&(this._zoomInButton=this._createButton("mapboxgl-ctrl-icon mapboxgl-ctrl-zoom-in","Zoom in",function(){return c._map.zoomIn()}),this._zoomOutButton=this._createButton("mapboxgl-ctrl-icon mapboxgl-ctrl-zoom-out","Zoom out",function(){return c._map.zoomOut()})),this.options.showCompass&&(a.bindAll(["_rotateCompassArrow"],this),this._compass=this._createButton("mapboxgl-ctrl-icon mapboxgl-ctrl-compass","Reset bearing to north",function(){return c._map.resetNorth()}),this._compassArrow=na.create("span","mapboxgl-ctrl-compass-arrow",this._compass))};Od.prototype._rotateCompassArrow=function(){var a="rotate("+this._map.transform.angle*(180/Math.PI)+"deg)";this._compassArrow.style.transform=a},Od.prototype.onAdd=function(a){return this._map=a,this.options.showCompass&&(this._map.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new xd(a,{button:"left",element:this._compass}),na.addEventListener(this._compass,"mousedown",this._handler.onMouseDown),this._handler.enable()),this._container},Od.prototype.onRemove=function(){na.remove(this._container),this.options.showCompass&&(this._map.off("rotate",this._rotateCompassArrow),na.removeEventListener(this._compass,"mousedown",this._handler.onMouseDown),this._handler.disable(),delete this._handler),delete this._map},Od.prototype._createButton=function(a,b,c){var d=na.create("button",a,this._container);return d.type="button",d.title=b,d.setAttribute("aria-label",b),d.addEventListener("click",c),d};var Pd,Qd={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"},Rd=function(b){function c(c,d){if(b.call(this),(c instanceof a.window.HTMLElement||d)&&(c=a.extend({element:c},d)),a.bindAll(["_update","_onMove","_onUp","_addDragHandler","_onMapClick"],this),this._anchor=c&&c.anchor||"center",this._color=c&&c.color||"#3FB1CE",this._draggable=c&&c.draggable||!1,this._state="inactive",c&&c.element)this._element=c.element,this._offset=a.Point.convert(c&&c.offset||[0,0]);else{this._defaultMarker=!0,this._element=na.create("div");var e=na.createNS("http://www.w3.org/2000/svg","svg");e.setAttributeNS(null,"height","41px"),e.setAttributeNS(null,"width","27px"),e.setAttributeNS(null,"viewBox","0 0 27 41");var f=na.createNS("http://www.w3.org/2000/svg","g");f.setAttributeNS(null,"stroke","none"),f.setAttributeNS(null,"stroke-width","1"),f.setAttributeNS(null,"fill","none"),f.setAttributeNS(null,"fill-rule","evenodd");var g=na.createNS("http://www.w3.org/2000/svg","g");g.setAttributeNS(null,"fill-rule","nonzero");var h=na.createNS("http://www.w3.org/2000/svg","g");h.setAttributeNS(null,"transform","translate(3.0, 29.0)"),h.setAttributeNS(null,"fill","#000000");for(var i=0,j=[{rx:"10.5",ry:"5.25002273"},{rx:"10.5",ry:"5.25002273"},{rx:"9.5",ry:"4.77275007"},{rx:"8.5",ry:"4.29549936"},{rx:"7.5",ry:"3.81822308"},{rx:"6.5",ry:"3.34094679"},{rx:"5.5",ry:"2.86367051"},{rx:"4.5",ry:"2.38636864"}];i<j.length;i+=1){var k=j[i],l=na.createNS("http://www.w3.org/2000/svg","ellipse");l.setAttributeNS(null,"opacity","0.04"),l.setAttributeNS(null,"cx","10.5"),l.setAttributeNS(null,"cy","5.80029008"),l.setAttributeNS(null,"rx",k.rx),l.setAttributeNS(null,"ry",k.ry),h.appendChild(l)}var m=na.createNS("http://www.w3.org/2000/svg","g");m.setAttributeNS(null,"fill",this._color);var n=na.createNS("http://www.w3.org/2000/svg","path");n.setAttributeNS(null,"d","M27,13.5 C27,19.074644 20.250001,27.000002 14.75,34.500002 C14.016665,35.500004 12.983335,35.500004 12.25,34.500002 C6.7499993,27.000002 0,19.222562 0,13.5 C0,6.0441559 6.0441559,0 13.5,0 C20.955844,0 27,6.0441559 27,13.5 Z"),m.appendChild(n);var o=na.createNS("http://www.w3.org/2000/svg","g");o.setAttributeNS(null,"opacity","0.25"),o.setAttributeNS(null,"fill","#000000");var p=na.createNS("http://www.w3.org/2000/svg","path");p.setAttributeNS(null,"d","M13.5,0 C6.0441559,0 0,6.0441559 0,13.5 C0,19.222562 6.7499993,27 12.25,34.5 C13,35.522727 14.016664,35.500004 14.75,34.5 C20.250001,27 27,19.074644 27,13.5 C27,6.0441559 20.955844,0 13.5,0 Z M13.5,1 C20.415404,1 26,6.584596 26,13.5 C26,15.898657 24.495584,19.181431 22.220703,22.738281 C19.945823,26.295132 16.705119,30.142167 13.943359,33.908203 C13.743445,34.180814 13.612715,34.322738 13.5,34.441406 C13.387285,34.322738 13.256555,34.180814 13.056641,33.908203 C10.284481,30.127985 7.4148684,26.314159 5.015625,22.773438 C2.6163816,19.232715 1,15.953538 1,13.5 C1,6.584596 6.584596,1 13.5,1 Z"),o.appendChild(p);var q=na.createNS("http://www.w3.org/2000/svg","g");q.setAttributeNS(null,"transform","translate(6.0, 7.0)"),q.setAttributeNS(null,"fill","#FFFFFF");var r=na.createNS("http://www.w3.org/2000/svg","g");r.setAttributeNS(null,"transform","translate(8.0, 8.0)");var s=na.createNS("http://www.w3.org/2000/svg","circle");s.setAttributeNS(null,"fill","#000000"),s.setAttributeNS(null,"opacity","0.25"),s.setAttributeNS(null,"cx","5.5"),s.setAttributeNS(null,"cy","5.5"),s.setAttributeNS(null,"r","5.4999962");var t=na.createNS("http://www.w3.org/2000/svg","circle");t.setAttributeNS(null,"fill","#FFFFFF"),t.setAttributeNS(null,"cx","5.5"),t.setAttributeNS(null,"cy","5.5"),t.setAttributeNS(null,"r","5.4999962"),r.appendChild(s),r.appendChild(t),g.appendChild(h),g.appendChild(m),g.appendChild(o),g.appendChild(q),g.appendChild(r),e.appendChild(g),this._element.appendChild(e),this._offset=a.Point.convert(c&&c.offset||[0,-14])}this._element.classList.add("mapboxgl-marker"),this._popup=null}return b&&(c.__proto__=b),c.prototype=Object.create(b&&b.prototype),c.prototype.constructor=c,c.prototype.addTo=function(a){return this.remove(),this._map=a,a.getCanvasContainer().appendChild(this._element),a.on("move",this._update),a.on("moveend",this._update),this.setDraggable(this._draggable),this._update(),this._map.on("click",this._onMapClick),this},c.prototype.remove=function(){return this._map&&(this._map.off("click",this._onMapClick),this._map.off("move",this._update),this._map.off("moveend",this._update),this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler),this._map.off("mouseup",this._onUp),this._map.off("touchend",this._onUp),delete this._map),na.remove(this._element),this._popup&&this._popup.remove(),this},c.prototype.getLngLat=function(){return this._lngLat},c.prototype.setLngLat=function(b){return this._lngLat=a.LngLat.convert(b),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(),this},c.prototype.getElement=function(){return this._element},c.prototype.setPopup=function(a){if(this._popup&&(this._popup.remove(),this._popup=null),a){if(!("offset"in a.options)){var b=Math.sqrt(Math.pow(13.5,2)/2);a.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[b,-1*(24.6+b)],"bottom-right":[-b,-1*(24.6+b)],left:[13.5,-24.6],right:[-13.5,-24.6]}:this._offset}this._popup=a,this._lngLat&&this._popup.setLngLat(this._lngLat)}return this},c.prototype._onMapClick=function(a){var b=a.originalEvent.target,c=this._element;this._popup&&(b===c||c.contains(b))&&this.togglePopup()},c.prototype.getPopup=function(){return this._popup},c.prototype.togglePopup=function(){var a=this._popup;return a?(a.isOpen()?a.remove():a.addTo(this._map),this):this},c.prototype._update=function(a){this._map&&(this._map.transform.renderWorldCopies&&(this._lngLat=ha(this._lngLat,this._pos,this._map.transform)),this._pos=this._map.project(this._lngLat)._add(this._offset),a&&"moveend"!==a.type||(this._pos=this._pos.round()),na.setTransform(this._element,Qd[this._anchor]+" translate("+this._pos.x+"px, "+this._pos.y+"px)"),ia(this._element,this._anchor,"marker"))},c.prototype.getOffset=function(){return this._offset},c.prototype.setOffset=function(b){return this._offset=a.Point.convert(b),this._update(),this},c.prototype._onMove=function(b){this._pos=b.point.sub(this._positionDelta),this._lngLat=this._map.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none","pending"===this._state&&(this._state="active",this.fire(new a.Event("dragstart"))),this.fire(new a.Event("drag"))},c.prototype._onUp=function(){this._element.style.pointerEvents="auto",this._positionDelta=null,this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),"active"===this._state&&this.fire(new a.Event("dragend")),this._state="inactive"},c.prototype._addDragHandler=function(a){this._element.contains(a.originalEvent.target)&&(a.preventDefault(),this._positionDelta=a.point.sub(this._pos).add(this._offset),this._state="pending",this._map.on("mousemove",this._onMove),this._map.on("touchmove",this._onMove),this._map.once("mouseup",this._onUp),this._map.once("touchend",this._onUp))},c.prototype.setDraggable=function(a){return this._draggable=!!a,this._map&&(a?(this._map.on("mousedown",this._addDragHandler),this._map.on("touchstart",this._addDragHandler)):(this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler))),this},c.prototype.isDraggable=function(){return this._draggable},c}(a.Evented),Sd={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showUserLocation:!0},Td=function(b){function c(c){b.call(this),this.options=a.extend({},Sd,c),a.bindAll(["_onSuccess","_onError","_finish","_setupUI","_updateCamera","_updateMarker"],this)}return b&&(c.__proto__=b),c.prototype=Object.create(b&&b.prototype),c.prototype.constructor=c,c.prototype.onAdd=function(b){var c;return this._map=b,this._container=na.create("div","mapboxgl-ctrl mapboxgl-ctrl-group"),c=this._setupUI,void 0!==Pd?c(Pd):void 0!==a.window.navigator.permissions?a.window.navigator.permissions.query({name:"geolocation"}).then(function(a){Pd="denied"!==a.state,c(Pd)}):(Pd=!!a.window.navigator.geolocation,c(Pd)),this._container},c.prototype.onRemove=function(){void 0!==this._geolocationWatchID&&(a.window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),na.remove(this._container),this._map=void 0},c.prototype._onSuccess=function(b){if(this.options.trackUserLocation)switch(this._lastKnownPosition=b,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background")}this.options.showUserLocation&&"OFF"!==this._watchState&&this._updateMarker(b),this.options.trackUserLocation&&"ACTIVE_LOCK"!==this._watchState||this._updateCamera(b),this.options.showUserLocation&&this._dotElement.classList.remove("mapboxgl-user-location-dot-stale"),this.fire(new a.Event("geolocate",b)),this._finish()},c.prototype._updateCamera=function(b){var c=new a.LngLat(b.coords.longitude,b.coords.latitude),d=b.coords.accuracy;this._map.fitBounds(c.toBounds(d),this.options.fitBoundsOptions,{geolocateSource:!0})},c.prototype._updateMarker=function(a){a?this._userLocationDotMarker.setLngLat([a.coords.longitude,a.coords.latitude]).addTo(this._map):this._userLocationDotMarker.remove()},c.prototype._onError=function(b){if(this.options.trackUserLocation)if(1===b.code)this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),void 0!==this._geolocationWatchID&&this._clearWatch();else switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting")}"OFF"!==this._watchState&&this.options.showUserLocation&&this._dotElement.classList.add("mapboxgl-user-location-dot-stale"),this.fire(new a.Event("error",b)),this._finish()},c.prototype._finish=function(){this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0},c.prototype._setupUI=function(b){var c=this;!1!==b?(this._container.addEventListener("contextmenu",function(a){return a.preventDefault()}),this._geolocateButton=na.create("button","mapboxgl-ctrl-icon mapboxgl-ctrl-geolocate",this._container),this._geolocateButton.type="button",this._geolocateButton.setAttribute("aria-label","Geolocate"),this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=na.create("div","mapboxgl-user-location-dot"),this._userLocationDotMarker=new Rd(this._dotElement),this.options.trackUserLocation&&(this._watchState="OFF")),this._geolocateButton.addEventListener("click",this.trigger.bind(this)),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",function(b){b.geolocateSource||"ACTIVE_LOCK"!==c._watchState||(c._watchState="BACKGROUND",c._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background"),c._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),c.fire(new a.Event("trackuserlocationend")))})):a.warnOnce("Geolocation support is not available, the GeolocateControl will not be visible.")},c.prototype.trigger=function(){if(!this._setup)return a.warnOnce("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new a.Event("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this.fire(new a.Event("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new a.Event("trackuserlocationstart"))}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"BACKGROUND":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background");break;case"BACKGROUND_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error")}
"OFF"===this._watchState&&void 0!==this._geolocationWatchID?this._clearWatch():void 0===this._geolocationWatchID&&(this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),this._geolocationWatchID=a.window.navigator.geolocation.watchPosition(this._onSuccess,this._onError,this.options.positionOptions))}else a.window.navigator.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0},c.prototype._clearWatch=function(){a.window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)},c}(a.Evented),Ud={maxWidth:100,unit:"metric"},Vd=function(b){this.options=a.extend({},Ud,b),a.bindAll(["_onMove","setUnit"],this)};Vd.prototype.getDefaultPosition=function(){return"bottom-left"},Vd.prototype._onMove=function(){ja(this._map,this._container,this.options)},Vd.prototype.onAdd=function(a){return this._map=a,this._container=na.create("div","mapboxgl-ctrl mapboxgl-ctrl-scale",a.getContainer()),this._map.on("move",this._onMove),this._onMove(),this._container},Vd.prototype.onRemove=function(){na.remove(this._container),this._map.off("move",this._onMove),this._map=void 0},Vd.prototype.setUnit=function(a){this.options.unit=a,ja(this._map,this._container,this.options)};var Wd=function(b){this._fullscreen=!1,b&&b.container&&(b.container instanceof a.window.HTMLElement?this._container=b.container:a.warnOnce("Full screen control 'container' must be a DOM element.")),a.bindAll(["_onClickFullscreen","_changeIcon"],this),"onfullscreenchange"in a.window.document?this._fullscreenchange="fullscreenchange":"onmozfullscreenchange"in a.window.document?this._fullscreenchange="mozfullscreenchange":"onwebkitfullscreenchange"in a.window.document?this._fullscreenchange="webkitfullscreenchange":"onmsfullscreenchange"in a.window.document&&(this._fullscreenchange="MSFullscreenChange"),this._className="mapboxgl-ctrl"};Wd.prototype.onAdd=function(b){return this._map=b,this._container||(this._container=this._map.getContainer()),this._controlContainer=na.create("div",this._className+" mapboxgl-ctrl-group"),this._checkFullscreenSupport()?this._setupUI():(this._controlContainer.style.display="none",a.warnOnce("This device does not support fullscreen mode.")),this._controlContainer},Wd.prototype.onRemove=function(){na.remove(this._controlContainer),this._map=null,a.window.document.removeEventListener(this._fullscreenchange,this._changeIcon)},Wd.prototype._checkFullscreenSupport=function(){return!!(a.window.document.fullscreenEnabled||a.window.document.mozFullScreenEnabled||a.window.document.msFullscreenEnabled||a.window.document.webkitFullscreenEnabled)},Wd.prototype._setupUI=function(){var b=this._fullscreenButton=na.create("button",this._className+"-icon "+this._className+"-fullscreen",this._controlContainer);b.setAttribute("aria-label","Toggle fullscreen"),b.type="button",this._fullscreenButton.addEventListener("click",this._onClickFullscreen),a.window.document.addEventListener(this._fullscreenchange,this._changeIcon)},Wd.prototype._isFullscreen=function(){return this._fullscreen},Wd.prototype._changeIcon=function(){(a.window.document.fullscreenElement||a.window.document.mozFullScreenElement||a.window.document.webkitFullscreenElement||a.window.document.msFullscreenElement)===this._container!==this._fullscreen&&(this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle(this._className+"-shrink"),this._fullscreenButton.classList.toggle(this._className+"-fullscreen"))},Wd.prototype._onClickFullscreen=function(){this._isFullscreen()?a.window.document.exitFullscreen?a.window.document.exitFullscreen():a.window.document.mozCancelFullScreen?a.window.document.mozCancelFullScreen():a.window.document.msExitFullscreen?a.window.document.msExitFullscreen():a.window.document.webkitCancelFullScreen&&a.window.document.webkitCancelFullScreen():this._container.requestFullscreen?this._container.requestFullscreen():this._container.mozRequestFullScreen?this._container.mozRequestFullScreen():this._container.msRequestFullscreen?this._container.msRequestFullscreen():this._container.webkitRequestFullscreen&&this._container.webkitRequestFullscreen()};var Xd={closeButton:!0,closeOnClick:!0,className:""},Yd=function(b){function c(c){b.call(this),this.options=a.extend(Object.create(Xd),c),a.bindAll(["_update","_onClickClose","remove"],this)}return b&&(c.__proto__=b),c.prototype=Object.create(b&&b.prototype),c.prototype.constructor=c,c.prototype.addTo=function(b){return this._map=b,this._map.on("move",this._update),this.options.closeOnClick&&this._map.on("click",this._onClickClose),this._map.on("remove",this.remove),this._update(),this.fire(new a.Event("open")),this},c.prototype.isOpen=function(){return!!this._map},c.prototype.remove=function(){return this._content&&na.remove(this._content),this._container&&(na.remove(this._container),delete this._container),this._map&&(this._map.off("move",this._update),this._map.off("click",this._onClickClose),this._map.off("remove",this.remove),delete this._map),this.fire(new a.Event("close")),this},c.prototype.getLngLat=function(){return this._lngLat},c.prototype.setLngLat=function(b){return this._lngLat=a.LngLat.convert(b),this._pos=null,this._update(),this},c.prototype.setText=function(b){return this.setDOMContent(a.window.document.createTextNode(b))},c.prototype.setHTML=function(b){var c,d=a.window.document.createDocumentFragment(),e=a.window.document.createElement("body");for(e.innerHTML=b;c=e.firstChild;)d.appendChild(c);return this.setDOMContent(d)},c.prototype.setDOMContent=function(a){return this._createContent(),this._content.appendChild(a),this._update(),this},c.prototype._createContent=function(){this._content&&na.remove(this._content),this._content=na.create("div","mapboxgl-popup-content",this._container),this.options.closeButton&&(this._closeButton=na.create("button","mapboxgl-popup-close-button",this._content),this._closeButton.type="button",this._closeButton.setAttribute("aria-label","Close popup"),this._closeButton.innerHTML="&#215;",this._closeButton.addEventListener("click",this._onClickClose))},c.prototype._update=function(){var b=this;if(this._map&&this._lngLat&&this._content){this._container||(this._container=na.create("div","mapboxgl-popup",this._map.getContainer()),this._tip=na.create("div","mapboxgl-popup-tip",this._container),this._container.appendChild(this._content),this.options.className&&this.options.className.split(" ").forEach(function(a){return b._container.classList.add(a)})),this._map.transform.renderWorldCopies&&(this._lngLat=ha(this._lngLat,this._pos,this._map.transform));var c=this._pos=this._map.project(this._lngLat),d=this.options.anchor,e=function b(c){if(c){if("number"==typeof c){var d=Math.round(Math.sqrt(.5*Math.pow(c,2)));return{center:new a.Point(0,0),top:new a.Point(0,c),"top-left":new a.Point(d,d),"top-right":new a.Point(-d,d),bottom:new a.Point(0,-c),"bottom-left":new a.Point(d,-d),"bottom-right":new a.Point(-d,-d),left:new a.Point(c,0),right:new a.Point(-c,0)}}if(c instanceof a.Point||Array.isArray(c)){var e=a.Point.convert(c);return{center:e,top:e,"top-left":e,"top-right":e,bottom:e,"bottom-left":e,"bottom-right":e,left:e,right:e}}return{center:a.Point.convert(c.center||[0,0]),top:a.Point.convert(c.top||[0,0]),"top-left":a.Point.convert(c["top-left"]||[0,0]),"top-right":a.Point.convert(c["top-right"]||[0,0]),bottom:a.Point.convert(c.bottom||[0,0]),"bottom-left":a.Point.convert(c["bottom-left"]||[0,0]),"bottom-right":a.Point.convert(c["bottom-right"]||[0,0]),left:a.Point.convert(c.left||[0,0]),right:a.Point.convert(c.right||[0,0])}}return b(new a.Point(0,0))}(this.options.offset);if(!d){var f,g=this._container.offsetWidth,h=this._container.offsetHeight;f=c.y+e.bottom.y<h?["top"]:c.y>this._map.transform.height-h?["bottom"]:[],c.x<g/2?f.push("left"):c.x>this._map.transform.width-g/2&&f.push("right"),d=0===f.length?"bottom":f.join("-")}var i=c.add(e[d]).round();na.setTransform(this._container,Qd[d]+" translate("+i.x+"px,"+i.y+"px)"),ia(this._container,d,"popup")}},c.prototype._onClickClose=function(){this.remove()},c}(a.Evented),Zd={version:a.version,supported:ma,setRTLTextPlugin:a.setRTLTextPlugin,Map:Md,NavigationControl:Od,GeolocateControl:Td,AttributionControl:Gd,ScaleControl:Vd,FullscreenControl:Wd,Popup:Yd,Marker:Rd,Style:gc,LngLat:a.LngLat,LngLatBounds:a.LngLatBounds,Point:a.Point,MercatorCoordinate:a.MercatorCoordinate,Evented:a.Evented,config:a.config,get accessToken(){return a.config.ACCESS_TOKEN},set accessToken(b){a.config.ACCESS_TOKEN=b},get baseApiUrl(){return a.config.API_URL},set baseApiUrl(b){a.config.API_URL=b},get workerCount(){return Db.workerCount},set workerCount(a){Db.workerCount=a},get maxParallelImageRequests(){return a.config.MAX_PARALLEL_IMAGE_REQUESTS},set maxParallelImageRequests(b){a.config.MAX_PARALLEL_IMAGE_REQUESTS=b},workerUrl:""};return Zd}),d}),L.MapboxGL=L.Layer.extend({options:{updateInterval:32},initialize:function(a){if(L.setOptions(this,a),!a.accessToken)throw new Error("You should provide a Mapbox GL access token as a token option.");mapboxgl.accessToken=a.accessToken;this._throttledUpdate=function(a,b,c){var d,e,f,g;return g=function(){d=!1,e&&(f.apply(c,e),e=!1)},f=function(){d?e=arguments:(a.apply(c,arguments),setTimeout(g,b),d=!0)}}(L.Util.bind(this._update,this),this.options.updateInterval)},onAdd:function(a){this._glContainer||this._initContainer(),a._panes.tilePane.appendChild(this._glContainer),this._initGL(),this._offset=this._map.containerPointToLayerPoint([0,0]),a.options.zoomAnimation&&L.DomEvent.on(a._proxy,L.DomUtil.TRANSITION_END,this._transitionEnd,this)},onRemove:function(a){this._map.options.zoomAnimation&&L.DomEvent.off(this._map._proxy,L.DomUtil.TRANSITION_END,this._transitionEnd,this),a.getPanes().tilePane.removeChild(this._glContainer),this._glMap.remove(),this._glMap=null},getEvents:function(){return{move:this._throttledUpdate,zoomanim:this._animateZoom,zoom:this._pinchZoom,zoomstart:this._zoomStart,zoomend:this._zoomEnd}},_initContainer:function(){var a=this._glContainer=L.DomUtil.create("div","leaflet-gl-layer"),b=this._map.getSize();a.style.width=b.x+"px",a.style.height=b.y+"px"},_initGL:function(){var a=this._map.getCenter(),b=L.extend({},this.options,{container:this._glContainer,interactive:!1,center:[a.lng,a.lat],zoom:this._map.getZoom()-1,attributionControl:!1});this._glMap=new mapboxgl.Map(b),this._glMap.transform.latRange=null,L.DomUtil.addClass(this._glMap._canvas,"leaflet-image-layer"),L.DomUtil.addClass(this._glMap._canvas,"leaflet-zoom-animated")},_update:function(a){if(this._offset=this._map.containerPointToLayerPoint([0,0]),!this._zooming){var b=this._map.getSize(),c=this._glContainer,d=this._glMap,e=this._map.containerPointToLayerPoint([0,0]);L.DomUtil.setPosition(c,e);var f=this._map.getCenter(),g=d.transform;g.center=mapboxgl.LngLat.convert([f.lng,f.lat]),g.zoom=this._map.getZoom()-1,d.transform.width!==b.x||d.transform.height!==b.y?(c.style.width=b.x+"px",c.style.height=b.y+"px",null!==d._resize&&void 0!==d._resize?d._resize():d.resize()):d._update()}},_pinchZoom:function(a){this._glMap.jumpTo({zoom:this._map.getZoom()-1,center:this._map.getCenter()})},_animateZoom:function(a){var b=this._map.getZoomScale(a.zoom),c=this._map._latLngToNewLayerPoint(this._map.getBounds().getNorthWest(),a.zoom,a.center);L.DomUtil.setTransform(this._glMap._canvas,c.subtract(this._offset),b)},_zoomStart:function(a){this._zooming=!0},_zoomEnd:function(){var a=this._map.getZoomScale(this._map.getZoom()),b=this._map._latLngToNewLayerPoint(this._map.getBounds().getNorthWest(),this._map.getZoom(),this._map.getCenter());L.DomUtil.setTransform(this._glMap._canvas,b.subtract(this._offset),a),this._zooming=!1},_transitionEnd:function(a){L.Util.requestAnimFrame(function(){var a=this._map.getZoom(),b=this._map.getCenter(),c=this._map.latLngToContainerPoint(this._map.getBounds().getNorthWest());L.DomUtil.setTransform(this._glMap._canvas,c,1),this._glMap.once("moveend",L.Util.bind(function(){this._zoomEnd()},this)),this._glMap.jumpTo({center:b,zoom:a-1})},this)}}),L.mapboxGL=function(a){return new L.MapboxGL(a)};var WEBAPP_BASEPATH="/",API_BASEPATH="/",MAP=null,WEBAPP_BASE_URL_ABSOLUTE_PROTOCOL="https",WEBAPP_BASE_URL_ABSOLUTE_HOST="maps.clevelandmetroparks.com",WEBAPP_BASE_URL_ABSOLUTE=WEBAPP_BASE_URL_ABSOLUTE_PROTOCOL+"://"+WEBAPP_BASE_URL_ABSOLUTE_HOST+"/",NATIVE_APP=!1,BBOX_SOUTHWEST=L.latLng(41.11816,-82.08504),BBOX_NORTHEAST=L.latLng(41.70009,-81.28029),MAX_BOUNDS=L.latLngBounds(BBOX_SOUTHWEST,BBOX_NORTHEAST),MIN_ZOOM=2,MAX_ZOOM=18,DEFAULT_POI_ZOOM=15,GEOCODE_BIAS_BOX="41.202048178648, -81.9627793163304, 41.5885467839419, -81.386224018357",PRINT_URL="/pdf/create.json",PRINT_PICKUP_BASEURL="/pdf/",BING_API_KEY="AjBuYw8goYn_CWiqk65Rbf_Cm-j1QFPH-gGfOxjBipxuEB2N3n9yACKu5s8Dl18N",PRINT_SIZES={"Letter portrait":[580,714],"Letter landscape":[762,526],"Ledger portrait":[744,1126],"Ledger landscape":[1178,690]};const MAPBOX_TOKEN="pk.eyJ1IjoiY2xldmVsYW5kLW1ldHJvcGFya3MiLCJhIjoiWHRKaDhuRSJ9.FGqNSOHwiCr2dmTH2JTMAA";L.mapbox.accessToken=MAPBOX_TOKEN;const MAPBOX_MAP_URL_FRAG="cleveland-metroparks/cisvvmgwe00112xlk4jnmrehn";var LAYER_MAPBOX_MAP=L.tileLayer("https://api.mapbox.com/styles/v1/"+MAPBOX_MAP_URL_FRAG+"/tiles/{z}/{x}/{y}?access_token="+L.mapbox.accessToken,{tileSize:512,zoomOffset:-1,attribution:'© <a href="https://www.mapbox.com/map-feedback/">Mapbox</a> © <a href="http://www.openstreetmap.org/copyright">OpenStreetMap</a>'});const MAPBOX_SAT_URL_FRAG="cleveland-metroparks/cjcutetjg07892ro6wunp2da9";var LAYER_MAPBOX_SAT=L.tileLayer("https://api.mapbox.com/styles/v1/"+MAPBOX_SAT_URL_FRAG+"/tiles/{z}/{x}/{y}?access_token="+L.mapbox.accessToken,{tileSize:512,zoomOffset:-1,attribution:'© <a href="https://www.mapbox.com/map-feedback/">Mapbox</a> © <a href="http://www.openstreetmap.org/copyright">OpenStreetMap</a>'}),LAYER_MAPBOX_GL_MAP=L.mapboxGL({accessToken:MAPBOX_TOKEN,style:"mapbox://styles/"+MAPBOX_MAP_URL_FRAG});const ALL_LAYERS=[LAYER_MAPBOX_MAP,LAYER_MAPBOX_SAT,LAYER_MAPBOX_GL_MAP],AVAILABLE_LAYERS={map:LAYER_MAPBOX_MAP,photo:LAYER_MAPBOX_SAT,vector:LAYER_MAPBOX_GL_MAP};WEBAPP_BASEPATH="https://maps.clevelandmetroparks.com/",API_BASEPATH="https://maps.clevelandmetroparks.com/";var CM_SITE_BASEURL="http://www.clevelandmetroparks.com/",isMobile=/Mobi/.test(navigator.userAgent),ICON_TARGET=L.icon({iconUrl:WEBAPP_BASEPATH+"static/images/markers/marker-target.png",iconSize:[25,41],iconAnchor:[13,41],popupAnchor:[0,-41]}),MARKER_TARGET=L.marker(L.latLng(0,0),{clickable:!1,draggable:!1,icon:ICON_TARGET}),ICON_GPS=L.icon({iconUrl:WEBAPP_BASEPATH+"static/images/markers/marker-gps.svg",iconSize:[25,41],iconAnchor:[13,41],popupAnchor:[0,-41]}),MARKER_GPS=L.marker(L.latLng(0,0),{clickable:!1,draggable:!1,icon:ICON_GPS}),ICON_FROM=L.icon({iconUrl:WEBAPP_BASEPATH+"static/images/markers/measure1.png",iconSize:[20,34],iconAnchor:[10,34]}),ICON_TO=L.icon({iconUrl:WEBAPP_BASEPATH+"static/images/markers/measure2.png",iconSize:[20,34],iconAnchor:[10,34]}),MARKER_FROM=L.marker(L.latLng(0,0),{clickable:!0,draggable:!0,icon:ICON_FROM}),MARKER_TO=L.marker(L.latLng(0,0),{clickable:!0,draggable:!0,icon:ICON_TO}),INFO_POPUP_OPTIONS={className:"info-popup"},INFO_POPUP=L.popup(INFO_POPUP_OPTIONS),CIRCLE=new L.Circle(L.latLng(0,0),1),ELEVATION_PROFILE=null,HIGHLIGHT_LINE=null,HIGHLIGHT_LINE_STYLE={color:"#01B3FD",weight:6,opacity:.75,clickable:!1,smoothFactor:.25},ENABLE_MAPCLICK=!0,SKIP_TO_DIRECTIONS=!1,SETTINGS=[];SETTINGS.coordinate_format="dms";