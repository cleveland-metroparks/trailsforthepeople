function callGetBeachClosures(e){return $.ajax({url:API_BASEPATH+"ajax/get_beach_closures",dataType:"json",data:e}).done(function(e){displayBeachClosures(e.results)}).fail(function(e,t,a){console.log("callGetBeachClosures "+t+": "+a)})}function displayBeachClosures(e){for(var t=[],a=0;a<e.length;a++){var s=e[a];t.push(turf.point([s.lng,s.lat],{status_color:s.status_color,name:s.name,date_updated:s.date_updated,external_link:s.external_link,status_color:s.status_color,status_text:s.status_text}))}MAP.addLayer({id:"beach_closures",type:"circle",source:{type:"geojson",data:{type:"FeatureCollection",features:t}},paint:{"circle-radius":10,"circle-color":["concat","#",["get","status_color"]]}}),MAP.on("click","beach_closures",function(e){for(var t=e.features[0].geometry.coordinates.slice(),a=beachPopupMarkup(e.features[0].properties);180<Math.abs(e.lngLat.lng-t[0]);)t[0]+=e.lngLat.lng>t[0]?360:-360;(new mapboxgl.Popup).setLngLat(t).setHTML(a).addTo(MAP)}),MAP.on("mouseenter","beach_closures",function(){MAP.getCanvas().style.cursor="pointer"}),MAP.on("mouseleave","beach_closures",function(){MAP.getCanvas().style.cursor=""})}function beachPopupMarkup(e){return markup="<h3>"+e.name+"</h3>",e.status_text&&(markup+="<p>Status: <strong>"+e.status_text+"</strong></p>"),e.external_link&&(markup+="<p>Water Quality: "+e.external_link+"</p>"),e.date_updated&&(markup+='<p style="font-size: 90% !important">Updated '+e.date_updated+"</p>"),markup}$(document).ready(function(){initMap({base:"map"}),MAP.scrollZoom.disable(),callGetBeachClosures()});