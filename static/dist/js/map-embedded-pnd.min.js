const projectDataGeoJsonUrl=WEBAPP_BASEPATH+"test/pnd-markers.geojson";let markerClasses=[{id:"reservation",text:"Reservation Capital Project",color:"blue"},{id:"trail",text:"Trail Project",color:"#397a11"},{id:"restoration",text:"Ecological Restoration and Site Improvements",color:"#ec8200"},{id:"golf",text:"Golf Capital Project",color:"black"},{id:"expansion",text:"New Reservations/Major Park Expansions",color:"Red"},{id:"zoo",text:"Zoo Capital Project",color:"DarkViolet"}],categoriesUsed=[];$.getJSON(projectDataGeoJsonUrl,(function(e){e.features.forEach(e=>{const t=e.properties["Map Class"];categoriesUsed.includes(t)||categoriesUsed.unshift(t)})})).done((function(){markerClasses=markerClasses.filter(e=>categoriesUsed.includes(e.text))})),$(document).ready((function(){var e={base:DEFAULT_LAYER,scrollZoom:!1,trackUserLocation:!1};initMap(e)})),$(document).on("mapInitialized",(function(){MAP.on("load",()=>{const e=document.getElementById("map_legend");markerClasses.forEach((t,o,r)=>{const a="source-"+t.id,c="layer-"+t.id,s="layer-cluster-"+t.id,i="layer-cluster-count-"+t.id;MAP.addSource(a,{type:"geojson",data:projectDataGeoJsonUrl,filter:["==",["get","Map Class"],t.text],cluster:!0,clusterMinPoints:2,clusterMaxZoom:9}),MAP.addLayer({id:c,type:"circle",source:a,filter:["!has","point_count"],paint:{"circle-radius":10,"circle-color":t.color,"circle-stroke-width":1,"circle-stroke-color":"white"}}),MAP.addLayer({id:s,type:"circle",source:a,filter:["has","point_count"],paint:{"circle-color":t.color,"circle-radius":["step",["get","point_count"],12,2,16,4,20],"circle-stroke-width":1,"circle-stroke-color":"white"}}),MAP.addLayer({id:i,type:"symbol",source:a,filter:["has","point_count"],layout:{"text-field":"{point_count}","text-font":["Open Sans Semibold","Arial Unicode MS Bold"],"text-size":16},paint:{"text-color":"white"}}),MAP.on("mousemove",c,e=>{MAP.getCanvas().style.cursor="pointer"}),MAP.on("mouseleave",c,()=>{MAP.getCanvas().style.cursor=""}),MAP.on("click",c,e=>{const t=e.features[0].geometry.coordinates.slice(),o='<h2 class="project-name">'+e.features[0].properties.Project+'</h2><p class="project-type">'+e.features[0].properties["Project Type"]+'</p><p class="project-link"><a class="project-link"><a href="'+e.features[0].properties["Project Page Link"]+'">More info</a></p>';for(;Math.abs(e.lngLat.lng-t[0])>180;)t[0]+=e.lngLat.lng>t[0]?360:-360;(new mapboxgl.Popup).setLngLat(t).setHTML(o).addTo(MAP)});const l=t.color,n=document.createElement("div"),d=document.createElement("span");d.className="legend_key",d.style.backgroundColor=l;const p=document.createElement("span");p.innerHTML=""+t.text,n.appendChild(d),n.appendChild(p),e.appendChild(n)})})}));