L.Control.ScaleBar=L.Class.extend({onAdd:function(e){this._pixelwidth=100;this._map=e;this._maptrigger_move=this._map.on("moveend",this._update,this);this._maptrigger_zoom=this._map.on("zoomend",this._update,this);this._container=L.DomUtil.create("div","leaflet-control-scalebar");this._container.style.overflow="hidden";this._container.style.width=this._pixelwidth+"px";this._container.style.height="15px";this._container.style.backgroundColor="white";this._container.style.borderColor="black";this._container.style.borderStyle="solid";this._container.style.borderWidth="0 5px 0 5px";this._container.style.fontSize="8pt";this._container.style.textAlign="center";this._update()},onRemove:function(e){e.off("moveend",this._maptrigger_move,this);e.off("zoomend",this._maptrigger_zoom,this)},getPosition:function(){return L.Control.Position.BOTTOM_LEFT},getContainer:function(){return this._container},_update:function(){if(!this._map)return;var e=this._map.getBounds();var t=e.getSouthWest();var n=e.getNorthEast();var r=(t.lng+n.lng)/2;var i=new L.LatLng(n.lat,r);var s=new L.LatLng(t.lat,r);var o=s.distanceTo(i);var u=this._map.getSize().y;var a=o/u;var f=this._pixelwidth*a;var l=f*3.2808399;var c=f*.000621371192;var h=Math.round(l)+" ft";var p=c.toFixed(2)+" mi";var d=l<1320?h:p;this._container.innerHTML=d}})